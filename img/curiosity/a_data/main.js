/*! For license information please see main.js.LICENSE.txt */
(()=>{var t,e=[(t,e,i)=>{"use strict";i.r(e);var s=i(1),n=i(2);document.addEventListener("DOMContentLoaded",(async()=>{await s.default.init(),window.app=s.default,window.Pioneer=n;try{await s.default.createManagers(),await s.default.createScene(),await s.default.createSceneManagers(),await s.default.createComponents(),s.default.createRouter()}catch(t){console.log(t)}}))},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>S});var s=i(2),n=i(125),r=(i(260),i(261),i(262),i(263),i(264)),o=i(405),a=i(408),l=i(410),h=i(414),c=i(416),d=i(419),u=i(421),_=i(422),g=i(423),p=i(424),m=i(426),f=i(428),y=i(430),T=i(431),E=i(433),x=i(435),v=i(438);const b=new class App{constructor(){this._router=null,this._selector=null,this._selectedEntity="",this._labelClicked=!1,this._hasMouse=!1;const onMouseMove=function(){this._hasMouse=!0,document.body.classList.remove("touch"),window.removeEventListener("mousemove",onMouseMove)};window.addEventListener("mousemove",(()=>{this._hasMouse=!0,window.removeEventListener("mousemove",onMouseMove)})),this._touchStartPos={x:0,y:0},this._dragging=!1,this._camera=null,this._managerTypes={label:p.default,compareManager:y.default,search:a.default,content:g.default,scene:T.default,time:r.default},this._managers={},this._componentTypes={clock:d.default,controls:c.default,searchBar:o.default,messageBar:m.default,detailsPanel:l.default,navigationBar:h.default,compareMenu:E.default,options:f.default},this._components={},this._isMetric=!0,this._conversionTable={kmToMi:.621371,kmToFt:3280.84,miToFt:5280},this._customLabels={"486958_2014_mu69":"Arrokoth","67p_churyumov_gerasimenko":"67P/C-G","1p_halley":"Halley's comet","9p_tempel_1":"Tempel 1","81p_wild_2":"Wild 2",c_1995_o1:"Hale-Bopp",sc_mars_science_laboratory:"Curiosity",sc_perseverance:"Perseverance"},this._trailTrimCategories={Spacecraft:4,Asteroid:4,"Dwarf Planet":4,Comet:8},this._customTrails={"67p_churyumov_gerasimenko":16935912,c_1995_o1:398651382,"81p_wild_2":28270350,"65803_didymos":27958776,sc_parker_solar_probe:12942631/8},this._isNASAEmbed=!1}async init(){const t=document.getElementById("pioneer");t.style.position="absolute",this._pioneer=new s.Engine(t),this._pioneer.getDownloader().setReplacement("STATIC_ASSETS_URL",window.config.staticAssetsUrl),this._pioneer.getDownloader().setReplacement("DYNAMIC_ASSETS_URL",window.config.dynamicAssetsUrl),this._pioneer.getDownloader().setReplacement("ANIMDATA_URL",window.config.animdataUrl),this._pioneer.getConfig().setValue("fontFamily","Raleway"),this._pioneer.getConfig().setValue("fontSize",16),this._pioneer.getConfig().setValue("pbr",!0),this._pioneer.getConfig().setValue("gammaCorrection",1);try{window.self!==window.top&&b.isNASADomain(document.referrer)&&(this._isNASAEmbed=!0,b.hideNASALogo())}catch(t){}this._pioneer.registerComponentType("wmts",n.WMTSComponent),this._pioneer.setTime(s.TimeUtils.now()),this._pioneer.setTimeRate(1),this.isTouch()&&document.body.classList.add("touch"),this._touchCount=0,this._scrollable=!1,this._touchMax=!1,window.addEventListener("touchstart",(t=>{this._touchCount++,this._touchMax=this._touchCount>1,this._labelClicked=!1;const e=t.changedTouches[0];this._touchStartPos.x=e.pageX,this._touchStartPos.y=e.pageY,this._dragging=!1,this._scrollable=!1;let i=t.target;for(;null!==i.parentElement;){if(i.classList.contains("scrollable")){this._scrollable=!0;break}i=i.parentElement}}),!1),window.addEventListener("touchmove",(t=>{const e=t.changedTouches[0];Math.max(Math.abs(e.pageX-this._touchStartPos.x),Math.abs(e.pageY-this._touchStartPos.y))>5&&(this._dragging=!0),this._scrollable||t.preventDefault()}),{passive:!1}),window.addEventListener("touchend",(t=>{this._touchCount--,0===t.touches.length&&(this._touchMax=!1),this._dragging=!1,this._scrollable=!1}))}async createManagers(){this._addManager("time","time",this._pioneer);const t=this._addManager("content","content",this._pioneer);await t.init(),this._addManager("search","search",t.getEntityList())}async createComponents(){this._addComponent("clock","clock",document.getElementById("clock"),this._pioneer);const t=this._addComponent("compareMenu","compareMenu",document.getElementById("compare-bar"),this.get("compareManager").getScene());await t.init(),this._addComponent("controls","controls",document.getElementById("controls-bar"),this._pioneer),this._addComponent("messageBar","messageBar",document.getElementById("message-bar")),this._addComponent("searchBar","searchBar",document.getElementById("search-bar"),this._pioneer),this._addComponent("detailsPanel","detailsPanel",document.getElementById("details-panel"),this._pioneer,this._scene),this._addComponent("navigationBar","navigationBar",document.getElementById("navigation-bar"),this._pioneer),this._addComponent("options","options",document.getElementById("options")),this._timeRateSlider=new x.default(document.getElementById("time-slider"),this._pioneer),this._timeRateSlider.setEnabled(!1);const e=this.get("time");e.setManagedComponents({update:["clock"],setDisplayUTC:["clock"],setTime:[]}),e.setDisplayUTC(!1)}async createSceneManagers(){this._addManager("scene","scene",this._pioneer,this._scene),this._addManager("label","label",this._scene._entities,this._pioneer),this._managers.label.setWeights(this.get("content").getEntityList()),this._managers.label.setAlgorithm(p.default.Quadtree),this._pioneer.addCallback(this._managers.label.update,!0),this._addManager("compareManager","compareManager",this._scene,this._pioneer),this._managers.compareManager._init()}_addManager(t,e,...i){const s=this._managerTypes[e];return void 0===this._managers[t]&&(this._managers[t]=new s(...i)),this._managers[t]}_addComponent(t,e,...i){const s=this._componentTypes[e];return void 0===this._components[t]&&(this._components[t]=new s(...i)),this._components[t]}getComponents(){return this._components}sendNotification(t,e={}){this.get("messageBar").showNotification(t,e)}search(t){return null===b.get("search")?[]:b.get("search").search(t)}async createScene(){this._scene=this._pioneer.addScene("main"),this._scene.setAmbientLightColor(new s.Color(.005,.005,.005)),this._selector=new u.default(this._scene),this.createViewportAndCamera(),this._selector.selectEntity("outer_solar_system");const t=this._scene.get("camera").addComponent("dynEnvMap");n.Entity.create("milky_way",this._scene,{milkyWaySprite:!0}),n.Entity.createGroup("stars",this._scene),n.Entity.createGroup("planets",this._scene),this._sun=this._scene.get("sun"),this._comparisonObjects=new Set(["scientist","school_bus","rose_bowl"]),this._comparisonObjects.forEach((t=>{const e=n.Entity.create(t,this._scene);e.setParent(this._sun),e.setEnabled(!1);const i=e.get("div").getDiv(),s=e.getName();i.className+=" no-select "+s;const r=document.createElement("span");r.className="icon";const o=document.createElement("span");o.innerHTML=i.innerHTML,i.innerHTML="",i.appendChild(r),i.appendChild(o)}));for(const e in this.get("content").getEntityList()){const i=n.Entity.create(e,this._scene),r=this.get("content").getEntityInfo(e);if("sc_perseverance"===e){const t=666952142;let e=i.addController("coverage");e instanceof s.CoverageController&&e.addCoverage(new s.Interval(t+949.453,Number.POSITIVE_INFINITY),(t=>{const e=t.get("model");e instanceof s.ModelComponent&&e.setEnabled(!1)}),(t=>{const e=t.get("model");e instanceof s.ModelComponent&&e.setEnabled(!0)}));const r=n.Entity.create("sc_perseverance_landing_site",this._scene);r.get("div").setEnabled(!1),r.setCanOcclude(!1),e=r.addController("coverage"),e instanceof s.CoverageController&&e.addCoverage(new s.Interval(t+949.453,Number.POSITIVE_INFINITY),(t=>{const e=r.get("div");e instanceof s.DivComponent&&e.setEnabled(!1)}),(t=>{const e=r.get("div");e instanceof s.DivComponent&&e.setEnabled(!0)}))}else if("sc_mars_science_laboratory"===e){n.Entity.create("sc_mars_science_laboratory_landing_site",this._scene).get("div").setEnabled(!1),i.get("div").setFadeWhenCloseToEntity("mars")}const o=i.get("trail");null!==o&&void 0!==this._customTrails[i.getName()]?o.setStartTime(this._customTrails[i.getName()]):void 0!==this._trailTrimCategories[r.category]&&void 0!==o.getStartTime()&&o.setStartTime(o.getStartTime()/this._trailTrimCategories[r.category]);const a=i.get("model");null!==a&&a.setDynamicEnvironmentMapComponent(t)}n.Entity.create("134340_pluto_barycenter",this._scene);const e=this._scene.get("sc_lucy");for(let t=0;;t++){const i=e.getControllerByType("dynamo",t);if(null===i)break;const s=i.getBaseUrl();s.includes("/earth")||s.includes("/sun/")||s.includes("/quat")||(e.removeController(i),t--)}const i=this._scene.get("mercury");let r=i.getComponentByType("spheroidLOD");null===r&&(r=i.addComponent("spheroidLOD"),r.setTexture("color","$STATIC_ASSETS_URL/maps/mercury/color_$SIZE_$FACE.png",[4,512,4096]),r.setMapping("cube"));return null!==i.getComponentByType("cmts")&&i.getComponentByType("cmts").setEnabled(!1),await this._scene.getLoadedPromise(),this._createLabels(),this._pioneer.waitUntilNextFrame()}_createLabels(){const t=this._scene.get("camera").getComponentByType("camera");for(let e=0,i=this._scene.getNumEntities();e<i;e++){const i=this._scene.getEntity(e),s=i.get("div");if(null!==s){s.setActiveCamera(t);const e=s.getDiv(),n=this.get("content").getClassName(i.getName());e.className+=" no-select "+n;const r=document.createElement("span");r.className="icon";const o=document.createElement("span");o.className="text",void 0!==this._customLabels[i.getName()]?o.innerHTML=this._customLabels[i.getName()]:o.innerHTML=e.innerHTML,e.innerHTML="",e.appendChild(r),e.appendChild(o),window.addEventListener("mousedown",(t=>{this._labelClicked=!1}),!1),e.addEventListener("click",(async t=>{if(this._selector.getCurrentId()===i.getName()){const t="/"+i.getName(),e={time:b.get("time").getTimeUrl()};await this._router.navigate(t,e)}else this._selector.selectEntity(i.getName());this._labelClicked=!0,t.preventDefault()}),!1),e.addEventListener("touchend",(async t=>{if(!this._dragging&&0===t.touches.length&&!this._touchMax){if(this._selector.getCurrentId()===i.getName()){const t="/"+i.getName(),e={time:b.get("time").getTimeUrl()};await this._router.navigate(t,e)}else this._selector.selectEntity(i.getName());this._labelClicked=!0,t.preventDefault()}}),!1),e.addEventListener("mousemove",(t=>{t.preventDefault()}),!0),e.style.cursor="pointer"}}}async createViewportAndCamera(){this._viewport=this._pioneer.addViewport("main-viewport"),this._viewport.getDiv().style.width="100%",this._viewport.getDiv().style.height="100%",this._viewport.getDiv().style.left="0",this._viewport.getDiv().style.top="0";const t=this._scene.addEntity("camera");t.setOrientation(s.Quaternion.Identity);const e=t.addComponent("camera");this._viewport.setCamera(e),this._camera=new _.default(this._scene,this._selector)}createRouter(){this._router=new v.default}get pioneer(){return this._pioneer}get scene(){return this._scene}get labelClicked(){return this._labelClicked}get camera(){return this._camera}get router(){return this._router}get managers(){return this._managers}get selector(){return this._selector}get(t){return void 0!==this._components[t]?this._components[t]:void 0!==this._managers[t]?this._managers[t]:null}isMobile(){return!!window.matchMedia("(max-width: 64em)").matches}isLandscape(){return!(!window.matchMedia("(orientation: landscape)").matches||!window.matchMedia("(max-height: 32em)").matches)}is2K(){return!!window.matchMedia("(min-width: 180em) and (min-height: 64em)").matches}is4K(){return!!window.matchMedia("(min-width: 200em) and (min-height: 90em)").matches}isTouch(){return!(!("ontouchstart"in window||window.navigator.msMaxTouchPoints>0)||this._hasMouse)}isFullscreen(){return this.get("controls").isFullscreen()}toggleFullscreen(){this.get("controls").toggleFullscreen()}isComparing(){return null!==this.get("compareManager")&&this.get("compareManager").isComparing()}isMetric(){return this._isMetric}toggleUnitSystem(){this._isMetric=!this._isMetric;const t=new CustomEvent("unitSystemToggle",{detail:{metric:this._isMetric}});return window.dispatchEvent(t),this._isMetric}get conversionTable(){return this._conversionTable}isNASADomain(t){return/^https?:\/\/([a-zA-Z\d-]+\.){0,}nasa\.gov.*$/.test(t)}hideNASALogo(){this._isNASAEmbed&&(document.getElementById("nasa-logo").style.display="none")}showNASALogo(){document.getElementById("nasa-logo").style.display="block"}},S=b},(t,e,i)=>{"use strict";i.r(e),i.d(e,{AER:()=>s.AER,AlignController:()=>s.AlignController,AnimdataController:()=>s.AnimdataController,AtmosphereComponent:()=>s.AtmosphereComponent,BaseComponent:()=>s.BaseComponent,BaseController:()=>s.BaseController,BaseRef:()=>s.BaseRef,CMTSComponent:()=>s.CMTSComponent,Cache:()=>s.Cache,CameraComponent:()=>s.CameraComponent,Capabilities:()=>s.Capabilities,Collection:()=>s.Collection,CollectionItem:()=>s.CollectionItem,Color:()=>s.Color,CometTailComponent:()=>s.CometTailComponent,ComponentRef:()=>s.ComponentRef,Config:()=>s.Config,ConnectedSpriteComponent:()=>s.ConnectedSpriteComponent,ControllerRef:()=>s.ControllerRef,CoverageController:()=>s.CoverageController,CubeMap:()=>s.CubeMap,DependencyGraph:()=>s.DependencyGraph,DivComponent:()=>s.DivComponent,Downloader:()=>s.Downloader,DynamicEnvironmentMapComponent:()=>s.DynamicEnvironmentMapComponent,DynamoController:()=>s.DynamoController,Engine:()=>s.Engine,Entity:()=>s.Entity,EntityItem:()=>s.EntityItem,EntityRef:()=>s.EntityRef,FPS:()=>s.FPS,FastIterable:()=>s.FastIterable,FastMap:()=>s.FastMap,FastSet:()=>s.FastSet,FixedController:()=>s.FixedController,FixedToParentController:()=>s.FixedToParentController,FreeFlyController:()=>s.FreeFlyController,Freezable:()=>s.Freezable,Geometry:()=>s.Geometry,GizmoComponent:()=>s.GizmoComponent,GroundClampController:()=>s.GroundClampController,Input:()=>s.Input,Interval:()=>s.Interval,KeyframeController:()=>s.KeyframeController,LabelComponent:()=>s.LabelComponent,LatLonAlt:()=>s.LatLonAlt,LightSourceComponent:()=>s.LightSourceComponent,LineMesh:()=>s.LineMesh,LookController:()=>s.LookController,MaterialManager:()=>s.MaterialManager,MaterialUtils:()=>s.MaterialUtils,MaterialUtilsPhong:()=>s.MaterialUtilsPhong,MaterialUtilsStandard:()=>s.MaterialUtilsStandard,MathUtils:()=>s.MathUtils,ModelAnimateController:()=>s.ModelAnimateController,ModelComponent:()=>s.ModelComponent,OrbitController:()=>s.OrbitController,OrbitKeyframeController:()=>s.OrbitKeyframeController,OrbitalElements:()=>s.OrbitalElements,OrbitalElementsController:()=>s.OrbitalElementsController,OrbitalParticlesComponent:()=>s.OrbitalParticlesComponent,ParticleSprayComponent:()=>s.ParticleSprayComponent,PickController:()=>s.PickController,Pool:()=>s.Pool,Quaternion:()=>s.Quaternion,Reader:()=>s.Reader,Rect:()=>s.Rect,RingsComponent:()=>s.RingsComponent,RollController:()=>s.RollController,RotateByEntityOrientationController:()=>s.RotateByEntityOrientationController,RotateController:()=>s.RotateController,SatelliteJs:()=>s.SatelliteJs,ScaleController:()=>s.ScaleController,Scene:()=>s.Scene,SelectController:()=>s.SelectController,SetParentController:()=>s.SetParentController,ShaderFix:()=>s.ShaderFix,SkyboxComponent:()=>s.SkyboxComponent,Sort:()=>s.Sort,SpheroidComponent:()=>s.SpheroidComponent,SpheroidLODComponent:()=>s.SpheroidLODComponent,SpinController:()=>s.SpinController,SpoutComponent:()=>s.SpoutComponent,SpriteComponent:()=>s.SpriteComponent,SpriteParticles:()=>s.SpriteParticles,StarfieldComponent:()=>s.StarfieldComponent,THREE:()=>s.THREE,TLEController:()=>s.TLEController,TapController:()=>s.TapController,TextureLOD:()=>s.TextureLOD,TextureLoader:()=>s.TextureLoader,TextureLoaderCompressed:()=>s.TextureLoaderCompressed,ThreeJsEffectComposer:()=>s.ThreeJsEffectComposer,ThreeJsGLTFLoader:()=>s.ThreeJsGLTFLoader,ThreeJsHelper:()=>s.ThreeJsHelper,ThreeJsKTXLoader:()=>s.ThreeJsKTXLoader,ThreeJsOutlinePass:()=>s.ThreeJsOutlinePass,ThreeJsRenderPass:()=>s.ThreeJsRenderPass,ThreeJsUnrealBloomPass:()=>s.ThreeJsUnrealBloomPass,Tile:()=>s.Tile,TimeUtils:()=>s.TimeUtils,TrailComponent:()=>s.TrailComponent,TransitionController:()=>s.TransitionController,TranslateController:()=>s.TranslateController,Types:()=>s.Types,Vector2:()=>s.Vector2,Vector3:()=>s.Vector3,Version:()=>s.Version,Viewport:()=>s.Viewport,ZoomController:()=>s.ZoomController});var s=i(3)},(t,e,i)=>{"use strict";i.r(e),i.d(e,{AER:()=>b.default,AlignController:()=>Rt.default,AnimdataController:()=>Mt.default,AtmosphereComponent:()=>lt.default,BaseComponent:()=>at.default,BaseController:()=>Nt.default,BaseRef:()=>d.default,CMTSComponent:()=>ct.default,Cache:()=>L.default,CameraComponent:()=>ht.default,Capabilities:()=>Q.default,Collection:()=>u.Collection,CollectionItem:()=>u.CollectionItem,Color:()=>S.default,CometTailComponent:()=>dt.default,ComponentRef:()=>F.default,Config:()=>q.default,ConnectedSpriteComponent:()=>ut.default,ControllerRef:()=>O.default,CoverageController:()=>Pt.default,CubeMap:()=>z.default,DependencyGraph:()=>_.default,DivComponent:()=>_t.default,Downloader:()=>Z.default,DynamicEnvironmentMapComponent:()=>gt.default,DynamoController:()=>Vt.default,Engine:()=>X.default,Entity:()=>W.default,EntityItem:()=>K.default,EntityRef:()=>U.default,FPS:()=>p.default,FastIterable:()=>g.default,FastMap:()=>I.default,FastSet:()=>C.default,FixedController:()=>Lt.default,FixedToParentController:()=>Ft.default,FreeFlyController:()=>Ot.default,Freezable:()=>m.default,Geometry:()=>w.default,GizmoComponent:()=>pt.default,GroundClampController:()=>zt.default,Input:()=>tt.default,Interval:()=>A.default,KeyframeController:()=>Ut.default,LabelComponent:()=>mt.default,LatLonAlt:()=>D.default,LightSourceComponent:()=>ft.default,LineMesh:()=>j.default,LookController:()=>Dt.default,MaterialManager:()=>et.default,MaterialUtils:()=>J.default,MaterialUtilsPhong:()=>H.default,MaterialUtilsStandard:()=>k.default,MathUtils:()=>f.default,ModelAnimateController:()=>jt.default,ModelComponent:()=>yt.default,OrbitController:()=>Ht.default,OrbitKeyframeController:()=>kt.default,OrbitalElements:()=>N.default,OrbitalElementsController:()=>Jt.default,OrbitalParticlesComponent:()=>Tt.default,ParticleSprayComponent:()=>Et.default,PickController:()=>Gt.default,Pool:()=>y.default,Quaternion:()=>M.default,Reader:()=>T.default,Rect:()=>R.default,RingsComponent:()=>xt.default,RollController:()=>Bt.default,RotateByEntityOrientationController:()=>$t.default,RotateController:()=>Yt.default,SatelliteJs:()=>c,ScaleController:()=>Qt.default,Scene:()=>it.default,SelectController:()=>qt.default,SetParentController:()=>Zt.default,ShaderFix:()=>G.default,SkyboxComponent:()=>vt.default,Sort:()=>E.default,SpheroidComponent:()=>bt.default,SpheroidLODComponent:()=>St.default,SpinController:()=>Xt.default,SpoutComponent:()=>It.default,SpriteComponent:()=>Ct.default,SpriteParticles:()=>B.default,StarfieldComponent:()=>wt.default,THREE:()=>s,TLEController:()=>Kt.default,TapController:()=>Wt.default,TextureLOD:()=>Y.default,TextureLoader:()=>st.default,TextureLoaderCompressed:()=>nt.default,ThreeJsEffectComposer:()=>n.EffectComposer,ThreeJsGLTFLoader:()=>r.GLTFLoader,ThreeJsHelper:()=>$.default,ThreeJsKTXLoader:()=>o.KTXLoader,ThreeJsOutlinePass:()=>a.OutlinePass,ThreeJsRenderPass:()=>l.RenderPass,ThreeJsUnrealBloomPass:()=>h.UnrealBloomPass,Tile:()=>x.default,TimeUtils:()=>v.default,TrailComponent:()=>At.default,TransitionController:()=>te.default,TranslateController:()=>ee.default,Types:()=>se.default,Vector2:()=>P.default,Vector3:()=>V.default,Version:()=>rt.default,Viewport:()=>ot.default,ZoomController:()=>ie.default});var s=i(8),n=i(4),r=i(10),o=i(11),a=i(12),l=i(13),h=i(14),c=i(16),d=i(17),u=i(18),_=i(19),g=i(20),p=i(21),m=i(22),f=i(23),y=i(24),T=i(25),E=i(26),x=i(27),v=i(28),b=i(29),S=i(30),I=i(31),C=i(32),w=i(33),A=i(34),N=i(35),R=i(36),M=i(37),P=i(38),V=i(39),L=i(40),F=i(41),O=i(42),z=i(43),U=i(44),D=i(45),j=i(46),H=i(47),k=i(48),J=i(49),G=i(50),B=i(51),Y=i(52),$=i(53),Q=i(54),q=i(55),Z=i(56),X=i(57),W=i(58),K=i(59),tt=i(60),et=i(61),it=i(69),st=i(70),nt=i(71),rt=i(72),ot=i(73),at=i(74),lt=i(75),ht=i(76),ct=i(77),dt=i(78),ut=i(79),_t=i(80),gt=i(81),pt=i(82),mt=i(83),ft=i(84),yt=i(85),Tt=i(86),Et=i(87),xt=i(88),vt=i(89),bt=i(90),St=i(91),It=i(92),Ct=i(93),wt=i(94),At=i(95),Nt=i(96),Rt=i(97),Mt=i(98),Pt=i(99),Vt=i(100),Lt=i(101),Ft=i(102),Ot=i(103),zt=i(104),Ut=i(105),Dt=i(106),jt=i(107),Ht=i(108),kt=i(109),Jt=i(110),Gt=i(111),Bt=i(112),Yt=i(113),$t=i(114),Qt=i(115),qt=i(116),Zt=i(117),Xt=i(118),Wt=i(119),Kt=i(120),te=i(121),ee=i(122),ie=i(123),se=i(124)},,,,,,,,,,,,,,(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});i(3);const s=class BaseRef{constructor(t){this._scene=t,this._ref=null,this._refChangedCallback=null}get(){return this.update(),this._ref}setRefChangedCallback(t){this._refChangedCallback=t}update(){}_setRef(t){if(null===t||t.isEnabled()||(t=null),this._ref!==t){const e=this._ref;this._ref=t,null!==this._refChangedCallback&&this._refChangedCallback(e,this._ref)}}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{Collection:()=>Collection,CollectionItem:()=>CollectionItem});class CollectionItem{constructor(t,e,i){this._type=t,this._typeIndex=0,this._name=e,this._collectionParent=i}getType(){return this._type}getTypeIndex(){return this._typeIndex}__setTypeIndex(t){this._typeIndex=t}getName(){return this._name}__getCollectionParent(){return this._collectionParent}__destroy(){}}class Collection{constructor(t,e){this._parent=t,this._types=e,this._items=[],this._itemNames=new Map}get(t){if("number"==typeof t)return this._items[t]||null;if("string"==typeof t)return this._itemNames.get(t)||null;throw new Error("The param nameOrIndex must be a string or number.")}getByType(t,e=0){for(let i=0;i<this._items.length;i++){const s=this._items[i];if(s.getType()===t&&s.getTypeIndex()===e)return s}return null}add(t,e="",i){if(""!==e&&this._itemNames.has(e))throw new Error("Already added '"+e+"'.");const s=this._types.get(t);if(void 0===t)throw new Error("Type '"+t+"' not found.");try{const n=new s(t,e,this._parent);if(void 0!==i){let t=this._items.length;for(let e=0;e<this._items.length;e++)this._items[e]===i&&(t=e);this._items.splice(t,0,n)}else this._items.push(n);""!==e&&this._itemNames.set(e,n);let r=0;for(let e=0;e<this._items.length;e++){const i=this._items[e];i.getType()===t&&(i.__setTypeIndex(r),r+=1)}return n}catch(i){throw new Error(`While adding "${e}" of type "${t}": ${i}`)}}remove(t){let e,i,s;if("string"==typeof t){s=this._itemNames.get(t),e=t;for(let t=this._items.length-1;t>=0;t--)if(this._items[t]===s){i=t;break}}else if("number"==typeof t)s=this._items[t],i=t,e=s.getName();else{s=t,e=s.getName();for(let t=this._items.length-1;t>=0;t--)if(this._items[t]===s){i=t;break}}if(void 0!==s&&void 0!==i){const t=this._items[i].getType();this._items.splice(i,1),""!==e&&this._itemNames.delete(e);let n=0;for(let e=0;e<this._items.length;e++){const i=this._items[e];i.getType()===t&&(i.__setTypeIndex(n),n+=1)}s.__destroy()}}clear(){for(let t=this._items.length-1;t>=0;t--)this._items[t].__destroy();this._items=[],this._itemNames.clear()}get size(){return this._items.length}__destroy(){for(let t=this._items.length-1;t>=0;t--)this._items[t].__destroy()}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});class Node{constructor(t){this.item=t,this.permanentMark=!1,this.temporaryMark=!1}}const s=class DependencyGraph{constructor(){this._updateItemCallback=null,this._compareItemCallback=null,this._nodes=new Map,this._sortedNodes=[],this._needsSorting=!1}setUpdateItemCallback(t){this._updateItemCallback=t}setCompareItemCallback(t){this._compareItemCallback=t}addItem(t){const e=new Node(t);this._nodes.set(t,e),this._needsSorting=!0}removeItem(t){this._nodes.delete(t)&&(this._needsSorting=!0)}needsSorting(){this._needsSorting=!0}update(){if(this._needsSorting){for(const t of this._nodes.values())t.permanentMark=!1,t.temporaryMark=!1;this._sortedNodes=[];const t=this._nodes.values();for(;;){const e=t.next();if(e.done)break;if(!this._visit(e.value))break}this._needsSorting=!1}for(let t=0,e=this._sortedNodes.length;t<e;t++)this._updateItemCallback(this._sortedNodes[t].item)}_visit(t){if(t.permanentMark)return!0;if(t.temporaryMark)throw new Error("Dependency cycle in graph: "+t.item);t.temporaryMark=!0;for(const e of this._nodes.values()){let i=!1;if(this._compareItemCallback&&(i=this._compareItemCallback(t.item,e.item)),i)try{this._visit(e)}catch(e){throw new Error(e.message+" ← "+t.item)}}return t.temporaryMark=!1,t.permanentMark=!0,this._sortedNodes.push(t),!0}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s=class FastIterable{getAt(t){throw new Error}get size(){throw new Error}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s=class FPS{constructor(){this._numberOfSamples=100,this._samples=new Array(this._numberOfSamples),this._index=0}getNumberOfSamples(){return this._numberOfSamples}setNumberOfSamples(t){this._numberOfSamples=t,this._samples=new Array(this._numberOfSamples)}getFPS(){let t=0;for(let e=0;e<this._samples.length;e++)t+=this._samples[e];return this._samples.length/t}update(t){this._samples[this._index]=t,this._index=(this._index+1)%this._samples.length}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s=class Freezable{constructor(){this._frozen=!1}throwIfFrozen(){if(this._frozen)throw new TypeError("The object is frozen.")}isFrozen(){return this._frozen}freeze(){this._frozen=!0}thaw(){this._frozen=!1}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s=class MathUtils{static get pi(){return 3.141592653589793}static get twoPi(){return 6.283185307179586}static get halfPi(){return 1.5707963267948966}static angle(t,e){return t=this.wrap(t,0,2*Math.PI),(e=this.wrap(e,0,2*Math.PI))-t>Math.PI?t-e+2*Math.PI:t-e>Math.PI?e-t+2*Math.PI:Math.abs(e-t)}static clamp(t,e,i){return Math.min(Math.max(e,t),i)}static clamp01(t){return Math.min(Math.max(0,t),1)}static wrap(t,e,i){let s=(t-e)%(i-e)+e;return s<e&&(s+=i-e),s}static lerp(t,e,i){return(1-i)*t+i*e}static lerpAngle(t,e,i){return t=this.wrap(t,-Math.PI,+Math.PI),(e=this.wrap(e,-Math.PI,+Math.PI))-t>Math.PI&&(t+=2*Math.PI),t-e>Math.PI&&(e+=2*Math.PI),this.wrap(this.lerp(t,e,i),-Math.PI,+Math.PI)}static radToDeg(t){return 57.29577951308232*t}static degToRad(t){return.01745329251994329*t}static ceilPow2(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.log(2)))}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class Pool extends s.FastIterable{constructor(t){super(),this._type=t,this._objects=[],this._free=[],this._freeLength=0,this._constructorFunction=()=>new this._type,this._destructorFunction=()=>{}}setConstructorFunction(t){this._constructorFunction=t}setDestructorFunction(t){this._destructorFunction=t}get(){let t=null;if(this._freeLength>0)t=this._objects[this._free[this._freeLength-1]],this._freeLength-=1;else{const e=this._objects.push(this._constructorFunction())-1;this._objects[e]._poolIndex=e,t=this._objects[e]}return t._poolUsed=!0,t}release(t){const e=t;void 0!==e._poolIndex&&(this._freeLength>=this._free.length?this._free.push(e._poolIndex):this._free[this._freeLength]=e._poolIndex,this._freeLength+=1,e._poolUsed=!1)}clean(t){if(void 0===t||t>=(this._objects.length-this._freeLength)/this._objects.length){for(let t=0;t<this._freeLength;t++){const e=this._free[t];this._destructorFunction(this._objects[e]),this._objects.splice(e,1);for(let t=e,i=this._objects.length;t<i;t++)this._objects[t]._poolIndex-=1;for(let i=t+1,s=this._freeLength;i<s;i++)this._free[i]>e&&(this._free[i]-=1)}this._free=[],this._freeLength=0}}getAsArray(){return this._objects}isUsed(t){return t._poolUsed}areAnyUsed(){return this._freeLength<this._objects.length}getAt(t){return this._objects[t]}get size(){return this._objects.length}}const n=Pool},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s=class Reader{constructor(t){this._dataView=new DataView(t),this._offset=0}isAtEnd(){return this._offset>=this._dataView.byteLength}readByte(){const t=this._dataView.getUint8(this._offset);return this._offset+=1,t}readFloat32(){const t=this._dataView.getFloat32(this._offset,!0);return this._offset+=4,t}readFloat64(){const t=this._dataView.getFloat64(this._offset,!0);return this._offset+=8,t}readUInt8(){const t=this._dataView.getUint8(this._offset);return this._offset+=1,t}readUInt16(){const t=this._dataView.getUint16(this._offset,!0);return this._offset+=2,t}readUInt32(){const t=this._dataView.getUint32(this._offset,!0);return this._offset+=4,t}readUInt64(){let t=this._dataView.getUint32(this._offset,!0);return t=t<<32||this._dataView.getUint32(this._offset+4,!0),this._offset+=8,t}readInt8(){const t=this._dataView.getInt8(this._offset);return this._offset+=1,t}readInt16(){const t=this._dataView.getInt16(this._offset,!0);return this._offset+=2,t}readInt32(){const t=this._dataView.getInt32(this._offset,!0);return this._offset+=4,t}readInt64(){let t=this._dataView.getInt32(this._offset,!0);return t=t<<32||this._dataView.getInt32(this._offset+4,!0),this._offset+=8,t}readLine(){const t=[];for(;;){const e=this.readByte(),i=String.fromCharCode(e);if("\r"!==i){if("\n"===i)break;t.push(e)}}if("undefined"!=typeof TextEncoder){const e=new TextDecoder,i=new Uint8Array(t);return e.decode(i)}return this._utf8ArrayToStr(t)}readString(t){const e=[];for(;;){const i=this.readByte();if(void 0===t&&0===i)break;if(e.push(i),void 0!==t&&e.length===t)break}if("undefined"!=typeof TextEncoder){const t=new TextDecoder,i=new Uint8Array(e);return t.decode(i)}return this._utf8ArrayToStr(e)}_utf8ArrayToStr(t){let e=0,i=0,s=0,n=0,r="",o=0;const a=t.length;for(;o<a;)switch(e=t[o],o+=1,e>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r+=String.fromCharCode(e);break;case 12:case 13:i=0|t[o],o+=1,r+=String.fromCharCode((31&e)<<6|63&i);break;case 14:i=0|t[o],o+=1,s=0|t[o],o+=1,r+=String.fromCharCode((15&e)<<12|(63&i)<<6|(63&s)<<0);break;case 15:i=0|t[o],o+=1,s=0|t[o],o+=1,n=0|t[o],o+=1,r+=String.fromCharCode((7&e)<<18|(63&i)<<12|(63&s)<<6|(63&n)<<0)}return r}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s=class Sort{static getIndex(t,e,i){let s=0,n=e.length;if(void 0===i)for(;s<n;){const i=s+n>>>1;e[i]<t?s=i+1:n=i}else for(;s<n;){const r=s+n>>>1;i(e[r],t)?s=r+1:n=r}return s}static add(t,e,i,s){let n=this.getIndex(t,e,i);if(void 0===s)for(;n<e.length&&e[n]===t;)n+=1;else for(;n<e.length&&s(e[n],t);)n+=1;e.splice(n,0,t)}static remove(t,e,i,s){const n=this.getIndex(t,e,i);let r=!1;return n<e.length&&(void 0===s&&e[n]===t||void 0!==s&&s(e[n],t))&&(r=!0),r&&e.splice(n,1),r}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s=class Tile{constructor(t){this._parent=t,this._children=[],this._active=!1,this._loaded=!1,this._destroyed=!1,this._transitioning=!1}getParent(){return this._parent}async forceLoad(){return this._transitioning=!0,this.load().then((()=>(this._loaded=!0,this.activate()))).then((()=>{this._active=!0,this._transitioning=!1}))}check(){return this._destroyed||this._transitioning||(0===this._children.length&&this.checkSplit()?this._split():this._children.length>0&&this.checkJoin()&&this._join()),this._transitioning}get children(){return this._children}createNewTile(t,e,i){return null}checkSplit(){return!1}checkJoin(){return!1}async load(){}async unload(){}async activate(){}async deactivate(){}destroy(){this._destroyed=!0;for(let t=0;t<this._children.length;t++)this._children[t].destroy();this._transitioning||(this._active?this.deactivate().then((()=>{this.unload()})).catch((t=>{throw t})):this._loaded&&this.unload())}_split(){const t=[],e=[];this._splitAndLoad(t,e),Promise.all(t).then((()=>{const t=[];for(let i=0;i<e.length;i++)e[i]._loaded&&!e[i]._destroyed?t.push(e[i].activate().then((async()=>{if(this._destroyed)return this.deactivate().then((()=>{this.unload()})).catch((t=>{throw t}));e[i]._active=!0,e[i]._transitioning=!1})).catch((t=>{throw t}))):e[i]._transitioning=!1;return this._active&&t.push(this.deactivate().then((()=>{this._active=!1})).catch((t=>{throw t}))),t})).then((()=>{this._loaded?this.unload().then((()=>{this._loaded=!1,this._transitioning=!1})).catch((t=>{throw t})):this._transitioning=!1})).catch((t=>{throw t}))}_join(){if(this._checkIfDescendantsAreTransitioning())return;const t=[];this._transitioning=!0,this._markDescendantsAsTransitioning(t),this.load().then((async()=>{if(this._destroyed)return this.unload();this._loaded=!0})).then((()=>{const e=[];for(let i=0;i<t.length;i++)e.push(t[i].deactivate().then((()=>{t[i]._active=!1})).catch((t=>{throw t})));return this._destroyed||e.push(this.activate().then((async()=>{if(this._destroyed)return this.deactivate().then((()=>{this.unload()})).catch((t=>{throw t}));this._active=!0})).catch((t=>{throw t}))),Promise.all(e)})).then((()=>{const e=[];for(let i=0;i<t.length;i++)e.push(t[i].unload().then((()=>{t[i]._loaded=!1})).catch((t=>{throw t})));return Promise.all(e)})).then((()=>{this._children=[],this._transitioning=!1})).catch((t=>{throw t}))}_splitAndLoad(t,e){this._transitioning=!0;for(let i=0;i<2;i++)for(let s=0;s<2;s++){const n=this.createNewTile(this,i,s);null!==n&&(this._children.push(n),n.checkSplit()?n._splitAndLoad(t,e):(n._transitioning=!0,t.push(n.load().then((async()=>{if(n._destroyed)return n.unload();n._loaded=!0})).catch((t=>{throw t})))),e.push(n))}}_checkIfDescendantsAreTransitioning(){for(let t=0;t<this._children.length;t++){const e=this._children[t];if(e._transitioning)return!0;if(e._checkIfDescendantsAreTransitioning())return!0}return!1}_markDescendantsAsTransitioning(t){for(let e=0;e<this._children.length;e++){const i=this._children[e];i._transitioning=!0,i._active&&t.push(i),i._markDescendantsAsTransitioning(t)}}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});class TimeUtils{static now(){return TimeUtils.unixToEt(Date.now()/1e3)}static etToUnix(t){let e=0;for(let i=0;i<s.length;i++)t+946727957.816+e>=s[i]+1&&(e-=1);return t+946727957.816+e}static unixToEt(t){let e=0;for(let i=0;i<s.length;i++)t>=s[i]+1&&(e+=1);return t-946727957.816+e}static get leapSeconds(){return s}}const s=[Date.UTC(1972,5,30,23,59,59)/1e3,Date.UTC(1972,11,31,23,59,59)/1e3,Date.UTC(1973,11,31,23,59,59)/1e3,Date.UTC(1974,11,31,23,59,59)/1e3,Date.UTC(1975,11,31,23,59,59)/1e3,Date.UTC(1976,11,31,23,59,59)/1e3,Date.UTC(1977,11,31,23,59,59)/1e3,Date.UTC(1978,11,31,23,59,59)/1e3,Date.UTC(1979,11,31,23,59,59)/1e3,Date.UTC(1981,5,30,23,59,59)/1e3,Date.UTC(1982,5,30,23,59,59)/1e3,Date.UTC(1983,5,30,23,59,59)/1e3,Date.UTC(1985,5,30,23,59,59)/1e3,Date.UTC(1987,11,31,23,59,59)/1e3,Date.UTC(1989,11,31,23,59,59)/1e3,Date.UTC(1990,11,31,23,59,59)/1e3,Date.UTC(1992,5,30,23,59,59)/1e3,Date.UTC(1993,5,30,23,59,59)/1e3,Date.UTC(1994,5,30,23,59,59)/1e3,Date.UTC(1995,11,31,23,59,59)/1e3,Date.UTC(1997,5,30,23,59,59)/1e3,Date.UTC(1998,11,31,23,59,59)/1e3,Date.UTC(2005,11,31,23,59,59)/1e3,Date.UTC(2008,11,31,23,59,59)/1e3,Date.UTC(2012,5,30,23,59,59)/1e3,Date.UTC(2015,5,30,23,59,59)/1e3,Date.UTC(2016,11,31,23,59,59)/1e3],n=TimeUtils},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);class AER extends s.Freezable{static get pool(){return n}constructor(t=0,e=0,i=0){super(),this._azimuth=t,this._elevation=e,this._range=i}get azimuth(){return this._azimuth}set azimuth(t){this.throwIfFrozen(),this._azimuth=t}get elevation(){return this._elevation}set elevation(t){this.throwIfFrozen(),this._elevation=t}get range(){return this._range}set range(t){this.throwIfFrozen(),this._range=t}toString(t=!1){return t?"["+s.MathUtils.radToDeg(this._azimuth)+", "+s.MathUtils.radToDeg(this._elevation)+", "+this._range+"]":"["+this._azimuth+", "+this._elevation+", "+this._range+"]"}copy(t){this.throwIfFrozen(),this._azimuth=t._azimuth,this._elevation=t._elevation,this._range=t._range}set(t,e,i){this.throwIfFrozen(),this._azimuth=t,this._elevation=e,this._range=i}setFromVector(t){this.throwIfFrozen(),this._range=t.magnitude(),this._elevation=Math.asin(t.z/this._range),this._azimuth=Math.atan2(t.y,t.x)}}const n=new s.Pool(AER),r=AER},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var s=i(3);class Color extends s.Freezable{static get pool(){return n}static get Black(){return r}static get Clear(){return o}constructor(t=1,e=1,i=1,s=1){super(),this._r=t,this._g=e,this._b=i,this._a=s}get r(){return this._r}set r(t){this.throwIfFrozen(),this._r=t}get g(){return this._g}set g(t){this.throwIfFrozen(),this._g=t}get b(){return this._b}set b(t){this.throwIfFrozen(),this._b=t}get a(){return this._a}set a(t){this.throwIfFrozen(),this._a=t}toString(){return"["+this._r+", "+this._g+", "+this._b+", "+this._a+"]"}copy(t){this.throwIfFrozen(),this._r=t._r,this._g=t._g,this._b=t._b,this._a=t._a}set(t,e,i,s=1){this.throwIfFrozen(),this._r=t,this._g=e,this._b=i,this._a=s}add(t,e){this.throwIfFrozen(),this._r=t._r+e._r,this._g=t._g+e._g,this._b=t._b+e._b,this._a=t._a+e._a}sub(t,e){this.throwIfFrozen(),this._r=t._r-e._r,this._g=t._g-e._g,this._b=t._b-e._b,this._a=t._a-e._a}mult(t,e){this.throwIfFrozen(),this._r=t._r*e,this._g=t._g*e,this._b=t._b*e,this._a=t._a*e}addMult(t,e,i){this.throwIfFrozen(),this._r=t._r+e._r*i,this._g=t._g+e._g*i,this._b=t._b+e._b*i,this._a=t._a+e._a*i}div(t,e){this.throwIfFrozen(),this._r=t._r/e,this._g=t._g/e,this._b=t._b/e,this._a=t._a/e}scale(t,e){this.throwIfFrozen(),this._r=t._r*e._r,this._g=t._g*e._g,this._b=t._b*e._b,this._a=t._a*e._a}value(){return(this._r+this._g+this._b)/3}min(){return Math.min(this._r,this._g,this._b)}max(){return Math.max(this._r,this._g,this._b)}lerp(t,e,i){this.throwIfFrozen(),this._r=s.MathUtils.lerp(t._r,e._r,i),this._g=s.MathUtils.lerp(t._g,e._g,i),this._b=s.MathUtils.lerp(t._b,e._b,i),this._a=s.MathUtils.lerp(t._a,e._a,i)}}const n=new s.Pool(Color),r=new Color(0,0,0,1);r.freeze();const o=new Color(0,0,0,1);o.freeze();const a=Color},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class Entry{constructor(t,e){this.key=t,this.value=e}}class FastMap extends s.FastIterable{constructor(t){if(super(),this._entries=[],this._keyMap=new Map,void 0!==t)for(const e of t)this._entries.push(new Entry(e.key,e.value)),this._keyMap.set(e.key,this._entries.length-1)}has(t){return this._keyMap.has(t)}get(t){const e=this._keyMap.get(t);if(void 0!==e)return this._entries[e].value}set(t,e){const i=this._keyMap.get(t);void 0!==i?this._entries[i].value=e:(this._entries.push(new Entry(t,e)),this._keyMap.set(t,this._entries.length-1))}delete(t){const e=this._keyMap.get(t);if(void 0!==e){this._entries.splice(e,1),this._keyMap.delete(t);for(const t of this._keyMap)t[1]>e&&this._keyMap.set(t[0],t[1]-1);return!0}return!1}clear(){this._entries=[],this._keyMap.clear()}getAt(t){return this._entries[t]}get size(){return this._entries.length}}const n=FastMap},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class FastSet extends s.FastIterable{constructor(t){if(super(),this._values=[],this._valueMap=new Map,void 0!==t)for(const e of t)this._values.push(e),this._valueMap.set(e,this._values.length-1)}has(t){return this._valueMap.has(t)}add(t){return void 0===this._valueMap.get(t)&&(this._values.push(t),this._valueMap.set(t,this._values.length-1)),this}delete(t){const e=this._valueMap.get(t);if(void 0!==e){this._values.splice(e,1),this._valueMap.delete(t);for(const t of this._valueMap)t[1]>e&&this._valueMap.set(t[0],t[1]-1);return!0}return!1}clear(){this._values=[],this._valueMap.clear()}getAt(t){return this._values[t]}get size(){return this._values.length}}const n=FastSet},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});i(3);const s=class Geometry{static getLineSphereIntersectionWithSphereAtOrigin(t,e,i){const s=t.dot(t),n=t.dot(e),r=e.dot(e),o=n*n+(i*i-s)*r;return o<0?Number.NaN:(-n-Math.sqrt(o))/r}static getLineSphereIntersectionWithLineStartAtOrigin(t,e,i,s){const n=e.dot(e),r=e.dot(i),o=r*r+(s*s-i.dot(i))*n;if(o<0)t.min=t.max=Number.NaN;else{const e=Math.sqrt(o);t.min=(r-e)/n,t.max=(r+e)/n}}static getLLAFromXYZOnSphere(t,e,i){const s=e.magnitudeXY();t.lon=Math.atan2(e.y,e.x),t.lat=Math.atan(e.z/s),t.alt=e.magnitude()-i}static getXYZFromLLAOnSphere(t,e,i){t.x=(i+e.alt)*Math.cos(e.lat)*Math.cos(e.lon),t.y=(i+e.alt)*Math.cos(e.lat)*Math.sin(e.lon),t.z=(i+e.alt)*Math.sin(e.lat)}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(3);class Interval extends s.Freezable{static get pool(){return n}static get Infinite(){return r}constructor(t=0,e=0){super(),this._min=t,this._max=e}get min(){return this._min}set min(t){this.throwIfFrozen(),this._min=t}get max(){return this._max}set max(t){this.throwIfFrozen(),this._max=t}toString(){return"["+this._min+", "+this._max+"]"}copy(t){this.throwIfFrozen(),this._min=t._min,this._max=t._max}set(t,e){this.throwIfFrozen(),this._min=t,this._max=e}length(){return this._max-this._min}clamp(t){return Math.min(Math.max(this._min,t),this._max)}expandTo(t){this.throwIfFrozen(),this._min=Math.min(this._min,t),this._max=Math.max(this._max,t)}contains(t){return this._min<=t&&t<this._max}intersects(t){return this._min<t._max&&t._min<this._max}intersection(t,e){this.throwIfFrozen(),this._min=Math.max(t._min,e._min),this._max=Math.min(t._max,e._max),this._max<this._min&&(this._max=this._min)}union(t,e){this.throwIfFrozen(),this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)}}const n=new s.Pool(Interval),r=new Interval(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY);r.freeze();const o=Interval},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>OrbitalElements});var s=i(3);class OrbitalElements{constructor(){this.epoch=0,this.eccentricity=0,this.semiMajorAxis=0,this.meanAngularMotion=0,this.meanAnomalyAtEpoch=0,this.orbitOrientation=new s.Quaternion}copy(t){this.epoch=t.epoch,this.eccentricity=t.eccentricity,this.semiMajorAxis=t.semiMajorAxis,this.meanAnomalyAtEpoch=t.meanAnomalyAtEpoch,this.meanAngularMotion=t.meanAngularMotion,this.orbitOrientation.copy(t.orbitOrientation)}projectFromMeanAnomaly(t,e,i){if(this.eccentricity<1){const s=this.getEccentricAnomalyFromMeanAnomaly(i),n=this.semiMajorAxis*(1-this.eccentricity*Math.cos(s)),r=this.meanAngularMotion*this.semiMajorAxis*this.semiMajorAxis/n;t.x=this.semiMajorAxis*(Math.cos(s)-this.eccentricity),t.y=this.semiMajorAxis*Math.sqrt(1-this.eccentricity*this.eccentricity)*Math.sin(s),e.x=-r*Math.sin(s),e.y=r*Math.sqrt(1-this.eccentricity*this.eccentricity)*Math.cos(s)}else{const s=this.getEccentricAnomalyFromMeanAnomaly(i),n=-this.semiMajorAxis*(1-this.eccentricity*Math.cosh(s)),r=this.meanAngularMotion*this.semiMajorAxis*this.semiMajorAxis/n;t.x=this.semiMajorAxis*(this.eccentricity-Math.cosh(s)),t.y=this.semiMajorAxis*Math.sqrt(this.eccentricity*this.eccentricity-1)*Math.sinh(s),e.x=-r*Math.sinh(s),e.y=r*Math.sqrt(this.eccentricity*this.eccentricity-1)*Math.cosh(s)}t.z=0,e.z=0,t.rotate(this.orbitOrientation,t),e.rotate(this.orbitOrientation,e)}project(t,e,i){let n=this.meanAnomalyAtEpoch+this.meanAngularMotion*(i-this.epoch);this.eccentricity<1&&(n=s.MathUtils.wrap(n,-s.MathUtils.pi,+s.MathUtils.pi)),this.projectFromMeanAnomaly(t,e,n)}getTrueAnomalyFromPosition(t){const e=s.Vector3.pool.get();return e.rotateInverse(this.orbitOrientation,t),Math.atan2(e.y,e.x)}getMeanAnomalyFromTrueAnomaly(t){let e=0,i=0;return this.eccentricity<1?(e=2*Math.atan(Math.tan(t/2)*Math.sqrt((1-this.eccentricity)/(1+this.eccentricity))),i=e-this.eccentricity*Math.sin(e)):(e=2*Math.atanh(Math.tan(t/2)*Math.sqrt((this.eccentricity-1)/(1+this.eccentricity))),i=this.eccentricity*Math.sinh(e)-e),i}getEccentricAnomalyFromMeanAnomaly(t){if(this.eccentricity<1){let e=t;this.eccentricity>=.8&&(e=Math.sign(t)*s.MathUtils.pi);for(let i=0;i<20;i++){const i=(e-this.eccentricity*Math.sin(e)-t)/(this.eccentricity*Math.cos(e)-1);if(e+=i,Math.abs(i)<.00174532925)break}return e}{let e=Math.log(2*Math.abs(t)/Math.E+1.8);this.eccentricity<=1.2&&(e=Math.log(2*Math.abs(t)/Math.E+1.8)),t<0&&(e*=-1);for(let i=0;i<20;i++){const i=(e-this.eccentricity*Math.sinh(e)+t)/(this.eccentricity*Math.cosh(e)-1);if(e+=i,Math.abs(i)<.00174532925)break}return e}}getMeanAnomalyFromEccentricAnomaly(t){if(this.eccentricity<1){const e=t-this.eccentricity*Math.sin(t);return s.MathUtils.wrap(e,-Math.PI,+Math.PI)}return this.eccentricity*Math.sinh(t)-t}getTrueAnomalyFromEccentricAnomaly(t){return this.eccentricity<1?2*Math.atan(Math.sqrt((1+this.eccentricity)/(1-this.eccentricity))*Math.tan(t/2)):2*Math.atan(Math.sqrt((1+this.eccentricity)/(this.eccentricity-1))*Math.tanh(t/2))}getEccentricAnomalyFromTrueAnomaly(t){if(this.eccentricity<1){const e=2*Math.atan2(Math.tan(t/2),Math.sqrt((1+this.eccentricity)/(1-this.eccentricity)));return s.MathUtils.wrap(e,-Math.PI,+Math.PI)}return 2*Math.atanh(Math.sqrt((this.eccentricity-1)/(this.eccentricity+1))*Math.tan(t/2))}getInclination(){const t=s.Vector3.pool.get();this.orbitOrientation.getAxis(t,2);const e=t.angle(s.Vector3.ZAxis);return s.Vector3.pool.release(t),e}getLongitudeOfAscendingNode(){const t=s.Vector3.pool.get();this.orbitOrientation.getAxis(t,2);const e=Math.atan2(t.x,-t.y);return s.Vector3.pool.release(t),s.MathUtils.wrap(e,0,s.MathUtils.twoPi)}getArgumentOfPeriapsis(){const t=s.Vector3.pool.get(),e=s.Vector3.pool.get();this.orbitOrientation.getAxis(t,2),t.set(-t.y,t.x,0),this.orbitOrientation.getAxis(e,0);const i=t.angle(e);return s.Vector3.pool.release(e),s.Vector3.pool.release(t),s.MathUtils.wrap(i,0,s.MathUtils.twoPi)}getPeriod(){return s.MathUtils.twoPi/this.meanAngularMotion}getPeriapsis(){return this.semiMajorAxis*(1-this.eccentricity)}getApoapsis(){return this.semiMajorAxis*(1+this.eccentricity)}setOrbitOrientationFromElements(t,e,i){const n=s.Vector3.pool.get(),r=s.Vector3.pool.get(),o=s.Quaternion.pool.get();n.set(Math.cos(e),Math.sin(e),0),r.set(Math.sin(e)*Math.sin(t),-Math.cos(e)*Math.sin(t),Math.cos(t)),this.orbitOrientation.setFromAxes(n,void 0,r),o.setFromAxisAngle(r,i),this.orbitOrientation.mult(o,this.orbitOrientation),s.Quaternion.pool.release(o),s.Vector3.pool.release(r),s.Vector3.pool.release(n)}setFromPositionAndVelocity(t,e,i,n){const r=1/n;this.epoch=i;const o=s.Vector3.pool.get();o.cross(t,e);const a=s.Vector3.pool.get(),l=s.Vector3.pool.get();l.normalize(t),a.cross(e,o),a.mult(a,r),a.sub(a,l),this.eccentricity=a.magnitude();const h=o.dot(o)*r;this.semiMajorAxis=h/(1-this.eccentricity*this.eccentricity),this.eccentricity>1&&(this.semiMajorAxis*=-1);let c=Math.acos(s.MathUtils.clamp(a.dot(l)/this.eccentricity,-1,1));t.dot(e)<0&&(c*=-1),c<-Math.PI&&(c+=s.MathUtils.twoPi),c>=Math.PI&&(c-=s.MathUtils.twoPi),a.normalize(a),o.normalize(o),this.orbitOrientation.setFromAxes(a,void 0,o),s.Vector3.pool.release(l),s.Vector3.pool.release(o),s.Vector3.pool.release(a);const d=this.getEccentricAnomalyFromTrueAnomaly(c);this.meanAnomalyAtEpoch=this.getMeanAnomalyFromEccentricAnomaly(d),this.meanAngularMotion=Math.sqrt(n/(this.semiMajorAxis*this.semiMajorAxis*this.semiMajorAxis))}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);class Rect extends s.Freezable{static get pool(){return n}constructor(t=0,e=0,i=0,n=0){super(),this._origin=new s.Vector2(t,e),this._size=new s.Vector2(i,n)}freeze(){this._origin.freeze(),this._size.freeze()}thaw(){this._origin.thaw(),this._size.thaw()}get origin(){return this._origin}get size(){return this._size}toString(){return"[Origin: ("+this._origin.x+", "+this._origin.y+"), Size: ("+this._size.x+", "+this._size.y+")]"}copy(t){this._origin.copy(t._origin),this._size.copy(t._size)}set(t,e,i,s){this._origin.set(t,e),this._size.set(i,s)}contains(t){return this._origin.x<=t.x&&t.x<this._origin.x+this._size.x&&this._origin.y<=t.y&&t.y<this._origin.y+this._size.y}intersects(t){return this._origin.x+this._size.x>t._origin.x&&t._origin.x+t._size.x>this._origin.x&&this._origin.y+this._size.y>t._origin.y&&t._origin.y+t._size.y>this._origin.y}}const n=new s.Pool(Rect),r=Rect},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var s=i(3);class Quaternion extends s.Freezable{static get pool(){return n}static get NaN(){return o}static get Identity(){return r}constructor(t=1,e=0,i=0,s=0){super(),this._w=t,this._x=e,this._y=i,this._z=s}get w(){return this._w}set w(t){this.throwIfFrozen(),this._w=t}get x(){return this._x}set x(t){this.throwIfFrozen(),this._x=t}get y(){return this._y}set y(t){this.throwIfFrozen(),this._y=t}get z(){return this._z}set z(t){this.throwIfFrozen(),this._z=t}getAngle(){return 2*Math.acos(this._w)}copy(t){this.throwIfFrozen(),this._w=t._w,this._x=t._x,this._y=t._y,this._z=t._z}copyFromThreeJs(t){this.throwIfFrozen(),this._w=t.w,this._x=t.x,this._y=t.y,this._z=t.z}set(t,e,i,s){this.throwIfFrozen(),this._w=t,this._x=e,this._y=i,this._z=s}setFromAxisAngle(t,e){this.throwIfFrozen();const i=Math.sin(e/2);this._w=Math.cos(e/2),this._x=i*t.x,this._y=i*t.y,this._z=i*t.z}setFromAxes(t,e,i){let n;this.throwIfFrozen(),void 0===t?(n=t=s.Vector3.pool.get(),t.cross(e,i)):void 0===e?(n=e=s.Vector3.pool.get(),e.cross(i,t)):void 0===i&&(n=i=s.Vector3.pool.get(),i.cross(t,e));const r=t.x+e.y+i.z;if(r>0){const s=2*Math.sqrt(r+1);this._w=.25*s,this._x=(e.z-i.y)/s,this._y=(i.x-t.z)/s,this._z=(t.y-e.x)/s}else if(t.x>e.y&&t.x>i.z){const s=2*Math.sqrt(1+t.x-e.y-i.z);this._w=(e.z-i.y)/s,this._x=.25*s,this._y=(e.x+t.y)/s,this._z=(i.x+t.z)/s}else if(e.y>i.z){const s=2*Math.sqrt(1+e.y-i.z-t.x);this._w=(i.x-t.z)/s,this._x=(e.x+t.y)/s,this._y=.25*s,this._z=(i.y+e.z)/s}else{const s=2*Math.sqrt(1+i.z-t.x-e.y);this._w=(t.y-e.x)/s,this._x=(i.x+t.z)/s,this._y=(i.y+e.z)/s,this._z=.25*s}s.Vector3.pool.release(n)}setFromEuler(t,e,i){this.throwIfFrozen();const s=.5*t,n=.5*e,r=.5*i,o=Math.cos(s),a=Math.sin(s),l=Math.cos(n),h=Math.sin(n),c=Math.cos(r),d=Math.sin(r);this._w=o*l*c+a*h*d,this._x=a*l*c-o*h*d,this._y=o*h*c+a*l*d,this._z=o*l*d-a*h*c}setFromVectorFromTo(t,e){const i=s.Vector3.pool.get(),n=t.dot(e);if(n>=1)this.set(1,0,0,0);else if(n<=-1)this.set(0,1,0,0);else{i.cross(t,e),i.normalize(i);const s=Math.acos(n);this.setFromAxisAngle(i,s)}s.Vector3.pool.release(i)}setFromAxis(t,e){const i=s.Vector3.pool.get(),n=s.Vector3.pool.get();i.normalize(t),n.cross(i,s.Vector3.XAxis),n.isZero()&&n.cross(i,s.Vector3.YAxis),n.normalize(n),0===e?this.setFromAxes(i,n,void 0):1===e?this.setFromAxes(void 0,i,n):2===e&&this.setFromAxes(n,void 0,i),s.Vector3.pool.release(i),s.Vector3.pool.release(n)}toString(){return"["+this._w+", "+this._x+", "+this._y+", "+this._z+"]"}isNaN(){return!(this._w<=0||this._w>0)}magnitude(){return Math.sqrt(this._w*this._w+this._x*this._x+this._y*this._y+this._z*this._z)}normalize(t){this.throwIfFrozen();const e=t.magnitude();e>0&&(this._w=t._w/e,this._x=t._x/e,this._y=t._y/e,this._z=t._z/e)}inverse(t){this.throwIfFrozen(),this._w=t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z}mult(t,e){this.throwIfFrozen();const i=Quaternion.pool.get();i._w=t._w*e._w-t._x*e._x-t._y*e._y-t._z*e._z,i._x=t._w*e._x+t._x*e._w+t._y*e._z-t._z*e._y,i._y=t._w*e._y-t._x*e._z+t._y*e._w+t._z*e._x,i._z=t._w*e._z+t._x*e._y-t._y*e._x+t._z*e._w,this.copy(i),Quaternion.pool.release(i)}multInverseL(t,e){this.throwIfFrozen();const i=Quaternion.pool.get();i._w=t._w*e._w+t._x*e._x+t._y*e._y+t._z*e._z,i._x=t._w*e._x-t._x*e._w-t._y*e._z+t._z*e._y,i._y=t._w*e._y+t._x*e._z-t._y*e._w-t._z*e._x,i._z=t._w*e._z-t._x*e._y+t._y*e._x-t._z*e._w,this.copy(i),Quaternion.pool.release(i)}multInverseR(t,e){this.throwIfFrozen();const i=Quaternion.pool.get();i._w=+t._w*e._w+t._x*e._x+t._y*e._y+t._z*e._z,i._x=-t._w*e._x+t._x*e._w-t._y*e._z+t._z*e._y,i._y=-t._w*e._y+t._x*e._z+t._y*e._w-t._z*e._x,i._z=-t._w*e._z-t._x*e._y+t._y*e._x+t._z*e._w,this.copy(i),Quaternion.pool.release(i)}scaleAngle(t,e){this.throwIfFrozen();const i=Math.acos(t._w),s=Math.sin(i);if(0===s)return void this.copy(t);const n=Math.sin(i*e);this._w=Math.cos(i*e),this._x=t._x/s*n,this._y=t._y/s*n,this._z=t._z/s*n}angle(t){return 2*Math.acos(this._w*t._w+this._x*t._x+this._y*t._y+this._z*t._z)}slerp(t,e,i){this.throwIfFrozen();let s=t._w*e._w+t._x*e._x+t._y*e._y+t._z*e._z,n=1;if(s<0&&(n=-1,s=-s),s<=.9995){const r=Math.acos(s),o=n*Math.sin((1-i)*r)/Math.sin(r),a=Math.sin(i*r)/Math.sin(r);this._w=o*t._w+a*e._w,this._x=o*t._x+a*e._x,this._y=o*t._y+a*e._y,this._z=o*t._z+a*e._z}else{const s=n*(1-i),r=i;this._w=s*t._w+r*e._w,this._x=s*t._x+r*e._x,this._y=s*t._y+r*e._y,this._z=s*t._z+r*e._z,this.normalize(this)}}getAxis(t,e){void 0===e?(t.set(this._x,this._y,this._z),t.normalize(t)):0===e?(t.x=this._w*this._w+this._x*this._x-this._y*this._y-this._z*this._z,t.y=2*this._w*this._z+2*this._x*this._y,t.z=2*this._x*this._z-2*this._w*this._y):1===e?(t.x=2*this._y*this._x-2*this._w*this._z,t.y=this._w*this._w-this._x*this._x+this._y*this._y-this._z*this._z,t.z=2*this._x*this._w+2*this._y*this._z):2===e&&(t.x=2*this._y*this._w+2*this._z*this._x,t.y=2*this._z*this._y-2*this._w*this._x,t.z=this._w*this._w-this._x*this._x-this._y*this._y+this._z*this._z)}}const n=new s.Pool(Quaternion),r=new Quaternion;r.freeze();const o=new Quaternion(Number.NaN,Number.NaN,Number.NaN,Number.NaN);o.freeze();const a=Quaternion},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>h});var s=i(3);class Vector2 extends s.Freezable{static get pool(){return n}static get NaN(){return l}static get Zero(){return r}static get XAxis(){return o}static get YAxis(){return a}constructor(t=0,e=0){super(),this._x=t,this._y=e}get x(){return this._x}set x(t){this.throwIfFrozen(),this._x=t}get y(){return this._y}set y(t){this.throwIfFrozen(),this._y=t}toString(){return"["+this._x+", "+this._y+"]"}equals(t){return this._x===t._x&&this._y===t._y}isZero(){return 0===this._x&&0===this._y}isNaN(){return!((this._x<=0||this._x>0)&&(this._y<=0||this._y>0))}copy(t){this.throwIfFrozen(),this._x=t._x,this._y=t._y}copyFromThreeJs(t){this.throwIfFrozen(),this._x=t.x,this._y=t.y}set(t,e){this.throwIfFrozen(),this._x=t,this._y=e}neg(t){this.throwIfFrozen(),this._x=-t._x,this._y=-t._y}add(t,e){this.throwIfFrozen(),this._x=t._x+e._x,this._y=t._y+e._y}sub(t,e){this.throwIfFrozen(),this._x=t._x-e._x,this._y=t._y-e._y}mult(t,e){this.throwIfFrozen(),this._x=t._x*e,this._y=t._y*e}addMult(t,e,i){this.throwIfFrozen(),this._x=t._x+e._x*i,this._y=t._y+e._y*i}div(t,e){this.throwIfFrozen(),this._x=t._x/e,this._y=t._y/e}scale(t,e){this.throwIfFrozen(),this._x=t._x*e._x,this._y=t._y*e._y}scaleInv(t,e){this.throwIfFrozen(),this._x=t._x/e._x,this._y=t._y/e._y}dot(t){return this._x*t._x+this._y*t._y}cross(t){return this._x*t._y-this._y*t._x}magnitudeSqr(){return this._x*this._x+this._y*this._y}magnitude(){return Math.sqrt(this.magnitudeSqr())}normalize(t){this.throwIfFrozen();const e=t.magnitude();e>0&&(this._x=t._x/e,this._y=t._y/e)}setMagnitude(t,e){this.throwIfFrozen(),this.normalize(t),this._x*=e,this._y*=e}distance(t){const e=this._x-t._x,i=this._y-t._y;return Math.sqrt(e*e+i*i)}angle(t){const e=this.magnitude()*t.magnitude();return e>0?Math.acos(s.MathUtils.clamp(this.dot(t)/e,-1,1)):Number.NaN}clamp(t,e,i){this.throwIfFrozen(),this._x=s.MathUtils.clamp(t._x,e._x,i._x),this._y=s.MathUtils.clamp(t._y,e._y,i._y)}lerp(t,e,i){this.throwIfFrozen(),this._x=s.MathUtils.lerp(t._x,e._x,i),this._y=s.MathUtils.lerp(t._y,e._y,i)}}const n=new s.Pool(Vector2),r=new Vector2;r.freeze();const o=new Vector2(1,0);o.freeze();const a=new Vector2(0,1);a.freeze();const l=new Vector2(Number.NaN,Number.NaN);l.freeze();const h=Vector2},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>_});var s=i(3);class Vector3 extends s.Freezable{static get pool(){return n}static get NaN(){return u}static get Zero(){return r}static get XAxis(){return o}static get YAxis(){return a}static get ZAxis(){return l}static get XAxisNeg(){return h}static get YAxisNeg(){return c}static get ZAxisNeg(){return d}constructor(t=0,e=0,i=0){super(),this._x=t,this._y=e,this._z=i}get x(){return this._x}set x(t){this.throwIfFrozen(),this._x=t}get y(){return this._y}set y(t){this.throwIfFrozen(),this._y=t}get z(){return this._z}set z(t){this.throwIfFrozen(),this._z=t}toString(){return"["+this._x+", "+this._y+", "+this._z+"]"}equals(t){return this._x===t._x&&this._y===t._y&&this._z===t._z}isZero(){return 0===this._x&&0===this._y&&0===this._z}isNaN(){return!((this._x<=0||this._x>0)&&(this._y<=0||this._y>0)&&(this._z<=0||this._z>0))}copy(t){this.throwIfFrozen(),this._x=t._x,this._y=t._y,this._z=t._z}copyFromThreeJs(t){this.throwIfFrozen(),this._x=t.x,this._y=t.y,this._z=t.z}set(t,e,i){this.throwIfFrozen(),this._x=t,this._y=e,this._z=i}setFromAER(t){this.throwIfFrozen();const e=Math.cos(t.elevation);this._x=t.range*e*Math.cos(t.azimuth),this._y=t.range*e*Math.sin(t.azimuth),this._z=t.range*Math.sin(t.elevation)}neg(t){this.throwIfFrozen(),this._x=-t._x,this._y=-t._y,this._z=-t._z}add(t,e){this.throwIfFrozen(),this._x=t._x+e._x,this._y=t._y+e._y,this._z=t._z+e._z}sub(t,e){this.throwIfFrozen(),this._x=t._x-e._x,this._y=t._y-e._y,this._z=t._z-e._z}mult(t,e){this.throwIfFrozen(),this._x=t._x*e,this._y=t._y*e,this._z=t._z*e}addMult(t,e,i){this.throwIfFrozen(),this._x=t._x+e._x*i,this._y=t._y+e._y*i,this._z=t._z+e._z*i}div(t,e){this.throwIfFrozen(),this._x=t._x/e,this._y=t._y/e,this._z=t._z/e}scale(t,e){this.throwIfFrozen(),this._x=t._x*e._x,this._y=t._y*e._y,this._z=t._z*e._z}scaleInv(t,e){this.throwIfFrozen(),this._x=t._x/e._x,this._y=t._y/e._y,this._z=t._z/e._z}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z}cross(t,e){this.throwIfFrozen();const i=t._y*e._z-t._z*e._y,s=t._z*e._x-t._x*e._z,n=t._x*e._y-t._y*e._x;this._x=i,this._y=s,this._z=n}magnitudeSqr(){return this._x*this._x+this._y*this._y+this._z*this._z}magnitude(){return Math.sqrt(this.magnitudeSqr())}magnitudeXY(){return Math.sqrt(this._x*this._x+this._y*this._y)}normalize(t){this.throwIfFrozen();const e=t.magnitude();e>0?(this._x=t._x/e,this._y=t._y/e,this._z=t._z/e):this.copy(t)}setMagnitude(t,e){this.throwIfFrozen(),this.normalize(t),this._x*=e,this._y*=e,this._z*=e}distance(t){const e=this._x-t._x,i=this._y-t._y,s=this._z-t._z;return Math.sqrt(e*e+i*i+s*s)}angle(t){const e=this.magnitude()*t.magnitude();return e>0?Math.acos(s.MathUtils.clamp(this.dot(t)/e,-1,1)):Number.NaN}angleAroundAxis(t,e){const i=Vector3.pool.get(),s=Vector3.pool.get();i.addMult(this,e,-this.dot(e)),s.addMult(t,e,-t.dot(e));let n=i.angle(s);return i.cross(i,s),i.dot(e)<0&&(n*=-1),Vector3.pool.release(i),Vector3.pool.release(s),n}clamp(t,e,i){this.throwIfFrozen(),this._x=s.MathUtils.clamp(t._x,e._x,i._x),this._y=s.MathUtils.clamp(t._y,e._y,i._y),this._z=s.MathUtils.clamp(t._z,e._z,i._z)}lerp(t,e,i){this.throwIfFrozen(),this._x=s.MathUtils.lerp(t._x,e._x,i),this._y=s.MathUtils.lerp(t._y,e._y,i),this._z=s.MathUtils.lerp(t._z,e._z,i)}slerp(t,e,i){this.throwIfFrozen();const n=t.magnitude(),r=e.magnitude();if(n>0&&r>0){const o=Math.acos(s.MathUtils.clamp(t.dot(e)/(n*r),-1,1));if(Math.abs(o)>.01745327777){const s=1/Math.sin(o),a=Math.sin((1-i)*o)*s,l=Math.sin(i*o)*s;this.set(t.x*a/n+e.x*l/r,t.y*a/n+e.y*l/r,t.z*a/n+e.z*l/r),this.mult(this,(1-i)*n+i*r)}else this.lerp(t,e,i)}else this.lerp(t,e,i)}rotate(t,e){this.throwIfFrozen();const i=t.w*e._x+t.y*e._z-t.z*e._y,s=t.w*e._y+t.z*e._x-t.x*e._z,n=t.w*e._z+t.x*e._y-t.y*e._x,r=-t.x*e._x-t.y*e._y-t.z*e._z;this._x=i*t.w-r*t.x-s*t.z+n*t.y,this._y=s*t.w-r*t.y-n*t.x+i*t.z,this._z=n*t.w-r*t.z-i*t.y+s*t.x}rotateInverse(t,e){this.throwIfFrozen();const i=t.w*e._x-t.y*e._z+t.z*e._y,s=t.w*e._y-t.z*e._x+t.x*e._z,n=t.w*e._z-t.x*e._y+t.y*e._x,r=t.x*e._x+t.y*e._y+t.z*e._z;this._x=i*t.w+r*t.x+s*t.z-n*t.y,this._y=s*t.w+r*t.y+n*t.x-i*t.z,this._z=n*t.w+r*t.z+i*t.y-s*t.x}setNormalTo(t,e){const i=e._x*(t._y*t._y+t._z*t._z)-t._x*(t._y*e._y+t._z*e._z),s=e._y*(t._z*t._z+t._x*t._x)-t._y*(t._z*e._z+t._x*e._x),n=e._z*(t._x*t._x+t._y*t._y)-t._z*(t._x*e._x+t._y*e._y);this._x=i,this._y=s,this._z=n,this.normalize(this)}}const n=new s.Pool(Vector3),r=new Vector3;r.freeze();const o=new Vector3(1,0,0);o.freeze();const a=new Vector3(0,1,0);a.freeze();const l=new Vector3(0,0,1);l.freeze();const h=new Vector3(-1,0,0);o.freeze();const c=new Vector3(0,-1,0);a.freeze();const d=new Vector3(0,0,-1);l.freeze();const u=new Vector3(Number.NaN,Number.NaN,Number.NaN);u.freeze();const _=Vector3},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class Cache extends s.FastIterable{constructor(t=null,e=null){super(),this._keysToEntries=new s.FastMap,this._itemToKeys=new Map,this._itemConstructor=t,this._itemDestructor=e}get(t){const e=this._keysToEntries.get(t);if(void 0===e){const e={item:this._itemConstructor(t),count:1};return this._keysToEntries.set(t,e),this._itemToKeys.set(e.item,t),e.item}return e.count+=1,e.item}release(t){const e=this._itemToKeys.get(t);if(void 0!==e){const i=this._keysToEntries.get(e);i.count-=1,0===i.count&&(this._itemDestructor(i.item),this._keysToEntries.delete(e),this._itemToKeys.delete(t))}}getAt(t){return this._keysToEntries.getAt(t).value.item}get size(){return this._keysToEntries.size}}const n=Cache},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class ComponentRef extends s.BaseRef{constructor(t){super(t),this._entityName="",this._componentName="",this._componentType="",this._componentTypeIndex=0}getEntityName(){return this._entityName}getComponentName(){return this._componentName}getComponentType(){return this._componentType}getComponentTypeIndex(){return this._componentTypeIndex}setByName(t,e){this._entityName=t,this._componentName=e,this._componentType=""}setByType(t,e,i=0){this._entityName=t,this._componentType=e,this._componentTypeIndex=i,this._componentName=""}update(){if(""===this._entityName||""===this._componentName&&""===this._componentType)this._setRef(null);else if(""!==this._componentName){const t=this._scene.getEntity(this._entityName);if(null!==t&&t.isEnabled()){const e=t.getComponent(this._componentName);this._setRef(e)}else this._setRef(null)}else{const t=this._scene.getEntity(this._entityName);if(null!==t&&t.isEnabled()){const e=t.getComponentByType(this._componentType,this._componentTypeIndex);this._setRef(e)}else this._setRef(null)}}}const n=ComponentRef},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class ControllerRef extends s.BaseRef{constructor(t){super(t),this._entityName="",this._controllerName="",this._controllerType="",this._controllerTypeIndex=0}getEntityName(){return this._entityName}getControllerName(){return this._controllerName}getControllerType(){return this._controllerType}getControllerTypeIndex(){return this._controllerTypeIndex}setByName(t,e){this._entityName=t,this._controllerName=e,this._controllerType=""}setByType(t,e,i=0){this._entityName=t,this._controllerType=e,this._controllerTypeIndex=i,this._controllerName=""}update(){if(""===this._entityName||""===this._controllerName&&""===this._controllerType)this._setRef(null);else if(""!==this._controllerName){const t=this._scene.getEntity(this._entityName);if(null!==t&&t.isEnabled()){const e=t.getController(this._controllerName);this._setRef(e)}else this._setRef(null)}else{const t=this._scene.getEntity(this._entityName);if(null!==t&&t.isEnabled()){const e=t.getControllerByType(this._controllerType,this._controllerTypeIndex);this._setRef(e)}else this._setRef(null)}}}const n=ControllerRef},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class CubeMap{static xyzToUVFace(t,e,i=this._defaultCubeMapFaceFrames){let n;for(let r=0;r<6;r++){const o=i[r],a=o[2];let l=0,h=0,c=0,d=!1;a===s.Vector3.XAxis||a===s.Vector3.XAxisNeg?(l=e.x,h=e.y,c=e.z,d=a===s.Vector3.XAxisNeg):a===s.Vector3.YAxis||a===s.Vector3.YAxisNeg?(l=e.y,h=e.z,c=e.x,d=a===s.Vector3.YAxisNeg):(l=e.z,h=e.x,c=e.y,d=a===s.Vector3.ZAxisNeg),Math.abs(l)>=Math.abs(h)&&Math.abs(l)>=Math.abs(c)&&(l>=0&&!d||l<0&&d)&&(n=o,t.z=r)}if(void 0===n)return void t.set(NaN,NaN,NaN);let r=n[2].x*e.x+n[2].y*e.y+n[2].z*e.z;r<0&&(r=1),t.x=(n[0].x*e.x+n[0].y*e.y+n[0].z*e.z)/r,t.y=(n[1].x*e.x+n[1].y*e.y+n[1].z*e.z)/r,t.x=.5*(t.x+1),t.y=.5*(t.y+1)}}CubeMap._defaultCubeMapFaceFrames=[[s.Vector3.YAxis,s.Vector3.ZAxis,s.Vector3.XAxis],[s.Vector3.XAxisNeg,s.Vector3.ZAxis,s.Vector3.YAxis],[s.Vector3.YAxisNeg,s.Vector3.ZAxis,s.Vector3.XAxisNeg],[s.Vector3.XAxis,s.Vector3.ZAxis,s.Vector3.YAxisNeg],[s.Vector3.YAxis,s.Vector3.XAxisNeg,s.Vector3.ZAxis],[s.Vector3.YAxis,s.Vector3.XAxis,s.Vector3.ZAxisNeg]];const n=CubeMap},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class EntityRef extends s.BaseRef{constructor(t,e){super(t),this._name=void 0!==e?e:""}getName(){return this._name}setName(t){this._name=t}update(){if(""===this._name)null!==this._ref&&this._setRef(null);else if(null===this._ref||this._ref.isDestroyed()||!this._ref.isEnabled()||this._ref.getName()!==this._name){const t=this._scene.getEntity(this._name);this._setRef(t)}}}const n=EntityRef},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);class LatLonAlt extends s.Freezable{static get pool(){return n}constructor(t=0,e=0,i=0){super(),this._lat=t,this._lon=e,this._alt=i}get lat(){return this._lat}set lat(t){this.throwIfFrozen(),this._lat=t}get lon(){return this._lon}set lon(t){this.throwIfFrozen(),this._lon=t}get alt(){return this._alt}set alt(t){this.throwIfFrozen(),this._alt=t}toString(t=!1){return t?"["+s.MathUtils.radToDeg(this._lat)+", "+s.MathUtils.radToDeg(this._lon)+", "+this._alt+"]":"["+this._lat+", "+this._lon+", "+this._alt+"]"}copy(t){this.throwIfFrozen(),this._lat=t._lat,this._lon=t._lon,this._alt=t._alt}set(t,e,i){this.throwIfFrozen(),this._lat=t,this._lon=e,this._alt=i}}const n=new s.Pool(LatLonAlt),r=LatLonAlt},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class LineMesh{constructor(t){this._component=t,this._alphaMultiplier=1,this._position=new s.Vector3,this._orientation=new s.Quaternion,this._scale=1,this._dashGapLength=0,this._dashLength=1,this._glowWidth=0,this._threeJsObjects=[],this._threeJsMaterial=null,this._threeJsMaterial=t.getEntity().getScene().getEngine().getMaterialManager().getPreloaded("line"),t.getThreeJsMaterials().push(this._threeJsMaterial),this._threeJsMaterial.uniforms.alphaMultiplier.value=this._alphaMultiplier,this._threeJsMaterial.uniforms.dashLength.value=this._dashLength,this._threeJsMaterial.uniforms.dashGapLength.value=this._dashGapLength,this._threeJsMaterial.uniforms.glowWidth.value=this._glowWidth}setPositions(t){if(t.length%2!=0)throw new Error("Number of positions in the LineMesh must be even.");this._adjustVerticesInGeometries(2*t.length);const e=s.Vector3.pool.get(),i=s.Vector3.pool.get(),n=s.Vector3.pool.get(),r=s.Vector3.pool.get(),o=s.Vector3.pool.get();let a=0;for(let n=0;n<this._threeJsObjects.length;n++){const r=this._threeJsObjects[n].geometry.getAttribute("position"),l=r.array;for(let r=0;r<l.length/(2*LineMesh._floatsPerVertex);r++){const h=r+n*(LineMesh._verticesPerGeometry/2);l[2*r*LineMesh._floatsPerVertex+0]=t[h].x,l[2*r*LineMesh._floatsPerVertex+1]=t[h].y,l[2*r*LineMesh._floatsPerVertex+2]=t[h].z,l[(2*r+1)*LineMesh._floatsPerVertex+0]=t[h].x,l[(2*r+1)*LineMesh._floatsPerVertex+1]=t[h].y,l[(2*r+1)*LineMesh._floatsPerVertex+2]=t[h].z,h%2==0?t[h].equals(t[s.MathUtils.wrap(h-1,0,t.length)])?(e.copy(t[s.MathUtils.wrap(h-2,0,t.length)]),i.copy(t[h+1])):(e.copy(t[h]),i.copy(t[h+1]),a=0):h%2==1&&(t[h].equals(t[s.MathUtils.wrap(h+1,0,t.length)])?(e.copy(t[h-1]),i.copy(t[s.MathUtils.wrap(h+2,0,t.length)])):(e.copy(t[h-1]),i.copy(t[h])),o.sub(t[h],t[h-1]),a+=o.magnitude()),l[2*r*LineMesh._floatsPerVertex+3]=e.x,l[2*r*LineMesh._floatsPerVertex+4]=e.y,l[2*r*LineMesh._floatsPerVertex+5]=e.z,l[(2*r+1)*LineMesh._floatsPerVertex+3]=e.x,l[(2*r+1)*LineMesh._floatsPerVertex+4]=e.y,l[(2*r+1)*LineMesh._floatsPerVertex+5]=e.z,l[2*r*LineMesh._floatsPerVertex+6]=i.x,l[2*r*LineMesh._floatsPerVertex+7]=i.y,l[2*r*LineMesh._floatsPerVertex+8]=i.z,l[(2*r+1)*LineMesh._floatsPerVertex+6]=i.x,l[(2*r+1)*LineMesh._floatsPerVertex+7]=i.y,l[(2*r+1)*LineMesh._floatsPerVertex+8]=i.z,l[2*r*LineMesh._floatsPerVertex+14]=a,l[(2*r+1)*LineMesh._floatsPerVertex+14]=a}r.data.needsUpdate=!0}s.Vector3.pool.release(n),s.Vector3.pool.release(r),s.Vector3.pool.release(e),s.Vector3.pool.release(i),s.Vector3.pool.release(o)}setColors(t){if(t.length%2!=0)throw new Error("Number of colors in the LineMesh must be even.");this._adjustVerticesInGeometries(2*t.length);for(let e=0;e<this._threeJsObjects.length;e++){const i=this._threeJsObjects[e].geometry.getAttribute("color"),s=i.array;for(let i=0;i<s.length/(2*LineMesh._floatsPerVertex);i++){const n=i+e*(LineMesh._verticesPerGeometry/2);s[2*i*LineMesh._floatsPerVertex+9]=t[n].r,s[2*i*LineMesh._floatsPerVertex+10]=t[n].g,s[2*i*LineMesh._floatsPerVertex+11]=t[n].b,s[2*i*LineMesh._floatsPerVertex+12]=t[n].a,s[(2*i+1)*LineMesh._floatsPerVertex+9]=t[n].r,s[(2*i+1)*LineMesh._floatsPerVertex+10]=t[n].g,s[(2*i+1)*LineMesh._floatsPerVertex+11]=t[n].b,s[(2*i+1)*LineMesh._floatsPerVertex+12]=t[n].a}i.data.needsUpdate=!0}}setWidths(t){if("number"==typeof t)for(let e=0;e<this._threeJsObjects.length;e++){const i=this._threeJsObjects[e].geometry.getAttribute("width"),s=i.array;for(let e=0;e<s.length/(2*LineMesh._floatsPerVertex);e++)s[2*e*LineMesh._floatsPerVertex+13]=t,s[(2*e+1)*LineMesh._floatsPerVertex+13]=-t;i.data.needsUpdate=!0}else{if(t.length%2!=0)throw new Error("Number of widths in the LineMesh must be even.");this._adjustVerticesInGeometries(2*t.length);for(let e=0;e<this._threeJsObjects.length;e++){const i=this._threeJsObjects[e].geometry.getAttribute("width"),s=i.array;for(let i=0;i<s.length/(2*LineMesh._floatsPerVertex);i++){const n=i+e*(LineMesh._verticesPerGeometry/2);s[2*i*LineMesh._floatsPerVertex+13]=t[n],s[(2*i+1)*LineMesh._floatsPerVertex+13]=-t[n]}i.data.needsUpdate=!0}}}setDashLength(t,e){this._dashLength=t,this._dashGapLength=e,s.ThreeJsHelper.setUniformNumber(this._threeJsMaterial,"dashLength",this._dashLength),s.ThreeJsHelper.setUniformNumber(this._threeJsMaterial,"dashGapLength",this._dashGapLength)}setGlowWidth(t){this._glowWidth=t,s.ThreeJsHelper.setUniformNumber(this._threeJsMaterial,"glowWidth",this._glowWidth)}setScale(t){this._scale=t,s.ThreeJsHelper.setScale(this._threeJsObjects,t)}getAlphaMultiplier(){return this._alphaMultiplier}setAlphaMultiplier(t){this._alphaMultiplier=t,s.ThreeJsHelper.setUniformNumber(this._threeJsMaterial,"alphaMultiplier",this._alphaMultiplier)}prepareForRender(t){const e=s.Vector2.pool.get();if("spout"===t.getType()){const i=t;e.set(.1*i.getRenderWidth(),.5*i.getRenderWidth()*.1)}else e.copy(t.getViewport().getBounds().size);s.ThreeJsHelper.setUniformVector2(this._threeJsMaterial,"pixelSize",e),s.Vector2.pool.release(e)}_adjustVerticesInGeometries(t){const e=Math.ceil(t/LineMesh._verticesPerGeometry);for(;this._threeJsObjects.length>e;){const t=this._threeJsObjects[this._threeJsObjects.length-1];s.ThreeJsHelper.destroyObject(t),this._threeJsObjects.splice(this._threeJsObjects.length-1,1);for(let e=0,i=this._component.getThreeJsObjects().length;e<i;e++)if(this._component.getThreeJsObjects()[e]===t){this._component.getThreeJsObjects().splice(e,1);break}}if(this._threeJsObjects.length<e){this._threeJsObjects.length>0&&this._setupThreeJsGeometry(this._threeJsObjects[this._threeJsObjects.length-1].geometry,LineMesh._verticesPerGeometry);for(let i=this._threeJsObjects.length;i<e;i++){const e=s.ThreeJsHelper.createMeshObject(this._component,this._threeJsMaterial,[],!1);this._threeJsObjects.push(e),this._component.getThreeJsObjects().push(e);const n=Math.min(t-i*LineMesh._verticesPerGeometry,LineMesh._verticesPerGeometry);this._setupThreeJsGeometry(e.geometry,n),s.ThreeJsHelper.setPosition(e,this._position),s.ThreeJsHelper.setOrientation(e,this._orientation),s.ThreeJsHelper.setScale(e,this._scale),e.frustumCulled=!1}}else if(e>0){const i=this._threeJsObjects[e-1].geometry,s=t-(e-1)*LineMesh._verticesPerGeometry;i.getAttribute("position").array.length!==s*LineMesh._floatsPerVertex&&this._setupThreeJsGeometry(i,s)}}_setupThreeJsGeometry(t,e){const i=new Float32Array(e*LineMesh._floatsPerVertex),n=new s.THREE.InterleavedBuffer(i,LineMesh._floatsPerVertex);t.setAttribute("position",new s.THREE.InterleavedBufferAttribute(n,3,0,!1)),t.setAttribute("positionPrev",new s.THREE.InterleavedBufferAttribute(n,3,3,!1)),t.setAttribute("positionNext",new s.THREE.InterleavedBufferAttribute(n,3,6,!1)),t.setAttribute("color",new s.THREE.InterleavedBufferAttribute(n,4,9,!1)),t.setAttribute("width",new s.THREE.InterleavedBufferAttribute(n,1,13,!1)),t.setAttribute("dashOffset",new s.THREE.InterleavedBufferAttribute(n,1,14,!1));const r=new Uint16Array(6*e/4);for(let t=0;t<e/4;t++)r[6*t+0]=4*t,r[6*t+1]=4*t+2,r[6*t+2]=4*t+3,r[6*t+3]=4*t,r[6*t+4]=4*t+3,r[6*t+5]=4*t+1;t.setIndex(new s.THREE.BufferAttribute(r,1))}}LineMesh._floatsPerVertex=15,LineMesh._verticesPerGeometry=65536;const n=LineMesh},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class MaterialUtilsPhong{static get(){null===MaterialUtilsPhong._material&&(MaterialUtilsPhong._material=new s.THREE.ShaderMaterial({uniforms:{entityPos:new s.THREE.Uniform(new s.THREE.Vector3),ambientLightColor:new s.THREE.Uniform(new s.THREE.Color),lightPositions:new s.THREE.Uniform([new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0)]),lightColors:new s.THREE.Uniform([new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0)]),lightRadii:new s.THREE.Uniform([0,0,0,0,0]),numLights:new s.THREE.Uniform(0),color:new s.THREE.Uniform(new s.THREE.Color(1,1,1)),specularColor:new s.THREE.Uniform(new s.THREE.Color(1,1,1)),specularIntensity:new s.THREE.Uniform(0),specularHardness:new s.THREE.Uniform(50),colorTexture:new s.THREE.Uniform(null),normalTexture:new s.THREE.Uniform(null),specularTexture:new s.THREE.Uniform(null),nightTexture:new s.THREE.Uniform(null),decalTexture:new s.THREE.Uniform(null),normalScale:new s.THREE.Uniform(new s.THREE.Vector2),numShadowEntities:new s.THREE.Uniform(0),shadowEntityPositions:new s.THREE.Uniform([new s.THREE.Vector3,new s.THREE.Vector3,new s.THREE.Vector3,new s.THREE.Vector3,new s.THREE.Vector3]),shadowEntityRadii:new s.THREE.Uniform([0,0,0,0,0]),shadowEntityRayleighAmount:new s.THREE.Uniform([0,0,0,0,0]),shadowRingsInnerRadius:new s.THREE.Uniform(0),shadowRingsOuterRadius:new s.THREE.Uniform(0),shadowRingsTexture:new s.THREE.Uniform(null),shadowRingsNormal:new s.THREE.Uniform(new s.THREE.Vector3),atmospherePosition:new s.THREE.Uniform(new s.THREE.Vector3(0,0,0)),atmosphereOrientation:new s.THREE.Uniform(new s.THREE.Vector4(1,0,0,0)),atmosphereEquatorialRadius:new s.THREE.Uniform(1),atmospherePolarRadius:new s.THREE.Uniform(1),atmosphereDensity:new s.THREE.Uniform(0),atmosphereScaleHeight:new s.THREE.Uniform(1),atmosphereEmissivity:new s.THREE.Uniform(0),atmosphereColor:new s.THREE.Uniform(new s.THREE.Vector3(0,0,0)),atmosphereSunBrightness:new s.THREE.Uniform(1),atmosphereSunsetColor:new s.THREE.Uniform(new s.THREE.Vector3(0,0,0)),atmosphereSunsetIntensity:new s.THREE.Uniform(0),atmosphereGroundIsSpheroid:new s.THREE.Uniform(0)},vertexShader:"\n\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\tattribute vec4 tangent;\n\t\t\t\t\t\tvarying vec4 viewTangent;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef normalUVs\n\t\t\t\t\t\tattribute vec2 normalUV;\n\t\t\t\t\t\tvarying vec2 vNormalUV;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef specularUVs\n\t\t\t\t\t\tattribute vec2 specularUV;\n\t\t\t\t\t\tvarying vec2 vSpecularUV;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef nightUVs\n\t\t\t\t\t\tattribute vec2 nightUV;\n\t\t\t\t\t\tvarying vec2 vNightUV;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef decalUVs\n\t\t\t\t\t\tattribute vec2 decalUV;\n\t\t\t\t\t\tvarying vec2 vDecalUV;\n\t\t\t\t\t#endif\n\t\t\t\t\tvarying vec2 vColorUV;\n\t\t\t\t\tvarying vec3 cameraSpacePosition;\n\t\t\t\t\tvarying vec3 cameraSpaceNormal;\n\n\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\tvarying float fragDepth;\n\t\t\t\t\t#else\n\t\t\t\t\t\tuniform float midDistance;\n\t\t\t\t\t\tuniform float nearDistance;\n\t\t\t\t\t#endif\n\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\t\tviewTangent = vec4((modelMatrix * vec4(tangent.xyz, 0.0)).xyz, tangent.w);\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\tvColorUV = uv;\n\t\t\t\t\t\t#ifdef normalUVs\n\t\t\t\t\t\t\tvNormalUV = normalUV;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#ifdef specularUVs\n\t\t\t\t\t\t\tvSpecularUV = specularUV;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#ifdef nightUVs\n\t\t\t\t\t\t\tvNightUV = nightUV;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#ifdef decalUVs\n\t\t\t\t\t\t\tvDecalUV = decalUV;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\tcameraSpacePosition = (modelMatrix * vec4(position, 1.)).xyz;\n\t\t\t\t\t\tcameraSpaceNormal = (modelMatrix * vec4(normal, 0.)).xyz;\n\t\t\t\t\t\tvec4 viewPosition = viewMatrix * vec4(cameraSpacePosition, 1.);\n\t\t\t\t\t\tgl_Position = projectionMatrix * viewPosition;\n\t\t\t\t\t\tgl_Position.w = viewPosition.y;\n\n\t\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\t\tfragDepth = gl_Position.w;\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tfloat z = gl_Position.w;\n\t\t\t\t\t\t\tif (z < midDistance) {\n\t\t\t\t\t\t\t\tgl_Position.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\n\t\t\t\t\t\t\t\tgl_Position.z = log2(z - midDistance + 1.0) * logFactor;\n\t\t\t\t\t\t\t\tgl_Position.z *= gl_Position.w;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}",fragmentShader:"\n\t\t\t\t\t#ifndef saturate\n\t\t\t\t\t\t#define saturate(a) clamp(a, 0.0, 1.0)\n\t\t\t\t\t#endif\n\t\t\t\t\tuniform mat3 normalMatrix;\n\n\t\t\t\t\t// External lighting and camera.\n\t\t\t\t\tuniform vec3 entityPos;\n\n\t\t\t\t\t// Lights\n\t\t\t\t\tuniform vec3 ambientLightColor;\n\t\t\t\t\tuniform vec3 lightPositions[5];\n\t\t\t\t\tuniform vec3 lightColors[5];\n\t\t\t\t\tuniform float lightRadii[5];\n\t\t\t\t\tuniform int numLights;\n\n\t\t\t\t\t// Shading.\n\t\t\t\t\tuniform vec3 color;\n\t\t\t\t\tuniform vec3 specularColor;\n\t\t\t\t\tuniform float specularIntensity;\n\t\t\t\t\tuniform float specularHardness;\n\n\t\t\t\t\t// Shadow Entities.\n\t\t\t\t\t#ifdef shadowEntities\n\t\t\t\t\t\tuniform int numShadowEntities;\n\t\t\t\t\t\tuniform vec3 shadowEntityPositions[5];\n\t\t\t\t\t\tuniform float shadowEntityRadii[5];\n\t\t\t\t\t\tuniform float shadowEntityRayleighAmount[5];\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#ifdef shadowRings\n\t\t\t\t\t\tuniform float shadowRingsInnerRadius;\n\t\t\t\t\t\tuniform float shadowRingsOuterRadius;\n\t\t\t\t\t\tuniform sampler2D shadowRingsTexture;\n\t\t\t\t\t\tuniform vec3 shadowRingsNormal;\n\t\t\t\t\t#endif\n\n\t\t\t\t\t// Textures.\n\t\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\tuniform sampler2D normalTexture;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef specularMap\n\t\t\t\t\t\tuniform sampler2D specularTexture;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef nightMap\n\t\t\t\t\t\tuniform sampler2D nightTexture;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef decalMap\n\t\t\t\t\t\tuniform sampler2D decalTexture;\n\t\t\t\t\t#endif\n\n\t\t\t\t\t// Modifications on the textures.\n\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\tuniform vec2 normalScale;\n\t\t\t\t\t#endif\n\n\t\t\t\t\t// The varying attributes.\n\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\tvarying vec4 viewTangent;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef normalUVs\n\t\t\t\t\t\tvarying vec2 vNormalUV;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef specularUVs\n\t\t\t\t\t\tvarying vec2 vSpecularUV;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef nightUVs\n\t\t\t\t\t\tvarying vec2 vNightUV;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef decalUVs\n\t\t\t\t\t\tvarying vec2 vDecalUV;\n\t\t\t\t\t#endif\n\t\t\t\t\tvarying vec2 vColorUV;\n\t\t\t\t\tvarying vec3 cameraSpacePosition;\n\t\t\t\t\tvarying vec3 cameraSpaceNormal;\n\n\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\tuniform mat4 projectionMatrix;\n\t\t\t\t\t\tvarying float fragDepth;\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\tvec3 getNormalFromMap() {\n\t\t\t\t\t\t\tvec3 normal = normalize(cameraSpaceNormal);\n\t\t\t\t\t\t\tvec3 tangent = normalize(viewTangent.xyz);\n\t\t\t\t\t\t\tvec3 bitangent = normalize(cross(normal, tangent));\n\t\t\t\t\t\t\tif (viewTangent.w < 0.0) {\n\t\t\t\t\t\t\t\tbitangent *= -1.0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmat3 transform = mat3(tangent, bitangent, normal);\n\t\t\t\t\t\t\t#ifdef normalUVs\n\t\t\t\t\t\t\t\tvec2 uv = vNormalUV;\n\t\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\tvec2 uv = vColorUV;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\tvec3 normalFromMap = texture2D(normalTexture, uv).rgb * 2.0 - 1.0;\n\t\t\t\t\t\t\tnormalFromMap.xy *= vec2(1, -1);\n\t\t\t\t\t\t\tnormalFromMap.xy *= normalScale;\n\t\t\t\t\t\t\treturn normalize(transform * normalFromMap);\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#ifdef colorTextureEnvironment\n\t\t\t\t\t\tvec4 getColorFromEnvironmentMap(sampler2D environmentTexture, vec3 positionDir, vec3 normal) {\n\t\t\t\t\t\t\tvec3 r = reflect(positionDir, normal);\n\t\t\t\t\t\t\tfloat m = 2. * sqrt(r.x * r.x + r.y * r.y + (r.z + 1.) * (r.z + 1.));\n\t\t\t\t\t\t\tvec2 uv = r.xy / m + .5;\n\t\t\t\t\t\t\treturn vec4(texture2D(environmentTexture, uv).rgb, 1.);\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#ifdef shadowEntities\n\t\t\t\t\t\tvec3 applyRayleighScattering(vec3 color, float amount) {\n\t\t\t\t\t\t\tfloat value = (color.r + color.g + color.b);\n\t\t\t\t\t\t\tif (value > 0.0) {\n\t\t\t\t\t\t\t\tfloat rFactor = 1.0; // 6.3^-4 / 6.3^-4\n\t\t\t\t\t\t\t\tfloat gFactor = 1.602; // 5.6^-4 / 6.3^-4\n\t\t\t\t\t\t\t\tfloat bFactor = 3.228; // 4.7^-4 / 6.3^-4\n\t\t\t\t\t\t\t\tcolor.r *= pow(rFactor, -amount);\n\t\t\t\t\t\t\t\tcolor.g *= pow(gFactor, -amount);\n\t\t\t\t\t\t\t\tcolor.b *= pow(bFactor, -amount);\n\t\t\t\t\t\t\t\tcolor = value * color / (color.r + color.g + color.b);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn color;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvec3 getLightColorFromShadowEntities(vec3 lightColor, vec3 lightDir, vec3 lightPosition, float lightRadius, vec3 normal) {\n\t\t\t\t\t\t\tvec3 color = lightColor;\n\t\t\t\t\t\t\tfor (int i = 0; i < 5; i++) {\n\t\t\t\t\t\t\t\tif (i >= numShadowEntities || lightRadius < 0.0) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvec3 origin = cameraSpacePosition - shadowEntityPositions[i];\n\t\t\t\t\t\t\t\tvec3 axis = normalize(shadowEntityPositions[i] - lightPosition);\n\t\t\t\t\t\t\t\tfloat originOffset = dot(origin, axis);\n\t\t\t\t\t\t\t\tif (originOffset > 0.0) {\n\t\t\t\t\t\t\t\t\tfloat e = length(origin - originOffset * axis);\n\t\t\t\t\t\t\t\t\tfloat ld = dot(cameraSpacePosition - lightPosition, axis);\n\t\t\t\t\t\t\t\t\tfloat sd = dot(origin, axis);\n\t\t\t\t\t\t\t\t\tfloat lr = lightRadius;\n\t\t\t\t\t\t\t\t\tfloat sr = shadowEntityRadii[i];\n\t\t\t\t\t\t\t\t\tfloat e0 = (ld * sr - lr * sd) / (ld - sd);\n\t\t\t\t\t\t\t\t\tfloat e1 = (ld * sr + lr * sd) / (ld - sd);\n\t\t\t\t\t\t\t\t\tfloat lightLevel = 0.0;\n\t\t\t\t\t\t\t\t\tif (e1 < 0.0 || sd < 0.0) { // light in front of shadow entity\n\t\t\t\t\t\t\t\t\t\tlightLevel = 1.0;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse if (e0 < e1) {\n\t\t\t\t\t\t\t\t\t\te0 -= (e1 - e0) * shadowEntityRayleighAmount[i] / 6.0;\n\t\t\t\t\t\t\t\t\t\tlightLevel = pow(saturate((e - e0) / (e1 - e0)), 0.5); // soft light\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\tlightLevel = e < e0 ? 0.0 : 1.0; // 0 radius light.\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcolor = lightLevel * applyRayleighScattering(color, (1.0 - lightLevel) * shadowEntityRayleighAmount[i]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn color;\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#ifdef shadowRings\n\t\t\t\t\t\tvec3 getLightColorFromShadowRings(vec3 lightColor, vec3 lightDir) {\n\t\t\t\t\t\t\tvec3 position = cameraSpacePosition - entityPos;\n\t\t\t\t\t\t\thighp float d = dot(position, shadowRingsNormal) / dot(lightDir, shadowRingsNormal);\n\t\t\t\t\t\t\thighp vec3 pointOnDisc = -d * lightDir + position;\n\t\t\t\t\t\t\thighp float lengthOnDisc = length(pointOnDisc - dot(pointOnDisc, shadowRingsNormal) * shadowRingsNormal);\n\t\t\t\t\t\t\thighp float u = (lengthOnDisc - shadowRingsInnerRadius) / (shadowRingsOuterRadius - shadowRingsInnerRadius);\n\t\t\t\t\t\t\thighp float shadow = 1.0 - texture2D(shadowRingsTexture, vec2(u, 0.0), 0.0).a;\n\t\t\t\t\t\t\tif (shadowRingsInnerRadius <= lengthOnDisc && lengthOnDisc <= shadowRingsOuterRadius && d > 0.0) {\n\t\t\t\t\t\t\t\treturn lightColor * saturate(shadow);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\treturn lightColor;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\t// ATMOSPHERE\n\n\t\t\t\t\t#ifdef atmosphere\n\t\t\t\t\t\tuniform vec3 atmospherePosition;\n\t\t\t\t\t\tuniform vec4 atmosphereOrientation;\n\t\t\t\t\t\tuniform float atmosphereEquatorialRadius;\n\t\t\t\t\t\tuniform float atmospherePolarRadius;\n\t\t\t\t\t\tuniform float atmosphereDensity;\n\t\t\t\t\t\tuniform float atmosphereScaleHeight;\n\t\t\t\t\t\tuniform vec3 atmosphereColor;\n\t\t\t\t\t\tuniform float atmosphereEmissivity;\n\t\t\t\t\t\tuniform float atmosphereSunBrightness;\n\t\t\t\t\t\tuniform vec3 atmosphereSunsetColor;\n\t\t\t\t\t\tuniform float atmosphereSunsetIntensity;\n\t\t\t\t\t\tuniform float atmosphereGroundIsSpheroid;\n\n\t\t\t\t\t\tconst int atmosphereNumIterations = 5;\n\n\t\t\t\t\t\t// Inverse rotate a vector by a quaternion.\n\t\t\t\t\t\tvec3 quatRotInv(vec4 q, vec3 v) {\n\t\t\t\t\t\t\tfloat tx = q.w * v.x - q.y * v.z + q.z * v.y;\n\t\t\t\t\t\t\tfloat ty = q.w * v.y - q.z * v.x + q.x * v.z;\n\t\t\t\t\t\t\tfloat tz = q.w * v.z - q.x * v.y + q.y * v.x;\n\t\t\t\t\t\t\tfloat tw = q.x * v.x + q.y * v.y + q.z * v.z;\n\t\t\t\t\t\t\tfloat x = tx * q.w + tw * q.x + ty * q.z - tz * q.y;\n\t\t\t\t\t\t\tfloat y = ty * q.w + tw * q.y + tz * q.x - tx * q.z;\n\t\t\t\t\t\t\tfloat z = tz * q.w + tw * q.z + tx * q.y - ty * q.x;\n\t\t\t\t\t\t\treturn vec3(x, y, z);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Given an origin and direction, computes the sampling start and end as distance from the origin in the direction.\n\t\t\t\t\t\tvoid getStartEndSamples(out float start, out float end, vec3 origin, vec3 direction, float maxDistance, float groundRadius, float atmosphereScaleHeight) {\n\t\t\t\t\t\t\t// Get the along the ray perpendicular to the sphere.\n\t\t\t\t\t\t\tfloat perpD = -dot(origin, direction);\n\t\t\t\t\t\t\tvec3 perp = origin + direction * perpD;\n\n\t\t\t\t\t\t\t// Figure out the sample distance.\n\t\t\t\t\t\t\tfloat atmosphereRadius = groundRadius + atmosphereScaleHeight * 6.0;\n\t\t\t\t\t\t\tfloat chordHalfLength = sqrt(max(0.0, atmosphereRadius * atmosphereRadius - dot(perp, perp)));\n\n\t\t\t\t\t\t\t// Figure out starting and ending sample points.\n\t\t\t\t\t\t\tstart = max(0.0, perpD - chordHalfLength);\n\t\t\t\t\t\t\tend = min(maxDistance, perpD + chordHalfLength);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Gets the density of the atmosphere at a given position.\n\t\t\t\t\t\tfloat getDensity(vec3 position, float radius, float density, float atmosphereScaleHeight) {\n\t\t\t\t\t\t\treturn density * exp((radius - length(position)) / atmosphereScaleHeight);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Returns 0 if the ray does not intersect and 1.0 if the ray very intersects (with a gradient inbetween).\n\t\t\t\t\t\tfloat getDayLevel(vec3 origin, vec3 direction, float radius, float scaleHeight) {\n\t\t\t\t\t\t\tfloat blendHeight = scaleHeight * radius / 200.0;\n\t\t\t\t\t\t\tfloat perpD = -dot(origin, direction);\n\t\t\t\t\t\t\tfloat depth = radius - sqrt(dot(origin, origin) - sign(perpD) * perpD * perpD);\n\t\t\t\t\t\t\tif (depth < 0.0) { // day\n\t\t\t\t\t\t\t\treturn 1.0 - max(0.0, 0.25 * depth / blendHeight + 0.25);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse { // night\n\t\t\t\t\t\t\t\treturn 1.0 - min(1.0, 0.75 * depth / blendHeight + 0.25);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Adjusts the color if one of the RGB values is greater than 1.0.\n\t\t\t\t\t\tvec3 adjustOverbrightness(vec3 color) {\n\t\t\t\t\t\t\tfloat maxColor = max(color.r, max(color.g, color.b));\n\t\t\t\t\t\t\tif (maxColor > 1.0) {\n\t\t\t\t\t\t\t\tfloat f = (maxColor - 1.0) / maxColor;\n\t\t\t\t\t\t\t\tcolor.r = min(1.0, pow(color.r / maxColor, 1.0 / maxColor));\n\t\t\t\t\t\t\t\tcolor.g = min(1.0, pow(color.g / maxColor, 1.0 / maxColor));\n\t\t\t\t\t\t\t\tcolor.b = min(1.0, pow(color.b / maxColor, 1.0 / maxColor));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn color;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfloat easeInOut(float x, float sharpness) {\n\t\t\t\t\t\t\tfloat b = sharpness;\n\t\t\t\t\t\t\tif (x < 0.5) {\n\t\t\t\t\t\t\t\treturn max(0.0, (pow(b, 2.0 * x) - 1.0) / (2.0 * (b - 1.0)));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\treturn min(1.0, 1.0 - (pow(b, 2.0 * (1.0 - x)) - 1.0) / (2.0 * (b - 1.0)));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Calculates a glow around the light direction.\n\t\t\t\t\t\tfloat glow(float spread, float amount, float lightDotCamera) {\n\t\t\t\t\t\t\treturn amount * spread / (1.0 + spread - lightDotCamera);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Adjust the incoming light for the atmosphere.\n\t\t\t\t\t\tvec4 getAtmosphereColor(vec3 incomingLight, vec3 lightPosition) {\n\t\t\t\t\t\t\t// Get position, camera, and light relative to the atmosphere center.\n\t\t\t\t\t\t\thighp vec3 position = cameraSpacePosition - atmospherePosition;\n\t\t\t\t\t\t\thighp vec3 cameraPosition = -atmospherePosition;\n\n\t\t\t\t\t\t\t// Get position, camera, and light relative to the atmosphere orientation.\n\t\t\t\t\t\t\tposition = quatRotInv(atmosphereOrientation, position);\n\t\t\t\t\t\t\tcameraPosition = quatRotInv(atmosphereOrientation, cameraPosition);\n\n\t\t\t\t\t\t\t// Convert everything into a sphere frame.\n\t\t\t\t\t\t\tfloat spheroidRatio = atmosphereEquatorialRadius / atmospherePolarRadius;\n\t\t\t\t\t\t\tposition.z *= spheroidRatio;\n\t\t\t\t\t\t\tcameraPosition.z *= spheroidRatio;\n\n\t\t\t\t\t\t\t// If the ground is a spheroid, get to be the right position.\n\t\t\t\t\t\t\tposition = normalize(position) * atmosphereEquatorialRadius;\n\n\t\t\t\t\t\t\thighp vec3 cameraToPosition = position - cameraPosition;\n\t\t\t\t\t\t\thighp float cameraToPositionDist = length(cameraToPosition / 1.0e8) * 1.0e8;\n\t\t\t\t\t\t\thighp vec3 cameraToPositionUnit = cameraToPosition / cameraToPositionDist;\n\n\t\t\t\t\t\t\t// This will be the final color.\n\t\t\t\t\t\t\tvec4 color = vec4(0.0);\n\n\t\t\t\t\t\t\t// Get the start and end of the sampling from the camera to the position.\n\t\t\t\t\t\t\tfloat start;\n\t\t\t\t\t\t\tfloat end;\n\t\t\t\t\t\t\tgetStartEndSamples(start, end, cameraPosition, cameraToPositionUnit, cameraToPositionDist, atmosphereEquatorialRadius, atmosphereScaleHeight);\n\t\t\t\t\t\t\tfloat step = 1.0 / float(atmosphereNumIterations - 1);\n\t\t\t\t\t\t\tfloat stepDist = step * (end - start);\n\n\t\t\t\t\t\t\t// Do the sampling.\n\t\t\t\t\t\t\tfloat totalDensity = 0.0;\n\t\t\t\t\t\t\tfloat segmentStart = start;\n\t\t\t\t\t\t\tfor (int j = 0; j < atmosphereNumIterations; j++) {\n\t\t\t\t\t\t\t\t// Get the distance that this segment covers.\n\t\t\t\t\t\t\t\tfloat segDist = stepDist;\n\t\t\t\t\t\t\t\tif (j == 0 || j == atmosphereNumIterations - 1) {\n\t\t\t\t\t\t\t\t\tsegDist *= 0.5;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Get the segment start that we're looking at.\n\t\t\t\t\t\t\t\tvec3 p = cameraPosition + segmentStart * cameraToPositionUnit;\n\n\t\t\t\t\t\t\t\t// Get the density at that segment start. It'll be the density for the whole segment.\n\t\t\t\t\t\t\t\tfloat densityAtP = getDensity(p, atmosphereEquatorialRadius, atmosphereDensity, atmosphereScaleHeight);\n\n\t\t\t\t\t\t\t\t// Add it to the total density.\n\t\t\t\t\t\t\t\ttotalDensity += densityAtP * segDist;\n\n\t\t\t\t\t\t\t\t// Next step.\n\t\t\t\t\t\t\t\tsegmentStart += stepDist;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Apply emissivity to the light color.\n\t\t\t\t\t\t\tvec3 sunLightColor = mix(incomingLight, vec3(1.0, 1.0, 1.0), atmosphereEmissivity);\n\n\t\t\t\t\t\t\t// Apply the total density to the transparency of the atmosphere.\n\t\t\t\t\t\t\tcolor.a = clamp(pow(3.0 * totalDensity, 0.3), 0.0, 1.0);\n\n\t\t\t\t\t\t\t// Multiply it all together with the source light color.\n\t\t\t\t\t\t\tcolor.rgb = sunLightColor * atmosphereColor * clamp(pow(15.0 * totalDensity / (atmosphereDensity * atmosphereEquatorialRadius), 0.2), 0.75, 1.0);\n\n\t\t\t\t\t\t\t// Make it more opaque when lower down.\n\t\t\t\t\t\t\tcolor.a *= 1.0 + 0.5 * getDensity(cameraPosition, atmosphereEquatorialRadius, 1.0, atmosphereScaleHeight);\n\n\t\t\t\t\t\t\t// Clamp it to make it clean for the day/night transition.\n\t\t\t\t\t\t\tcolor.a = clamp(color.a, 0.0, 1.0);\n\n\t\t\t\t\t\t\t// Get the light position in the sphere entity-space.\n\t\t\t\t\t\t\tlightPosition = quatRotInv(atmosphereOrientation, lightPosition);\n\t\t\t\t\t\t\tlightPosition.z *= spheroidRatio;\n\t\t\t\t\t\t\thighp vec3 lightToPosition = position - lightPosition;\n\t\t\t\t\t\t\thighp vec3 lightToPositionUnit = normalize(lightToPosition / 1.0e8);\n\n\t\t\t\t\t\t\t// Get the day level, from 0 to 1, and apply it to the alpha.\n\t\t\t\t\t\t\tfloat ambientLightIntensity = min(1.0, length(ambientLightColor));\n\t\t\t\t\t\t\tvec3 dayRefUp = normalize(cameraPosition + end * cameraToPositionUnit);\n\t\t\t\t\t\t\tfloat dayLevel = -dot(lightToPositionUnit, dayRefUp);\n\t\t\t\t\t\t\tfloat lightIntensity = mix(dayLevel, 0.0, ambientLightIntensity);\n\t\t\t\t\t\t\tcolor.a *= mix(atmosphereEmissivity, 1.0, easeInOut(0.25 * 700.0 * atmosphereDensity + 1.0 * lightIntensity, 2.0));\n\n\t\t\t\t\t\t\t// Add broader sun glare.\n\t\t\t\t\t\t\tfloat lightDotCamera = max(0.0, -dot(lightToPositionUnit, cameraToPositionUnit));\n\t\t\t\t\t\t\tcolor.rgb *= sunLightColor * (1.0 + atmosphereSunBrightness * color.a * glow(0.04, 0.125, lightDotCamera));\n\n\t\t\t\t\t\t\t// Apply the sunset.\n\t\t\t\t\t\t\tfloat sunsetAmount = mix(atmosphereSunsetIntensity * easeInOut(0.5 * (1.0 - abs(dayLevel)), 4.0), 0.0, ambientLightIntensity);\n\t\t\t\t\t\t\tcolor.rgb = color.rgb * mix(vec3(1.0), atmosphereSunsetColor, clamp(sunsetAmount, 0.0, 1.0));\n\n\t\t\t\t\t\t\t// Adjust for values that are greater than one.\n\t\t\t\t\t\t\tcolor.rgb = adjustOverbrightness(color.rgb);\n\n\t\t\t\t\t\t\treturn color;\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\tvoid main(void) {\n\t\t\t\t\t\t// Get the camera direction to the position.\n\t\t\t\t\t\tvec3 positionDir = normalize(cameraSpacePosition);\n\n\t\t\t\t\t\t// Calculate the normal.\n\t\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\t\tvec3 normal = getNormalFromMap();\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tvec3 normal = normalize(cameraSpaceNormal);\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// The diffuse light.\n\t\t\t\t\t\tvec3 diffuseLight = ambientLightColor;\n\t\t\t\t\t\tvec3 specularLight = vec3(0, 0, 0);\n\t\t\t\t\t\tvec4 atmosphereColor = vec4(0, 0, 0, 0);\n\n\t\t\t\t\t\t// For each light,\n\t\t\t\t\t\tfor (int i = 0; i < 5; i++) {\n\t\t\t\t\t\t\tif (i >= numLights) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Get lighting angles.\n\t\t\t\t\t\t\tvec3 lightDir = normalize(cameraSpacePosition - lightPositions[i]);\n\t\t\t\t\t\t\tfloat lightCosAngle = -dot(lightDir, normal);\n\n\t\t\t\t\t\t\t// If an atmosphere is being used, brighten up the surface a bit, depending on the density of the atmosphere.\n\t\t\t\t\t\t\t#ifdef atmosphere\n\t\t\t\t\t\t\t\tlightCosAngle += 0.25 * 700.0 * atmosphereDensity;\n\t\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t\t// Get the incoming light after shadows.\n\t\t\t\t\t\t\tvec3 incomingLight = lightColors[i];\n\t\t\t\t\t\t\t#if !defined(colorMapEmmissive) | !defined(nightMapEmmissive) | !defined(decalMapEmmissive)\n\t\t\t\t\t\t\t\t#ifdef shadowEntities\n\t\t\t\t\t\t\t\t\tincomingLight = getLightColorFromShadowEntities(incomingLight, lightDir, lightPositions[i], lightRadii[i], normal);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t\t#ifdef shadowRings\n\t\t\t\t\t\t\t\t\tincomingLight = getLightColorFromShadowRings(incomingLight, lightDir);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t\t// Diffuse shading.\n\t\t\t\t\t\t\tdiffuseLight += incomingLight * saturate(lightCosAngle);\n\n\t\t\t\t\t\t\t// Specular shading.\n\t\t\t\t\t\t\tvec3 reflectedLightDir = reflect(lightDir, normal);\n\t\t\t\t\t\t\tvec3 halfVector = normalize(-lightDir - positionDir);\n\t\t\t\t\t\t\tfloat phongHighlight = 0.25 * pow(saturate(-dot(reflectedLightDir, positionDir)), specularHardness / 2.0);\n\t\t\t\t\t\t\tfloat blinnHighlight = 4.0 * pow(saturate(dot(halfVector, normal)), specularHardness);\n\t\t\t\t\t\t\tfloat specularAngle = phongHighlight + pow(1.0 - saturate(-dot(positionDir, normal)), specularHardness / 12.0) * blinnHighlight;\n\t\t\t\t\t\t\tspecularLight += saturate(lightCosAngle * 20.0) * specularAngle * incomingLight;\t\n\n\t\t\t\t\t\t\t// Atmosphere shading.\n\t\t\t\t\t\t\t#ifdef atmosphere\n\t\t\t\t\t\t\t\tif (length(lightPositions[i]) > 0.0) { // don't use a camera light\n\t\t\t\t\t\t\t\t\tatmosphereColor += getAtmosphereColor(incomingLight, lightPositions[i]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdiffuseLight = saturate(diffuseLight);\n\n\t\t\t\t\t\t// If there's ambience, remove the direct light components.\n\t\t\t\t\t\tspecularLight *= vec3(1, 1, 1) - ambientLightColor;\n\n\t\t\t\t\t\t// Main Color map.\n\t\t\t\t\t\tvec4 colorPixel = vec4(1, 0, 1, 1);\n\t\t\t\t\t\t#ifdef colorTextureEnvironment\n\t\t\t\t\t\t\tcolorPixel = getColorFromEnvironmentMap(colorTexture, positionDir, normal);\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tcolorPixel = texture2D(colorTexture, vColorUV) * vec4(color, 1);\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#ifdef baseColor\n\t\t\t\t\t\t\tcolorPixel = vec4(color, 1);\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// Apply diffuse shading.\n\t\t\t\t\t\t#ifndef colorMapEmmissive\n\t\t\t\t\t\t\tcolorPixel *= vec4(diffuseLight, 1.0);\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\tgl_FragColor = colorPixel;\n\n\t\t\t\t\t\t// Specular Map\n\t\t\t\t\t\tvec3 specularPixel = specularColor * specularIntensity;\n\t\t\t\t\t\t#ifdef specularMap\n\t\t\t\t\t\t\t#ifdef specularUVs\n\t\t\t\t\t\t\t\tvec2 specularUV = vSpecularUV;\n\t\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\tvec2 specularUV = vColorUV;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\tspecularPixel = specularColor * texture2D(specularTexture, specularUV).r;\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// Apply specular Shading\n\t\t\t\t\t\tgl_FragColor.rgb += specularLight * specularPixel;\n\n\t\t\t\t\t\t// Night-Side Map\n\t\t\t\t\t\t#ifdef nightMap\n\t\t\t\t\t\t\tfloat ambientLightIntensity = min(1.0, length(ambientLightColor));\n\t\t\t\t\t\t\t#ifdef nightUVs\n\t\t\t\t\t\t\t\tvec2 nightUV = vNightUV;\n\t\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\tvec2 nightUV = vColorUV;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\tvec4 nightPixel = texture2D(nightTexture, nightUV);\n\t\t\t\t\t\t\t#ifndef nightMapEmmissive\n\t\t\t\t\t\t\t\tnightPixel *= vec4(diffuseLight, 1.0);\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\tgl_FragColor = mix(gl_FragColor, nightPixel, 1.0 - min(1.0, length(ambientLightColor + diffuseLight)));//(1.0 - ambientLightIntensity) * saturate(0.5 - length(diffuseLight)));\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// Decal Map\n\t\t\t\t\t\t#ifdef decalMap\n\t\t\t\t\t\t\t#ifdef decalUVs\n\t\t\t\t\t\t\t\tvec2 decalUV = vDecalUV;\n\t\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\tvec2 decalUV = vColorUV;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\tvec4 decalPixel = texture2D(decalTexture, decalUV);\n\t\t\t\t\t\t\t#ifndef decalMapEmmissive\n\t\t\t\t\t\t\t\tdecalPixel *= vec4(diffuseLight, 1.0);\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, decalPixel.rgb, decalPixel.a);\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// Atmosphere\n\t\t\t\t\t\t#ifdef atmosphere\n\t\t\t\t\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, atmosphereColor.rgb, clamp(atmosphereColor.a, 0.0, 1.0));\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// Log-Depth Buffering\n\t\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\n\t\t\t\t\t\t\tgl_FragDepthEXT = projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}"}));const t=MaterialUtilsPhong._material.clone();for(let e=0;e<t.uniforms.shadowEntityPositions.value.length;e++)t.uniforms.shadowEntityPositions.value[e]=MaterialUtilsPhong._material.uniforms.shadowEntityPositions.value[e].clone();return s.ThreeJsHelper.setupLogDepthBuffering(t),t.extensions.derivatives=!0,t.needsUpdate=!0,t}}MaterialUtilsPhong._material=null;const n=MaterialUtilsPhong},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class MaterialUtilsStandard{static get(){null===MaterialUtilsStandard._material&&(MaterialUtilsStandard._material=new s.THREE.ShaderMaterial({uniforms:{ambientLightColor:new s.THREE.Uniform(new s.THREE.Color),lightPositions:new s.THREE.Uniform([new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0)]),lightColors:new s.THREE.Uniform([new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0)]),lightRadii:new s.THREE.Uniform([0,0,0,0,0]),numLights:new s.THREE.Uniform(0),environmentIntensity:new s.THREE.Uniform(1),gammaCorrectionFactor:new s.THREE.Uniform(1),entityPos:new s.THREE.Uniform(new s.THREE.Vector3),color:new s.THREE.Uniform(new s.THREE.Color(1,1,1)),metalness:new s.THREE.Uniform(0),roughness:new s.THREE.Uniform(0),emissiveColor:new s.THREE.Uniform(new s.THREE.Color(0,0,0)),alphaMultiplier:new s.THREE.Uniform(1),colorTexture:new s.THREE.Uniform(null),roughnessTexture:new s.THREE.Uniform(null),metalnessTexture:new s.THREE.Uniform(null),normalTexture:new s.THREE.Uniform(null),emissiveTexture:new s.THREE.Uniform(null),numShadowEntities:new s.THREE.Uniform(0),shadowEntityPositions:new s.THREE.Uniform([new s.THREE.Vector3,new s.THREE.Vector3,new s.THREE.Vector3,new s.THREE.Vector3,new s.THREE.Vector3]),shadowEntityRadii:new s.THREE.Uniform([0,0,0,0,0]),shadowEntityRayleighAmount:new s.THREE.Uniform([0,0,0,0,0]),envTexture:new s.THREE.Uniform(null),maxMipLevel:new s.THREE.Uniform(0),dynEnvTexture:new s.THREE.Uniform(null),dynEnvFaceSize:new s.THREE.Uniform(0),normalScale:new s.THREE.Uniform(new s.THREE.Vector2)},vertexShader:"\n\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\tattribute vec4 tangent;\n\t\t\t\t\t\tvarying vec4 localTangent;\n\t\t\t\t\t\tvarying vec3 localNormal;\n\t\t\t\t\t#else\n\t\t\t\t\t\tvarying vec3 modelNormal;\n\t\t\t\t\t#endif\n\t\t\t\t\t#if defined(normalMap) || defined(colorMap) || defined(roughnessMap) || defined(metalnessMap) || defined(emissiveMap)\n\t\t\t\t\t\tvarying vec2 localUV;\n\t\t\t\t\t#endif\n\t\t\t\t\tvarying vec3 cameraSpacePosition;\n\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\tvarying float fragDepth;\n\t\t\t\t\t#else\n\t\t\t\t\t\tuniform float midDistance;\n\t\t\t\t\t\tuniform float nearDistance;\n\t\t\t\t\t#endif\n\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\t\tlocalTangent = tangent;\n\t\t\t\t\t\t\tlocalNormal = normal;\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tmodelNormal = normalize((modelMatrix * vec4(normal, 0.)).xyz);\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#if defined(normalMap) || defined(colorMap) || defined(roughnessMap) || defined(metalnessMap) || defined(emissiveMap)\n\t\t\t\t\t\t\tlocalUV = uv;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\tcameraSpacePosition = (modelMatrix * vec4(position, 1.)).xyz;\n\t\t\t\t\t\tvec4 viewPosition = modelViewMatrix * vec4(position, 1.);\n\t\t\t\t\t\tgl_Position = projectionMatrix * viewPosition;\n\t\t\t\t\t\tgl_Position.w = viewPosition.y;\n\n\t\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\t\tfragDepth = gl_Position.w;\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tfloat z = gl_Position.w;\n\t\t\t\t\t\t\tif (z < midDistance) {\n\t\t\t\t\t\t\t\tgl_Position.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\n\t\t\t\t\t\t\t\tgl_Position.z = log2(z - midDistance + 1.0) * logFactor;\n\t\t\t\t\t\t\t\tgl_Position.z *= gl_Position.w;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}",fragmentShader:"\n\t\t\t\t\t#define DEFAULT_SPECULAR_COEFFICIENT 0.04\n\t\t\t\t\t#define EPSILON 1e-6\n\t\t\t\t\t#define PI 3.14159265359\n\t\t\t\t\t#define RECIPROCAL_PI 0.31830988618\n\t\t\t\t\t#define RECIPROCAL_PI2 0.15915494\n\t\t\t\t\t#ifndef saturate\n\t\t\t\t\t\t#define saturate(a) clamp( a, 0.0, 1.0 )\n\t\t\t\t\t#endif\n\n\t\t\t\t\tfloat pow2( float x ) { return x*x; }\n\n\t\t\t\t\tuniform mat4 modelMatrix;\n\n\t\t\t\t\t// Lights\n\t\t\t\t\tuniform vec3 ambientLightColor;\n\t\t\t\t\tuniform vec3 lightPositions[5];\n\t\t\t\t\tuniform vec3 lightColors[5];\n\t\t\t\t\tuniform float lightRadii[5];\n\t\t\t\t\tuniform int numLights;\n\t\t\t\t\tuniform float environmentIntensity;\n\t\t\t\t\tuniform float gammaCorrectionFactor;\n\n\t\t\t\t\t// External lighting and camera.\n\t\t\t\t\tuniform vec3 entityPos;\n\n\t\t\t\t\t// Textures.\n\t\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\t\tuniform sampler2D roughnessTexture;\n\t\t\t\t\tuniform sampler2D metalnessTexture;\n\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\tuniform sampler2D normalTexture;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef emissiveMap\n\t\t\t\t\t\tuniform sampler2D emissiveTexture;\n\t\t\t\t\t#endif\n\t\t\t\t\t#ifdef dynEnvMap\n\t\t\t\t\t\tuniform sampler2D dynEnvTexture;\n\t\t\t\t\t\tuniform float dynEnvFaceSize;\n\t\t\t\t\t#elif defined( envMap )\n\t\t\t\t\t\t#ifdef envIsCube\n\t\t\t\t\t\t\tuniform samplerCube envTexture;\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tuniform sampler2D envTexture;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\tuniform vec2 normalScale;\n\t\t\t\t\t#endif\n\n\t\t\t\t\t// Shadow Entities.\n\t\t\t\t\t#ifdef shadowEntities\n\t\t\t\t\t\tuniform int numShadowEntities;\n\t\t\t\t\t\tuniform vec3 shadowEntityPositions[5];\n\t\t\t\t\t\tuniform float shadowEntityRadii[5];\n\t\t\t\t\t\tuniform float shadowEntityRayleighAmount[5];\n\t\t\t\t\t#endif\n\n\t\t\t\t\t// Scalars\n\t\t\t\t\tuniform vec3 color;\n\t\t\t\t\tuniform float roughness;\n\t\t\t\t\tuniform float metalness;\n\t\t\t\t\tuniform vec3 emissiveColor;\n\t\t\t\t\tuniform float alphaMultiplier;\n\n\t\t\t\t\t// The varying attributes.\n\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\tvarying vec4 localTangent;\n\t\t\t\t\t\tvarying vec3 localNormal;\n\t\t\t\t\t#else\n\t\t\t\t\t\tvarying vec3 modelNormal;\n\t\t\t\t\t#endif\n\t\t\t\t\t#if defined(normalMap) || defined(colorMap) || defined(roughnessMap) || defined(metalnessMap) || defined(emissiveMap)\n\t\t\t\t\t\tvarying vec2 localUV;\n\t\t\t\t\t#endif\n\t\t\t\t\tvarying vec3 cameraSpacePosition;\n\n\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\tuniform mat4 projectionMatrix;\n\t\t\t\t\t\tvarying float fragDepth;\n\t\t\t\t\t#endif\n\n\t\t\t\t\tstruct PhysicalMaterial {\n\t\t\t\t\t\tvec3 diffuseColor;\n\t\t\t\t\t\tvec3 specularColor;\n\t\t\t\t\t\tfloat specularRoughness;\n\t\t\t\t\t};\n\t\t\t\t\tstruct IncidentLight {\n\t\t\t\t\t\tvec3 color;\n\t\t\t\t\t\tvec3 direction;\n\t\t\t\t\t};\n\n\t\t\t\t\tstruct ReflectedLight {\n\t\t\t\t\t\tvec3 directDiffuse;\n\t\t\t\t\t\tvec3 directSpecular;\n\t\t\t\t\t\tvec3 indirectDiffuse;\n\t\t\t\t\t\tvec3 indirectSpecular;\n\t\t\t\t\t};\n\n\t\t\t\t\tstruct GeometricContext {\n\t\t\t\t\t\tvec3 normal;\n\t\t\t\t\t\tvec3 viewDir;\n\t\t\t\t\t};\n\n\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\tvec3 getNormalFromMap() {\n\t\t\t\t\t\t\tvec3 normal = normalize(localNormal);\n\t\t\t\t\t\t\tvec3 tangent = normalize(localTangent.xyz);\n\t\t\t\t\t\t\tvec3 bitangent = normalize(cross(normal, tangent));\n\t\t\t\t\t\t\tif (localTangent.w < 0.0) {\n\t\t\t\t\t\t\t\tbitangent *= -1.0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmat3 transform = mat3(tangent, bitangent, normal);\n\t\t\t\t\t\t\tvec3 normalFromMap = texture2D(normalTexture, localUV).rgb * 2.0 - 1.0;\n\t\t\t\t\t\t\tnormalFromMap.xy *= vec2(1, -1);\n\t\t\t\t\t\t\tnormalFromMap.xy *= normalScale;\n\t\t\t\t\t\t\treturn normalize(transform * normalFromMap);\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#ifdef shadowEntities\n\t\t\t\t\t\tvec3 applyRayleighScattering(vec3 color, float amount) {\n\t\t\t\t\t\t\tfloat value = (color.r + color.g + color.b);\n\t\t\t\t\t\t\tif (value > 0.0) {\n\t\t\t\t\t\t\t\tfloat rFactor = 1.0; // 6.3^-4 / 6.3^-4\n\t\t\t\t\t\t\t\tfloat gFactor = 1.602; // 5.6^-4 / 6.3^-4\n\t\t\t\t\t\t\t\tfloat bFactor = 3.228; // 4.7^-4 / 6.3^-4\n\t\t\t\t\t\t\t\tcolor.r *= pow(rFactor, -amount);\n\t\t\t\t\t\t\t\tcolor.g *= pow(gFactor, -amount);\n\t\t\t\t\t\t\t\tcolor.b *= pow(bFactor, -amount);\n\t\t\t\t\t\t\t\tcolor = value * color / (color.r + color.g + color.b);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn color;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvec3 getLightColorFromShadowEntities(vec3 lightColor, vec3 lightDir, vec3 lightPosition, float lightRadius, vec3 normal) {\n\t\t\t\t\t\t\tvec3 color = lightColor;\n\t\t\t\t\t\t\tfor (int i = 0; i < 5; i++) {\n\t\t\t\t\t\t\t\tif (i >= numShadowEntities || lightRadius < 0.0) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvec3 origin = cameraSpacePosition - shadowEntityPositions[i];\n\t\t\t\t\t\t\t\tvec3 axis = normalize(shadowEntityPositions[i] - lightPosition);\n\t\t\t\t\t\t\t\tfloat originOffset = dot(origin, axis);\n\t\t\t\t\t\t\t\tif (originOffset > 0.0) {\n\t\t\t\t\t\t\t\t\tfloat e = length(origin - originOffset * axis);\n\t\t\t\t\t\t\t\t\tfloat ld = dot(cameraSpacePosition - lightPosition, axis);\n\t\t\t\t\t\t\t\t\tfloat sd = dot(origin, axis);\n\t\t\t\t\t\t\t\t\tfloat lr = lightRadius;\n\t\t\t\t\t\t\t\t\tfloat sr = shadowEntityRadii[i];\n\t\t\t\t\t\t\t\t\tfloat e0 = (ld * sr - lr * sd) / (ld - sd);\n\t\t\t\t\t\t\t\t\tfloat e1 = (ld * sr + lr * sd) / (ld - sd);\n\t\t\t\t\t\t\t\t\tfloat lightLevel = 0.0;\n\t\t\t\t\t\t\t\t\tif (e1 < 0.0 || sd < 0.0) { // light in front of shadow entity\n\t\t\t\t\t\t\t\t\t\tlightLevel = 1.0;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse if (e0 < e1) {\n\t\t\t\t\t\t\t\t\t\te0 -= (e1 - e0) * shadowEntityRayleighAmount[i] / 6.0;\n\t\t\t\t\t\t\t\t\t\tlightLevel = pow(saturate((e - e0) / (e1 - e0)), 0.5); // soft light\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\tlightLevel = e < e0 ? 0.0 : 1.0; // 0 radius light.\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcolor = lightLevel * applyRayleighScattering(color, (1.0 - lightLevel) * shadowEntityRayleighAmount[i]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn color;\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\tvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\t\t\t\t\t\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\t\t\t\t\t}\n\n\t\t\t\t\t// These use optimizations found in https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf.\n\n\t\t\t\t\t// The Smith-method geometry function. Calculates the ratio of incident light that is blocked by the microfacets to never reach the viewer.\n\t\t\t\t\t// alpha is the roughness^2\n\t\t\t\t\t// dotNL is the normal · the light vector.\n\t\t\t\t\t// dotNV is the normal · the view vector.\n\t\t\t\t\tfloat G_GGX_SmithCorrelated( float alpha, float dotNL, float dotNV ) {\n\t\t\t\t\t\tfloat a2 = pow2( alpha );\n\t\t\t\t\t\t// Get the light direction part of the geometry function.\n\t\t\t\t\t\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\t\t\t\t\t\t// Get the view direction part of the geometry function.\n\t\t\t\t\t\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\t\t\t\t\t\t// It would normally be be gv * gl, but this is using an optimization by Heitz (2014),\n\t\t\t\t\t\t// including the BRDF denominator, simplifying the results.\n\t\t\t\t\t\treturn 0.5 / max( gv + gl, EPSILON );\n\t\t\t\t\t}\n\n\t\t\t\t\t// The Trowbridge-Reitz normal distribution function. Calculates the relative surface area microfacets exactly aligned to the halfway vector, how \"smooth\" the surface is.\n\t\t\t\t\t// alpha is the roughness^2.\n\t\t\t\t\t// dotNH is the normal · the halfway vector.\n\t\t\t\t\tfloat D_GGX( float alpha, float dotNH ) {\n\t\t\t\t\t\tfloat a2 = pow2( alpha );\n\t\t\t\t\t\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\t\t\t\t\t\treturn RECIPROCAL_PI * a2 / pow2( denom );\n\t\t\t\t\t}\n\n\t\t\t\t\t// The Schlick approximation for the Fresnel equation.\n\t\t\t\t\t// Since metallic and non-metallic surfaces have different equations, this function combines the two by approximation.\n\t\t\t\t\t// specularColor is the specular color at normal incidence.\n\t\t\t\t\t// dotLH is the light direction · the halfway vector.\n\t\t\t\t\tvec3 F_Schlick( vec3 specularColor, float dotLH ) {\n\t\t\t\t\t\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\t\t\t\t\t\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n\t\t\t\t\t}\n\n\t\t\t\t\t// The specular part of the main BRDF function that describes the weighting function for the sum of every incoming light.\n\t\t\t\t\t// It uses the Cook-Torrance model.\n\t\t\t\t\tvec3 BRDF_Specular_GGX( IncidentLight incidentLight, GeometricContext geometry, vec3 specularColor, float roughness ) {\n\t\t\t\t\t\tfloat alpha = pow2( roughness );\n\t\t\t\t\t\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\t\t\t\t\t\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\t\t\t\t\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\t\t\t\t\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\t\t\t\t\t\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\t\t\t\t\t\tvec3 F = F_Schlick( specularColor, dotLH );\n\t\t\t\t\t\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\t\t\t\t\tfloat D = D_GGX( alpha, dotNH );\n\t\t\t\t\t\treturn F * ( G * D );\n\t\t\t\t\t}\n\n\t\t\t\t\t// The diffuse part of the main BRDF function.\n\t\t\t\t\tvec3 BRDF_Diffuse_Lambert( vec3 diffuseColor ) {\n\t\t\t\t\t\treturn RECIPROCAL_PI * diffuseColor;\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat BlinnExponentToGGXRoughness( float blinnExponent ) {\n\t\t\t\t\t\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat GGXRoughnessToBlinnExponent( float ggxRoughness ) {\n\t\t\t\t\t\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n\t\t\t\t\t}\n\n\t\t\t\t\tvec2 integrateSpecularBRDF( float dotNV, float roughness ) {\n\t\t\t\t\t\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\t\t\t\t\t\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\t\t\t\t\t\tvec4 r = roughness * c0 + c1;\n\t\t\t\t\t\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\t\t\t\t\t\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n\t\t\t\t\t}\n\n\t\t\t\t\tvec3 BRDF_Specular_GGX_Environment( GeometricContext geometry, vec3 specularColor, float roughness ) {\n\t\t\t\t\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\t\t\t\t\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\t\t\t\t\t\treturn specularColor * brdf.x + brdf.y;\n\t\t\t\t\t}\n\n\t\t\t\t\tvoid BRDF_Specular_Multiscattering_Environment( GeometricContext geometry, vec3 specularColor, float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\t\t\t\t\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\t\t\t\t\tvec3 F = F_Schlick( specularColor, dotNV );\n\t\t\t\t\t\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\t\t\t\t\t\tvec3 FssEss = F * brdf.x + brdf.y;\n\t\t\t\t\t\tfloat Ess = brdf.x + brdf.y;\n\t\t\t\t\t\tfloat Ems = 1.0 - Ess;\n\t\t\t\t\t\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\t\t\t\t\t\tsingleScatter += FssEss;\n\t\t\t\t\t\tmultiScatter += Fms * Ems;\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat opacity = 1.0;\n\n\t\t\t\t\tuniform float reflectivity;\n\t\t\t\t\tuniform int maxMipLevel;\n\n\t\t\t\t\t// Returns the radiance: the incoming light * the cos(light angle to the normal)\n\t\t\t\t\tvec3 getIncomingLight( IncidentLight directLight, GeometricContext geometry) {\n\t\t\t\t\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\t\t\t\t\treturn (dotNL * directLight.color);\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat getSpecularMIPLevel( float blinnShininessExponent, int maxMIPLevel ) {\n\t\t\t\t\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\t\t\t\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\t\t\t\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t\t\t\t\t}\n\n\t\t\t\t\t#ifdef envIsCubeUV\n\t\t\t\t\t\t// These defines must match with PMREMGenerator\n\t\t\t\t\t\t#define cubeUV_maxMipLevel 8.0\n\t\t\t\t\t\t#define cubeUV_minMipLevel 4.0\n\t\t\t\t\t\t#define cubeUV_maxTileSize 256.0\n\t\t\t\t\t\t#define cubeUV_minTileSize 16.0\n\t\t\t\t\t\t// These shader functions convert between the UV coordinates of a single face of\n\t\t\t\t\t\t// a cubemap, the 0-5 integer index of a cube face, and the direction vector for\n\t\t\t\t\t\t// sampling a textureCube (not generally normalized ).\n\t\t\t\t\t\tfloat getFace( vec3 direction ) {\n\t\t\t\t\t\t\tvec3 absDirection = abs( direction );\n\t\t\t\t\t\t\tfloat face = - 1.0;\n\t\t\t\t\t\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\t\t\t\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\t\t\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\t\t\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn face;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// RH coordinate system; PMREM face-indexing convention\n\t\t\t\t\t\tvec2 getUV( vec3 direction, float face ) {\n\t\t\t\t\t\t\tvec2 uv;\n\t\t\t\t\t\t\tif ( face == 0.0 ) {\n\t\t\t\t\t\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x\n\t\t\t\t\t\t\t} else if ( face == 1.0 ) {\n\t\t\t\t\t\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y\n\t\t\t\t\t\t\t} else if ( face == 2.0 ) {\n\t\t\t\t\t\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z\n\t\t\t\t\t\t\t} else if ( face == 3.0 ) {\n\t\t\t\t\t\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x\n\t\t\t\t\t\t\t} else if ( face == 4.0 ) {\n\t\t\t\t\t\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 0.5 * ( uv + 1.0 );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvec3 bilinearCubeUV( sampler2D environmentMap, vec3 direction, float mipInt ) {\n\t\t\t\t\t\t\tfloat face = getFace( direction );\n\t\t\t\t\t\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\t\t\t\t\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\t\t\t\t\t\tfloat faceSize = exp2( mipInt );\n\t\t\t\t\t\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\t\t\t\t\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\t\t\t\t\t\tvec2 f = fract( uv );\n\t\t\t\t\t\t\tuv += 0.5 - f;\n\t\t\t\t\t\t\tif ( face > 2.0 ) {\n\t\t\t\t\t\t\t\tuv.y += faceSize;\n\t\t\t\t\t\t\t\tface -= 3.0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tuv.x += face * faceSize;\n\t\t\t\t\t\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\t\t\t\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\t\t\t\t\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\t\t\t\t\t\tuv *= texelSize;\n\t\t\t\t\t\t\tvec3 tl = texture2D( environmentMap, uv ).rgb;\n\t\t\t\t\t\t\tuv.x += texelSize;\n\t\t\t\t\t\t\tvec3 tr = texture2D( environmentMap, uv ).rgb;\n\t\t\t\t\t\t\tuv.y += texelSize;\n\t\t\t\t\t\t\tvec3 br = texture2D( environmentMap, uv ).rgb;\n\t\t\t\t\t\t\tuv.x -= texelSize;\n\t\t\t\t\t\t\tvec3 bl = texture2D( environmentMap, uv ).rgb;\n\t\t\t\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\t\t\t\treturn mix( tm, bm, f.y );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#define r0 1.0\n\t\t\t\t\t\t#define v0 0.339\n\t\t\t\t\t\t#define m0 - 2.0\n\t\t\t\t\t\t#define r1 0.8\n\t\t\t\t\t\t#define v1 0.276\n\t\t\t\t\t\t#define m1 - 1.0\n\t\t\t\t\t\t#define r4 0.4\n\t\t\t\t\t\t#define v4 0.046\n\t\t\t\t\t\t#define m4 2.0\n\t\t\t\t\t\t#define r5 0.305\n\t\t\t\t\t\t#define v5 0.016\n\t\t\t\t\t\t#define m5 3.0\n\t\t\t\t\t\t#define r6 0.21\n\t\t\t\t\t\t#define v6 0.0038\n\t\t\t\t\t\t#define m6 4.0\n\t\t\t\t\t\tfloat roughnessToMip( float roughness ) {\n\t\t\t\t\t\t\tfloat mip = 0.0;\n\t\t\t\t\t\t\tif ( roughness >= r1 ) {\n\t\t\t\t\t\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t\t\t\t\t\t} else if ( roughness >= r4 ) {\n\t\t\t\t\t\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t\t\t\t\t\t} else if ( roughness >= r5 ) {\n\t\t\t\t\t\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t\t\t\t\t\t} else if ( roughness >= r6 ) {\n\t\t\t\t\t\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn mip;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvec4 textureCubeUV( sampler2D environmentMap, vec3 sampleDir, float roughness ) {\n\t\t\t\t\t\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\t\t\t\t\t\tfloat mipF = fract( mip );\n\t\t\t\t\t\t\tfloat mipInt = floor( mip );\n\t\t\t\t\t\t\tvec3 color0 = bilinearCubeUV( environmentMap, sampleDir, mipInt );\n\t\t\t\t\t\t\tif ( mipF == 0.0 ) {\n\t\t\t\t\t\t\t\treturn vec4( color0, 1.0 );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvec3 color1 = bilinearCubeUV( environmentMap, sampleDir, mipInt + 1.0 );\n\t\t\t\t\t\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#ifdef dynEnvMap\n\t\t\t\t\t\t// Converts an XY in cylindrical space to a face (z) with coordinates within that face (xy).\n\t\t\t\t\t\tvec3 xyzToUvFace(vec3 xyz, float pixelSize) {\n\t\t\t\t\t\t\t// Figure out which basis we're using.\n\t\t\t\t\t\t\tvec3 basis[3];\n\t\t\t\t\t\t\tfloat face;\n\t\t\t\t\t\t\tif (xyz.x * xyz.x >= xyz.y * xyz.y && xyz.x * xyz.x >= xyz.z * xyz.z) {\n\t\t\t\t\t\t\t\tif (xyz.x >= 0.0) {\n\t\t\t\t\t\t\t\t\tbasis[0] = vec3(0, 1, 0); basis[1] = vec3(0, 0, 1); basis[2] = vec3(1, 0, 0);\n\t\t\t\t\t\t\t\t\tface = 0.0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tbasis[0] = vec3(0, -1, 0); basis[1] = vec3(0, 0, 1); basis[2] = vec3(-1, 0, 0);\n\t\t\t\t\t\t\t\t\tface = 2.0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (xyz.y * xyz.y >= xyz.x * xyz.x && xyz.y * xyz.y >= xyz.z * xyz.z) {\n\t\t\t\t\t\t\t\tif (xyz.y >= 0.0) {\n\t\t\t\t\t\t\t\t\tbasis[0] = vec3(-1, 0, 0); basis[1] = vec3(0, 0, 1); basis[2] = vec3(0, 1, 0);\n\t\t\t\t\t\t\t\t\tface = 1.0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tbasis[0] = vec3(1, 0, 0); basis[1] = vec3(0, 0, 1); basis[2] = vec3(0, -1, 0);\n\t\t\t\t\t\t\t\t\tface = 3.0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tif (xyz.z >= 0.0) {\n\t\t\t\t\t\t\t\t\tbasis[0] = vec3(0, 1, 0); basis[1] = vec3(-1, 0, 0); basis[2] = vec3(0, 0, 1);\n\t\t\t\t\t\t\t\t\tface = 4.0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tbasis[0] = vec3(0, 1, 0); basis[1] = vec3(1, 0, 0); basis[2] = vec3(0, 0, -1);\n\t\t\t\t\t\t\t\t\tface = 5.0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Convert into the uv basis from the xyz basis.\n\t\t\t\t\t\t\tfloat z = basis[2].x * xyz.x + basis[2].y * xyz.y + basis[2].z * xyz.z;\n\t\t\t\t\t\t\tif (z < 0.0) {\n\t\t\t\t\t\t\t\tz = 1.0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvec2 uv = vec2(\n\t\t\t\t\t\t\t\t(basis[0].x * xyz.x + basis[0].y * xyz.y + basis[0].z * xyz.z) / z,\n\t\t\t\t\t\t\t\t(basis[1].x * xyz.x + basis[1].y * xyz.y + basis[1].z * xyz.z) / z);\n\n\t\t\t\t\t\t\t// Convert from -1 to +1, to 0 to 1.\n\t\t\t\t\t\t\tuv = 0.5 * (uv + vec2(1.0));\n\n\t\t\t\t\t\t\t// Convert to pixel-space.\n\t\t\t\t\t\t\tuv *= pixelSize;\n\n\t\t\t\t\t\t\t// Shrink to ignore 1 pixel borders.\n\t\t\t\t\t\t\tuv.x = (pixelSize - 2.0) / pixelSize * uv.x + 1.0;\n\t\t\t\t\t\t\tuv.y = (pixelSize - 2.0) / pixelSize * uv.y + 1.0;\n\n\t\t\t\t\t\t\t// Convert back to unit-space.\n\t\t\t\t\t\t\tuv /= pixelSize;\n\n\t\t\t\t\t\t\treturn vec3(uv, face);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Gets the dynamic environmental lighting given the outward direction.\n\t\t\t\t\t\tvec3 getEnvLight(vec3 direction, float roughness) {\n\t\t\t\t\t\t\t// Get the mip levels.\n\t\t\t\t\t\t\tfloat mipLevel = pow(roughness, 0.25) * (log2(dynEnvFaceSize) - 2.0);\n\t\t\t\t\t\t\tfloat mipLevel0 = floor(mipLevel);\n\t\t\t\t\t\t\tfloat mipLevel1 = floor(mipLevel) + 1.0;\n\t\t\t\t\t\t\tfloat mipLevelU = mipLevel - mipLevel0;\n\t\t\t\t\t\t\tfloat mipSizeX0 = pow(2.0, -mipLevel0);\n\t\t\t\t\t\t\tfloat mipOffsetY0 = 1.0 - pow(2.0, -mipLevel0);\n\t\t\t\t\t\t\tfloat mipSizeX1 = pow(2.0, -mipLevel1);\n\t\t\t\t\t\t\tfloat mipOffsetY1 = 1.0 - pow(2.0, -mipLevel1);\n\t\t\t\t\t\t\t// Get UV within a mip of cube faces.\n\t\t\t\t\t\t\tvec3 uvFace0 = xyzToUvFace(direction, dynEnvFaceSize * mipSizeX0);\n\t\t\t\t\t\t\tvec3 uvFace1 = xyzToUvFace(direction, dynEnvFaceSize * mipSizeX1);\n\t\t\t\t\t\t\tvec2 faceOffset = vec2(mod(uvFace0.z, 3.0) / 3.0, floor(uvFace0.z / 3.0) / 2.0);\n\t\t\t\t\t\t\tvec2 uvInMip0 = vec2(faceOffset.x + uvFace0.x / 3.0, faceOffset.y + uvFace0.y / 2.0);\n\t\t\t\t\t\t\tvec2 uvInMip1 = vec2(faceOffset.x + uvFace1.x / 3.0, faceOffset.y + uvFace1.y / 2.0);\n\t\t\t\t\t\t\t// Get the UVs within the textures.\n\t\t\t\t\t\t\tvec2 uv0 = vec2(uvInMip0.x * mipSizeX0 * 0.75, 0.5 * uvInMip0.y * mipSizeX0 + mipOffsetY0);\n\t\t\t\t\t\t\tvec2 uv1 = vec2(uvInMip1.x * mipSizeX1 * 0.75, 0.5 * uvInMip1.y * mipSizeX1 + mipOffsetY1);\n\t\t\t\t\t\t\tvec3 color0 = texture2D(dynEnvTexture, uv0).rgb;\n\t\t\t\t\t\t\tvec3 color1 = texture2D(dynEnvTexture, uv1).rgb;\n\t\t\t\t\t\t\treturn mix(color0, color1, mipLevelU) * environmentIntensity * ((PI - 1.0) * roughness + 1.0);\n\t\t\t\t\t\t}\n\t\t\t\t\t#endif\n\n\t\t\t\t\tvec3 getLightProbeIndirectRadiance( GeometricContext geometry, float blinnShininessExponent, int maxMIPLevel ) {\n\t\t\t\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t\t\t\t\t#if defined( envMap )\n\t\t\t\t\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\t\t\t\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t\t\t\t\t\tvec3 queryReflectVec = vec3( reflectVec.x, reflectVec.yz );\n\t\t\t\t\t\t\t#ifdef envIsCube\n\t\t\t\t\t\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\t\t\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envTexture, queryReflectVec, specularMIPLevel );\n\t\t\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\t\tvec4 envMapColor = textureCube( envTexture, queryReflectVec, specularMIPLevel );\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t#elif defined( envIsCubeUV )\n\t\t\t\t\t\t\t\tvec4 envMapColor = textureCubeUV( envTexture, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\tvec2 sampleUV;\n\t\t\t\t\t\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\t\t\t\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t\t\t\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\t\t\t\t\t\tvec4 envMapColor = texture2DLodEXT( envTexture, sampleUV, specularMIPLevel );\n\t\t\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\t\tvec4 envMapColor = texture2D( envTexture, sampleUV, specularMIPLevel );\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\treturn envMapColor.rgb * environmentIntensity;\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\treturn vec3(0, 0, 0);\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}\n\n\t\t\t\t\t// Given the directLight, accumulates onto the reflectedLight the irradiance as the BRDF function.\n\t\t\t\t\tvoid RE_Direct_Physical( IncidentLight directLight, GeometricContext geometry, PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\tvec3 irradiance = getIncomingLight( directLight, geometry );\n\t\t\t\t\t\tirradiance *= PI;\n\t\t\t\t\t\tfloat clearCoatDHR = 0.0;\n\t\t\t\t\t\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\t\t\t\t\t\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t\t\t\t\t}\n\n\t\t\t\t\tvoid RE_IndirectDiffuse_Physical( vec3 irradiance, GeometricContext geometry, PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t\t\t\t\t}\n\n\t\t\t\t\tvoid RE_IndirectSpecular_Physical( vec3 radiance, vec3 irradiance, vec3 clearCoatRadiance, GeometricContext geometry, PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t\t\t\t\t\tfloat clearCoatDHR = 0.0;\n\t\t\t\t\t\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t\t\t\t\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t\t\t\t\t}\n\n\t\t\t\t\t#define RE_Direct RE_Direct_Physical\n\t\t\t\t\t#define Material_BlinnShininessExponent( material ) GGXRoughnessToBlinnExponent( material.specularRoughness )\n\t\t\t\t\t#define RE_IndirectDiffuse RE_IndirectDiffuse_Physical\n\t\t\t\t\t#define RE_IndirectSpecular RE_IndirectSpecular_Physical\n\n\t\t\t\t\tvoid main(void) {\n\t\t\t\t\t\tvec4 diffuseColor = vec4( color, 1.0 );\n\t\t\t\t\t\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t\t\t\t\t\t#ifdef colorMap\n\t\t\t\t\t\t\tvec4 texelColor = texture2D(colorTexture, localUV);\n\t\t\t\t\t\t\tdiffuseColor *= texelColor;\n\t\t\t\t\t\t\topacity = texelColor.a;\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// PBR variables\n\t\t\t\t\t\tfloat roughnessFactor;\n\t\t\t\t\t\tfloat metalnessFactor;\n\n\t\t\t\t\t\troughnessFactor = roughness;\n\t\t\t\t\t\t#ifdef roughnessMap\n\t\t\t\t\t\t\troughnessFactor *= texture2D( roughnessTexture, localUV ).g;\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\tmetalnessFactor = metalness;\n\t\t\t\t\t\t#ifdef metalnessMap\n\t\t\t\t\t\t\tmetalnessFactor *= texture2D( metalnessTexture, localUV ).b;\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\tPhysicalMaterial material;\n\t\t\t\t\t\tmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\n\t\t\t\t\t\tmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n\t\t\t\t\t\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n\n\t\t\t\t\t\tGeometricContext geometry;\n\t\t\t\t\t\tgeometry.viewDir = -normalize(cameraSpacePosition);\n\t\t\t\t\t\t#ifdef normalMap\n\t\t\t\t\t\t\tgeometry.normal = normalize((modelMatrix * vec4(getNormalFromMap(), 0.)).xyz);\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tgeometry.normal = modelNormal;\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// Env Light\n\t\t\t\t\t\tvec3 irradiance = ambientLightColor;\n\t\t\t\t\t\t#ifdef dynEnvMap\n\t\t\t\t\t\t\tirradiance += getEnvLight(geometry.normal, 1.0);\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\tvec3 radiance = ambientLightColor / 2.0;\n\t\t\t\t\t\t#ifdef dynEnvMap\n\t\t\t\t\t\t\tradiance += getEnvLight(reflect(-geometry.viewDir, geometry.normal), material.specularRoughness);\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// Add emissivity.\n\t\t\t\t\t\tvec3 totalEmissiveRadiance = emissiveColor;\n\t\t\t\t\t\t#ifdef emissiveMap\n\t\t\t\t\t\t\ttotalEmissiveRadiance *= texture2D(emissiveTexture, localUV).rgb;\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// Add direct radiance.\n\t\t\t\t\t\tvec3 totalDirectIrradiance = ambientLightColor / 2.0;\n\t\t\t\t\t\t#ifdef dynEnvMap\n\t\t\t\t\t\t\ttotalDirectIrradiance += getEnvLight(reflect(-geometry.viewDir, geometry.normal), material.specularRoughness);\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t// For each light,\n\t\t\t\t\t\tfor (int i = 0; i < 5; i++) {\n\t\t\t\t\t\t\tif (i >= numLights) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tIncidentLight directLight;\n\t\t\t\t\t\t\tdirectLight.color = lightColors[i];\n\t\t\t\t\t\t\tdirectLight.direction = -normalize(cameraSpacePosition - lightPositions[i]);\n\t\t\t\t\t\t\t#ifdef shadowEntities\n\t\t\t\t\t\t\t\tdirectLight.color = getLightColorFromShadowEntities(directLight.color, directLight.direction, lightPositions[i], lightRadii[i], geometry.normal);\n\t\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t\tRE_Direct(directLight, geometry, material, reflectedLight);\n\n\t\t\t\t\t\t\tradiance += getLightProbeIndirectRadiance(geometry, Material_BlinnShininessExponent(material), maxMipLevel);\n\t\t\t\t\t\t\tRE_IndirectDiffuse(irradiance, geometry, material, reflectedLight);\n\t\t\t\t\t\t\tRE_IndirectSpecular(radiance, irradiance, vec3(0.0), geometry, material, reflectedLight);\n\n\t\t\t\t\t\t\t// Modify env light by total incoming light.\n\t\t\t\t\t\t\ttotalDirectIrradiance += getIncomingLight(directLight, geometry);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Multiply in the direct irradiance.\n\t\t\t\t\t\treflectedLight.indirectSpecular *= totalDirectIrradiance;\n\n\t\t\t\t\t\t// If there's ambience, remove the direct light components.\n\t\t\t\t\t\treflectedLight.directDiffuse *= vec3(1, 1, 1) - ambientLightColor;\n\t\t\t\t\t\treflectedLight.directSpecular *= vec3(1, 1, 1) - ambientLightColor;\n\n\t\t\t\t\t\t// Add the reflected light to the outgoing light.\n\t\t\t\t\t\tvec3 outgoingLight = totalEmissiveRadiance + reflectedLight.directDiffuse + reflectedLight.directSpecular + reflectedLight.indirectDiffuse + reflectedLight.indirectSpecular;\n\n\t\t\t\t\t\t// Set the frag color based on the total outgoing light.\n\t\t\t\t\t\tgl_FragColor = vec4( outgoingLight, opacity );\n\n\t\t\t\t\t\t// Gamma correction\n\t\t\t\t\t\tgl_FragColor = vec4( pow( abs(gl_FragColor.rgb), vec3( 1.0 / gammaCorrectionFactor ) ), gl_FragColor.a );\n\n\t\t\t\t\t\t// Convert to sRGB.\n\t\t\t\t\t\tgl_FragColor = LinearTosRGB(gl_FragColor);\n\n\t\t\t\t\t\t// Multiply the alphaMultiplier.\n\t\t\t\t\t\tgl_FragColor.a *= alphaMultiplier;\n\n\t\t\t\t\t\t// Log-Depth Buffering\n\t\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\n\t\t\t\t\t\t\tgl_FragDepthEXT = projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}"}));const t=MaterialUtilsStandard._material.clone();for(let e=0;e<t.uniforms.shadowEntityPositions.value.length;e++)t.uniforms.shadowEntityPositions.value[e]=MaterialUtilsStandard._material.uniforms.shadowEntityPositions.value[e].clone();return s.ThreeJsHelper.setupLogDepthBuffering(t),s.Capabilities.hasGLExtension("EXT_shader_texture_lod")&&(t.extensions.shaderTextureLOD=!0),t.extensions.derivatives=!0,t.needsUpdate=!0,t}}MaterialUtilsStandard._material=null;const n=MaterialUtilsStandard},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class MaterialUtils{static setLightSourceUniforms(t,e,i){const n=e.getScene(),r=s.Color.pool.get();for(let e=0,s=n.getNumLightSources();e<Math.min(s,5);e++){const s=n.getLightSource(e);if(null!==s){const n=s.getEntity().getCameraSpacePosition(i),o=1;r.mult(s.getColor(),o);const a=null===s.getEntity().getComponentByType("camera")?s.getEntity().getOcclusionRadius():-1;for(let i=0,s=t.length;i<s;i++)void 0!==t[i].uniforms.lightPositions&&(t[i].uniforms.lightPositions.value[e].set(n.x,n.y,n.z),t[i].uniforms.lightColors.value[e].set(r.r,r.g,r.b),t[i].uniforms.lightRadii.value[e]=a)}}for(let e=0,i=t.length;e<i;e++)void 0!==t[e].uniforms.numLights&&(t[e].uniforms.numLights.value=n.getNumLightSources());s.Color.pool.release(r)}static setUniforms(t,e,i,n,r,o){const a=i.getScene().getEngine().getTime(),l=i.getScene().getAmbientLightColor();MaterialUtils.setLightSourceUniforms(t,i,e);for(let h=0,c=t.length;h<c;h++){const c=t[h],d=c.uniforms;if(s.Capabilities.hasFragDepth()||(d.nearDistance.value=e.getAutoNearDistance(),d.midDistance.value=e.getAutoMidDistance()),c instanceof s.THREE.RawShaderMaterial)void 0!==d.time&&(d.time.value=s.MathUtils.wrap(a,0,3600));else{const r=i.getCameraSpacePosition(e);if(d.entityPos.value.set(r.x,r.y,r.z),d.ambientLightColor.value.setRGB(l.r,l.g,l.b),void 0!==n&&n.length>0){let t=0;for(let i=0;i<n.length;i++){const s=n[i];if("string"!=typeof s){const i=s.getCameraSpacePosition(e);d.shadowEntityPositions.value[t].set(i.x,i.y,i.z),d.shadowEntityRadii.value[t]=s.getOcclusionRadius();const n=s.get("atmosphere");d.shadowEntityRayleighAmount.value[t]=null!==n?5*n.getSunsetIntensity():0,t+=1}else d.shadowEntityRadii.value[t]=0}d.numShadowEntities.value=t}if(t[h].defines.shadowRings){const t=i.get("rings");if(null!==t){const e=s.Vector3.pool.get();i.getOrientation().getAxis(e,2),d.shadowRingsInnerRadius.value=t.getInnerRadius(),d.shadowRingsOuterRadius.value=t.getOuterRadius(),d.shadowRingsTexture.value=t.getTopTexture(),d.shadowRingsNormal.value.set(e.x,e.y,e.z),s.Vector3.pool.release(e)}}}if(null===r||"loaded"!==r.getLoadState()||r.isExcludedFromCamera(e)||void 0===d.atmospherePosition)!0===c.defines.atmosphere&&(delete c.defines.atmosphere,c.needsUpdate=!0);else{const t=r.getSpheroid(),i=r.getEntity().getCameraSpacePosition(e),s=r.getEntity().getOrientation(),n=r.getColor(),a=r.getSunsetColor();d.atmospherePosition.value.set(i.x,i.y,i.z),d.atmosphereOrientation.value.set(s.x,s.y,s.z,s.w),null!==t?(d.atmosphereEquatorialRadius.value=t.getEquatorialRadius(),d.atmospherePolarRadius.value=t.getPolarRadius()):(d.atmosphereEquatorialRadius.value=0,d.atmospherePolarRadius.value=0),d.atmosphereDensity.value=r.getDensity(),d.atmosphereScaleHeight.value=r.getScaleHeight(),d.atmosphereEmissivity.value=r.getEmissivity(),d.atmosphereColor.value.set(n.r,n.g,n.b),d.atmosphereSunsetColor.value.set(a.r,a.g,a.b),d.atmosphereSunsetIntensity.value=r.getSunsetIntensity(),d.atmosphereGroundIsSpheroid.value=o?1:0,void 0===c.defines.atmosphere&&(c.defines.atmosphere=!0,c.needsUpdate=!0)}}}}MaterialUtils.get=s.MaterialUtilsPhong.get,MaterialUtils.getPBR=s.MaterialUtilsStandard.get;const n=MaterialUtils},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);const n=class ShaderFix{static fix(t,e){const i=s.Capabilities.isWebGL2(),n=s.Capabilities.hasFragDepth();return i?"vertex"===e?"#version 300 es\n\t\t\t\t\t#define attribute in\n\t\t\t\t\t#define varying out\n\t\t\t\t\t#define texture2D texture\n\t\t\t\t\tprecision highp float;\n\t\t\t\t\tprecision highp int;\n\t\t\t\t\t#define L_EXT_frag_depth true\n\t\t\t\t\t"+t:"#version 300 es\n\t\t\t\t\t#define varying in\n\t\t\t\t\tout highp vec4 pc_fragColor;\n\t\t\t\t\t#define gl_FragColor pc_fragColor\n\t\t\t\t\t#define gl_FragDepthEXT gl_FragDepth\n\t\t\t\t\t#define texture2D texture\n\t\t\t\t\t#define textureCube texture\n\t\t\t\t\t#define texture2DProj textureProj\n\t\t\t\t\t#define texture2DLodEXT textureLod\n\t\t\t\t\t#define texture2DProjLodEXT textureProjLod\n\t\t\t\t\t#define textureCubeLodEXT textureLod\n\t\t\t\t\t#define texture2DGradEXT textureGrad\n\t\t\t\t\t#define texture2DProjGradEXT textureProjGrad\n\t\t\t\t\t#define textureCubeGradEXT textureGrad\n\t\t\t\t\t#define L_EXT_frag_depth true\n\t\t\t\t\tprecision highp float;\n\t\t\t\t\tprecision highp int;\n\t\t\t\t\t"+t:(n?"\n\t\t\t\t#extension GL_EXT_frag_depth : enable\n\t\t\t\t#define L_EXT_frag_depth true\n\t\t\t\t":"")+"\n\t\t\t\tprecision highp float;\n\t\t\t\tprecision highp int;\n\t\t\t\t"+t}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);const n=class SpriteParticles{constructor(t){this._component=t,this._relativeToEntityOrientation=!0,this._offsetArray=new Float32Array(0),this._colorArray=new Float32Array(0),this._scaleArray=new Float32Array(0),this._threeJsGeometry=null,this._threeJsMaterial=null,this._threeJsObject=null,this._threeJsGeometry=new s.THREE.InstancedBufferGeometry,this._threeJsGeometry.setAttribute("position",new s.THREE.BufferAttribute(new Float32Array([-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1]),3)),this._threeJsGeometry.setIndex(new s.THREE.BufferAttribute(new Uint16Array([0,1,2,2,3,0]),1)),this._threeJsGeometry.setAttribute("offset",new s.THREE.InstancedBufferAttribute(this._offsetArray,3)),this._threeJsGeometry.setAttribute("color",new s.THREE.InstancedBufferAttribute(this._colorArray,4)),this._threeJsGeometry.setAttribute("scale",new s.THREE.InstancedBufferAttribute(this._scaleArray,1)),this._threeJsMaterial=this._component.getEntity().getScene().getEngine().getMaterialManager().getPreloaded("sprite_particles"),this._threeJsObject=s.ThreeJsHelper.createMeshObjectGivenGeometry(t,this._threeJsMaterial,this._threeJsGeometry)}getThreeJsObject(){return this._threeJsObject}getThreeJsMaterial(){return this._threeJsMaterial}setParticleOffsets(t){this._setAttribute("offset",t,3)}setParticleColors(t){this._setAttribute("color",t,4)}setParticleScales(t){this._setAttribute("scale",t,1)}getRelativeToEntityOrientation(){return this._relativeToEntityOrientation}setRelativeToEntityOrientation(t){this._relativeToEntityOrientation=t}prepareForRender(t){s.ThreeJsHelper.setPositionToEntity(this._threeJsObject,this._component.getEntity(),t),this._relativeToEntityOrientation&&s.ThreeJsHelper.setOrientationToEntity(this._threeJsObject,this._component.getEntity())}_setAttribute(t,e,i){let n=this._threeJsGeometry.getAttribute(t);n instanceof s.THREE.InstancedBufferAttribute&&n.count!==e.length/i&&(this._offsetArray=new Float32Array(e.length/i*3),this._colorArray=new Float32Array(e.length/i*4),this._scaleArray=new Float32Array(e.length/i*1),this._threeJsGeometry.instanceCount=e.length/i,this._threeJsGeometry.setAttribute("offset",new s.THREE.InstancedBufferAttribute(this._offsetArray,3)),this._threeJsGeometry.setAttribute("color",new s.THREE.InstancedBufferAttribute(this._colorArray,4)),this._threeJsGeometry.setAttribute("scale",new s.THREE.InstancedBufferAttribute(this._scaleArray,1))),n=this._threeJsGeometry.getAttribute(t),n instanceof s.THREE.InstancedBufferAttribute&&(n.copyArray(e),n.needsUpdate=!0)}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});i(3);const s=class TextureLOD{constructor(t){this._engine=t.getEntity().getScene().getEngine(),this._component=t,this._uniform=null,this._url="",this._sizes=[],this._currentSize=0,this._forcedSize=void 0,this._useCompressed=!1,this._loadedPromise=Promise.resolve(),this._loading=!1}getUrl(){return this._url}setUrl(t){this._url=t,this._currentSize=0}getUniform(){return this._uniform}setUniform(t){this._uniform=t,this._currentSize=0}getSizes(){return this._sizes.slice()}setSizes(t){this._sizes=t.slice(),this._currentSize=0}getCurrentSize(){return this._currentSize}getForcedSize(){return this._forcedSize}setForcedSize(t){this._forcedSize=t}getUseCompression(){return this._useCompression}setUseCompression(t){this._useCompression=t,this._currentSize=0}getLoadedPromise(){return this._loadedPromise}update(){if(this._loading||null===this._uniform)return;if(""===this._url||0===this._sizes.length||"loaded"!==this._component.getLoadState()&&void 0===this._forcedSize)return void(null!==this._uniform.value&&(this._uniform.value.dispose(),this._uniform.value=null,this._currentSize=0));let t=this._sizes[0];t=void 0!==this._forcedSize?this._forcedSize:this._component.getEntity().getGreatestPixelSpaceExtentsRadius();let e=0;for(let i=0,s=this._sizes.length;i<s;i++){const n=this._sizes[i];if(i===s-1&&(e=i),n>=t||n>=this._engine.getConfig().getValue("maxTextureSize")&&void 0===this._forcedSize){e=i;break}}this._currentSize!==this._sizes[e]&&(this._currentSize=this._sizes[e],this._loadTexture(this._currentSize))}_loadTexture(t){const e=this._url.replace("$SIZE",t.toString());this._loading=!0;const i=this._useCompression?this._engine.getTextureLoaderCompressed():this._engine.getTextureLoader();this._loadedPromise=i.loadIntoUniform(this._uniform,e,!0).then((()=>{this._loading=!1})).catch((t=>{throw Error(t)}))}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class ThreeJsHelper{static createGeometry(t,e){const i=new s.THREE.BufferGeometry;if(e){let e=0;for(let i=0;i<t.length;i++)e+=t[i].dimensions;const n=new s.THREE.InterleavedBuffer(new Float32Array(0),e);let r=0;for(let e=0;e<t.length;e++)i.setAttribute(t[e].name,new s.THREE.InterleavedBufferAttribute(n,t[e].dimensions,r)),r+=t[e].dimensions}else for(let e=0;e<t.length;e++)i.setAttribute(t[e].name,new s.THREE.BufferAttribute(new Float32Array(0),t[e].dimensions));return i.setIndex(new s.THREE.BufferAttribute(new Uint16Array(0),1)),i}static setupObject(t,e){e.name=t+"."+Math.floor(1e4*Math.random()),e.matrixAutoUpdate=!1,e.frustumCulled=!1,e.visible=!1,t.getEntity().getScene().getThreeJsScene().add(e)}static createMeshObjectGivenGeometry(t,e,i){const n=new s.THREE.Mesh(i,e);return this.setupObject(t,n),n}static createMeshObject(t,e,i,s){const n=this.createGeometry(i,s);return this.createMeshObjectGivenGeometry(t,e,n)}static destroyGeometry(t){t.dispose()}static destroyObject(t){for(;t.children.length>0;)this.destroyObject(t.children[t.children.length-1]);null!==t.parent&&t.parent.remove(t),t instanceof s.THREE.Mesh&&this.destroyGeometry(t.geometry)}static destroyMaterial(t){const e=t.uniforms;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t].value&&void 0!==e[t].value.dispose&&e[t].value.dispose();t.dispose()}static destroyAllObjectsAndMaterials(t){const e=t.getThreeJsObjects(),i=t.getThreeJsMaterials();for(let t=0;t<e.length;t++)this.destroyObject(e[t]);for(let t=0;t<i.length;t++)this.destroyMaterial(i[t])}static setPosition(t,e){if(t)if(Array.isArray(t))for(let i=0,s=t.length;i<s;i++)t[i].position.set(e.x,e.y,e.z);else t.position.set(e.x,e.y,e.z)}static setPositionToEntity(t,e,i,n,r){if(!t)return;const o=e.getCameraSpacePosition(i);if(this._tempThreeJsVector3.set(o.x,o.y,o.z),n){const t=s.Vector3.pool.get();r?t.rotate(e.getOrientation(),n):t.copy(n),this._tempThreeJsVector3.x+=t.x,this._tempThreeJsVector3.y+=t.y,this._tempThreeJsVector3.z+=t.z,s.Vector3.pool.release(t)}if(Array.isArray(t))for(let e=0,i=t.length;e<i;e++)t[e].position.copy(this._tempThreeJsVector3);else t.position.copy(this._tempThreeJsVector3)}static setScale(t,e){if(t)if(Array.isArray(t))for(let i=0,s=t.length;i<s;i++)"number"==typeof e?t[i].scale.set(e,e,e):t[i].scale.set(e.x,e.y,e.z);else"number"==typeof e?t.scale.set(e,e,e):t.scale.set(e.x,e.y,e.z)}static setOrientation(t,e){if(t)if(s.BaseComponent._tempThreeJsQuaternion.set(e.x,e.y,e.z,e.w),Array.isArray(t))for(let e=0,i=t.length;e<i;e++)t[e].setRotationFromQuaternion(s.BaseComponent._tempThreeJsQuaternion);else t.setRotationFromQuaternion(s.BaseComponent._tempThreeJsQuaternion)}static setOrientationToBillboard(t,e,i){if(!t)return;const n=s.Quaternion.pool.get(),r=s.Vector3.pool.get(),o=s.Vector3.pool.get();if(r.normalize(e.getCameraSpacePosition(i)),i.getEntity().getOrientation().getAxis(o,0),o.setNormalTo(r,o),n.setFromAxes(o,void 0,r),s.BaseComponent._tempThreeJsQuaternion.set(n.x,n.y,n.z,n.w),Array.isArray(t))for(let e=0,i=t.length;e<i;e++)t[e].setRotationFromQuaternion(s.BaseComponent._tempThreeJsQuaternion);else t.setRotationFromQuaternion(s.BaseComponent._tempThreeJsQuaternion);s.Quaternion.pool.release(n),s.Vector3.pool.release(r),s.Vector3.pool.release(o)}static setOrientationToEntity(t,e,i){if(!t)return;const n=e.getOrientation();if(void 0===i)s.BaseComponent._tempThreeJsQuaternion.set(n.x,n.y,n.z,n.w);else{const t=s.Quaternion.pool.get();t.mult(n,i),s.BaseComponent._tempThreeJsQuaternion.set(t.x,t.y,t.z,t.w),s.Quaternion.pool.release(t)}if(Array.isArray(t))for(let e=0,i=t.length;e<i;e++)t[e].setRotationFromQuaternion(s.BaseComponent._tempThreeJsQuaternion);else t.setRotationFromQuaternion(s.BaseComponent._tempThreeJsQuaternion)}static useInDynEnvMap(t,e){e?t.layers.enable(1):t.layers.disable(1)}static setVertices(t,e,i){const n=t.getAttribute(e);n instanceof s.THREE.BufferAttribute&&(n.array.length===i.length?(n.copyArray(i),n.needsUpdate=!0):t.setAttribute(e,new s.THREE.BufferAttribute(i,t.getAttribute(e).itemSize)))}static setIndices(t,e){const i=t.getIndex();i.array.length===e.length?(i.copyArray(e),i.needsUpdate=!0):t.setIndex(new s.THREE.BufferAttribute(e,1))}static computeTangents(t){t.computeTangents()}static setRenderOrder(t,e){t&&(t.renderOrder=e)}static setupLogDepthBuffering(t){s.Capabilities.hasFragDepth()?(t.defines={L_EXT_frag_depth:!0},t.extensions.fragDepth=!0):(t.uniforms.nearDistance=new s.THREE.Uniform(1e-4),t.uniforms.midDistance=new s.THREE.Uniform(3)),t.needsUpdate=!0}static loadTexture(t,e,i,s){const n=t.getEntity().getScene().getEngine();return(s?n.getTextureLoaderCompressed():n.getTextureLoader()).loadTexture(e,i)}static loadTextureFromCanvas(t){const e=new s.THREE.CanvasTexture(t);return e.magFilter=s.THREE.NearestFilter,e.minFilter=s.THREE.NearestFilter,e.flipY=!1,e.needsUpdate=!0,e}static async loadTextureIntoUniform(t,e,i,s,n,r){if(!e)return;const o=t.getEntity().getScene().getEngine(),a=r?o.getTextureLoaderCompressed():o.getTextureLoader(),l=await a.loadTexture(s,n);if(t.getThreeJsMaterials().includes(e)){const s=e.uniforms[i];if(void 0===s)throw new Error(`Material in ${t} doesn't have uniform name '${i}'.`);null!==s.value&&s.value.dispose(),s.value=l}else l.dispose()}static setOverlay(t,e){t&&(t.depthFunc=e?s.THREE.AlwaysDepth:s.THREE.LessEqualDepth)}static setTransparent(t,e){t&&(t.transparent=e,t.depthWrite=!e)}static setBlending(t,e){if(t){switch(e){case"normal":t.blending=s.THREE.NormalBlending;break;case"additive":t.blending=s.THREE.AdditiveBlending;break;case"subtractive":t.blending=s.THREE.SubtractiveBlending;break;case"multiply":t.blending=s.THREE.MultiplyBlending;break;case"custom":t.blending=s.THREE.CustomBlending;break;default:t.blending=s.THREE.NoBlending}t.needsUpdate=!0}}static setDefine(t,e,i){i&&!t.defines[e]?(t.defines[e]=!0,t.needsUpdate=!0):i||!0!==t.defines[e]||(delete t.defines[e],t.needsUpdate=!0)}static setUniformNumber(t,e,i){t&&(t.uniforms[e].value=i)}static setUniformVector2(t,e,i){t&&t.uniforms[e].value.set(i.x,i.y)}static setUniformVector3(t,e,i){t&&t.uniforms[e].value.set(i.x,i.y,i.z)}static setUniformColorRGB(t,e,i){t&&t.uniforms[e].value.set(i.r,i.g,i.b)}static setUniformColorRGBA(t,e,i,s=1){t&&t.uniforms[e].value.set(i.r,i.g,i.b,i.a*s)}static setUniformQuaternion(t,e,i){t&&t.uniforms[e].value.set(i.x,i.y,i.z,i.w)}static setUniformTexture(t,e,i){t&&(null!==t.uniforms[e].value&&t.uniforms[e].value.dispose(),t.uniforms[e].value=i)}}ThreeJsHelper._tempThreeJsVector3=new s.THREE.Vector3;const n=ThreeJsHelper},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});const s=new Map;let n=null,r="";const o=new Map([["astc","astc"],["s3tc","dxt"],["pvrtc","pvrtc"],["etc","etc2"],["etc1","etc1"]]),a=class Capabilities{static isWebGL2(){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext}static hasFragDepth(){return this.isWebGL2()||this.hasGLExtension("EXT_frag_depth")}static hasGLExtension(t){if(null===n)return!1;let e=s.get(t);return void 0===e&&(e=null!==n.getExtension(t),s.set(t,e)),e}static __getCompressedTextureExtension(){return r}static __setContext(t){n=t,o.forEach(((t,e)=>{!0!==this.hasGLExtension("WEBGL_compressed_texture_"+e)&&!0!==this.hasGLExtension("WEBKIT_WEBGL_compressed_texture_"+e)||""===r&&(r=t)}))}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s=class Config{constructor(){this._valueMap=new Map,this._callbacksMap=new Map,this.setValue("maxTextureSize",512),this.setValue("useTextureCompression",!0),this.setValue("fontFamily","Arial"),this.setValue("fontSize",16),this.setValue("gammaCorrection",1)}getValue(t){return this._valueMap.get(t)}setValue(t,e){if(this._valueMap.get(t)!==e){this._valueMap.set(t,e);const i=this._callbacksMap.get(t);if(i)for(let s=0;s<i.length;s++)i[s](t,e)}}addEventListener(t,e){let i=this._callbacksMap.get(t);void 0===i&&(i=[],this._callbacksMap.set(t,i)),i.push(e)}removeEventListener(t,e){const i=this._callbacksMap.get(t);if(i)for(let t=0;t<i.length;t++)if(i[t]===e){i.splice(t,1);break}}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});class Download{constructor(t,e){this.url=t,this.actualUrl=e,this.progress=0,this.totalBytes=0,this.content=void 0,this.status="downloading",this.errorMessage=""}}class DownloadData{constructor(t,e){this.download=new Download(t,e),this.promise=null,this.progressCallbacks=[],this.request=null}}const s=class Downloader{constructor(){this._replacements=new Map,this._currentDownloads=new Map}getReplacement(t){return this._replacements.get(t)}setReplacement(t,e){this._replacements.set(t,e)}cancel(t){const e=this.processUrl(t),i=this._currentDownloads.get(e);void 0!==i&&null!==i.request&&i.request.abort()}processUrl(t){let e=t;for(const[t,i]of this._replacements)e=e.replace("$"+t,i);return e}download(t,e,i){const s=this.processUrl(t);let n=this._currentDownloads.get(s);return void 0!==n&&null!==n.promise?(i&&n.progressCallbacks.push(i),n.promise):(n=new DownloadData(t,s),this._currentDownloads.set(s,n),n.promise=new Promise((t=>{const i=new XMLHttpRequest;i.addEventListener("load",(()=>{200<=i.status&&i.status<=299?(n.download.content=i.response,n.download.status="completed"):(n.download.content=void 0,n.download.status="failed"),this._currentDownloads.delete(n.download.actualUrl),t(n.download)})),i.addEventListener("progress",(t=>{n.download.progress=t.lengthComputable?t.loaded/t.total:0,n.download.totalBytes=t.lengthComputable?t.total:0;for(const t of n.progressCallbacks)t(n.download)})),i.addEventListener("abort",(()=>{n.download.content=void 0,n.download.status="cancelled",this._currentDownloads.delete(n.download.actualUrl),t(n.download)})),i.addEventListener("error",(()=>{n.download.content=void 0,n.download.status="failed",n.download.errorMessage=i.statusText,this._currentDownloads.delete(n.download.actualUrl),t(n.download)})),i.responseType=e?"arraybuffer":"text",n.request=i,i.open("GET",s),i.send()})),n.promise)}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);const n=class Engine{constructor(t){if(!(t instanceof HTMLDivElement))throw new Error("The root div param is not an actual div element.");this._rootDiv=t,this._canvas=null,this._renderSize=new s.Vector2,this._renderSize.freeze(),this._input=new s.Input(this),this._config=new s.Config,this._downloader=new s.Downloader,this._textureLoader=null,this._textureLoaderCompressed=null,this._materialManager=null,this._scenes=new s.Collection(this,new Map([["scene",s.Scene]])),this._viewports=new s.Collection(this,new Map([["viewport",s.Viewport]])),this._lastAppTime=Date.now(),this._realDeltaTime=0,this._fps=new s.FPS,this._fpsLimit=Number.POSITIVE_INFINITY,this._time=0,this._timeRate=0,this._callbacks=[],this._callbacksToRemove=[],this._thisLoop=this._loop.bind(this),this._threeJsRenderer=null,this._viewportDiv=null,"relative"!==this._rootDiv.style.position&&"absolute"!==this._rootDiv.style.position&&(this._rootDiv.style.position="relative"),this._rootDiv.style.userSelect="none",this._rootDiv.style.webkitUserSelect="none",this._rootDiv.style.touchAction="none",this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute",this._canvas.style.left="0px",this._canvas.style.top="0px",this._canvas.style.width="100%",this._canvas.style.height="100%",this._rootDiv.appendChild(this._canvas),this._viewportDiv=document.createElement("div"),this._viewportDiv.style.position="absolute",this._viewportDiv.style.left="0px",this._viewportDiv.style.top="0px",this._viewportDiv.style.width="100%",this._viewportDiv.style.height="100%",this._viewportDiv.style.overflow="hidden",this._rootDiv.appendChild(this._viewportDiv);try{this._threeJsRenderer=new s.THREE.WebGLRenderer({canvas:this._canvas,antialias:!0}),this._threeJsRenderer.setScissorTest(!0),this._threeJsRenderer.setPixelRatio(window.devicePixelRatio),this._textureLoader=new s.TextureLoader(this._downloader,this._threeJsRenderer),this._textureLoaderCompressed=new s.TextureLoaderCompressed(this._downloader,this._config,this._threeJsRenderer),s.THREE.Cache.enabled=!1;const t=this._threeJsRenderer.getContext().getShaderInfoLog.bind(this._threeJsRenderer.getContext());this._threeJsRenderer.getContext().getShaderInfoLog=e=>{const i=t(e);return i.includes("GL_ARB_gpu_shader5")?"":i},s.Capabilities.__setContext(this._threeJsRenderer.getContext()),this._materialManager=new s.MaterialManager(this._downloader)}catch(t){throw console.log(t),t}requestAnimationFrame(this._thisLoop)}getVersion(){return s.Version}getRootDiv(){return this._rootDiv}getRenderSize(){return this._renderSize}getCanvas(){return this._canvas}getViewportDiv(){return this._viewportDiv}getConfig(){return this._config}getInput(){return this._input}getDownloader(){return this._downloader}getTextureLoader(){return this._textureLoader}getTextureLoaderCompressed(){return this._textureLoaderCompressed}getMaterialManager(){return this._materialManager}getScene(t){return this._scenes.get(t)}getNumScenes(){return this._scenes.size}addScene(t){return this._scenes.add("scene",t)}removeScene(t){this._scenes.remove(t)}get(t,e,i,s=0){const n=this._scenes.get(t);return void 0===e||null===n?n:n.get(e,i,s)}getViewport(t){return this._viewports.get(t)}getNumViewports(){return this._viewports.size}addViewport(t=""){return this._viewports.add("viewport",t)}removeViewport(t){this._viewports.remove(t)}getTime(){return this._time}setTime(t){this._time=t}getTimeRate(){return this._timeRate}setTimeRate(t){this._timeRate=t}getFPS(){return this._fps.getFPS()}getFPSLimit(){return this._fpsLimit}setFPSLimit(t){this._fpsLimit=t}getDeltaTime(){return this._realDeltaTime}isComponentTypeRegistered(t){return s.Types.Components.has(t)}registerComponentType(t,e){if(s.Types.Components.has(t))throw new Error("Already registered component type '"+t+"'.");s.Types.Components.set(t,e)}unregisterComponentType(t){s.Types.Components.delete(t)}isControllerTypeRegistered(t){return s.Types.Controllers.has(t)}registerControllerType(t,e){if(s.Types.Controllers.has(t))throw new Error("Already registered controller type '"+t+"'.");s.Types.Controllers.set(t,e)}unregisterControllerType(t){s.Types.Controllers.delete(t)}waitUntilNextFrame(){return new Promise((t=>{this.addCallback((()=>{t()}),!1)}))}addCallback(t,e){this._callbacks.push({callback:t,recurring:e})}removeCallback(t){this._callbacksToRemove.push(t)}__getThreeJsRenderer(){return this._threeJsRenderer}_loop(){try{const t=Date.now();if(this._realDeltaTime=(t-this._lastAppTime)/1e3,this._realDeltaTime<1/this._fpsLimit)return void requestAnimationFrame(this._thisLoop);this._lastAppTime=t,this._fps.update(this._realDeltaTime),this._time+=this._timeRate*this._realDeltaTime,this._renderSize.x===this._rootDiv.clientWidth&&this._renderSize.y===this._rootDiv.clientHeight||(this._renderSize.thaw(),this._renderSize.set(this._rootDiv.clientWidth,this._rootDiv.clientHeight),this._renderSize.freeze(),this._threeJsRenderer.setSize(this._renderSize.x,this._renderSize.y,!1));for(let t=0;t<this._scenes.size;t++)this._scenes.get(t).__update();for(let t=0;t<this._viewports.size;t++)this._viewports.get(t).__updateViewportVariables();for(let t=0;t<this._scenes.size;t++)this._scenes.get(t).__updateVisuals();this._threeJsRenderer.setViewport(0,0,this._renderSize.x,this._renderSize.y),this._threeJsRenderer.setScissor(0,0,this._renderSize.x,this._renderSize.y),this._threeJsRenderer.clear();for(let t=0;t<this._viewports.size;t++)this._viewports.get(t).__render();for(let t=0;t<this._callbacks.length;t++)this._callbacks[t].callback(),this._callbacks[t].recurring||this._callbacksToRemove.push(this._callbacks[t].callback);for(let t=0,e=this._callbacksToRemove.length;t<e;t++)for(let e=0,i=this._callbacks.length;e<i;e++)if(this._callbacks[e].callback===this._callbacksToRemove[t]){this._callbacks.splice(e,1);break}this._input.__resetStatesForNextFrame()}catch(t){throw console.log(t),t}requestAnimationFrame(this._thisLoop)}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class Entity extends s.CollectionItem{constructor(t,e,i){super(t,e,i),this._enabled=!0,this._disabledByAncestor=!1,this._destroyed=!1,this._parent=null,this._lastParent=null,this._children=[],this._parentingTable=[],this._parentChangedCallbacks=[],this._childChangedCallbacks=[],this._position=new s.Vector3(Number.NaN,Number.NaN,Number.NaN),this._position.freeze(),this._velocity=new s.Vector3(Number.NaN,Number.NaN,Number.NaN),this._velocity.freeze(),this._orientation=new s.Quaternion(Number.NaN,Number.NaN,Number.NaN,Number.NaN),this._orientation.freeze(),this._angularVelocity=new s.Vector3(Number.NaN,Number.NaN,Number.NaN),this._angularVelocity.freeze(),this._cameraSpacePosition=new s.FastMap,this._normalSpacePosition=new s.FastMap,this._pixelSpacePosition=new s.FastMap,this._normalSpaceExtentsRadius=new s.FastMap,this._pixelSpaceExtentsRadius=new s.FastMap,this._greatestPixelSpaceExtentsRadius=0,this._components=new s.Collection(this,s.Types.Components),this._controllers=new s.Collection(this,s.Types.Controllers),this._occlusionRadius=0,this._extentsRadius=0,this._canOcclude=!0,this._positionCoverage=new s.Interval(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),this._positionCoverage.freeze(),this._orientationCoverage=new s.Interval(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),this._orientationCoverage.freeze(),this._isInPositionCoverage=!1,this._isInOrientationCoverage=!1}getScene(){return this.__getCollectionParent()}isEnabled(){return this._enabled&&!this._disabledByAncestor}isDisabledByAncestor(){return this._disabledByAncestor}setEnabled(t){this._enabled!==t&&(this._enabled=t,this._updateEnabled())}_updateEnabled(){for(let t=0;t<this._components.size;t++)this._components.get(t).__updateLoadState();for(let t=0,e=this._children.length;t<e;t++)this._children[t]._updateDisabledByAncestor()}_updateDisabledByAncestor(){let t=!1,e=this._parent;for(;null!==e;){if(!e._enabled||e._disabledByAncestor){t=!0;break}e=e._parent}this._disabledByAncestor!==t&&(this._disabledByAncestor=t,this._updateEnabled())}isDestroyed(){return this._destroyed}getPosition(){return this._position}setPosition(t){this._position.thaw(),this._position.copy(t),this._position.freeze()}getVelocity(){return this._velocity}setVelocity(t){this._velocity.thaw(),this._velocity.copy(t),this._velocity.freeze()}getOrientation(){return this._orientation}setOrientation(t){this._orientation.thaw(),this._orientation.copy(t),this._orientation.freeze()}getAngularVelocity(){return this._angularVelocity}setAngularVelocity(t){this._angularVelocity.thaw(),this._angularVelocity.copy(t),this._angularVelocity.freeze()}getPositionRelativeToEntity(t,e,i,n){let r=this;if(t.copy(e),void 0===n){const e=this.getLowestCommonAncestor(i);if(null===e)return void t.copy(s.Vector3.NaN);for(t.add(t,r.getPosition());r!==e;)r=r.getParent(),t.add(t,r.getPosition());if(null!==i)for(r=i,t.sub(t,r.getPosition());r!==e;)r=r.getParent(),t.sub(t,r.getPosition())}else{const e=this.getScene(),o=s.Vector3.pool.get(),a=this.getLowestCommonAncestorAtTime(i,n);if(null!==a){for(r.getPositionAtTime(o,n),t.add(t,o);r!==a;){const i=r.getParentAtTime(n);if(r=e.getEntity(i),null===r)return void t.copy(s.Vector3.NaN);r.getPositionAtTime(o,n),t.add(t,o)}if(null!==i)for(r=i,r.getPositionAtTime(o,n),t.sub(t,o);r!==a;){const i=r.getParentAtTime(n);if(r=e.getEntity(i),null===r)return void t.copy(s.Vector3.NaN);r.getPositionAtTime(o,n),t.sub(t,o)}}else t.copy(s.Vector3.NaN);s.Vector3.pool.release(o)}}getVelocityRelativeToEntity(t,e,i,n){let r=this;if(t.copy(e),void 0===n){const e=this.getLowestCommonAncestor(i);if(null===e)return void t.copy(s.Vector3.NaN);for(t.add(t,r.getVelocity());r!==e;)r=r.getParent(),t.add(t,r.getVelocity());if(null!==i)for(r=i,t.sub(t,r.getVelocity());r!==e;)r=r.getParent(),t.sub(t,r.getVelocity())}else{const e=this.getScene(),o=s.Vector3.pool.get(),a=this.getLowestCommonAncestorAtTime(i,n);if(null!==a){for(r.getVelocityAtTime(o,n),t.add(t,o);r!==a;){const i=r.getParentAtTime(n);if(r=e.getEntity(i),null===r)return void t.copy(s.Vector3.NaN);r.getVelocityAtTime(o,n),t.add(t,o)}if(null!==i)for(r=i,r.getVelocityAtTime(o,n),t.sub(t,o);r!==a;){const i=r.getParentAtTime(n);if(r=e.getEntity(i),null===r)return void t.copy(s.Vector3.NaN);r.getVelocityAtTime(o,n),t.sub(t,o)}}else t.copy(s.Vector3.NaN);s.Vector3.pool.release(o)}}getPositionAtTime(t,e){if(this.isEnabled())if(void 0===e)t.copy(this._position);else if(t.set(Number.NaN,Number.NaN,Number.NaN),this._controllers.size>0)for(let i=0;i<this._controllers.size;i++){const s=this._controllers.get(i);s.hasModifiedState("position")&&s.getCoverage().contains(e)&&s.isEnabled()&&s.__updatePositionAtTime(t,e)}else t.copy(this._position);else t.set(Number.NaN,Number.NaN,Number.NaN)}getVelocityAtTime(t,e){if(this.isEnabled())if(void 0===e)t.copy(this._velocity);else if(t.set(Number.NaN,Number.NaN,Number.NaN),this._controllers.size>0)for(let i=0;i<this._controllers.size;i++){const s=this._controllers.get(i);s.hasModifiedState("velocity")&&s.getCoverage().contains(e)&&s.isEnabled()&&s.__updateVelocityAtTime(t,e)}else t.copy(this._velocity);else t.set(Number.NaN,Number.NaN,Number.NaN)}getOrientationAtTime(t,e){if(this.isEnabled())if(void 0===e)t.copy(this._orientation);else if(t.set(Number.NaN,Number.NaN,Number.NaN,Number.NaN),this._controllers.size>0)for(let i=0;i<this._controllers.size;i++){const s=this._controllers.get(i);s.hasModifiedState("orientation")&&s.getCoverage().contains(e)&&s.isEnabled()&&s.__updateOrientationAtTime(t,e)}else t.copy(this._orientation);else t.set(Number.NaN,Number.NaN,Number.NaN,Number.NaN)}getOcclusionRadius(){return this._occlusionRadius}getExtentsRadius(){return this._extentsRadius}setOcclusionRadius(t){this._occlusionRadius=t}setExtentsRadius(t){this._extentsRadius=t}getPositionCoverage(){return this._positionCoverage}getOrientationCoverage(){return this._orientationCoverage}isInPositionCoverage(){return this._isInPositionCoverage}isInOrientationCoverage(){return this._isInOrientationCoverage}__updateCoverage(){let t=0,e=0;this._positionCoverage.thaw(),this._orientationCoverage.thaw(),this._positionCoverage.set(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY),this._orientationCoverage.set(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY);for(let i=0;i<this._controllers.size;i++){const s=this._controllers.get(i);s.isEnabled()&&(s.hasModifiedState("position")&&(this._positionCoverage.union(this._positionCoverage,s.getCoverage()),t++),s.hasModifiedState("orientation")&&(this._orientationCoverage.union(this._orientationCoverage,s.getCoverage()),e++))}0===t&&this._positionCoverage.set(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),0===e&&this._orientationCoverage.set(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),this._positionCoverage.freeze(),this._orientationCoverage.freeze()}canOcclude(){return this._canOcclude}setCanOcclude(t){this._canOcclude=t}isOccludingPosition(t,e){if(!this._canOcclude||!this.isInPositionCoverage())return!1;const i=Math.min(this._occlusionRadius,this.getCameraSpacePosition(t).magnitude()),n=s.Interval.pool.get();s.Geometry.getLineSphereIntersectionWithLineStartAtOrigin(n,e,this.getCameraSpacePosition(t),i);const r=n.min<n.max&&0<=n.min+n.max&&n.min+n.max<2;return s.Interval.pool.release(n),r}getParent(){return this._parent}getParentAtTime(t){const e=s.Sort.getIndex(t,this._parentingTable,isStartTimeLessThanTime);return e<this._parentingTable.length&&t===this._parentingTable[e][0]?this._parentingTable[e][1]:e>0?this._parentingTable[e-1][1]:this._parentingTable.length>0?"":null!==this._parent?this._parent.getName():""}setParent(t){if(t===this._parent)return;const e=s.Vector3.pool.get();if(this.getPositionRelativeToEntity(e,s.Vector3.Zero,t),e.isNaN()||this.setPosition(e),s.Vector3.pool.release(e),null!==this._parent)for(let t=0;t<this._parent._children.length;t++){this._parent._children[t]===this&&this._parent._children.splice(t,1)}const i=this._parent;this._parent=t,null!==this._parent&&this._parent._children.push(this),this._clearCameraReferences(),this._updateDisabledByAncestor();for(let t=0,e=this._parentChangedCallbacks.length;t<e;t++)this._parentChangedCallbacks[t](this,i,this._parent);if(null!==i)for(let t=0,e=i._childChangedCallbacks.length;t<e;t++)i._childChangedCallbacks[t](i,this,!1);if(null!==this._parent)for(let t=0,e=this._parent._childChangedCallbacks.length;t<e;t++)this._parent._childChangedCallbacks[t](this._parent,this,!0)}_clearCameraReferences(){this._cameraSpacePosition.clear(),this._normalSpacePosition.clear(),this._pixelSpacePosition.clear(),this._normalSpaceExtentsRadius.clear(),this._pixelSpaceExtentsRadius.clear();for(let t=0,e=this._components.size;t<e;t++){this._components.get(t).__clearCameraDependentsBase()}for(let t=0,e=this._children.length;t<e;t++)this._children[t]._clearCameraReferences()}getNumChildren(){return this._children.length}getChild(t){return this._children[t]}getLowestCommonAncestor(t){if(null===t)return null;let e=this,i=t,s=0,n=0;for(;null!==e.getParent();)s+=1,e=e.getParent();for(;null!==i.getParent();)n+=1,i=i.getParent();for(e=this,i=t;s>n;)s-=1,e=e.getParent();for(;n>s;)n-=1,i=i.getParent();for(;e!==i&&null!==e;)e=e.getParent(),i=i.getParent();return e}getLowestCommonAncestorAtTime(t,e){if(null===t)return null;let i=this,s=t,n=0,r=0;const o=this.getScene();for(;;){const t=i.getParentAtTime(e);if(""===t)break;const s=o.getEntity(t);if(null===s)return null;n+=1,i=s}for(;;){const t=s.getParentAtTime(e);if(""===t)break;const i=o.getEntity(t);if(null===i)return null;r+=1,s=i}for(i=this,s=t;n>r;){n-=1;const t=i.getParentAtTime(e),s=o.getEntity(t);if(null===s)return null;i=s}for(;r>n;){r-=1;const t=s.getParentAtTime(e),i=o.getEntity(t);if(null===i)return null;s=i}for(;i!==s&&null!==i;){const t=i.getParentAtTime(e),n=o.getEntity(t);if(null===n)return null;i=n;const r=s.getParentAtTime(e),a=o.getEntity(r);if(null===a)return null;s=a}return i}getNumParentingTableEntries(){return this._parentingTable.length}getParentingTableEntry(t){return this._parentingTable[t]}addParentingTableEntry(t,e){s.Sort.add([t,e],this._parentingTable,isStartTimeLess,isStartTimeEqual)}removeParentingTableEntry(t){const e=s.Sort.getIndex(t,this._parentingTable,isStartTimeLessThanTime);e<this._parentingTable.length&&this._parentingTable[e][0]===t&&this._parentingTable.splice(e)}addParentChangedCallback(t){this._parentChangedCallbacks.push(t)}removeParentChangedCallback(t){const e=this._parentChangedCallbacks.indexOf(t);-1!==e&&this._parentChangedCallbacks.splice(e,1)}addChildChangedCallback(t){this._childChangedCallbacks.push(t)}removeChildChangedCallback(t){const e=this._childChangedCallbacks.indexOf(t);-1!==e&&this._childChangedCallbacks.splice(e,1)}getNumComponents(){return this._components.size}getComponent(t){return this._components.get(t)}getComponentByType(t,e=0){return this._components.getByType(t,e)}addComponent(t,e,i){return this._components.add(t,e,i)}removeComponent(t){this._components.remove(t)}clearComponents(){this._components.clear()}getNumControllers(){return this._controllers.size}getController(t){return this._controllers.get(t)}getControllerByType(t,e=0){return this._controllers.getByType(t,e)}addController(t,e,i){const s=this._controllers.add(t,e,i);return this.__updateCoverage(),s}removeController(t){this._controllers.remove(t),this.__updateCoverage()}clearControllers(){this._controllers.clear(),this.__updateCoverage()}getCameraSpacePosition(t){const e=this._cameraSpacePosition.get(t);return void 0!==e?e:s.Vector3.NaN}getNormalSpacePosition(t){const e=this._normalSpacePosition.get(t);return void 0!==e?e:s.Vector3.NaN}getPixelSpacePosition(t){const e=this._pixelSpacePosition.get(t);return void 0!==e?e:s.Vector2.NaN}getNormalSpaceOcclusionRadius(t){return 0!==this._extentsRadius?this.getNormalSpaceExtentsRadius(t)*this._occlusionRadius/this._extentsRadius:0}getNormalSpaceExtentsRadius(t){const e=this._normalSpaceExtentsRadius.get(t);return void 0!==e?e:Number.NaN}getPixelSpaceOcclusionRadius(t){return 0!==this._extentsRadius?this.getPixelSpaceExtentsRadius(t)*this._occlusionRadius/this._extentsRadius:0}getPixelSpaceExtentsRadius(t){const e=this._pixelSpaceExtentsRadius.get(t);return void 0!==e?e:Number.NaN}getGreatestPixelSpaceOcclusionRadius(){return 0!==this._extentsRadius?this.getGreatestPixelSpaceExtentsRadius()*this._occlusionRadius/this._extentsRadius:0}getGreatestPixelSpaceExtentsRadius(){return this._greatestPixelSpaceExtentsRadius}__setCameraDependentVariables(t,e){const i=t.getViewport();if(null===i)return;let n=this._cameraSpacePosition.get(t);void 0===n?(n=new s.Vector3,this._cameraSpacePosition.set(t,n)):n.thaw(),n.copy(e),n.freeze();let r=this._normalSpacePosition.get(t);void 0===r?(r=new s.Vector3,this._normalSpacePosition.set(t,r)):r.thaw(),t.getNormalSpacePositionFromCameraSpacePosition(r,n),r.freeze();let o=this._pixelSpacePosition.get(t);void 0===o?(o=new s.Vector2,this._pixelSpacePosition.set(t,o)):o.thaw(),i.getPixelSpacePositionFromNormalSpacePosition(o,r),o.freeze();const a=t.getNormalSpaceRadiusFromRadius(this._extentsRadius,n.magnitude());this._normalSpaceExtentsRadius.set(t,a);const l=i.getPixelSpaceRadiusFromNormalSpaceRadius(a);this._pixelSpaceExtentsRadius.set(t,l)}__removeCameraDependents(t){this._cameraSpacePosition.delete(t),this._normalSpacePosition.delete(t),this._pixelSpacePosition.delete(t),this._normalSpaceExtentsRadius.delete(t),this._pixelSpaceExtentsRadius.delete(t);for(let e=0;e<this._components.size;e++)this._components.get(e).__removeCameraDependentsBase(t)}get(t,e=0){const i=this._components.getByType(t,e);return null!==i?i:this._controllers.getByType(t,e)}getLoadedPromise(){const t=[];if(this.isEnabled()){for(let e=0;e<this._controllers.size;e++)t.push(this._controllers.get(e).getLoadedPromise());for(let e=0;e<this._components.size;e++)t.push(this._components.get(e).getLoadedPromise())}return Promise.all(t).then()}toString(){return this.getName()}__destroy(){this._destroyed=!0,super.__destroy();for(let t=0;t<this._children.length;t++)this._children[t].setParent(null);null!==this._parent&&this.setParent(null),this._controllers.__destroy(),this._components.__destroy()}__updateParent(t){const e=this.getParentAtTime(t);if(""!==e){const t=this.getScene().getEntity(e);t!==this._parent&&this.setParent(t)}else null!==this._parent&&this.setParent(null);this._parent!==this._lastParent&&(this.getScene().getControllerDependencyGraph().needsSorting(),this._lastParent=this._parent)}__updateIsInCoverages(t){this._isInPositionCoverage=this._positionCoverage.contains(t),this._isInOrientationCoverage=this._orientationCoverage.contains(t);for(let t=0;t<this._components.size;t++)this._components.get(t).__updateLoadState()}__updateVisuals(){this._greatestPixelSpaceExtentsRadius=0;for(let t=0,e=this._pixelSpaceExtentsRadius.size;t<e;t++){const e=this._pixelSpaceExtentsRadius.getAt(t).value;this._greatestPixelSpaceExtentsRadius<e&&(this._greatestPixelSpaceExtentsRadius=e)}for(let t=0,e=this._components.size;t<e;t++){const e=this._components.get(t);e.isEnabled()&&e.__updateBase()}}__updateCameraVariables(t,e,i){if(this.isEnabled()){const n=s.Vector3.pool.get();this===t.getEntity()?n.set(0,0,0):i?n.sub(e.getCameraSpacePosition(t),e.getPosition()):n.add(e.getCameraSpacePosition(t),this._position),this.__setCameraDependentVariables(t,n),this._canOcclude&&this.getPixelSpaceOcclusionRadius(t)>=1&&t.__addToOccludingEntities(this),s.Vector3.pool.release(n);for(let e=0,i=this._components.size;e<i;e++){const i=this._components.get(e);i!==t&&i.isEnabled()&&i.__updateCameraVariablesBase(t)}}null===this._parent||!i&&this!==t.getEntity()||this._parent.__updateCameraVariables(t,this,!0);for(let i=0,s=this._children.length;i<s;i++){const s=this._children[i];s!==e&&s.__updateCameraVariables(t,this,!1)}}__prepareForRender(t){for(let e=0,i=this._components.size;e<i;e++){const i=this._components.get(e);"camera"!==i.getType()&&i.__prepareForRenderBase(t)}}}function isStartTimeLess(t,e){return t[0]<e[0]}function isStartTimeEqual(t,e){return t[0]===e[0]}function isStartTimeLessThanTime(t,e){return t[0]<e}const n=Entity},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class EntityItem extends s.CollectionItem{constructor(t,e,i){super(t,e,i),this._enabled=!0,this._destroyed=!1}getEntity(){return this.__getCollectionParent()}isDestroyed(){return this._destroyed}__destroy(){this._destroyed=!0,super.__destroy()}isEnabled(){return this._enabled}setEnabled(t){this._enabled=t}getLoadedPromise(){return Promise.resolve()}__update(){}}const n=EntityItem},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);class Touch{constructor(){this.identifier=0,this.pressedPosition=new s.Vector2,this.pressedTime=0,this.lastFramePosition=new s.Vector2,this.thisFramePosition=new s.Vector2}}const n=new Set(["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Hyper","Meta","NumLock","ScrollLock","Shift","Super","Symbol","SymbolLock"]),r=class Input{constructor(t){this._engine=t,this._activeViewport=null,this._draggedOffset=new s.Vector2,this._draggedOffset.freeze(),this._zoomedOffset=0,this._rotatedOffset=0,this._shiftPressed=!1,this._keysPressed=new Set,this._maxSelectTime=.5,this._maxSelectDistance=5,this._cursorPosition=new s.Vector2,this._selected=!1,this._selectedPosition=new s.Vector2,this._selectedPosition.freeze(),this._touches=[],window.addEventListener("blur",(()=>{this._touches=[],this._keysPressed.clear(),this._shiftPressed=!1})),window.addEventListener("keydown",(t=>{t.target instanceof HTMLElement&&["INPUT","SELECT","TEXTAREA"].includes(t.target.tagName)||("Shift"===t.key?this._shiftPressed=!0:n.has(t.key)?(this._keysPressed.clear(),this._shiftPressed=!1):this._keysPressed.add(t.key.toLowerCase()))})),window.addEventListener("keyup",(t=>{"Shift"===t.key?this._shiftPressed=!1:n.has(t.key)||this._keysPressed.delete(t.key.toLowerCase())})),this._engine.getRootDiv().addEventListener("mousedown",(t=>{if(0===t.button&&(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),0===this._touches.length)){const e=this._engine.getRootDiv().getBoundingClientRect();let i=null;for(let t=0;t<this._touches.length;t++)0===this._touches[t].identifier&&(i=this._touches[t]);null===i&&(i=new Touch),i.identifier=0,i.pressedPosition.set(t.clientX-e.left,t.clientY-e.top),i.pressedTime=Date.now(),i.lastFramePosition.copy(i.pressedPosition),i.thisFramePosition.copy(i.pressedPosition),this._touches.push(i),this._updateActiveViewport()}})),window.addEventListener("mousemove",(t=>{const e=this._engine.getRootDiv().getBoundingClientRect();if(1===this._touches.length&&0===this._touches[0].identifier){const i=this._touches[0];i.thisFramePosition.set(t.clientX-e.left,t.clientY-e.top),this._draggedOffset.thaw(),this._draggedOffset.sub(i.thisFramePosition,i.lastFramePosition);const s=Math.max(Math.abs(i.thisFramePosition.x-i.pressedPosition.x),Math.abs(i.thisFramePosition.y-i.pressedPosition.y));(Date.now()-i.pressedTime)/1e3<=this._maxSelectTime&&s<=this._maxSelectDistance&&this._draggedOffset.set(0,0),this._draggedOffset.freeze()}this._touches.length<=1&&this._cursorPosition.set(t.clientX-e.left,t.clientY-e.top)})),window.addEventListener("mouseup",(t=>{if(0===t.button&&1===this._touches.length&&0===this._touches[0].identifier){const e=this._engine.getRootDiv().getBoundingClientRect(),i=this._touches[0];i.thisFramePosition.set(t.clientX-e.left,t.clientY-e.top);const s=Math.max(Math.abs(i.thisFramePosition.x-i.pressedPosition.x),Math.abs(i.thisFramePosition.y-i.pressedPosition.y));(Date.now()-i.pressedTime)/1e3<=this._maxSelectTime&&s<=this._maxSelectDistance&&(this._selected=!0,this._selectedPosition.thaw(),this._selectedPosition.copy(i.thisFramePosition),this._selectedPosition.freeze()),this._touches.splice(0,1)}})),this._engine.getRootDiv().addEventListener("wheel",(t=>{if(t.deltaY){let e=1;1===t.deltaMode?e=16:2===t.deltaMode&&(e=64),this._zoomedOffset+=t.deltaY*e}t.preventDefault()}),{passive:!1}),this._engine.getRootDiv().addEventListener("touchstart",(t=>{const e=this._engine.getRootDiv().getBoundingClientRect();for(let i=0;i<t.changedTouches.length;i++){const s=t.changedTouches[i];let n=null;for(let t=0;t<this._touches.length;t++)this._touches[t].identifier===s.identifier&&(n=this._touches[t]);null===n&&(n=new Touch),n.identifier=s.identifier,n.pressedPosition.thaw(),n.pressedPosition.set(s.pageX-window.pageXOffset-e.left,s.pageY-window.pageYOffset-e.top),n.pressedPosition.freeze(),n.pressedTime=Date.now(),n.lastFramePosition.copy(n.pressedPosition),n.thisFramePosition.copy(n.pressedPosition),this._touches.push(n),1===this._touches.length&&this._cursorPosition.copy(n.thisFramePosition),this._updateActiveViewport()}}),{passive:!1}),window.addEventListener("touchmove",(t=>{const e=this._engine.getRootDiv().getBoundingClientRect();for(let i=0;i<t.changedTouches.length;i++){const n=t.changedTouches[i];for(let t=0;t<this._touches.length;t++){const r=this._touches[t];if(r.identifier===n.identifier)if(r.thisFramePosition.set(n.pageX-window.pageXOffset-e.left,n.pageY-window.pageYOffset-e.top),1===this._touches.length){this._draggedOffset.thaw(),this._draggedOffset.sub(r.thisFramePosition,r.lastFramePosition);const t=Math.max(Math.abs(r.thisFramePosition.x-r.pressedPosition.x),Math.abs(r.thisFramePosition.y-r.pressedPosition.y));(Date.now()-r.pressedTime)/1e3<=this._maxSelectTime&&t<=this._maxSelectDistance&&this._draggedOffset.set(0,0),this._draggedOffset.freeze(),this._cursorPosition.copy(r.thisFramePosition)}else if(2===this._touches.length){const t=s.Vector2.pool.get();t.sub(this._touches[i].thisFramePosition,this._touches[1-i].thisFramePosition);const e=s.Vector2.pool.get();e.sub(this._touches[i].thisFramePosition,this._touches[i].lastFramePosition);const n=e.dot(t)/t.magnitude()/e.magnitude(),o=e.cross(t)/t.magnitude()/e.magnitude();n<-.7?this._zoomedOffset+=-(n+.7)*e.magnitude():n>.7?this._zoomedOffset+=-(n-.7)*e.magnitude():Math.abs(o)>.3&&(this._rotatedOffset+=o*e.magnitude()),s.Vector2.pool.release(e),s.Vector2.pool.release(t);const a=Math.max(Math.abs(r.thisFramePosition.x-r.pressedPosition.x),Math.abs(r.thisFramePosition.y-r.pressedPosition.y));(Date.now()-r.pressedTime)/1e3<=this._maxSelectTime&&a<=this._maxSelectDistance&&(this._zoomedOffset=0,this._rotatedOffset=0)}}}})),window.addEventListener("touchend",(t=>{const e=this._engine.getRootDiv().getBoundingClientRect();for(let i=0;i<t.changedTouches.length;i++){const s=t.changedTouches[i];for(let t=0;t<this._touches.length;t++){const i=this._touches[t];if(i.identifier===s.identifier){if(i.thisFramePosition.set(s.pageX-window.pageXOffset-e.left,s.pageY-window.pageYOffset-e.top),1===this._touches.length){const t=Math.max(Math.abs(i.thisFramePosition.x-i.pressedPosition.x),Math.abs(i.thisFramePosition.y-i.pressedPosition.y));(Date.now()-i.pressedTime)/1e3<=this._maxSelectTime&&t<=this._maxSelectDistance&&(this._selected=!0,this._selectedPosition.thaw(),this._selectedPosition.copy(i.thisFramePosition),this._selectedPosition.freeze())}this._touches.splice(t,1)}}}})),window.addEventListener("touchcancel",(()=>{}))}getActiveViewport(){return this._activeViewport}getDraggedOffset(){return this._draggedOffset}getZoomedOffset(){return this._zoomedOffset}getRotatedOffset(){return this._rotatedOffset}isShiftPressed(){return this._shiftPressed}isKeyPressed(t){return this._keysPressed.has(t)}isSelected(){return this._selected}getSelectedPosition(){return this._selectedPosition}getCursorPosition(){return this._cursorPosition}__setActiveViewport(t){this._activeViewport=t}__resetStatesForNextFrame(){for(let t=0;t<this._touches.length;t++)this._touches[t].lastFramePosition.copy(this._touches[t].thisFramePosition);this._selected=!1,this._altSelected=!1,this._draggedOffset.thaw(),this._draggedOffset.set(0,0),this._draggedOffset.freeze(),this._zoomedOffset=0,this._rotatedOffset=0}_updateActiveViewport(){this._activeViewport=null;for(let t=this._engine.getNumViewports()-1;t>=0;t--){const e=this._engine.getViewport(t).getBounds();if(this._engine.getViewport(t).isEnabled()&&e.contains(this._touches[0].pressedPosition)){this._activeViewport=this._engine.getViewport(t);break}}}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>d});var s=i(3),n=i(62),r=i(63),o=i(64),a=i(65),l=i(66),h=i(67),c=i(68);class Resource{constructor(t){this.value=t,this.useCount=0}}const d=class MaterialManager{constructor(t){this._downloader=t,this._cache=new Map,this._clonedMaterials=new Map,this._promises=new Map,this._preload()}async get(t){let e=this._cache.get(t);if(void 0===e){const i=this._promises.get(t);void 0!==i&&(e=await i)}if(void 0===e){const i=await this._downloader.download(t,!1);if("completed"!==i.status||"string"!=typeof i.content)throw new Error('Failed to download material "'+t+'".');const s=JSON.parse(i.content);e=new Resource(await this._load(t,s)),this._cache.set(t,e)}return e.useCount+=1,this._clone(e.value,t)}getPreloaded(t){const e=this._cache.get(t);if(void 0===e)throw new Error('Invalid pre-loaded material "'+t+'".');return e.useCount+=1,this._clone(e.value,t)}release(t){const e=this._clonedMaterials.get(t);if(void 0===e)return;this._clonedMaterials.delete(t);const i=this._cache.get(e);i&&(i.useCount-=1,0===i.useCount&&(this._unload(i.value),this._cache.delete(e)))}_unload(t){const e=t.uniforms;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t].value&&void 0!==e[t].value.dispose&&e[t].value.dispose();t.dispose()}_preload(){const t=new Map;t.set("basic",n),t.set("basic_alpha",r),t.set("line",o.default),t.set("plumes",a),t.set("sprite",l),t.set("sprite_particles",h),t.set("trail",c.default);for(const[e,i]of t){const t=this._load(e,i),s=new Resource(t);s.useCount+=1,this._cache.set(e,s)}}_load(t,e){try{const t={};if(e.uniforms)for(const[i,n]of Object.entries(e.uniforms))["modelMatrix","modelViewMatrix","projectionMatrix","viewMatrix","normalMatrix","cameraPosition"].includes(i)||(t[i]=new s.THREE.Uniform(this._getUniformValueFromType(n)));let i=!1,n=!0,r=s.THREE.FrontSide,o=s.THREE.NoBlending;if(e.properties){switch(!0===e.properties.transparent&&(i=!0),!1===e.properties.depthWrite&&(n=!1),e.properties.side){case"front":r=s.THREE.FrontSide;break;case"back":r=s.THREE.BackSide;break;case"double":r=s.THREE.DoubleSide}switch(e.properties.blending){case"normal":o=s.THREE.NormalBlending;break;case"additive":o=s.THREE.AdditiveBlending;break;case"subtractive":o=s.THREE.SubtractiveBlending;break;case"multiply":o=s.THREE.MultiplyBlending;break;case"custom":o=s.THREE.CustomBlending}}if("object"!=typeof e.vertex||"string"!=typeof e.vertex.code)throw new Error("Missing vertex stage code.");if("object"!=typeof e.fragment||"string"!=typeof e.fragment.code)throw new Error("Missing fragment stage code.");if(Array.isArray(e.vertex.extensions)){let t="";for(const i of e.vertex.extensions)s.Capabilities.hasGLExtension(i)&&(t+="#extension GL_"+i+": enable\n");for(const i of e.vertex.extensions)s.Capabilities.hasGLExtension(i)&&(t+="#define L_"+i+" true\n"),s.Capabilities.isWebGL2()&&"EXT_frag_depth"===i&&(t+="#define L_"+i+" true\n");e.vertex.code=t+e.vertex.code}if(Array.isArray(e.fragment.extensions)){let t="";for(const i of e.fragment.extensions)s.Capabilities.hasGLExtension(i)&&(t+="#extension GL_"+i+": enable\n");for(const i of e.fragment.extensions)s.Capabilities.hasGLExtension(i)&&(t+="#define L_"+i+" true\n");e.fragment.code=t+e.fragment.code}const a=new s.THREE.RawShaderMaterial({uniforms:t,vertexShader:s.ShaderFix.fix(e.vertex.code,"vertex"),fragmentShader:s.ShaderFix.fix(e.fragment.code,"fragment"),transparent:i,depthWrite:n,side:r,blending:o});return a.needsUpdate=!0,a}catch(e){throw new Error('while processing material "'+t+'", '+e.message)}}_getUniformValueFromType(t){switch(t=t.replace(/.* /,"")){case"int":case"float":return 0;case"ivec2":case"vec2":return new s.THREE.Vector2(0,0);case"ivec3":case"vec3":return new s.THREE.Vector3(0,0,0);case"ivec4":case"vec4":return new s.THREE.Vector4(0,0,0,0);case"mat3":return new s.THREE.Matrix3;case"mat4":return new s.THREE.Matrix4;case"sampler2D":case"samplerCube":return null}if(t.endsWith("]")){const e=t.indexOf("["),i=t.indexOf("]"),s=t.substring(0,e),n=Number.parseInt(t.substring(e+1,i)),r=[];for(let t=0;t<n;t++)r.push(this._getUniformValueFromType(s));return r}throw new Error("Unrecognized type: "+t+".")}_clone(t,e){const i=t.clone();for(const[e,i]of Object.entries(t.uniforms)){const s=i.value;if(Array.isArray(s)){const i=s[0];if(i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)){t.uniforms[e].value=[];for(let i=0;i<s.length;i++)t.uniforms[e].value[i]=s[i].clone()}}}return i.needsUpdate=!0,this._clonedMaterials.set(i,e),i}}},t=>{"use strict";t.exports=JSON.parse('{"uniforms":{"modelViewMatrix":"mat4","projectionMatrix":"highp mat4","nearDistance":"float","midDistance":"float","color":"vec4"},"properties":{},"vertex":{"extensions":["EXT_frag_depth"],"code":"attribute vec3 position;\\nuniform mat4 modelViewMatrix;\\nuniform mat4 projectionMatrix;\\nuniform float nearDistance;\\nuniform float midDistance;\\nvarying highp float vDepth;\\nvec4 mv3_mult_func(mat4 m, vec3 v, float w) {\\n\\treturn m * vec4(v, w);\\n}\\nvec4 mv4_mult_func(mat4 m, vec4 v) {\\n\\treturn m * v;\\n}\\nvec4 log_depth_vert_func(vec4 projectedPosition, vec4 viewPosition, float nearDistance, float midDistance) {\\n\\t#ifndef L_EXT_frag_depth\\n\\t\\tfloat z = projectedPosition.w;\\n\\t\\tif (z < midDistance) {\\n\\t\\t\\tprojectedPosition.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\\n\\t\\t}\\n\\t\\telse {\\n\\t\\t\\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\\n\\t\\t\\tprojectedPosition.z = log2(z - midDistance + 1.0) * logFactor;\\n\\t\\t\\tprojectedPosition.z *= projectedPosition.w;\\n\\t\\t}\\n\\t#else\\n\\t\\tprojectedPosition.w = viewPosition.y;\\n\\t#endif\\n\\treturn projectedPosition;\\n}\\nvoid main() {\\n\\tvec4 view_position = mv3_mult_func(modelViewMatrix, position, 1.0);\\n\\tvec4 projected_position = mv4_mult_func(projectionMatrix, view_position);\\n\\tvec4 log_depth_vert = log_depth_vert_func(projected_position, view_position, nearDistance, midDistance);\\n\\tgl_Position = log_depth_vert;\\n\\tvDepth = projected_position.w;\\n}\\n"},"fragment":{"extensions":["EXT_frag_depth"],"code":"precision mediump float;\\nuniform highp mat4 projectionMatrix;\\nuniform vec4 color;\\nvarying highp float vDepth;\\nhighp float log_depth_frag_func(highp float fragDepth, mat4 projectionMatrix) {\\n\\t#ifdef L_EXT_frag_depth\\n\\t\\thighp float logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\\n\\t\\treturn projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\\n\\t#else\\n\\t\\treturn 0.0;\\n\\t#endif\\n}\\nvoid main() {\\n\\thighp float log_depth_frag = log_depth_frag_func(vDepth, projectionMatrix);\\n\\t#ifdef L_EXT_frag_depth\\n\\t\\tgl_FragDepthEXT = log_depth_frag;\\n\\t#endif\\n\\tgl_FragColor = color;\\n}\\n"}}')},t=>{"use strict";t.exports=JSON.parse('{"uniforms":{"modelViewMatrix":"mat4","projectionMatrix":"highp mat4","nearDistance":"float","midDistance":"float","color":"vec4"},"properties":{"transparent":true,"depthWrite":false,"side":"double","blending":"normal"},"vertex":{"extensions":["EXT_frag_depth"],"code":"attribute vec3 position;\\nuniform mat4 modelViewMatrix;\\nuniform mat4 projectionMatrix;\\nuniform float nearDistance;\\nuniform float midDistance;\\nvarying highp float vDepth;\\nvec4 mv3_mult_func(mat4 m, vec3 v, float w) {\\n\\treturn m * vec4(v, w);\\n}\\nvec4 mv4_mult_func(mat4 m, vec4 v) {\\n\\treturn m * v;\\n}\\nvec4 log_depth_vert_func(vec4 projectedPosition, vec4 viewPosition, float nearDistance, float midDistance) {\\n\\t#ifndef L_EXT_frag_depth\\n\\t\\tfloat z = projectedPosition.w;\\n\\t\\tif (z < midDistance) {\\n\\t\\t\\tprojectedPosition.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\\n\\t\\t}\\n\\t\\telse {\\n\\t\\t\\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\\n\\t\\t\\tprojectedPosition.z = log2(z - midDistance + 1.0) * logFactor;\\n\\t\\t\\tprojectedPosition.z *= projectedPosition.w;\\n\\t\\t}\\n\\t#else\\n\\t\\tprojectedPosition.w = viewPosition.y;\\n\\t#endif\\n\\treturn projectedPosition;\\n}\\nvoid main() {\\n\\tvec4 view_position = mv3_mult_func(modelViewMatrix, position, 1.0);\\n\\tvec4 projected_position = mv4_mult_func(projectionMatrix, view_position);\\n\\tvec4 log_depth_vert = log_depth_vert_func(projected_position, view_position, nearDistance, midDistance);\\n\\tgl_Position = log_depth_vert;\\n\\tvDepth = projected_position.w;\\n}\\n"},"fragment":{"extensions":["EXT_frag_depth"],"code":"precision mediump float;\\nuniform highp mat4 projectionMatrix;\\nuniform vec4 color;\\nvarying highp float vDepth;\\nhighp float log_depth_frag_func(highp float fragDepth, mat4 projectionMatrix) {\\n\\t#ifdef L_EXT_frag_depth\\n\\t\\thighp float logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\\n\\t\\treturn projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\\n\\t#else\\n\\t\\treturn 0.0;\\n\\t#endif\\n}\\nvoid main() {\\n\\thighp float log_depth_frag = log_depth_frag_func(vDepth, projectionMatrix);\\n\\t#ifdef L_EXT_frag_depth\\n\\t\\tgl_FragDepthEXT = log_depth_frag;\\n\\t#endif\\n\\tgl_FragColor = color;\\n}\\n"}}')},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s={uniforms:{modelViewMatrix:"mat4",projectionMatrix:"highp mat4",nearDistance:"float",midDistance:"float",pixelSize:"vec2",alphaMultiplier:"float",dashLength:"float",dashGapLength:"float",glowWidth:"float"},properties:{transparent:!0,depthWrite:!1,side:"double",blending:"additive"},vertex:{extensions:["EXT_frag_depth"],code:"\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec3 positionPrev;\n\t\t\tattribute vec3 positionNext;\n\t\t\tattribute vec4 color;\n\t\t\tattribute float width;\n\t\t\tattribute float dashOffset;\n\n\t\t\tuniform mat4 modelViewMatrix;\n\t\t\tuniform mat4 projectionMatrix;\n\t\t\tuniform float nearDistance;\n\t\t\tuniform float midDistance;\n\t\t\tuniform vec2 pixelSize;\n\t\t\tuniform mediump float glowWidth;\n\n\t\t\tvarying highp float fDepth;\n\t\t\tvarying vec4 fColor;\n\t\t\tvarying float fDashOffset;\n\t\t\tvarying float fWidth;\n\t\t\tvarying float fOffsetScalar;\n\n\t\t\tvec4 log_depth_vert_func(vec4 projectedPosition, vec4 viewPosition, float nearDistance, float midDistance) {\n\t\t\t\t#ifndef L_EXT_frag_depth\n\t\t\t\t\tfloat z = projectedPosition.w;\n\t\t\t\t\tif (z < midDistance) {\n\t\t\t\t\t\tprojectedPosition.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\n\t\t\t\t\t\tprojectedPosition.z = log2(z - midDistance + 1.0) * logFactor;\n\t\t\t\t\t\tprojectedPosition.z *= projectedPosition.w;\n\t\t\t\t\t}\n\t\t\t\t#else\n\t\t\t\t\tprojectedPosition.w = viewPosition.y;\n\t\t\t\t#endif\n\t\t\t\treturn projectedPosition;\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\t// Get the line vertices into pixel space.\n\t\t\t\tvec4 view_center = modelViewMatrix * vec4(position, 1.0);\n\t\t\t\tvec4 view_prev = modelViewMatrix * vec4(positionPrev, 1.0);\n\t\t\t\tvec4 view_next = modelViewMatrix * vec4(positionNext, 1.0);\n\t\t\t\tvec4 projected_center = projectionMatrix * view_center;\n\t\t\t\tvec4 projected_prev = projectionMatrix * view_prev;\n\t\t\t\tvec4 projected_next = projectionMatrix * view_next;\n\t\t\t\tvec2 ndc_center = projected_center.xy / view_center.y;\n\t\t\t\tvec2 ndc_prev = projected_prev.xy / view_prev.y;\n\t\t\t\tvec2 ndc_next = projected_next.xy / view_next.y;\n\t\t\t\tvec2 pixel_center = (ndc_center.xy + 1.0) / 2.0 * pixelSize;\n\t\t\t\tvec2 pixel_prev = (ndc_prev.xy + 1.0) / 2.0 * pixelSize;\n\t\t\t\tvec2 pixel_next = (ndc_next.xy + 1.0) / 2.0 * pixelSize;\n\n\t\t\t\t// Get the offset of the part perpendicular to the lines.\n\t\t\t\tvec2 l0 = normalize(pixel_center - pixel_prev);\n\t\t\t\tvec2 l1 = normalize(pixel_next - pixel_center);\n\t\t\t\tfloat offsetScalar = sign(width) * (abs(width) / 2.0 + glowWidth);\n\t\t\t\tvec2 offset = vec2(offsetScalar, offsetScalar);\n\t\t\t\tif (pixel_center == pixel_prev) {\n\t\t\t\t\tif (pixel_center == pixel_next) {\n\t\t\t\t\t\toffset = vec2(0.0, 0.0);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\toffset *= vec2(-l1.y, l1.x);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (pixel_center == pixel_next) {\n\t\t\t\t\toffset *= vec2(-l0.y, l0.x);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\toffset *= normalize(vec2(-l0.y - l1.y, l0.x + l1.x));\n\t\t\t\t\toffset /= max(0.25, sqrt((1.0 + dot(l0, l1)) / 2.0));\n\t\t\t\t}\n\n\t\t\t\t// Re-add the perpendicular part to the center as the final vertex.\n\t\t\t\tndc_center = (pixel_center + offset) / pixelSize * 2.0 - 1.0;\n\t\t\t\tprojected_center = vec4(ndc_center * view_center.y, projected_center.z, projected_center.w);\n\t\t\t\tvec4 log_depth_vert = log_depth_vert_func(projected_center, view_center, nearDistance, midDistance);\n\t\t\t\tgl_Position = log_depth_vert;\n\n\t\t\t\t// Set the varyings.\n\t\t\t\tfDepth = projected_center.w;\n\t\t\t\tfColor = color;\n\t\t\t\tfDashOffset = dashOffset;\n\t\t\t\tfWidth = width;\n\t\t\t\tfOffsetScalar = offsetScalar;\n\t\t\t}\n\t\t"},fragment:{extensions:["EXT_frag_depth"],code:"\n\t\t\tprecision mediump float;\n\n\t\t\tuniform highp mat4 projectionMatrix;\n\t\t\tuniform float alphaMultiplier;\n\t\t\tuniform float dashLength;\n\t\t\tuniform float dashGapLength;\n\t\t\tuniform float glowWidth;\n\n\t\t\tvarying highp float fDepth;\n\t\t\tvarying vec4 fColor;\n\t\t\tvarying float fDashOffset;\n\t\t\tvarying float fWidth;\n\t\t\tvarying float fOffsetScalar;\n\n\t\t\thighp float log_depth_frag_func(highp float fragDepth, mat4 projectionMatrix) {\n\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\thighp float logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\n\t\t\t\t\treturn projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\n\t\t\t\t#else\n\t\t\t\t\treturn 0.0;\n\t\t\t\t#endif\n\t\t\t}\n\n\t\t\tfloat line_dash_func() {\n\t\t\t\tfloat u = mod(fDashOffset, dashLength + dashGapLength);\n\t\t\t\treturn float(u < dashLength);\n\t\t\t}\n\n\t\t\tfloat edgeGlow() {\n\t\t\t\tif (glowWidth > 0.0) {\n\t\t\t\t\tfloat value = clamp((fWidth / 2.0 + glowWidth - abs(fOffsetScalar)) / glowWidth, 0.0, 1.0);\n\t\t\t\t\tif (value < 1.0) {\n\t\t\t\t\t\tvalue *= 0.75;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t\treturn 1.0;\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\thighp float log_depth_frag = log_depth_frag_func(fDepth, projectionMatrix);\n\t\t\t\tgl_FragColor = fColor;\n\t\t\t\tgl_FragColor.a *= alphaMultiplier * edgeGlow() * line_dash_func();\n\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\tgl_FragDepthEXT = log_depth_frag;\n\t\t\t\t#endif\n\t\t\t}\n\t\t"}}},t=>{"use strict";t.exports=JSON.parse('{"uniforms":{"modelViewMatrix":"mat4","projectionMatrix":"highp mat4","nearDistance":"float","midDistance":"float","colorTexture":"sampler2D","colorMultiplier":"vec4","speed":"float","time":"float"},"properties":{"transparent":true,"depthWrite":false,"side":"double","blending":"normal"},"vertex":{"extensions":["EXT_frag_depth"],"code":"attribute vec3 position;\\nattribute vec2 uv;\\nuniform mat4 modelViewMatrix;\\nuniform mat4 projectionMatrix;\\nuniform float nearDistance;\\nuniform float midDistance;\\nvarying highp float vDepth;\\nvarying vec2 vUV;\\nvec4 mv3_mult_func(mat4 m, vec3 v, float w) {\\n\\treturn m * vec4(v, w);\\n}\\nvec4 mv4_mult_func(mat4 m, vec4 v) {\\n\\treturn m * v;\\n}\\nvec4 log_depth_vert_func(vec4 projectedPosition, vec4 viewPosition, float nearDistance, float midDistance) {\\n\\t#ifndef L_EXT_frag_depth\\n\\t\\tfloat z = projectedPosition.w;\\n\\t\\tif (z < midDistance) {\\n\\t\\t\\tprojectedPosition.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\\n\\t\\t}\\n\\t\\telse {\\n\\t\\t\\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\\n\\t\\t\\tprojectedPosition.z = log2(z - midDistance + 1.0) * logFactor;\\n\\t\\t\\tprojectedPosition.z *= projectedPosition.w;\\n\\t\\t}\\n\\t#else\\n\\t\\tprojectedPosition.w = viewPosition.y;\\n\\t#endif\\n\\treturn projectedPosition;\\n}\\nvoid main() {\\n\\tvec4 view_position = mv3_mult_func(modelViewMatrix, position, 1.0);\\n\\tvec4 projected_position = mv4_mult_func(projectionMatrix, view_position);\\n\\tvec4 log_depth_vert = log_depth_vert_func(projected_position, view_position, nearDistance, midDistance);\\n\\tgl_Position = log_depth_vert;\\n\\tvDepth = projected_position.w;\\n\\tvUV = uv;\\n}\\n"},"fragment":{"extensions":["EXT_frag_depth"],"code":"precision mediump float;\\nuniform highp mat4 projectionMatrix;\\nuniform sampler2D colorTexture;\\nuniform vec4 colorMultiplier;\\nuniform float speed;\\nuniform float time;\\nvarying highp float vDepth;\\nvarying vec2 vUV;\\nhighp float log_depth_frag_func(highp float fragDepth, mat4 projectionMatrix) {\\n\\t#ifdef L_EXT_frag_depth\\n\\t\\thighp float logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\\n\\t\\treturn projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\\n\\t#else\\n\\t\\treturn 0.0;\\n\\t#endif\\n}\\nvec2 v2_construct_func(float x, float y) {\\n\\treturn vec2(x, y);\\n}\\nfloat s_mult_func(float s1, float s2) {\\n\\treturn s1 * s2;\\n}\\nfloat s_mod_func(float s1, float s2) {\\n\\treturn mod(s1, s2);\\n}\\nvec2 v2s_mult_func(vec2 v, float s) {\\n\\treturn v * s;\\n}\\nvec2 v2_add_func(vec2 v1, vec2 v2) {\\n\\treturn v1 + v2;\\n}\\nvec4 texture_func(sampler2D tex, vec2 uv) {\\n\\treturn texture2D(tex, uv);\\n}\\nvec4 v4v4_mult_func(vec4 v1, vec4 v2) {\\n\\treturn v1 * v2;\\n}\\nfloat s_sub_func(float s1, float s2) {\\n\\treturn s1 - s2;\\n}\\nvec4 alpha_mult_func(vec4 color, float alpha) {\\n\\treturn vec4(color.rgb, color.a * alpha);\\n}\\nvoid main() {\\n\\thighp float log_depth_frag = log_depth_frag_func(vDepth, projectionMatrix);\\n\\tvec2 yAxis = v2_construct_func(0.0, 1.0);\\n\\tfloat yMultiplier = s_mult_func(time, speed);\\n\\tfloat yMultiplierMod = s_mod_func(yMultiplier, 1.0);\\n\\tvec2 uvOffset = v2s_mult_func(yAxis, yMultiplierMod);\\n\\tvec2 finalUV = v2_add_func(vUV, uvOffset);\\n\\tvec4 textureOffset = texture_func(colorTexture, finalUV);\\n\\tvec4 color = v4v4_mult_func(textureOffset, colorMultiplier);\\n\\tfloat fade = s_sub_func(1.0, vUV.y);\\n\\tvec4 color_with_fade = alpha_mult_func(color, fade);\\n\\t#ifdef L_EXT_frag_depth\\n\\t\\tgl_FragDepthEXT = log_depth_frag;\\n\\t#endif\\n\\tgl_FragColor = color_with_fade;\\n}\\n"}}')},t=>{"use strict";t.exports=JSON.parse('{"uniforms":{"modelViewMatrix":"mat4","projectionMatrix":"highp mat4","nearDistance":"float","midDistance":"float","pixelBased":"float","color":"vec4","colorTexture":"sampler2D"},"properties":{"transparent":true,"depthWrite":false,"side":"double","blending":"normal"},"vertex":{"extensions":["EXT_frag_depth"],"code":"attribute vec3 position;\\nattribute vec2 uv;\\nuniform mat4 modelViewMatrix;\\nuniform mat4 projectionMatrix;\\nuniform float nearDistance;\\nuniform float midDistance;\\nuniform float pixelBased;\\nvarying highp float vDepth;\\nvarying vec2 vUV;\\nvec4 mv3_mult_func(mat4 m, vec3 v, float w) {\\n\\treturn m * vec4(v, w);\\n}\\nvec4 mv4_mult_func(mat4 m, vec4 v) {\\n\\treturn m * v;\\n}\\nvec4 log_depth_vert_func(vec4 projectedPosition, vec4 viewPosition, float nearDistance, float midDistance) {\\n\\t#ifndef L_EXT_frag_depth\\n\\t\\tfloat z = projectedPosition.w;\\n\\t\\tif (z < midDistance) {\\n\\t\\t\\tprojectedPosition.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\\n\\t\\t}\\n\\t\\telse {\\n\\t\\t\\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\\n\\t\\t\\tprojectedPosition.z = log2(z - midDistance + 1.0) * logFactor;\\n\\t\\t\\tprojectedPosition.z *= projectedPosition.w;\\n\\t\\t}\\n\\t#else\\n\\t\\tprojectedPosition.w = viewPosition.y;\\n\\t#endif\\n\\treturn projectedPosition;\\n}\\nvec4 pixel_based_func(float pixelBased, vec4 projectedPosition) {\\n\\tif (pixelBased != 0.0) {\\n\\t\\tprojectedPosition /= abs(projectedPosition.w);\\n\\t}\\n\\treturn projectedPosition;\\n}\\nvoid main() {\\n\\tvec4 view_position = mv3_mult_func(modelViewMatrix, position, 1.0);\\n\\tvec4 projected_position = mv4_mult_func(projectionMatrix, view_position);\\n\\tvec4 log_depth_vert = log_depth_vert_func(projected_position, view_position, nearDistance, midDistance);\\n\\tvec4 pixel_based_projected_position = pixel_based_func(pixelBased, log_depth_vert);\\n\\tgl_Position = pixel_based_projected_position;\\n\\tvDepth = projected_position.w;\\n\\tvUV = uv;\\n}\\n"},"fragment":{"extensions":["EXT_frag_depth"],"code":"precision mediump float;\\nuniform highp mat4 projectionMatrix;\\nuniform vec4 color;\\nuniform sampler2D colorTexture;\\nvarying highp float vDepth;\\nvarying vec2 vUV;\\nhighp float log_depth_frag_func(highp float fragDepth, mat4 projectionMatrix) {\\n\\t#ifdef L_EXT_frag_depth\\n\\t\\thighp float logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\\n\\t\\treturn projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\\n\\t#else\\n\\t\\treturn 0.0;\\n\\t#endif\\n}\\nvec4 texture_func(sampler2D tex, vec2 uv) {\\n\\treturn texture2D(tex, uv);\\n}\\nvec4 v4v4_mult_func(vec4 v1, vec4 v2) {\\n\\treturn v1 * v2;\\n}\\nvoid main() {\\n\\thighp float log_depth_frag = log_depth_frag_func(vDepth, projectionMatrix);\\n\\tvec4 textureColor = texture_func(colorTexture, vUV);\\n\\tvec4 finalColor = v4v4_mult_func(textureColor, color);\\n\\t#ifdef L_EXT_frag_depth\\n\\t\\tgl_FragDepthEXT = log_depth_frag;\\n\\t#endif\\n\\tgl_FragColor = finalColor;\\n}\\n"}}')},t=>{"use strict";t.exports=JSON.parse('{"uniforms":{"modelViewMatrix":"mat4","projectionMatrix":"highp mat4","nearDistance":"float","midDistance":"float"},"properties":{"transparent":true,"depthWrite":false,"side":"double","blending":"additive"},"vertex":{"extensions":["EXT_frag_depth"],"code":"attribute vec3 position;\\nattribute vec4 color;\\nattribute vec3 offset;\\nattribute float scale;\\nuniform mat4 modelViewMatrix;\\nuniform mat4 projectionMatrix;\\nuniform float nearDistance;\\nuniform float midDistance;\\nvarying highp float vDepth;\\nvarying vec4 fColor;\\nvarying vec2 fPosition;\\nvec4 v4v4_add_func(vec4 v1, vec4 v2) {\\n\\treturn v1 + v2;\\n}\\nvec4 mv4_mult_func(mat4 m, vec4 v) {\\n\\treturn m * v;\\n}\\nvec4 log_depth_vert_func(vec4 projectedPosition, vec4 viewPosition, float nearDistance, float midDistance) {\\n\\t#ifndef L_EXT_frag_depth\\n\\t\\tfloat z = projectedPosition.w;\\n\\t\\tif (z < midDistance) {\\n\\t\\t\\tprojectedPosition.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\\n\\t\\t}\\n\\t\\telse {\\n\\t\\t\\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\\n\\t\\t\\tprojectedPosition.z = log2(z - midDistance + 1.0) * logFactor;\\n\\t\\t\\tprojectedPosition.z *= projectedPosition.w;\\n\\t\\t}\\n\\t#else\\n\\t\\tprojectedPosition.w = viewPosition.y;\\n\\t#endif\\n\\treturn projectedPosition;\\n}\\nvec4 mv3_mult_func(mat4 m, vec3 v, float w) {\\n\\treturn m * vec4(v, w);\\n}\\nvec4 v3s_extend_func(vec3 v, float s) {\\n\\treturn vec4(v, s);\\n}\\nvec4 v4s_mult_func(vec4 v, float s) {\\n\\treturn v * s;\\n}\\nvoid main() {\\n\\tvec4 view_offset = mv3_mult_func(modelViewMatrix, offset, 1.0);\\n\\tvec4 position_v4 = v3s_extend_func(position, 0.0);\\n\\tvec4 position_scaled = v4s_mult_func(position_v4, scale);\\n\\tvec4 view_position = v4v4_add_func(view_offset, position_scaled);\\n\\tvec4 projected_position = mv4_mult_func(projectionMatrix, view_position);\\n\\tvec4 log_depth_vert = log_depth_vert_func(projected_position, view_position, nearDistance, midDistance);\\n\\tgl_Position = log_depth_vert;\\n\\tvDepth = projected_position.w;\\n\\tfColor = color;\\n\\tfPosition = position.xz;\\n}\\n"},"fragment":{"extensions":["EXT_frag_depth"],"code":"precision mediump float;\\nuniform highp mat4 projectionMatrix;\\nvarying highp float vDepth;\\nvarying vec4 fColor;\\nvarying vec2 fPosition;\\nhighp float log_depth_frag_func(highp float fragDepth, mat4 projectionMatrix) {\\n\\t#ifdef L_EXT_frag_depth\\n\\t\\thighp float logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\\n\\t\\treturn projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\\n\\t#else\\n\\t\\treturn 0.0;\\n\\t#endif\\n}\\nfloat v2_length_func(vec2 v) {\\n\\treturn length(v);\\n}\\nfloat s_sub_func(float s1, float s2) {\\n\\treturn s1 - s2;\\n}\\nvec4 v4_construct_func(float x, float y, float z, float w) {\\n\\treturn vec4(x, y, z, w);\\n}\\nvec4 v4s_mult_func(vec4 v, float s) {\\n\\treturn v * s;\\n}\\nvoid main() {\\n\\thighp float log_depth_frag = log_depth_frag_func(vDepth, projectionMatrix);\\n\\tfloat distance_from_center = v2_length_func(fPosition);\\n\\tfloat distance_from_edge = s_sub_func(1.0, distance_from_center);\\n\\tvec4 c2olor = v4_construct_func(1.0, 1.0, 1.0, 1.0);\\n\\tvec4 color = v4s_mult_func(fColor, distance_from_edge);\\n\\t#ifdef L_EXT_frag_depth\\n\\t\\tgl_FragDepthEXT = log_depth_frag;\\n\\t#endif\\n\\tgl_FragColor = color;\\n}\\n"}}')},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s={uniforms:{modelViewMatrix:"mat4",projectionMatrix:"highp mat4",nearDistance:"float",midDistance:"float",pixelSize:"vec2",alphaMultiplier:"float",dashLength:"float",dashGapLength:"float",glowWidth:"float",indexStart:"float",indexCount:"float",indexLength:"float",color:"vec4",alphaFade:"float",widthMin:"float",widthMax:"float"},properties:{transparent:!0,depthWrite:!1,side:"double",blending:"additive"},vertex:{extensions:["EXT_frag_depth"],code:"\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec3 positionPrev;\n\t\t\tattribute vec3 positionNext;\n\t\t\tattribute float side;\n\t\t\tattribute float index;\n\t\t\tattribute float dashOffset;\n\n\t\t\tuniform mat4 modelViewMatrix;\n\t\t\tuniform mat4 projectionMatrix;\n\t\t\tuniform float nearDistance;\n\t\t\tuniform float midDistance;\n\t\t\tuniform vec2 pixelSize;\n\t\t\tuniform mediump float glowWidth;\n\t\t\tuniform float indexStart;\n\t\t\tuniform float indexCount;\n\t\t\tuniform float indexLength;\n\t\t\tuniform float widthMin;\n\t\t\tuniform float widthMax;\n\n\t\t\tvarying highp float fDepth;\n\t\t\tvarying vec4 fColor;\n\t\t\tvarying float fDashOffset;\n\t\t\tvarying float fWidth;\n\t\t\tvarying float fOffsetScalar;\n\t\t\tvarying float fIndexU;\n\n\t\t\tvec4 log_depth_vert_func(vec4 projectedPosition, vec4 viewPosition, float nearDistance, float midDistance) {\n\t\t\t\t#ifndef L_EXT_frag_depth\n\t\t\t\t\tfloat z = projectedPosition.w;\n\t\t\t\t\tif (z < midDistance) {\n\t\t\t\t\t\tprojectedPosition.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\n\t\t\t\t\t\tprojectedPosition.z = log2(z - midDistance + 1.0) * logFactor;\n\t\t\t\t\t\tprojectedPosition.z *= projectedPosition.w;\n\t\t\t\t\t}\n\t\t\t\t#else\n\t\t\t\t\tprojectedPosition.w = viewPosition.y;\n\t\t\t\t#endif\n\t\t\t\treturn projectedPosition;\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\t// Get the width depending on the length.\n\t\t\t\tfloat indexU = mod(index - indexStart + indexLength, indexLength) / (indexCount - 1.0);\n\t\t\t\tfloat width = mix(widthMin, widthMax, indexU);\n\n\t\t\t\t// Get the line vertices into pixel space.\n\t\t\t\tvec4 view_center = modelViewMatrix * vec4(position, 1.0);\n\t\t\t\tvec4 view_prev = modelViewMatrix * vec4(positionPrev, 1.0);\n\t\t\t\tvec4 view_next = modelViewMatrix * vec4(positionNext, 1.0);\n\t\t\t\tvec4 projected_center = projectionMatrix * view_center;\n\t\t\t\tvec4 projected_prev = projectionMatrix * view_prev;\n\t\t\t\tvec4 projected_next = projectionMatrix * view_next;\n\t\t\t\tvec2 ndc_center = projected_center.xy / view_center.y;\n\t\t\t\tvec2 ndc_prev = projected_prev.xy / view_prev.y;\n\t\t\t\tvec2 ndc_next = projected_next.xy / view_next.y;\n\t\t\t\tvec2 pixel_center = (ndc_center.xy + 1.0) / 2.0 * pixelSize;\n\t\t\t\tvec2 pixel_prev = (ndc_prev.xy + 1.0) / 2.0 * pixelSize;\n\t\t\t\tvec2 pixel_next = (ndc_next.xy + 1.0) / 2.0 * pixelSize;\n\n\t\t\t\t// Get the offset of the part perpendicular to the lines.\n\t\t\t\tvec2 l0 = normalize(pixel_center - pixel_prev);\n\t\t\t\tvec2 l1 = normalize(pixel_next - pixel_center);\n\t\t\t\tfloat offsetScalar = side * (width / 2.0 + glowWidth);\n\t\t\t\tvec2 offset = vec2(offsetScalar, offsetScalar);\n\t\t\t\tif (pixel_center == pixel_prev) {\n\t\t\t\t\tif (pixel_center == pixel_next) {\n\t\t\t\t\t\toffset = vec2(0.0, 0.0);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\toffset *= vec2(-l1.y, l1.x);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (pixel_center == pixel_next) {\n\t\t\t\t\toffset *= vec2(-l0.y, l0.x);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\toffset *= normalize(vec2(-l0.y - l1.y, l0.x + l1.x));\n\t\t\t\t\toffset /= max(0.25, sqrt((1.0 + dot(l0, l1)) / 2.0));\n\t\t\t\t}\n\n\t\t\t\t// Re-add the perpendicular part to the center as the final vertex.\n\t\t\t\tndc_center = (pixel_center + offset) / pixelSize * 2.0 - 1.0;\n\t\t\t\tprojected_center = vec4(ndc_center * view_center.y, projected_center.z, projected_center.w);\n\t\t\t\tvec4 log_depth_vert = log_depth_vert_func(projected_center, view_center, nearDistance, midDistance);\n\t\t\t\tgl_Position = log_depth_vert;\n\n\t\t\t\t// Set the varyings.\n\t\t\t\tfDepth = projected_center.w;\n\t\t\t\tfIndexU = indexU;\n\t\t\t\tfDashOffset = dashOffset;\n\t\t\t\tfWidth = width;\n\t\t\t\tfOffsetScalar = offsetScalar;\n\t\t\t}\n\t\t"},fragment:{extensions:["EXT_frag_depth"],code:"\n\t\t\tprecision mediump float;\n\n\t\t\tuniform highp mat4 projectionMatrix;\n\t\t\tuniform vec4 color;\n\t\t\tuniform float alphaMultiplier;\n\t\t\tuniform float alphaFade;\n\t\t\tuniform float dashLength;\n\t\t\tuniform float dashGapLength;\n\t\t\tuniform float glowWidth;\n\n\t\t\tvarying highp float fDepth;\n\t\t\tvarying float fIndexU;\n\t\t\tvarying float fDashOffset;\n\t\t\tvarying float fWidth;\n\t\t\tvarying float fOffsetScalar;\n\n\t\t\thighp float log_depth_frag_func(highp float fragDepth, mat4 projectionMatrix) {\n\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\thighp float logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\n\t\t\t\t\treturn projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\n\t\t\t\t#else\n\t\t\t\t\treturn 0.0;\n\t\t\t\t#endif\n\t\t\t}\n\n\t\t\tfloat line_dash_func() {\n\t\t\t\tfloat u = mod(fDashOffset, dashLength + dashGapLength);\n\t\t\t\treturn float(u < dashLength);\n\t\t\t}\n\n\t\t\tfloat edgeGlow() {\n\t\t\t\tif (glowWidth > 0.0) {\n\t\t\t\t\tfloat value = clamp((fWidth / 2.0 + glowWidth - abs(fOffsetScalar)) / glowWidth, 0.0, 1.0);\n\t\t\t\t\tif (value < 1.0) {\n\t\t\t\t\t\tvalue *= 0.75;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t\treturn 1.0;\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\thighp float log_depth_frag = log_depth_frag_func(fDepth, projectionMatrix);\n\t\t\t\tgl_FragColor = color;\n\t\t\t\tgl_FragColor.a *= alphaMultiplier * edgeGlow() * line_dash_func() * mix(alphaFade, 1.0, fIndexU);\n\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\tgl_FragDepthEXT = log_depth_frag;\n\t\t\t\t#endif\n\t\t\t}\n\t\t\t"}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class Scene extends s.CollectionItem{constructor(t,e,i){super(t,e,i),this._entities=new s.Collection(this,new Map([["entity",s.Entity]])),this._controllerDependencyGraph=new s.DependencyGraph,this._ambientLightColor=new s.Color(.02,.02,.02),this._ambientLightColor.freeze(),this._lightSources=[],this._threeJsScene=null,this._threeJsScene=new s.THREE.Scene,this._controllerDependencyGraph.setUpdateItemCallback((function(t){t.getEntity().isEnabled()&&t.getCoverage().contains(t.getEntity().getScene().getEngine().getTime())&&t.isEnabled()&&t.__update()})),this._controllerDependencyGraph.setCompareItemCallback((function(t,e){if(t===e)return!1;if(!(t.getEntity().isEnabled()&&e.getEntity().isEnabled()&&t.isEnabled()&&e.isEnabled()))return!1;const i=t.getEntity().getScene().getEngine().getTime();if(!t.getCoverage().contains(i)||!e.getCoverage().contains(i))return!1;if(t.getEntity()===e.getEntity()){const i=t.getEntity();for(let s=0,n=i.getNumControllers();s<n;s++){const n=i.getController(s);if(e===n)return!0;if(t===n)break}}if(t.getEntity().getParent()===e.getEntity()){if(t.hasModifiedState("position")&&e.hasModifiedState("position")||t.hasModifiedState("velocity")&&e.hasModifiedState("velocity"))return!0;for(const i of e.__modifiedStates)if(t.hasDependentState("parent",i))return!0}for(const i of e.__modifiedStates)if(t.hasDependentState(e.getEntity().getName(),i))return!0;return!1}))}getEngine(){return this.__getCollectionParent()}getEntity(t){return this._entities.get(t)}getNumEntities(){return this._entities.size}addEntity(t){return this._entities.add("entity",t)}removeEntity(t){this._entities.remove(t)}get(t,e,i=0){const s=this._entities.get(t);return void 0===e||null===s?s:s.get(e,i)}getControllerDependencyGraph(){return this._controllerDependencyGraph}getAmbientLightColor(){return this._ambientLightColor}setAmbientLightColor(t){this._ambientLightColor.thaw(),this._ambientLightColor.copy(t),this._ambientLightColor.freeze()}__addLightSource(t,e=0){for(let i=0,s=this._lightSources.length;i<s;i++){const s=this._lightSources[i];if(s.getEntityName()===t&&s.getComponentTypeIndex()===e)throw new Error(`Light source on ${t} with type index ${e} already added.`)}const i=new s.ComponentRef(this);i.setByType(t,"lightSource",e),this._lightSources.push(i)}__removeLightSource(t,e=0){for(let i=0,s=this._lightSources.length;i<s;i++){const s=this._lightSources[i];if(s.getEntityName()===t&&s.getComponentTypeIndex()===e)return void this._lightSources.splice(i,1)}throw new Error(`Light source on ${t} with type index ${e} not found.`)}getLightSource(t){return 0<=t&&t<this._lightSources.length?this._lightSources[t].get():null}getNumLightSources(){return this._lightSources.length}getLoadedPromise(){const t=[];for(let e=0,i=this._entities.size;e<i;e++)t.push(this._entities.get(e).getLoadedPromise());return Promise.all(t).then()}__destroy(){super.__destroy(),this._entities.__destroy()}getThreeJsScene(){return this._threeJsScene}__update(){const t=this.getEngine().getTime();for(let e=this._entities.size-1;e>=0;e--){const i=this._entities.get(e);i.__updateParent(t),i.__updateIsInCoverages(t)}this._controllerDependencyGraph.update()}__updateVisuals(){for(let t=this._entities.size-1;t>=0;t--){const e=this._entities.get(t);e.isInPositionCoverage()&&e.isEnabled()&&this._entities.get(t).__updateVisuals()}}__removeCameraDependents(t){for(let e=this._entities.size-1;e>=0;e--)this._entities.get(e).__removeCameraDependents(t)}}const n=Scene},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);class TextureLoader extends s.THREE.Loader{constructor(t,e){super(),this._downloader=t,this._renderer=e,this._crossOrigin="anonymous",this._path=void 0,this._white=null,this._black=null,this._clear=null,this._pink=null,this._gray=null,this._threeJsTextureLoader=new s.THREE.TextureLoader,this._threeJsTextureLoader.setCrossOrigin(this._crossOrigin),this._threeJsTextureLoader.setPath(this._path),this._white=TextureLoader._newTexture(new s.Color(1,1,1,1)),this._black=TextureLoader._newTexture(new s.Color(0,0,0,1)),this._clear=TextureLoader._newTexture(new s.Color(0,0,0,0)),this._pink=TextureLoader._newTexture(new s.Color(1,105/255,180/255,1)),this._gray=TextureLoader._newTexture(new s.Color(.4,.4,.4,1)),s.THREE.DefaultLoadingManager.addHandler(/.$/i,this)}async loadIntoUniform(t,e,i){return this.loadTexture(e,i).then((e=>{null!==t.value&&t.value.dispose(),t.value=e}))}async loadCubeTexture(t,e){const i=new s.THREE.CubeTexture,r=[];for(let s=0;s<6;s++){const o=t.replace("$FACE",n[s]);r.push(new Promise((t=>{this.loadTexture(o,e).then((e=>{i.images[s]=e.image,t()}))})))}return Promise.all(r).then((()=>(i.needsUpdate=!0,i)))}async loadTexture(t,e){return new Promise(((i,s)=>{this.load(t,(t=>{i(t)}),void 0,(e=>{s(new Error(`Failed to load ${t}: ${e}`))}),e)}))}generateEnvMap(t){let e=t;if(!(t instanceof s.THREE.CubeTexture)){const i={depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!0,minFilter:s.THREE.LinearMipMapLinearFilter,magFilter:s.THREE.LinearFilter};e=new s.THREE.WebGLCubeRenderTarget(512,i).fromEquirectangularTexture(this._renderer,t).texture}const i=new s.THREE.PMREMGenerator(this._renderer);i.compileEquirectangularShader();return i.fromEquirectangular(e).texture}load(t,e,i,n,r){t=this._downloader.processUrl(t);let o=null;if("white"===t?o=this._white:"black"===t?o=this._black:"clear"===t?o=this._clear:"pink"===t?o=this._pink:"gray"===t&&(o=this._gray),null!==o)e(o);else if(t.includes(".mp4")){const i=document.createElement("video");i.src=t,i.muted=!0,i.playsInline=!0,i.autoplay=!0,i.loop=!1,i.crossOrigin="anonymous",i.play(),o=new s.THREE.VideoTexture(i),o.format=s.THREE.RGBAFormat,o.flipY=!1,o.needsUpdate=!0,i.onplaying=()=>{e(o)},i.onerror=t=>{n(t.toString())}}else this._threeJsTextureLoader.load(t,(t=>{t.flipY=!1,!1===r&&(t.minFilter=s.THREE.LinearFilter,t.generateMipmaps=!1),t.needsUpdate=!0,e(t)}),void 0,(t=>{n(t.message)}));return o}get crossOrigin(){return this._crossOrigin}set crossOrigin(t){this._crossOrigin=t,this._threeJsTextureLoader&&this._threeJsTextureLoader.setCrossOrigin(this._crossOrigin)}setCrossOrigin(t){return this.crossOrigin=t,this}get path(){return this._path}set path(t){this._path=t,this._threeJsTextureLoader&&this._threeJsTextureLoader.setPath(this._path)}setPath(t){return this.path=t,this}static _newTexture(t){const e=document.createElement("canvas");e.width=1,e.height=1;const i=e.getContext("2d");return i.fillStyle="rgba("+255*t.r+","+255*t.g+","+255*t.b+","+255*t.a+")",i.fillRect(0,0,1,1),new s.THREE.CanvasTexture(e)}}const n=["posx","negx","posy","negy","posz","negz"],r=TextureLoader},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class TextureLoaderCompressed extends s.TextureLoader{constructor(t,e,i){super(t,i),this._config=e,this._threeJsKTXLoader=new s.ThreeJsKTXLoader,this._threeJsKTXLoader.setCrossOrigin(this._crossOrigin),this._threeJsKTXLoader.setPath(this._path)}load(t,e,i,n,r){if(null!==t.match(/_n\.[^.]+$/))return super.load(t,e,i,n,r);let o=null;return"white"===(t=this._downloader.processUrl(t))?o=this._white:"black"===t?o=this._black:"clear"===t?o=this._clear:"pink"===t&&(o=this._pink),null!==o?e(o):(t=t.replace(/\.(\w+)$/,"-"+s.Capabilities.__getCompressedTextureExtension()+".ktx"),this._threeJsKTXLoader.load(t,(t=>{t.flipY=!1,t.needsUpdate=!0,!1===r&&(t.minFilter=s.THREE.LinearFilter,t.generateMipmaps=!1),t.ktxFormat=t.format,e(t)}),void 0,(t=>{n(t.message)}))),o}}const n=TextureLoaderCompressed},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s="44.0.0"},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class Viewport extends s.CollectionItem{constructor(t,e,i){super(t,e,i),this._enabled=!0,this._camera=null,this._div=document.createElement("div"),this._bounds=new s.Rect(0,0,0,0),this._bounds.freeze(),this._backgroundColor=new s.Color(0,0,0,1),this._backgroundColor.freeze(),this._threeJsBackgroundColor=new s.THREE.Color,this._div.style.position="absolute",this._div.style.overflow="hidden",this._div.id=e||"",this._div.classList.add("viewport"),this._enabled||(this._div.style.display="none"),this.getEngine().getViewportDiv().appendChild(this._div);const n=this.getEngine().getRootDiv();this._bounds.thaw(),this._bounds.set(this._div.offsetLeft-n.offsetLeft,this._div.offsetTop-n.offsetTop,this._div.offsetWidth,this._div.offsetHeight),this._bounds.freeze();const r=this.getEngine().getInput();null===r.getActiveViewport()&&r.__setActiveViewport(this)}getEngine(){return this.__getCollectionParent()}getDiv(){return this._div}getBounds(){return this._bounds}getBackgroundColor(){return this._backgroundColor}setBackgroundColor(t){this._backgroundColor.thaw(),this._backgroundColor=t,this._backgroundColor.freeze(),this._threeJsBackgroundColor.setRGB(this._backgroundColor.r,this._backgroundColor.g,this._backgroundColor.b)}getCamera(){return this._camera}setCamera(t){this._camera=t,null!==this._camera&&this._camera.__setViewport(this)}isEnabled(){return this._enabled}setEnabled(t){this._enabled=t,this._enabled?this._div.style.display="block":this._div.style.display="none"}getNormalSpacePositionFromPixelSpacePosition(t,e){t.x=2*(e.x-this._bounds.origin.x)/this._bounds.size.x-1,t.y=1-2*(e.y-this._bounds.origin.y)/this._bounds.size.y,t.z=1}getPixelSpacePositionFromNormalSpacePosition(t,e){-1<e.z&&e.z<1?(t.x=this._bounds.size.x*(e.x+1)/2+this._bounds.origin.x,t.y=this._bounds.size.y*(1-e.y)/2+this._bounds.origin.y):t.copy(s.Vector2.NaN)}getPixelSpaceRadiusFromNormalSpaceRadius(t){return t*Math.max(this._bounds.size.x,this._bounds.size.y)}getNormalSpaceRadiusFromPixelSpaceRadius(t){return t/Math.max(this._bounds.size.x,this._bounds.size.y)}__destroy(){super.__destroy(),this._div.parentNode.removeChild(this._div)}__updateViewportVariables(){this._enabled&&(this._bounds.thaw(),this._bounds.set(this._div.offsetLeft,this._div.offsetTop,this._div.offsetWidth,this._div.offsetHeight),this._bounds.freeze(),null!==this._camera&&this._camera.__updateCameraVariablesForConnectedScene())}__render(){if(!this._enabled)return;const t=this.getEngine().__getThreeJsRenderer(),e=this.getEngine().getRootDiv().offsetHeight-this._div.offsetTop-this._div.offsetHeight;t.setViewport(this._bounds.origin.x,e,this._bounds.size.x,this._bounds.size.y),t.setScissor(this._bounds.origin.x,e,this._bounds.size.x,this._bounds.size.y),this._threeJsBackgroundColor.setRGB(this._backgroundColor.r,this._backgroundColor.g,this._backgroundColor.b),t.setClearColor(this._threeJsBackgroundColor,this._backgroundColor.a),null!==this._camera?(this._camera.__prepareForRender(),this._camera.__render()):this.getEngine().__getThreeJsRenderer().clear()}}const n=Viewport},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class BaseComponent extends s.EntityItem{constructor(t,e,i){super(t,e,i),this._radius=.5,this._pixelSpaceRadiusPerCamera=new s.FastMap,this._greatestPixelSpaceRadius=0,this._loadState="unloaded",this._forceLoaded=!1,this._resourcesLoadedCallback=null,this._resourcesUnloadedCallback=null,this._loadedPromise=Promise.resolve(),this._excludedCameras=new Set,this._threeJsObjects=[],this._threeJsMaterials=[],this._usesEntityOrientation=!1}__destroy(){"loaded"===this._loadState&&this._unloadResources(),super.__destroy()}setEnabled(t){super.setEnabled(t),this.__updateLoadState()}getRadius(){return this._radius}__setRadius(t){this._radius=t}getPixelSpaceRadiusInCamera(t){return this._pixelSpaceRadiusPerCamera.get(t)}getGreatestPixelSpaceRadius(){return this._greatestPixelSpaceRadius}getThreeJsObjects(){return this._threeJsObjects}getThreeJsMaterials(){return this._threeJsMaterials}getThreeJsObjectByName(t){for(let e=0;e<this._threeJsObjects.length;e++){const i=this._threeJsObjects[e];if(i.name===t)return i}return null}getLoadState(){return this._loadState}setForceLoaded(t){this._forceLoaded=t,this._forceLoaded&&"unloaded"===this._loadState&&this._loadResources()}__updateLoadState(){const t=this.getEntity(),e=t.isEnabled()&&this.isEnabled(),i=t.isInPositionCoverage()&&(t.isInOrientationCoverage()||!this._usesEntityOrientation);e&&(this._forceLoaded||i&&this._greatestPixelSpaceRadius>.5)&&"unloaded"===this._loadState?this._loadResources():e&&(this._forceLoaded||i&&!(this._greatestPixelSpaceRadius<.25))||"loaded"!==this._loadState||this._unloadResources()}resetResources(){"loading"===this._loadState?this._loadState="unloaded":"loaded"===this._loadState&&this._unloadResources()}setResourcesLoadedCallback(t){this._resourcesLoadedCallback=t}setResourcesUnloadedCallback(t){this._resourcesUnloadedCallback=t}_loadResources(){this._loadState="loading",this._loadedPromise=this.__loadResources().then((()=>{"loading"===this._loadState?(this._loadState="loaded",null!==this._resourcesLoadedCallback&&this._resourcesLoadedCallback()):this._unloadResources()}))}_unloadResources(){this.__unloadResources(),this._loadState="unloaded",this._threeJsObjects=[],this._threeJsMaterials=[],null!==this._resourcesUnloadedCallback&&this._resourcesUnloadedCallback()}__loadResources(){return Promise.resolve()}__unloadResources(){}getLoadedPromise(){return this._loadedPromise}__updateCameraVariablesBase(t){const e=t.getViewport(),i=t.getNormalSpaceRadiusFromRadius(this._radius,this.getEntity().getCameraSpacePosition(t).magnitude()),s=e.getPixelSpaceRadiusFromNormalSpaceRadius(i);this._pixelSpaceRadiusPerCamera.set(t,s),this.__updateCameraVariables(t)}__updateBase(){this._greatestPixelSpaceRadius=0;for(let t=0,e=this._pixelSpaceRadiusPerCamera.size;t<e;t++){const e=this._pixelSpaceRadiusPerCamera.getAt(t).value;this._greatestPixelSpaceRadius<e&&(this._greatestPixelSpaceRadius=e)}this.__updateLoadState(),this.__update()}__prepareForRenderBase(t){if("loaded"===this._loadState)if(this._excludedCameras.has(t))for(let t=0;t<this._threeJsObjects.length;t++)this._threeJsObjects[t].visible=!1;else{for(let t=0;t<this._threeJsObjects.length;t++)this._threeJsObjects[t].visible=!0;if(this.__prepareForRender(t),!s.Capabilities.hasFragDepth())for(let e=0;e<this._threeJsMaterials.length;e++){const i=this._threeJsMaterials[e].uniforms;void 0!==i.nearDistance&&(i.nearDistance.value=t.getAutoNearDistance(),i.midDistance.value=t.getAutoMidDistance())}for(let t=0;t<this._threeJsObjects.length;t++)this._threeJsObjects[t].updateMatrix()}}__updateCameraVariables(t){}__prepareForRender(t){}getUsesEntityOrientation(){return this._usesEntityOrientation}__setUsesEntityOrientation(t){this._usesEntityOrientation=t,this.__updateLoadState()}isExcludedFromCamera(t){return this._excludedCameras.has(t)}setExcludedFromCamera(t,e){!e&&this._excludedCameras.has(t)?this._excludedCameras.delete(t):e&&!this._excludedCameras.has(t)&&(this.__removeCameraDependents(t),this._excludedCameras.add(t))}__removeCameraDependentsBase(t){this._pixelSpaceRadiusPerCamera.delete(t),this.__removeCameraDependents(t)}__clearCameraDependentsBase(){this._pixelSpaceRadiusPerCamera.clear(),this.__clearCameraDependents()}__removeCameraDependents(t){}__clearCameraDependents(){}toString(){let t=0;for(let e=0,i=this.getEntity().getNumComponents();e<i;e++){const i=this.getEntity().getComponent(e);if(this===i)break;this.getType()===i.getType()&&(t+=1)}return this.getEntity().getName()+"."+this.getType()+"."+t}}BaseComponent._tempThreeJsQuaternion=new s.THREE.Quaternion;const n=BaseComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(3);class AtmosphereComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._density=0,this._scaleHeight=1,this._emissivity=0,this._color=new s.Color,this._color.freeze(),this._sunBrightness=1,this._sunsetColor=new s.Color,this._sunsetColor.freeze(),this._sunsetIntensity=0,this._spheroidComponentRef=new s.ComponentRef(this.getEntity().getScene()),this._spheroidComponentRef.setByType(this.getEntity().getName(),"spheroid"),this._spheroidComponentRef.setRefChangedCallback(this._spheroidRefChangedCallback.bind(this)),this._spheroidChangedCallback=this._spheroidChangedCallback.bind(this),this.__setUsesEntityOrientation(!0)}getSpheroid(){return this._spheroidComponentRef.get()}getDensity(){return this._density}setDensity(t){this._density=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"density",t)}getScaleHeight(){return this._scaleHeight}setScaleHeight(t){this._scaleHeight=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"scaleHeight",t)}getEmissivity(){return this._emissivity}setEmissivity(t){this._emissivity=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"emissivity",t)}getColor(){return this._color}setColor(t){this._color.thaw(),this._color.copy(t),this._color.freeze(),s.ThreeJsHelper.setUniformColorRGB(this.getThreeJsMaterials()[0],"color",t)}getSunBrightness(){return this._sunBrightness}setSunBrightness(t){this._sunBrightness=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"sunBrightness",t)}getSunsetColor(){return this._sunsetColor}setSunsetColor(t){this._sunsetColor.thaw(),this._sunsetColor.copy(t),this._sunsetColor.freeze(),s.ThreeJsHelper.setUniformColorRGB(this.getThreeJsMaterials()[0],"sunsetColor",t)}getSunsetIntensity(){return this._sunsetIntensity}setSunsetIntensity(t){this._sunsetIntensity=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"sunsetIntensity",t)}setSpheroidReference(t){"string"==typeof t?this._spheroidComponentRef.setByName(this.getEntity().getName(),t):this._spheroidComponentRef.setByType(this.getEntity().getName(),"spheroid",t)}__destroy(){const t=this._spheroidComponentRef.get();null!==t&&t.removeChangedCallback(this._spheroidChangedCallback),super.__destroy()}__update(){this._spheroidComponentRef.update()}__prepareForRender(t){const e=s.Vector3.pool.get();e.neg(this.getEntity().getCameraSpacePosition(t)),e.rotateInverse(this.getEntity().getOrientation(),e),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"cameraPosition",e),s.Vector3.pool.release(e),s.MaterialUtils.setLightSourceUniforms(this.getThreeJsMaterials(),this.getEntity(),t),s.ThreeJsHelper.setUniformQuaternion(this.getThreeJsMaterials()[0],"entityOrientation",this.getEntity().getOrientation()),s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects()[0],this.getEntity()),s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t)}__loadResources(){const t=new s.THREE.RawShaderMaterial({uniforms:{lightPositions:new s.THREE.Uniform([new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0)]),lightColors:new s.THREE.Uniform([new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0)]),lightRadii:new s.THREE.Uniform([0,0,0,0,0]),numLights:new s.THREE.Uniform(0),density:new s.THREE.Uniform(this._density),scaleHeight:new s.THREE.Uniform(this._scaleHeight),emissivity:new s.THREE.Uniform(this._emissivity),equatorialRadius:new s.THREE.Uniform(1),polarRadius:new s.THREE.Uniform(1),cameraPosition:new s.THREE.Uniform(new s.THREE.Vector3(1,0,0)),entityOrientation:new s.THREE.Uniform(new s.THREE.Vector4(1,0,0,0)),color:new s.THREE.Uniform(new s.THREE.Vector3(this._color.r,this._color.g,this._color.b)),sunBrightness:new s.THREE.Uniform(this._sunBrightness),sunsetColor:new s.THREE.Uniform(new s.THREE.Vector3(this._sunsetColor.r,this._sunsetColor.g,this._sunsetColor.b)),sunsetIntensity:new s.THREE.Uniform(this._sunsetIntensity),nearDistance:new s.THREE.Uniform(0),midDistance:new s.THREE.Uniform(0)},vertexShader:s.ShaderFix.fix(n,"vertex"),fragmentShader:s.ShaderFix.fix(r,"fragment"),transparent:!0,depthWrite:!1,blending:s.THREE.NormalBlending});this.getThreeJsMaterials().push(t);const e=s.ThreeJsHelper.createMeshObject(this,t,[{name:"position",dimensions:3}],!1);this.getThreeJsObjects().push(e);const i=128,o=s.MathUtils.pi/63,a=s.MathUtils.twoPi/i,l=new Float32Array(24768),h=new Uint16Array(48384),c=s.Vector3.pool.get(),d=s.LatLonAlt.pool.get();for(let t=0;t<64;t++){d.lat=t*o-s.MathUtils.halfPi,d.alt=0;const e=Math.cos(d.lat),n=Math.sin(d.lat);for(let r=0;r<129;r++){d.lon=r*a-s.MathUtils.pi;const o=129*t+r;l[3*o+0]=e*Math.cos(d.lon),l[3*o+1]=e*Math.sin(d.lon),l[3*o+2]=n;const c=t*i+r;t<63&&r<i&&(h[6*c+0]=129*(t+0)+(r+0),h[6*c+1]=129*(t+1)+(r+0),h[6*c+2]=129*(t+1)+(r+1),h[6*c+3]=129*(t+0)+(r+0),h[6*c+4]=129*(t+1)+(r+1),h[6*c+5]=129*(t+0)+(r+1))}}return s.LatLonAlt.pool.release(d),s.Vector3.pool.release(c),s.ThreeJsHelper.setVertices(e.geometry,"position",l),s.ThreeJsHelper.setIndices(e.geometry,h),s.ThreeJsHelper.setRenderOrder(e,-1),s.ThreeJsHelper.useInDynEnvMap(e,!0),this._spheroidChangedCallback(),Promise.resolve()}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this)}_spheroidRefChangedCallback(t,e){null!==t&&t.removeChangedCallback(this._spheroidChangedCallback),null!==e&&e.addChangedCallback(this._spheroidChangedCallback),this._spheroidChangedCallback()}_spheroidChangedCallback(){const t=this._spheroidComponentRef.get(),e=this.getThreeJsMaterials()[0];null!==t?(this.__setRadius(Math.max(t.getEquatorialRadius(),t.getPolarRadius())),void 0!==e&&(s.ThreeJsHelper.setUniformNumber(e,"equatorialRadius",t.getEquatorialRadius()),s.ThreeJsHelper.setUniformNumber(e,"polarRadius",t.getPolarRadius()))):(this.__setRadius(0),void 0!==e&&(s.ThreeJsHelper.setUniformNumber(e,"equatorialRadius",0),s.ThreeJsHelper.setUniformNumber(e,"polarRadius",0)))}}const n="\n\tattribute vec3 position;\n\tuniform mat4 projectionMatrix;\n\tuniform mat4 modelViewMatrix;\n\n\tuniform float scaleHeight;\n\tuniform float equatorialRadius;\n\tuniform float polarRadius;\n\n\t#ifdef L_EXT_frag_depth\n\t\tvarying float fragDepth;\n\t#else\n\t\tuniform float nearDistance;\n\t\tuniform float midDistance;\n\t#endif\n\n\tvarying vec3 localPosition;\n\n\tvoid main() {\n\t\tfloat scaleHeightMultiplier = 20.0;\n\t\tlocalPosition = vec3(position.x * (equatorialRadius + scaleHeight * scaleHeightMultiplier), position.y * (equatorialRadius + scaleHeight * scaleHeightMultiplier), position.z * (polarRadius + scaleHeight * scaleHeightMultiplier));\n\t\tvec4 viewPosition = modelViewMatrix * vec4(localPosition, 1.);\n\t\tgl_Position = projectionMatrix * viewPosition;\n\t\tgl_Position.w = viewPosition.y;\n\n\t\t#ifdef L_EXT_frag_depth\n\t\t\tfragDepth = gl_Position.w;\n\t\t#else\n\t\t\tfloat z = gl_Position.w;\n\t\t\tif (z < midDistance) {\n\t\t\t\tgl_Position.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\n\t\t\t\tgl_Position.z = log2(z - midDistance + 1.0) * logFactor;\n\t\t\t\tgl_Position.z *= gl_Position.w;\n\t\t\t}\n\t\t#endif\n\t}",r="\n\tuniform vec3 lightPositions[5];\n\tuniform vec3 lightColors[5];\n\tuniform int numLights;\n\n\tuniform float density;\n\tuniform float scaleHeight;\n\tuniform float equatorialRadius;\n\tuniform float polarRadius;\n\tuniform vec3 cameraPosition;\n\tuniform vec4 entityOrientation;\n\tuniform vec3 color;\n\tuniform float emissivity;\n\tuniform float sunBrightness;\n\tuniform vec3 sunsetColor;\n\tuniform float sunsetIntensity;\n\n\t#ifdef L_EXT_frag_depth\n\t\tuniform mat4 projectionMatrix;\n\t\tvarying float fragDepth;\n\t#endif\n\n\tvarying vec3 localPosition;\n\n\tconst int numIterations = 5;\n\n\t// Inverse rotate a vector by a quaternion.\n\tvec3 quatRotInv(vec4 q, vec3 v) {\n\t\tfloat tx = q.w * v.x - q.y * v.z + q.z * v.y;\n\t\tfloat ty = q.w * v.y - q.z * v.x + q.x * v.z;\n\t\tfloat tz = q.w * v.z - q.x * v.y + q.y * v.x;\n\t\tfloat tw = q.x * v.x + q.y * v.y + q.z * v.z;\n\t\tfloat x = tx * q.w + tw * q.x + ty * q.z - tz * q.y;\n\t\tfloat y = ty * q.w + tw * q.y + tz * q.x - tx * q.z;\n\t\tfloat z = tz * q.w + tw * q.z + tx * q.y - ty * q.x;\n\t\treturn vec3(x, y, z);\n\t}\n\n\t// Given an origin and direction, computes the sampling start and end as distance from the origin in the direction.\n\tvoid getStartEndSamples(out float start, out float end, vec3 origin, vec3 direction, float maxDistance, float groundRadius, float atmosphereScaleHeight) {\n\t\t// Get the along the ray perpendicular to the sphere.\n\t\tfloat perpD = -dot(origin, direction);\n\t\tvec3 perp = origin + direction * perpD;\n\n\t\t// Figure out the sample distance.\n\t\tfloat atmosphereRadius = groundRadius + atmosphereScaleHeight * 6.0;\n\t\tfloat chordHalfLength = sqrt(max(0.0, atmosphereRadius * atmosphereRadius - dot(perp, perp)));\n\n\t\t// Figure out starting and ending sample points, and step distance.\n\t\tstart = max(0.0, perpD - chordHalfLength);\n\t\tend = min(maxDistance, perpD + chordHalfLength);\n\t}\n\n\t// Gets the density of the atmosphere at a given position.\n\tfloat getDensity(vec3 position, float radius, float density, float atmosphereScaleHeight) {\n\t\treturn density * exp(min(radius - length(position), 0.0) / atmosphereScaleHeight);\n\t}\n\n\t// Returns 0 if the ray does not intersect and 1.0 if the ray very intersects (with a gradient inbetween).\n\tfloat getDayLevel(vec3 origin, vec3 direction, float radius, float scaleHeight) {\n\t\tfloat blendHeight = scaleHeight * radius / 200.0;\n\t\tfloat perpD = -dot(origin, direction);\n\t\tfloat depth = radius - sqrt(dot(origin, origin) - sign(perpD) * perpD * perpD);\n\t\tif (depth < 0.0) { // day\n\t\t\treturn 1.0 - max(0.0, 0.25 * depth / blendHeight + 0.25);\n\t\t}\n\t\telse { // night\n\t\t\treturn 1.0 - min(1.0, 0.75 * depth / blendHeight + 0.25);\n\t\t}\n\t}\n\n\tfloat easeInOut(float x, float sharpness) {\n\t\tfloat b = sharpness;\n\t\tif (x < 0.5) {\n\t\t\treturn max(0.0, (pow(b, 2.0 * x) - 1.0) / (2.0 * (b - 1.0)));\n\t\t}\n\t\telse {\n\t\t\treturn min(1.0, 1.0 - (pow(b, 2.0 * (1.0 - x)) - 1.0) / (2.0 * (b - 1.0)));\n\t\t}\n\t}\n\n\tvec3 adjustOverbrightness(vec3 color) {\n\t\tfloat maxColor = max(color.r, max(color.g, color.b));\n\t\tif (maxColor > 1.0) {\n\t\t\tfloat f = (maxColor - 1.0) / maxColor;\n\t\t\tcolor.r = min(1.0, pow(color.r / maxColor, 1.0 / maxColor));\n\t\t\tcolor.g = min(1.0, pow(color.g / maxColor, 1.0 / maxColor));\n\t\t\tcolor.b = min(1.0, pow(color.b / maxColor, 1.0 / maxColor));\n\t\t}\n\t\treturn color;\n\t}\n\n\t// Calculates a glow around the light direction (the star).\n\tfloat glow(float spread, float amount, float lightDotCamera) {\n\t\treturn amount * spread / (1.0 + spread - lightDotCamera);\n\t}\n\n\t// Gets the color for an atmosphere.\n\tvec4 getColor(float totalDensity, vec3 lightColor, vec3 lightPosition, float spheroidRatio, vec3 positionS, vec3 cameraPositionS, vec3 cameraToPositionUnit) {\n\t\t// The color that will be added onto gl_FragColor.\n\t\tvec4 outColor;\n\n\t\t// Apply the total density to the transparency of the atmosphere.\n\t\toutColor.a = clamp(totalDensity, 0.0, 1.0);\n\n\t\t// Multiply it all together with the source light color.\n\t\toutColor.rgb = lightColor * color * clamp(pow(15.0 * totalDensity / (density * equatorialRadius), 0.2), 0.75, 1.0);\n\n\t\t// Make it more opaque when lower down.\n\t\toutColor.a = mix(outColor.a, 1.0, getDensity(cameraPositionS, equatorialRadius + scaleHeight, 1.0, 2.0 * scaleHeight));\n\n\t\t// Make the alpha dependent on the brightness of the light.\n\t\toutColor.a *= length(lightColor) / sqrt(3.0);\n\n\t\t// Clamp it to make it clean for the day/night transition.\n\t\toutColor.a = clamp(outColor.a, 0.0, 1.0);\n\n\t\thighp vec3 lightPositionS = quatRotInv(entityOrientation, lightPosition);\n\t\tlightPositionS.z *= spheroidRatio;\n\n\t\thighp vec3 lightToPosition = positionS - lightPositionS;\n\t\thighp vec3 lightToPositionUnit = normalize(lightToPosition / 1.0e8);\n\n\t\t// Get the day level, from 0 to 1, and apply it to the alpha. Lots of tricks to get it looking good on earth.\n\t\tvec3 dayRefUp = normalize(cameraPositionS - min(0.0, dot(cameraPositionS, cameraToPositionUnit)) * cameraToPositionUnit);\n\t\tfloat dayLevel = -dot(lightToPositionUnit, dayRefUp);\n\t\toutColor.rgb *= mix(emissivity, 1.0, easeInOut(0.5 + 2.0 * dayLevel, 2.0));\n\t\toutColor.a *= mix(emissivity, 1.0, easeInOut(1.0 + 2.0 * dayLevel, 2.0));\n\n\t\t// Brighten up the atmosphere when looking from space toward the sun.\n\t\tfloat lightDotCamera = max(0.0, -dot(lightToPositionUnit, cameraToPositionUnit));\n\t\toutColor.a = clamp(outColor.a * (1.0 + glow(0.004, 1.0, lightDotCamera)), 0.0, 1.0);\n\n\t\t// Add narrower sun glare.\n\t\toutColor.rgb *= lightColor * (1.0 + sunBrightness * outColor.a * glow(0.00004, 1.0, lightDotCamera));\n\n\t\t// Add broader sun glare.\n\t\toutColor.rgb *= lightColor * (1.0 + sunBrightness * outColor.a * glow(0.04, 0.125, lightDotCamera));\n\n\t\t// Apply the sunset.\n\t\tfloat lightDotHorizon = pow(clamp(1.0 - dot(lightToPositionUnit, dayRefUp), 0.0, 1.0), 2.0);\n\t\tfloat cameraDotHorizon = pow(clamp(1.0 - dot(cameraToPositionUnit, dayRefUp), 0.0, 1.0), 8.0);\n\t\tfloat sunsetAmount = sunsetIntensity * lightDotHorizon * cameraDotHorizon * glow(0.04, 0.5, lightDotCamera);\n\t\toutColor.rgb = mix(outColor.rgb, sunsetColor, clamp(sunsetAmount, 0.0, 1.0));\n\n\t\treturn outColor;\n\t}\n\n\tvoid main(void) {\n\t\t// Convert everything into a sphere frame.\n\t\tfloat spheroidRatio = equatorialRadius / polarRadius;\n\t\thighp vec3 positionS = localPosition;\n\t\thighp vec3 cameraPositionS = cameraPosition;\n\t\tpositionS.z *= spheroidRatio;\n\t\tcameraPositionS.z *= spheroidRatio;\n\n\t\thighp vec3 cameraToPosition = positionS - cameraPositionS;\n\t\thighp float cameraToPositionDist = length(cameraToPosition / 1.0e8) * 1.0e8;\n\t\thighp vec3 cameraToPositionUnit = cameraToPosition / cameraToPositionDist;\n\n\t\t// Get the start and end of the sampling from the camera to the position.\n\t\tfloat start;\n\t\tfloat end;\n\t\tgetStartEndSamples(start, end, cameraPositionS, cameraToPositionUnit, 1.0e24, equatorialRadius, scaleHeight);\n\t\tfloat step = 1.0 / float(numIterations - 1);\n\t\tfloat stepDist = step * (end - start);\n\n\t\t// Do the sampling.\n\t\tfloat totalDensity = 0.0;\n\t\tfloat segmentStart = start;\n\t\tfor (int j = 0; j < numIterations; j++) {\n\t\t\t// Get the distance that this segment covers.\n\t\t\tfloat segDist = stepDist;\n\t\t\tif (j == 0 || j == numIterations - 1) {\n\t\t\t\tsegDist *= 0.5;\n\t\t\t}\n\n\t\t\t// Get the segment start that we're looking at.\n\t\t\tvec3 p = cameraPositionS + segmentStart * cameraToPositionUnit;\n\n\t\t\t// Get the density at that segment start. It'll be the density for the whole segment.\n\t\t\tfloat densityAtP = getDensity(p, equatorialRadius, density, scaleHeight);\n\n\t\t\t// Add it to the total density.\n\t\t\ttotalDensity += densityAtP * segDist;\n\n\t\t\t// Next step.\n\t\t\tsegmentStart += stepDist;\n\t\t}\n\n\t\t// For each light,\n\t\tfor (int i = 0; i < 5; i++) {\n\t\t\tif (i >= numLights) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// If it's not a camera light,\n\t\t\tif (length(lightPositions[i]) > 0.0) {\n\t\t\t\t// Add on the color for the light.\n\t\t\t\tgl_FragColor += getColor(totalDensity, lightColors[i], lightPositions[i], spheroidRatio, positionS, cameraPositionS, cameraToPositionUnit);\n\t\t\t}\n\t\t}\n\n\t\t// Adjust for values that are greater than one.\n\t\tgl_FragColor.rgb = adjustOverbrightness(gl_FragColor.rgb);\n\n\t\t// Log-Depth Buffering\n\t\t#ifdef L_EXT_frag_depth\n\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\n\t\t\tgl_FragDepthEXT = projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\n\t\t#endif\n\t}",o=AtmosphereComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class CameraComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._threeJsRenderer=this.getEntity().getScene().getEngine().__getThreeJsRenderer(),this._viewport=null,this._threeJsScene=i.getScene().getThreeJsScene(),this._fieldOfView=1.0471975512,this._nearDistance=void 0,this._autoNearDistance=0,this._midDistance=void 0,this._autoMidDistance=0,this._aspectRatio=1,this._renderSize=new s.Vector2,this._occludingEntities=[],this._threeJsCamera=new s.THREE.PerspectiveCamera(75,this._aspectRatio,.1,1e3),this._threeJsComposer=null,this._outlinePass=new s.ThreeJsOutlinePass(void 0,this._threeJsScene,this._threeJsCamera,[]),this._outlinePass.enabled=!1,this._threeJsUnrealBloomPass=new s.ThreeJsUnrealBloomPass(void 0,0,0,0),this._threeJsUnrealBloomPass.enabled=!1,this.__setupEffectComposer()}getViewport(){return this._viewport}getFieldOfView(){return this._fieldOfView}getHorizontalFieldOfView(){return this._aspectRatio>=1?this._fieldOfView:2*Math.atan(Math.tan(this._fieldOfView/2)*this._aspectRatio)}getVerticalFieldOfView(){return this._aspectRatio>1?2*Math.atan(Math.tan(this._fieldOfView/2)/this._aspectRatio):this._fieldOfView}setFieldOfView(t){this._fieldOfView=t}getNearDistance(){return this._nearDistance}setNearDistance(t){this._nearDistance=t}getAutoNearDistance(){return this._autoNearDistance}getMidDistance(){return this._midDistance}setMidDistance(t){this._midDistance=t}getAutoMidDistance(){return this._autoMidDistance}getNormalSpacePositionFromCameraSpacePosition(t,e){const i=s.Quaternion.pool.get();i.copy(this.getEntity().getOrientation()),i.inverse(i);const n=s.Vector3.pool.get();n.rotate(i,e),s.Quaternion.pool.release(i),t.x=this._threeJsCamera.projectionMatrix.elements[0]*n.x/n.y,t.y=this._threeJsCamera.projectionMatrix.elements[9]*n.z/n.y,t.z=this._threeJsCamera.projectionMatrix.elements[6]+this._threeJsCamera.projectionMatrix.elements[14]/n.y,s.Vector3.pool.release(n)}getNormalSpaceRadiusFromRadius(t,e){return t/e/Math.tan(this._fieldOfView/2)}getCameraSpacePositionFromNormalSpacePosition(t,e){const i=s.Vector3.pool.get();i.y=this._threeJsCamera.projectionMatrix.elements[14]/(e.z-this._threeJsCamera.projectionMatrix.elements[6]),i.x=e.x*i.y/this._threeJsCamera.projectionMatrix.elements[0],i.z=e.y*i.y/this._threeJsCamera.projectionMatrix.elements[9],t.rotate(this.getEntity().getOrientation(),i),s.Vector3.pool.release(i)}getRadiusFromNormalSpaceRadius(t,e){return t*e*Math.tan(this._fieldOfView/2)}isPositionOccluded(t){for(let e=0;e<this._occludingEntities.length;e++)if(this._occludingEntities[e].isOccludingPosition(this,t))return!0;return!1}getNearestIntersectingEntity(t){let e=Number.POSITIVE_INFINITY,i=null;const n=s.Interval.pool.get();for(let r=0;r<this._occludingEntities.length;r++){const o=this._occludingEntities[r].getCameraSpacePosition(this);if(s.Geometry.getLineSphereIntersectionWithLineStartAtOrigin(n,t,o,this._occludingEntities[r].getOcclusionRadius()),!Number.isNaN(n.min)&&n.min>=0){const t=n.min*o.magnitude();t<e&&(e=t,i=this._occludingEntities[r])}}return s.Interval.pool.release(n),i}setBloom(t){this._threeJsUnrealBloomPass.enabled=t>0,this._threeJsUnrealBloomPass.strength=t}setOutline(t,e,i){if(this._outlinePass.enabled=null!==e,null!==e){if(void 0!==i)this._outlinePass.selectedObjects=[e.getThreeJsObjectByName(i)];else{const t=e.getThreeJsObjects();this._outlinePass.selectedObjects=[];for(let e=0,i=t.length;e<i;e++)t[e].parent===this._threeJsScene&&this._outlinePass.selectedObjects.push(t[e])}this._outlinePass.visibleEdgeColor.setRGB(t.r,t.g,t.b),this._outlinePass.hiddenEdgeColor.setRGB(t.r/4,t.g/4,t.b/4)}this.__setupEffectComposer()}__addToOccludingEntities(t){for(let e=0;e<this._occludingEntities.length;e++)if(this._occludingEntities[e]===t)return;this._occludingEntities.push(t)}__destroy(){super.__destroy(),this.getEntity().getScene().__removeCameraDependents(this),null!==this._viewport&&this._viewport.setCamera(null)}__updateCameraVariablesForConnectedScene(){const t=this._viewport.getBounds().size;if(!t.equals(this._renderSize)){const e=t.x/t.y;this._aspectRatio!==e&&(this._aspectRatio=e),this._threeJsComposer.setSize(t.x,t.y),this._renderSize.copy(t)}s.Capabilities.hasFragDepth()||(void 0===this._midDistance?null!==this.getEntity().getParent()&&(this._autoMidDistance=this.getEntity().getPosition().magnitude()+10*this.getEntity().getParent().getExtentsRadius()):this._autoMidDistance=this._midDistance),void 0===this._nearDistance?null!==this.getEntity().getParent()?this._autoNearDistance=Math.max(1e-5,.01*(this.getEntity().getPosition().magnitude()-this.getEntity().getParent().getExtentsRadius())):this._autoNearDistance=Math.max(1e-5,.01*this.getEntity().getPosition().magnitude()):this._autoNearDistance=this._nearDistance,this._updateProjectionMatrix(),this.getEntity().__updateCameraVariables(this,null,!1);for(let t=0;t<this._occludingEntities.length;t++)(this._occludingEntities[t].getPixelSpaceOcclusionRadius(this)<1||!this._occludingEntities[t].isEnabled()||!this._occludingEntities[t].canOcclude()||null===this.getEntity().getScene().get(this._occludingEntities[t].getName()))&&(this._occludingEntities.splice(t,1),t--)}__prepareForRender(){const t=this.getEntity().getScene();for(let e=0;e<t.getNumEntities();e++){const i=t.getEntity(e);i.isEnabled()&&i.__prepareForRender(this)}const e=this.getEntity().get("dynEnvMap");null!==e&&e.__render()}__render(){const t=this.getEntity().getOrientation();CameraComponent._tempThreeJsQuaternion.set(t.x,t.y,t.z,t.w),this._threeJsCamera.setRotationFromQuaternion(CameraComponent._tempThreeJsQuaternion),this._threeJsComposer.render()}__setViewport(t){null!==this._viewport&&this._viewport!==t&&this._viewport.setCamera(null),this._viewport=t}__setupEffectComposer(){const t=new s.THREE.Vector2;this._threeJsRenderer.getSize(t);const e={samples:s.Capabilities.isWebGL2()&&!this._outlinePass.enabled?4:0},i=new s.THREE.WebGLRenderTarget(t.x,t.y,e);if(null!==this._threeJsComposer)this._threeJsComposer.reset(i);else{this._threeJsComposer=new s.ThreeJsEffectComposer(this._threeJsRenderer,i);const t=new s.ThreeJsRenderPass(this._threeJsScene,this._threeJsCamera);this._threeJsComposer.addPass(t),this._threeJsComposer.addPass(this._outlinePass),this._threeJsComposer.addPass(this._threeJsUnrealBloomPass)}}_updateProjectionMatrix(){if(this._fieldOfView>0&&this._fieldOfView<180&&this._aspectRatio>0){const t=Math.tan(this._fieldOfView/2);let e=0,i=0;this._aspectRatio>=1?(e=1/t,i=this._aspectRatio/t):(e=1/(t*this._aspectRatio),i=1/t);const n=Number.EPSILON-1,r=this._autoNearDistance*(2-Number.EPSILON),o=new s.THREE.Matrix4;o.set(e,0,0,0,0,0,i,0,0,n,0,r,0,1,0,0),this._threeJsCamera.projectionMatrix=o;const a=new s.THREE.Matrix4;a.set(1/e,0,0,0,0,0,0,1,0,1/i,0,0,0,0,1/r,-n/r),this._threeJsCamera.projectionMatrixInverse=a}}__loadResources(){return Promise.resolve()}__unloadResources(){}}const n=CameraComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class CMTSComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._threeJsScene=this.getEntity().getScene().getThreeJsScene(),this._endPoints=new s.FastMap,this._heightScale=1,this._numEndPointsLoading=0,this._minLevel=Number.NEGATIVE_INFINITY,this._maxLevel=Number.POSITIVE_INFINITY,this._tileOffsets=[],this._splitJoinThresholdFactor=512,this._colorTileSize=512,this._shadowEntities=[],this._engine=this.getEntity().getScene().getEngine(),this._cameraPositions=[],this._rootTiles=[null,null,null,null,null,null],this._tilesLoadedPromise=null,this._transitionsCompleteCallback=null,this._textureCache=new s.Cache((t=>this.getEntity().getScene().getEngine().getTextureLoader().loadTexture(t,!0)),(t=>{t.then((t=>{t.dispose()}))})),this._numLoadsThisFrame=0,this._atmosphereComponentRef=new s.ComponentRef(this.getEntity().getScene()),this._atmosphereComponentRef.setByType(this.getEntity().getName(),"atmosphere"),this._spheroidComponentRef=new s.ComponentRef(this.getEntity().getScene()),this._spheroidComponentRef.setByType(this.getEntity().getName(),"spheroid"),this._spheroidComponentRef.setRefChangedCallback(this._spheroidRefChangedCallback.bind(this)),this._spheroidChangedCallback=this._spheroidChangedCallback.bind(this),this.__setUsesEntityOrientation(!0)}setBaseUrl(t,e){this.resetResources(),this._endPoints.set(t,{url:e,configuration:null})}getHeightScale(){return this._heightScale}setHeightScale(t){this._heightScale=t,this.resetResources()}getMinLevel(){return this._minLevel}setMinLevel(t){this._minLevel=t}getMaxLevel(){return this._maxLevel}setMaxLevel(t){this._maxLevel=t}addTileOffset(t,e,i,n,r,o,a){this._tileOffsets.push({offset:t,face:e,level:i,min:new s.Vector2(n,r),max:new s.Vector2(o,a)}),this.resetResources()}removeTileOffset(t,e,i,s,n,r){for(let o=0;o<this._tileOffsets.length;o++){const a=this._tileOffsets[o];if(a.face===e&&a.level===t&&a.min.x===i&&a.min.y===s&&a.max.x===n&&a.max.y===r)return this._tileOffsets.splice(o,1),void this.resetResources()}}getNumShadowEntities(){return this._shadowEntities.length}getShadowEntity(t){return this._shadowEntities[t]}setShadowEntities(t){this._shadowEntities=t.slice(0);const e=t.length>0;for(let t=0,i=this.getThreeJsMaterials().length;t<i;t++)s.ThreeJsHelper.setDefine(this.getThreeJsMaterials()[t],"shadowEntities",e)}getGroundPosition(t,e,i){const n=this._spheroidComponentRef.get();if(null===n)return void t.set(NaN,NaN,NaN);const r=s.LatLonAlt.pool.get();n.llaFromXYZ(r,e),r.alt=0,n.xyzFromLLA(t,r);const o=s.Vector3.pool.get();n.upFromLLA(o,r);const a=this._endPoints.get("height");if(void 0!==a){const e=s.Vector3.pool.get();s.CubeMap.xyzToUVFace(e,t);let n=this._rootTiles[e.z];if(null==n)return t.addMult(t,o,i),s.LatLonAlt.pool.release(r),void s.Vector3.pool.release(o);for(;n.children.length>0;){const t=1<<n.getLevel()+1,i=Math.floor(e.x*t-2*n.getTileCoord().x),s=Math.floor(e.y*t-2*n.getTileCoord().y);n=n.children[2*s+i]}const l=n.getHeightData();if(null!==l){const i=1<<n.getLevel(),s=(e.x*i-n.getTileCoord().x)*(l.width-2)+1,r=(1-(e.y*i-n.getTileCoord().y))*(l.width-2)+1,h=CMTSTile.getLinearInterpolatedHeightPixel(s,r,l.data,l.width),c=a.configuration,d=c.height_range.min*this._heightScale,u=(c.height_range.max-c.height_range.min)*this._heightScale;t.addMult(t,o,d+h*u)}s.Vector3.pool.release(e)}t.addMult(t,o,i),s.LatLonAlt.pool.release(r),s.Vector3.pool.release(o)}areTilesLoaded(){return null===this._tilesLoadedPromise}getTilesLoadedPromise(){return this._tilesLoadedPromise||Promise.resolve()}setSpheroidReference(t){"string"==typeof t?this._spheroidComponentRef.setByName(this.getEntity().getName(),t):this._spheroidComponentRef.setByType(this.getEntity().getName(),"spheroid",t)}__destroy(){for(let t=0;t<6;t++)null!==this._rootTiles[t]&&this._rootTiles[t].destroy();const t=this._spheroidComponentRef.get();null!==t&&t.removeChangedCallback(this._spheroidChangedCallback),super.__destroy()}__update(){if(this._spheroidComponentRef.update(),"loaded"!==this.getLoadState()||null===this._spheroidComponentRef.get())return;if(null===this._rootTiles[0]){if(0!==this._numEndPointsLoading)return;for(let t=0;t<6;t++)this._rootTiles[t]=new CMTSTile(this,null,t,0,new s.Vector2(0,0)),this._rootTiles[t].forceLoad()}let t=!1;for(;this._cameraPositions.length>this._engine.getNumViewports();)this._cameraPositions.pop();for(;this._cameraPositions.length<this._engine.getNumViewports();)this._cameraPositions.push(new s.Vector3);for(let t=0,e=this._engine.getNumViewports();t<e;t++){const e=this._cameraPositions[t];this._engine.getViewport(t).getCamera().getEntity().getPositionRelativeToEntity(e,s.Vector3.Zero,this.getEntity()),e.rotateInverse(this.getEntity().getOrientation(),e)}this._numLoadsThisFrame=0;for(let e=0;e<6;e++)t=this._rootTiles[e].update()||t;if(null===this._tilesLoadedPromise&&t&&(this._tilesLoadedPromise=new Promise((t=>{this._transitionsCompleteCallback=t}))),null!==this._tilesLoadedPromise&&!t){const t=this._transitionsCompleteCallback;this._tilesLoadedPromise=null,this._transitionsCompleteCallback=null,t()}}__prepareForRender(t){if(null===this._rootTiles[0])return;s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects(),this.getEntity());for(let e=0;e<6;e++)this._rootTiles[e].prepareForRender(t);for(let t=0,e=this._shadowEntities.length;t<e;t++){let e=this._shadowEntities[t];if("string"==typeof e){const t=this.getEntity().getScene().getEntity(e);null!==t&&(e=t)}null!==e&&(this._shadowEntities[t]=e)}const e=this._atmosphereComponentRef.get();s.MaterialUtils.setUniforms(this.getThreeJsMaterials(),t,this.getEntity(),this._shadowEntities,e,!0)}__loadResources(){const t=[];for(let e=0,i=this._endPoints.size;e<i;e++){const i=this._endPoints.getAt(e),s=i.value.url;this._numEndPointsLoading+=1;const n=this.getEntity().getScene().getEngine().getDownloader().download(s+"/configuration.json",!1).then((t=>{if("failed"===t.status)throw new Error("Failed to download "+s+"/configuration.json");if("completed"===t.status&&"string"==typeof t.content){const e=JSON.parse(t.content);i.value.configuration=e,"color"===i.key&&(this._colorTileSize=e.tile_size),this._numEndPointsLoading-=1}}));t.push(n)}return Promise.all(t)}__unloadResources(){for(let t=0;t<6;t++)null!==this._rootTiles[t]&&this._rootTiles[t].destroy();this._rootTiles=[null,null,null,null,null,null];for(let t=0,e=this._endPoints.size;t<e;t++)this._endPoints.getAt(t).value.configuration=null}__getNumLoadsThisFrame(){return this._numLoadsThisFrame}__incNumLoadsThisFrame(){this._numLoadsThisFrame+=1}__getEndPoints(){return this._endPoints}__endPointsAreLoaded(){return 0===this._numEndPointsLoading}__getTileOffsets(){return this._tileOffsets}__getTextureCache(){return this._textureCache}__getCameraPositions(){return this._cameraPositions}__getThreeJsScene(){return this._threeJsScene}__getSplitJoinThresholdFactor(){return this._splitJoinThresholdFactor}__getColorTileSize(){return this._colorTileSize}__getSpheroidComponent(){return this._spheroidComponentRef.get()}_spheroidRefChangedCallback(t,e){null!==t&&t.removeChangedCallback(this._spheroidChangedCallback),null!==e&&e.addChangedCallback(this._spheroidChangedCallback),this._spheroidChangedCallback()}_spheroidChangedCallback(){const t=this._spheroidComponentRef.get();null!==t?this.__setRadius(Math.max(t.getEquatorialRadius(),t.getPolarRadius())):this.__setRadius(0),this.resetResources()}}class CMTSTile extends s.Tile{constructor(t,e,i,n,r){super(e),this._component=t,this._face=i,this._level=n,this._tile=new s.Vector2,this._tile.copy(r),this._isLeaf=!0,this._center=new s.Vector3,this._radius=0,this._threeJsMaterial=null,this._textureLevels=new s.FastMap,this._texturePromises=new s.FastMap,this._nonPositiveTextureLoading=!1,this._threeJsObject=null,this._heightData=null,this._tileOffset=this._getTileOffset();for(let t=0;t<2;t++)for(let e=0;e<2;e++)for(let i=0;i<this._component.__getEndPoints().size;i++){const n=this._component.__getEndPoints().getAt(i).value.configuration;this._isLeaf=this._isLeaf&&!CMTSTile._isInABoundary(n,this._face,this._level+1,new s.Vector2(2*this._tile.x+e,2*this._tile.y+t))}const o=t.__getSpheroidComponent();CMTSTile.cmtsCoordToPosition(this._center,this._face,this._level,this._tile.x+.5,this._tile.y+.5,o);const a=new s.Vector3,l=new s.Vector3,h=new s.Vector3,c=new s.Vector3;CMTSTile.cmtsCoordToPosition(a,this._face,this._level,this._tile.x,this._tile.y,o),CMTSTile.cmtsCoordToPosition(l,this._face,this._level,this._tile.x+1,this._tile.y,o),CMTSTile.cmtsCoordToPosition(h,this._face,this._level,this._tile.x+1,this._tile.y+1,o),CMTSTile.cmtsCoordToPosition(c,this._face,this._level,this._tile.x,this._tile.y+1,o),a.sub(this._center,a),l.sub(this._center,l),h.sub(this._center,h),c.sub(this._center,c),this._radius=Math.max(a.magnitude(),l.magnitude(),h.magnitude(),c.magnitude());const d=this._component.__getEndPoints();for(let t=0;t<d.size;t++){const e=d.getAt(t).key,i=d.getAt(t).value,s=0===this._level?this._getNonPositiveLevel(e):0;if(CMTSTile._isInABoundary(i.configuration,this._face,this._level,this._tile)){const t=0===this._level?s:this._level;this._textureLevels.set(e,t)}else{let i=this.getParent();for(;null!==i&&i._level!==i._textureLevels.getAt(t).value;)i=i.getParent();null!==i?this._textureLevels.set(e,i._textureLevels.getAt(t).value):this._textureLevels.set(e,0)}}}getLevel(){return this._level}getTileCoord(){return this._tile}getHeightData(){return this._heightData}createNewTile(t,e,i){const n=this._level+1,r=new s.Vector2(2*t._tile.x+i,2*t._tile.y+e);return new CMTSTile(t._component,this,this._face,n,r)}checkSplit(){if(this._isLeaf||this._level>=this._component.getMaxLevel())return!1;if(this._component.__getNumLoadsThisFrame()>1)return!1;if(this._level<this._component.getMinLevel())return!0;const t=this._component.__getColorTileSize();return this._getNearestDistance()<this._component.__getSplitJoinThresholdFactor()*this._radius/t}checkJoin(){if(this._level>=this._component.getMaxLevel())return!0;if(this._level<this._component.getMinLevel())return!1;const t=this._component.__getColorTileSize();return this._getNearestDistance()>this._component.__getSplitJoinThresholdFactor()*this._radius/t*4}async load(){if(this._component.__incNumLoadsThisFrame(),null!==this._threeJsMaterial)throw new Error("Tile already has material.");this._threeJsMaterial=s.MaterialUtils.get(),this._component.getThreeJsMaterials().push(this._threeJsMaterial),this._threeJsMaterial.defines.shadowEntities=this._component.getNumShadowEntities()>0;const t=this._component.__getEndPoints(),e=[];for(let i=0;i<t.size;i++){const s=t.getAt(i).key,n=t.getAt(i).value;let r=null;const o=this._textureLevels.get(s),a=this._tile.x>>this._level-o,l=this._tile.y>>this._level-o,h=n.url+"/"+this._face+"/"+o+"/"+a+"/"+l+"."+n.configuration.extension;r=this._component.__getTextureCache().get(h),this._texturePromises.set(s,r),e.push(r.then((t=>{this._setTexture(s,t)})).catch((()=>(this._component.__getTextureCache().release(r),r=this._component.__getTextureCache().get("pink"),r.then((t=>{this._setTexture(s,t)}))))))}return Promise.all(e)}async unload(){if(null===this._threeJsMaterial)throw new Error("Tile has no material to unload.");const t=this._component.getThreeJsMaterials();for(let e=0,i=t.length;e<i;e++)if(t[e]===this._threeJsMaterial){t.splice(e,1);break}this._threeJsMaterial.dispose(),this._threeJsMaterial=null;for(let t=0;t<this._texturePromises.size;t++)this._component.__getTextureCache().release(this._texturePromises.getAt(t).value)}async activate(){if(null!==this._threeJsObject||null===this._threeJsMaterial)throw new Error("NULL");const t=[{name:"position",dimensions:3},{name:"normal",dimensions:3},{name:"uv",dimensions:2}];this._textureLevels.has("normal")&&(t.push({name:"tangent",dimensions:3}),t.push({name:"bitangent",dimensions:3}));for(let e=0;e<this._textureLevels.size;e++){const i=this._textureLevels.getAt(e).key;"color"!==i&&"height"!==i&&t.push({name:i+"UV",dimensions:2})}this._threeJsObject=s.ThreeJsHelper.createMeshObject(this._component,this._threeJsMaterial,t,!1),this._component.getThreeJsObjects().push(this._threeJsObject),s.ThreeJsHelper.useInDynEnvMap(this._threeJsObject,!0),this._setupMesh()}async deactivate(){const t=this._component.getThreeJsObjects();for(let e=0,i=t.length;e<i;e++)if(t[e]===this._threeJsObject){t.splice(e,1);break}s.ThreeJsHelper.destroyObject(this._threeJsObject),this._threeJsObject=null}update(){if(!this._component.__endPointsAreLoaded())return!1;let t=this.check();for(let e=0,i=this.children.length;e<i;e++)t=this.children[e].update()||t;if(!t&&!this._nonPositiveTextureLoading&&0===this._level&&0===this.children.length){const e=this._component.__getEndPoints();for(let i=0;i<e.size;i++){const s=e.getAt(i).key,n=e.getAt(i).value,r=this._getNonPositiveLevel(s);if(r!==this._textureLevels.get(s)){this._nonPositiveTextureLoading=!0,this._textureLevels.set(s,r),t=!0;const e=n.url+"/"+this._face+"/"+r+"/0/0."+n.configuration.extension,i=this._texturePromises.get(s);let o=this._component.__getTextureCache().get(e);this._texturePromises.set(s,o),o.then((t=>{this._setTexture(s,t),this._setupMesh(),this._nonPositiveTextureLoading=!1})).catch((()=>(this._component.__getTextureCache().release(o),o=this._component.__getTextureCache().get("pink"),o.then((t=>{this._setTexture(s,t),this._nonPositiveTextureLoading=!1}))))).finally((()=>{"height"!==s&&this._component.__getTextureCache().release(i)}))}}}return t=this._nonPositiveTextureLoading||t,t}_setupMesh(){const t=this._threeJsMaterial.uniforms.colorTexture.value.image.width-4,e=new s.FastMap,i=new s.FastMap,n=new s.FastMap;for(let t=0;t<this._textureLevels.size;t++){const e=this._textureLevels.getAt(t).key,r=1<<this._level-Math.max(0,this._textureLevels.get(e));i.set(e,new s.Vector2((this._tile.x-Math.floor(this._tile.x/r)*r)/r,(this._tile.y-Math.floor(this._tile.y/r)*r)/r)),n.set(e,new s.Vector2(1/r,1/r))}const r=this._textureLevels.has("normal"),o=this._heightData?s.MathUtils.clamp(Math.ceil(this._heightData.width*n.get("height").x)-2,5,129):5<<s.MathUtils.clamp(2-this._level/2,0,2),a=this._heightData?s.MathUtils.clamp(Math.ceil(this._heightData.height*n.get("height").y)-2,5,129):5<<s.MathUtils.clamp(2-this._level/2,0,2),l=o*a,h=new Float32Array(3*l),c=new Float32Array(3*l);let d=null,u=null;r&&(d=new Float32Array(3*l),u=new Float32Array(3*l));const _=new Uint16Array((o-1)*(a-1)*6);for(let t=0;t<this._textureLevels.size;t++){const i=this._textureLevels.getAt(t).key;e.set(i,new Float32Array(2*l))}let g=0,p=0;if(this._textureLevels.has("height")){const t=this._component.__getEndPoints().get("height").configuration;g=t.height_range.min*this._component.getHeightScale(),p=(t.height_range.max-t.height_range.min)*this._component.getHeightScale()}const m=new s.Vector2,f=new s.Vector3,y=new s.Vector3,T=new s.Vector3,E=new s.Vector3,x=new s.LatLonAlt,v=this._component.__getSpheroidComponent();for(let l=0;l<a;l++)for(let b=0;b<o;b++){const S=l*o+b;if(m.set(this._tile.x+(b-1)/(o-3),this._tile.y+(l-1)/(a-3)),CMTSTile.cmtsCoordToPosition(f,this._face,this._level,m.x,m.y,v),r&&(CMTSTile.cmtsCoordToTangent(T,this._face,this._level,m.x,m.y,v),CMTSTile.cmtsCoordToBitangent(E,this._face,this._level,m.x,m.y,v)),v.llaFromXYZ(x,f),v.upFromLLA(y,x),this._heightData){const t=this._heightData.data,e=i.get("height"),r=n.get("height"),h=this._heightData.width-4;if(CMTSTile.getHeightPos(f,y,b,l,t,e,o,a,r,h,g,p),!this._textureLevels.has("normal")){const i=s.Vector3.pool.get(),n=s.Vector3.pool.get(),c=s.Vector3.pool.get(),d=s.Vector3.pool.get(),u=s.Vector3.pool.get(),_=s.Vector3.pool.get(),f=s.Vector3.pool.get(),T=s.Vector3.pool.get();CMTSTile.cmtsCoordToPosition(i,this._face,this._level,m.x-1/(o-3),m.y,v),CMTSTile.getHeightPos(i,y,b-1,l,t,e,o,a,r,h,g,p),CMTSTile.cmtsCoordToPosition(n,this._face,this._level,m.x+1/(o-3),m.y,v),CMTSTile.getHeightPos(n,y,b+1,l,t,e,o,a,r,h,g,p),CMTSTile.cmtsCoordToPosition(c,this._face,this._level,m.x,m.y-1/(a-3),v),CMTSTile.getHeightPos(c,y,b,l-1,t,e,o,a,r,h,g,p),CMTSTile.cmtsCoordToPosition(d,this._face,this._level,m.x,m.y+1/(a-3),v),CMTSTile.getHeightPos(d,y,b,l+1,t,e,o,a,r,h,g,p),CMTSTile.cmtsCoordToPosition(u,this._face,this._level,m.x-1/(o-3),m.y-1/(a-3),v),CMTSTile.getHeightPos(u,y,b-1,l-1,t,e,o,a,r,h,g,p),CMTSTile.cmtsCoordToPosition(_,this._face,this._level,m.x+1/(o-3),m.y+1/(a-3),v),CMTSTile.getHeightPos(_,y,b+1,l+1,t,e,o,a,r,h,g,p),i.sub(n,i),c.sub(d,c),y.cross(i,c),y.normalize(y),s.Vector3.pool.release(i),s.Vector3.pool.release(n),s.Vector3.pool.release(c),s.Vector3.pool.release(d),s.Vector3.pool.release(u),s.Vector3.pool.release(_),s.Vector3.pool.release(f),s.Vector3.pool.release(T)}}0!==b&&0!==l&&b!==o-1&&l!==a-1||(this._textureLevels.has("height")?f.setMagnitude(f,f.magnitude()-2*p):f.mult(f,.9)),f.sub(f,this._tileOffset),h[3*S+0]=f.x,h[3*S+1]=f.y,h[3*S+2]=f.z,c[3*S+0]=y.x,c[3*S+1]=y.y,c[3*S+2]=y.z,r&&(d[3*S+0]=T.x,d[3*S+1]=T.y,d[3*S+2]=T.z,u[3*S+0]=E.x,u[3*S+1]=E.y,u[3*S+2]=E.z);for(let s=0;s<this._textureLevels.size;s++){const r=this._textureLevels.getAt(s).key,h=i.get(r),c=n.get(r),d=e.get(r);d[2*S+0]=(h.x+(b-1)/(o-3)*c.x)*t/(t+4)+2/(t+4),d[2*S+1]=1-((h.y+(l-1)/(a-3)*c.y)*t/(t+4)+2/(t+4))}if(b<o-1&&l<a-1){const t=l*(o-1)+b;_[6*t+0]=o*(l+0)+(b+0),_[6*t+1]=o*(l+0)+(b+1),_[6*t+2]=o*(l+1)+(b+1),_[6*t+3]=o*(l+0)+(b+0),_[6*t+4]=o*(l+1)+(b+1),_[6*t+5]=o*(l+1)+(b+0)}}s.ThreeJsHelper.setVertices(this._threeJsObject.geometry,"position",h),s.ThreeJsHelper.setVertices(this._threeJsObject.geometry,"normal",c),r&&(s.ThreeJsHelper.setVertices(this._threeJsObject.geometry,"tangent",d),s.ThreeJsHelper.setVertices(this._threeJsObject.geometry,"bitangent",u));for(let t=0;t<this._textureLevels.size;t++){const i=this._textureLevels.getAt(t).key,n=e.get(i);"height"!==i&&("color"===i?s.ThreeJsHelper.setVertices(this._threeJsObject.geometry,"uv",n):s.ThreeJsHelper.setVertices(this._threeJsObject.geometry,i+"UV",n))}s.ThreeJsHelper.setIndices(this._threeJsObject.geometry,_)}_getNonPositiveLevel(t){const e=this._getNearestDistance(),i=this._component.__getEndPoints().get(t),n=i.configuration.tile_size;return s.MathUtils.clamp(4-Math.floor(Math.log2(e/this._radius/this._component.__getSplitJoinThresholdFactor()*n*4)),i.configuration.first_level,0)}_getNearestDistance(){let t=Number.POSITIVE_INFINITY;const e=this._component.__getCameraPositions();for(let i=0,s=e.length;i<s;i++){const s=e[i];CMTSTile._pos.sub(s,this._center);const n=Math.max(0,CMTSTile._pos.magnitude()-this._radius);t>n&&(t=n)}return t}toString(){return this._face+"/"+this._level+"/"+this._tile.x+"/"+this._tile.y}prepareForRender(t){s.ThreeJsHelper.setPositionToEntity(this._threeJsObject,this._component.getEntity(),t,this._tileOffset,!0);for(let e=0,i=this.children.length;e<i;e++)this.children[e].prepareForRender(t)}_setTexture(t,e){if("loaded"===this._component.getLoadState())if("height"===t){const t=document.createElement("canvas");t.width=e.image.width,t.height=e.image.height;const i=t.getContext("2d",{desynchronized:!0,alpha:!1});i.drawImage(e.image,0,0),e.dispose(),this._heightData=i.getImageData(0,0,e.image.width,e.image.height),this._component.__getTextureCache().release(this._texturePromises.get("height")),this._texturePromises.delete("height");const n=this._component.__getSpheroidComponent();CMTSTile.cmtsCoordToPosition(this._center,this._face,this._level,this._tile.x+.5,this._tile.y+.5,n);const r=s.Vector3.pool.get(),o=s.LatLonAlt.pool.get();n.llaFromXYZ(o,this._center),n.upFromLLA(r,o);const a=CMTSTile.getLinearInterpolatedHeightPixel(this._heightData.width/2,this._heightData.height/2,this._heightData.data,this._heightData.width),l=this._component.__getEndPoints().get("height").configuration,h=l.height_range.min*this._component.getHeightScale(),c=(l.height_range.max-l.height_range.min)*this._component.getHeightScale();this._center.addMult(this._center,r,h+a*c),s.Vector3.pool.release(r),s.LatLonAlt.pool.release(o)}else this._threeJsMaterial.uniforms[t+"Texture"].value=e,"normal"===t?(this._threeJsMaterial.defines.normalMap=!0,this._threeJsMaterial.defines.normalUVs=!0,this._threeJsMaterial.defines.hasBitangents=!0,this._threeJsMaterial.uniforms.normalScale.value.set(this._component.getHeightScale(),this._component.getHeightScale()),this._threeJsMaterial.uniforms.specularIntensity.value=0,this._threeJsMaterial.uniforms.specularHardness.value=100):"specular"===t?(this._threeJsMaterial.defines.specularMap=!0,this._threeJsMaterial.defines.specularUVs=!0):"night"===t?(this._threeJsMaterial.defines.nightMap=!0,this._threeJsMaterial.defines.nightUVs=!0):"decal"===t&&(this._threeJsMaterial.defines.decalMap=!0,this._threeJsMaterial.defines.decalUVs=!0)}static _getGreatestLevel(t,e,i,s){let n=Number.NEGATIVE_INFINITY;for(let r=0,o=t.boundaries.length;r<o;r++){const o=t.boundaries[r];if(o.face!==e)continue;const a=o.last_level-i;o.min[0]<=s.x>>a&&s.x>>a<=o.max[0]&&o.min[1]<=s.y>>a&&s.y>>a<=o.max[1]&&n<o.last_level&&(n=o.last_level)}return n}static _isInABoundary(t,e,i,s){let n=!1;for(let r=0,o=t.boundaries.length;r<o;r++){const o=t.boundaries[r];if(o.face!==e)continue;if(o.last_level<i)continue;const a=1<<o.last_level-i;s.x<Math.floor(o.min[0]/a)||Math.floor(o.max[0]/a)<s.x||(s.y<Math.floor(o.min[1]/a)||Math.floor(o.max[1]/a)<s.y||(n=!0))}return n}_getTileOffset(){const t=this._component.__getTileOffsets();for(let e=0,i=t.length;e<i;e++){const i=t[e];if(i.face!==this._face||i.level>this._level)continue;const s=1<<this._level-i.level;if(i.min.x*s<=this._tile.x&&this._tile.x<(i.max.x+1)*s&&i.min.y*s<=this._tile.y&&this._tile.y<(i.max.y+1)*s)return i.offset}return s.Vector3.Zero}static getHeightPos(t,e,i,s,n,r,o,a,l,h,c,d){const u=((r.x+(i-1)/(o-3)*l.x)*h/(h+4)+2/(h+4))*(h+4),_=(1-((r.y+(s-1)/(a-3)*l.y)*h/(h+4)+2/(h+4)))*(h+4),g=this.getLinearInterpolatedHeightPixel(u,_,n,h+4);t.addMult(t,e,c+g*d)}static getLinearInterpolatedHeightPixel(t,e,i,s){const n=Math.floor(t),r=Math.floor(e),o=t-n,a=e-r,l=Math.abs(o-.5),h=Math.abs(a-.5);let c=this.getHeightFromPixel(n,r,i,s)*((1-l)*(1-h));return o>=.5?(c+=this.getHeightFromPixel(n+1,r,i,s)*(l*(1-h)),a<.5?c+=this.getHeightFromPixel(n+1,r-1,i,s)*(l*h):a>=.5&&(c+=this.getHeightFromPixel(n+1,r+1,i,s)*(l*h))):o<.5&&(c+=this.getHeightFromPixel(n-1,r,i,s)*(l*(1-h)),a<.5?c+=this.getHeightFromPixel(n-1,r-1,i,s)*(l*h):a>=.5&&(c+=this.getHeightFromPixel(n-1,r+1,i,s)*(l*h))),a>=.5?c+=this.getHeightFromPixel(n,r+1,i,s)*((1-l)*h):a<.5&&(c+=this.getHeightFromPixel(n,r-1,i,s)*((1-l)*h)),c}static getHeightFromPixel(t,e,i,n){t=s.MathUtils.clamp(t,0,n-1);const r=4*((e=s.MathUtils.clamp(e,0,n-1))*n+t);return i[r+0]/256+i[r+1]/65536+i[r+2]/16777216}static cmtsCoordToPosition(t,e,i,n,r,o){let a=n/(1<<Math.max(i,0)),l=r/(1<<Math.max(i,0));for(;a<0||a>1||l<0||l>1;)if(0<=e&&e<=3){if(a>1)a-=1,e=(e+1)%4;else if(a<0)a+=1,e=(e+3)%4;else if(0===e)l<0?(l+=1,e=5):l>1&&(l-=1,e=4);else if(1===e){if(l<0){const t=a;a=l+1,l=1-t,e=5}else if(l>1){const t=a;a=2-l,l=t,e=4}}else if(2===e)l<0?(a=1-a,l=0-l,e=5):l>1&&(a=1-a,l=2-l,e=4);else if(3===e)if(l<0){const t=a;a=0-l,l=t,e=5}else if(l>1){const t=a;a=l-1,l=1-t,e=4}}else if(4===e)if(a<0){const t=a;a=1-l,l=t+1,e=3}else if(a>1){const t=a;a=l,l=2-t,e=1}else l<0?(l+=1,e=0):l>1&&(a=1-a,l=2-l,e=2);else if(5===e)if(a<0){const t=a;a=l,l=0-t,e=3}else if(a>1){const t=a;a=1-l,l=t-1,e=1}else l<0?(a=1-a,l=0-l,e=2):l>1&&(l-=1,e=0);const h=2*a-1,c=2*l-1,d=this._basis[e];t.set(d[0].x*h+d[1].x*c+d[2].x,d[0].y*h+d[1].y*c+d[2].y,d[0].z*h+d[1].z*c+d[2].z),t.normalize(t),s.Geometry.getLLAFromXYZOnSphere(this._lla,t,0),this._lla.alt=0,o.xyzFromLLA(t,this._lla)}static cmtsCoordToTangent(t,e,i,s,n,r){this.cmtsCoordToPosition(t,e,i,s,n,r);const o=this._basis[e];t.setNormalTo(t,o[0])}static cmtsCoordToBitangent(t,e,i,s,n,r){this.cmtsCoordToPosition(t,e,i,s,n,r);const o=this._basis[e];t.setNormalTo(t,o[1])}}CMTSTile._basis=[[s.Vector3.YAxis,s.Vector3.ZAxis,s.Vector3.XAxis],[s.Vector3.XAxisNeg,s.Vector3.ZAxis,s.Vector3.YAxis],[s.Vector3.YAxisNeg,s.Vector3.ZAxis,s.Vector3.XAxisNeg],[s.Vector3.XAxis,s.Vector3.ZAxis,s.Vector3.YAxisNeg],[s.Vector3.YAxis,s.Vector3.XAxisNeg,s.Vector3.ZAxis],[s.Vector3.YAxis,s.Vector3.XAxis,s.Vector3.ZAxisNeg]],CMTSTile._lla=new s.LatLonAlt,CMTSTile._pos=new s.Vector3;const n=CMTSComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class CometTailComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._lightSource=new s.EntityRef(this.getEntity().getScene()),this._timeLength=6e5,this._numberOfParticles=200,this._color=new s.Color,this._color.freeze(),this._starAccelerationMultiplier=1,this._timeOfParticle0=0}getLightSource(){return this._lightSource.getName()}setLightSource(t){this._lightSource.setName(t)}getTimeLength(){return this._timeLength}setTimeLength(t){this._timeLength=t,this.resetResources()}getStarAccelerationMultiplier(){return this._starAccelerationMultiplier}setStarAccelerationMultiplier(t){this._starAccelerationMultiplier=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"starAccelerationMultiplier",this._starAccelerationMultiplier)}getNumberOfParticles(){return this._numberOfParticles}setNumberOfParticles(t){this._numberOfParticles=t,this.resetResources()}getColor(){return this._color}setColor(t){this._color.thaw(),this._color.copy(t),this._color.freeze(),s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"color",this._color)}__update(){if(this.__setRadius(Math.max(this.getEntity().getExtentsRadius(),this._timeLength*this.getEntity().getVelocity().magnitude())),"loaded"!==this.getLoadState())return;const t=this.getEntity().getScene().getEngine().getTime(),e=this.getThreeJsObjects()[0].geometry.attributes.originTime.array;for(let i=0,n=this._numberOfParticles;i<n;i++){const n=e[i]+this._timeOfParticle0;(n<t-this._timeLength||n>t)&&this._newParticle(i,s.MathUtils.wrap(n,t-this._timeLength,t))}this._numberOfParticles>1?s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"time",t-this._timeOfParticle0):s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"time",0);const i=this._lightSource.get();if(null!==i){const t=i.getComponentByType("lightSource");null!==t&&s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"starAbsoluteMagnitude",t.getAbsoluteMagnitude());const e=s.Vector3.pool.get();this.getEntity().getPositionRelativeToEntity(e,s.Vector3.Zero,i),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"positionOfEntity",e),s.Vector3.pool.release(e)}}__prepareForRender(t){s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects(),this.getEntity(),t);const e=this.getEntity().getCameraSpacePosition(t);if(s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"positionInCamera",e),e.magnitude()<4e4)this.getThreeJsObjects()[0].visible=!1;else{const t=(e.magnitude()-4e4)/4e5;this.getThreeJsMaterials()[0].uniforms.color.value.w=this._color.a*s.MathUtils.clamp01(t),this.getThreeJsObjects()[0].visible=!0}}async __loadResources(){const t=new s.THREE.RawShaderMaterial({uniforms:{time:new s.THREE.Uniform(0),timeLength:new s.THREE.Uniform(0),positionInCamera:new s.THREE.Uniform(new s.THREE.Vector3),starAbsoluteMagnitude:new s.THREE.Uniform(0),starAccelerationMultiplier:new s.THREE.Uniform(0),positionOfEntity:new s.THREE.Uniform(new s.THREE.Vector3),color:new s.THREE.Uniform(new s.THREE.Vector4)},vertexShader:s.ShaderFix.fix(CometTailComponent.vertexShader,"vertex"),fragmentShader:s.ShaderFix.fix(CometTailComponent.fragmentShader,"fragment"),transparent:!0,depthWrite:!1,blending:s.THREE.AdditiveBlending,side:s.THREE.DoubleSide});this.getThreeJsMaterials().push(t);const e=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),i=new Uint16Array([0,1,2,2,3,0]),n=new Float32Array(1*this._numberOfParticles),r=new Float32Array(3*this._numberOfParticles),o=new Float32Array(1*this._numberOfParticles),a=new s.THREE.InstancedBufferGeometry;a.setAttribute("position",new s.THREE.BufferAttribute(e,3)),a.setAttribute("originTime",new s.THREE.InstancedBufferAttribute(n,1)),a.setAttribute("originPosition",new s.THREE.InstancedBufferAttribute(r,3)),a.setAttribute("accelerationMultiplier",new s.THREE.InstancedBufferAttribute(o,1)),a.setIndex(new s.THREE.BufferAttribute(i,1)),a.instanceCount=this._numberOfParticles;const l=s.ThreeJsHelper.createMeshObjectGivenGeometry(this,t,a);this.getThreeJsObjects().push(l);const h=this.getEntity().getScene().getEngine().getTime();for(let t=0,e=this._numberOfParticles;t<e;t++)this._newParticle(t,h-t/e*this._timeLength);s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"timeLength",this._timeLength),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"starAccelerationMultiplier",this._starAccelerationMultiplier),s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"color",this._color)}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this)}_newParticle(t,e){const i=e,n=this.getThreeJsObjects()[0].geometry.attributes.originTime,r=n.array;if(t>0)r[t]=i-this._timeOfParticle0;else{for(let t=1,e=this._numberOfParticles;t<e;t++)r[t]+=this._timeOfParticle0-i;this._timeOfParticle0=i,r[0]=0}n.needsUpdate=!0;const o=s.Vector3.pool.get(),a=this._lightSource.get();null!==a&&this.getEntity().getPositionRelativeToEntity(o,s.Vector3.Zero,a,i);const l=this.getThreeJsObjects()[0].geometry.attributes.originPosition,h=l.array;h[3*t+0]=o.x,h[3*t+1]=o.y,h[3*t+2]=o.z,l.needsUpdate=!0,s.Vector3.pool.release(o);const c=this.getThreeJsObjects()[0].geometry.attributes.accelerationMultiplier;c.array[t]=0+1*Math.random(),c.needsUpdate=!0}}CometTailComponent.vertexShader="\n\tattribute vec3 position;\n\tattribute float originTime;\n\tattribute vec3 originPosition;\n\tattribute vec3 originStarPosition;\n\tattribute vec3 originExternalAcceleration;\n\tattribute float accelerationMultiplier;\n\n\tuniform float time;\n\tuniform float timeLength;\n\tuniform vec3 positionInCamera;\n\tuniform float starAbsoluteMagnitude;\n\tuniform float starAccelerationMultiplier;\n\tuniform vec3 positionOfEntity;\n\tuniform mat4 viewMatrix;\n\tuniform mat4 modelViewMatrix;\n\tuniform mat4 projectionMatrix;\n\n\tvarying vec2 vPosition;\n\tvarying float vAlpha;\n\n\t#ifdef L_EXT_frag_depth\n\t\tvarying float fragDepth;\n\t#else\n\t\tuniform float nearDistance;\n\t\tuniform float midDistance;\n\t#endif\n\n\tvoid main() {\n\t\t// Get the position of the center point of the quad in model space.\n\t\tfloat deltaTime = time - originTime;\n\t\tvec3 externalAcceleration = starAccelerationMultiplier * accelerationMultiplier * normalize(originPosition) * 5.0e7 * pow(2.51188643151, 20.0 - starAbsoluteMagnitude) / dot(originPosition, originPosition);\n\t\tvec3 modelPosition = externalAcceleration * pow(deltaTime, 1.5);\n\n\t\t// Get a general expansion scale in all directions.\n\t\tfloat expansion = 0.2 * max(1.0e5, length(modelPosition));\n\n\t\t// Get the stretch direction in view space.\n\t\tvec3 modelStretch = modelPosition;\n\t\tvec3 cameraDirection = normalize(positionInCamera);\n\t\tmodelStretch = modelStretch - dot(cameraDirection, modelStretch) * cameraDirection;\n\t\tvec4 viewStretch = viewMatrix * vec4(modelStretch, 1.0);\n\n\t\t// Get the stretch amounts in the x and y directions.\n\t\tvec2 stretch2d = vec2(max(expansion, 2.0 * length(viewStretch.xz)), expansion);\n\n\t\t// Do the stretch calculation on the vertex position in view space.\n\t\t// It translates it, rotates it, stretches it, and unrotates it.\n\t\tvec2 translate = 0.5 * normalize(vec2(viewStretch.xz));\n\t\tfloat angle = length(viewStretch.xz) > 0.0 ? atan(viewStretch.z, viewStretch.x) : 0.0;\n\t\tfloat cosAngle = cos(angle);\n\t\tfloat sinAngle = sin(angle);\n\t\tfloat stretchedX = (stretch2d.x * cosAngle * cosAngle + stretch2d.y * sinAngle * sinAngle) * 0.5 * (position.x + translate.x) + (stretch2d.x - stretch2d.y) * sinAngle * cosAngle * 0.5 * (position.y + translate.y);\n\t\tfloat stretchedY = (stretch2d.x - stretch2d.y) * sinAngle * cosAngle * 0.5 * (position.x + translate.x) + (stretch2d.x * sinAngle * sinAngle + stretch2d.y * cosAngle * cosAngle) * 0.5 * (position.y + translate.y);\n\n\t\t// Get the position in view space and then in normalized space.\n\t\tvec4 viewPosition = vec4(stretchedX, 0.0, stretchedY, 0.0) + modelViewMatrix * vec4(modelPosition, 1.0);\n\t\tgl_Position = projectionMatrix * viewPosition;\n\t\tgl_Position.w = viewPosition.y;\n\n\t\t// Set the varying variables for adjusting te\n\t\tvPosition = vec2(cosAngle * position.x + sinAngle * position.y, -sinAngle * position.x + cosAngle * position.y);\n\t\tvAlpha = sqrt(1.0 - sqrt(deltaTime / timeLength));\n\n\t\t// Make the gas fade far from the star.\n\t\tvAlpha *= min(1.0, 1.0 - length(originPosition) / 7.0e8);\n\n\t\t// Do log-depth buffering.\n\t\t#ifdef L_EXT_frag_depth\n\t\t\tfragDepth = gl_Position.w;\n\t\t#else\n\t\t\tfloat z = gl_Position.w;\n\t\t\tif (z < midDistance) {\n\t\t\t\tgl_Position.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\n\t\t\t\tgl_Position.z = log2(z - midDistance + 1.0) * logFactor;\n\t\t\t\tgl_Position.z *= gl_Position.w;\n\t\t\t}\n\t\t#endif\n\t}",CometTailComponent.fragmentShader="\n\tuniform vec4 color;\n\n\tvarying vec2 vPosition;\n\tvarying float vAlpha;\n\n\t#ifdef L_EXT_frag_depth\n\t\tuniform mat4 projectionMatrix;\n\t\tvarying float fragDepth;\n\t#endif\n\n\tvoid main(void) {\n\t\t// Set the color to be a circle tinted by the color.\n\t\tgl_FragColor = vec4(color.rgb, 0.5 * color.a) * max(0.0, 1.0 - dot(vPosition, vPosition)) * vAlpha;\n\n\t\t// Do log-depth buffering.\n\t\t#ifdef L_EXT_frag_depth\n\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\n\t\t\tgl_FragDepthEXT = projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\n\t\t#endif\n\t}";const n=CometTailComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class ConnectedSpriteComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._entity1=new s.EntityRef(this.getEntity().getScene()),this._entity1Offset=new s.Vector3,this._entity1Offset.freeze(),this._entity2=new s.EntityRef(this.getEntity().getScene()),this._entity2Offset=new s.Vector3,this._entity2Offset.freeze(),this._width=1,this._widthUnits="km",this._textureUrl="",this._textureAspectRatio=1,this._textureRepeat=!0,this._textureStretch=1,this._textureYOffset=0,this._uOffsetStart=0,this._uOffsetEnd=1,this._colorMultiplier=new s.Color(1,1,1,1),this._colorMultiplier.freeze(),this._blending="normal"}getEntity1(){return this._entity1.getName()}setEntity1(t){this._entity1.setName(t)}getEntity1Offset(){return this._entity1Offset}setEntity1Offset(t){this._entity1Offset.thaw(),this._entity1Offset.copy(t),this._entity1Offset.freeze()}getEntity2(){return this._entity2.getName()}setEntity2(t){this._entity2.setName(t)}getEntity2Offset(){return this._entity2Offset}setEntity2Offset(t){this._entity2Offset.thaw(),this._entity2Offset.copy(t),this._entity2Offset.freeze()}getWidth(){return this._width}setWidth(t){this._width=t}getWidthUnits(){return this._widthUnits}setWidthUnits(t){this._widthUnits=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"pixelBased","px"===t?1:0)}getTextureUrl(){return this._textureUrl}setTextureUrl(t){this._textureUrl=t,this.resetResources()}getTextureRepeat(){return this._textureRepeat}setTextureRepeat(t){this._textureRepeat=t}getTextureStretch(){return this._textureStretch}setTextureStretch(t){this._textureStretch=t}getTextureYOffset(){return this._textureYOffset}setTextureYOffset(t){this._textureYOffset=t}getUOffsetStart(){return this._uOffsetStart}setUOffsetStart(t){this._uOffsetStart=t}getUOffsetEnd(){return this._uOffsetEnd}setUOffsetEnd(t){this._uOffsetEnd=t}getColorMultiplier(){return this._colorMultiplier}setColorMultiplier(t){this._colorMultiplier.thaw(),this._colorMultiplier.copy(t),this._colorMultiplier.freeze(),s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"color",this._colorMultiplier,1)}setBlending(t){this._blending=t,s.ThreeJsHelper.setBlending(this.getThreeJsMaterials()[0],t)}__update(){const t=this._entity1.get(),e=this._entity2.get();if(null===t||null===e)return;const i=s.Vector3.pool.get();t.getPositionRelativeToEntity(i,s.Vector3.Zero,e),this.__setRadius(i.magnitude()+t.getExtentsRadius()+e.getExtentsRadius()),s.Vector3.pool.release(i)}__prepareForRender(t){const e=this._entity1.get(),i=this._entity2.get();if(null===e||null===i)return void(this.getThreeJsObjects()[0].visible=!1);const n=e.getCameraSpacePosition(t),r=i.getCameraSpacePosition(t),o=s.Vector3.pool.get(),a=s.Vector3.pool.get(),l=s.Vector3.pool.get();o.rotate(e.getOrientation(),this._entity1Offset),o.add(n,o),l.rotate(i.getOrientation(),this._entity2Offset),l.add(r,l),a.copy(o),o.lerp(o,l,this._uOffsetStart),l.lerp(a,l,this._uOffsetEnd),s.Vector3.pool.release(a);const h=s.Vector3.pool.get(),c=s.Vector3.pool.get();if("px"===this._widthUnits){t.getNormalSpacePositionFromCameraSpacePosition(h,o),t.getNormalSpacePositionFromCameraSpacePosition(c,l),h.div(h,Math.max(Math.sign(h.z+1),h.z+1)),c.div(c,Math.max(Math.sign(c.z+1),c.z+1));const e=Math.max(1,Math.abs(h.x),Math.abs(h.y)),i=Math.max(1,Math.abs(c.x),Math.abs(c.y));h.x/=e,h.y/=e,h.z=0,c.x/=i,c.y/=i,c.z=0,t.getCameraSpacePositionFromNormalSpacePosition(o,h),t.getCameraSpacePositionFromNormalSpacePosition(l,c)}const d=o.magnitude(),u=l.magnitude(),_=s.Vector3.pool.get(),g=s.Vector3.pool.get();_.sub(l,o),d<u?g.copy(o):g.copy(l),g.cross(g,_),g.normalize(g);let p=1/this._textureStretch;if("px"===this._widthUnits){if(this._textureRepeat){const e=s.Vector2.pool.get(),i=s.Vector2.pool.get();t.getViewport().getPixelSpacePositionFromNormalSpacePosition(e,h),t.getViewport().getPixelSpacePositionFromNormalSpacePosition(i,c);const n=s.Vector2.pool.get();n.sub(e,i),p*=n.magnitude()/this._width*this._textureAspectRatio,s.Vector2.pool.release(n),s.Vector2.pool.release(e),s.Vector2.pool.release(i)}}else this._textureRepeat&&(p*=_.magnitude()/this._width*this._textureAspectRatio);s.Vector3.pool.release(h),s.Vector3.pool.release(c);let m=this._width/2,f=this._width/2,y=this._width/2,T=1;if("px"===this._widthUnits){m=f=y=t.getViewport().getNormalSpaceRadiusFromPixelSpaceRadius(this._width),m=t.getRadiusFromNormalSpaceRadius(m,d),y=t.getRadiusFromNormalSpaceRadius(y,u);const e=s.Vector3.pool.get();e.copy(_),T=s.MathUtils.clamp01(-e.dot(o)/e.dot(e)),e.addMult(o,e,T),f=t.getRadiusFromNormalSpaceRadius(f,e.magnitude()),s.Vector3.pool.release(e)}p>1e3&&(T=1e3/p,d>u&&(T=1-T));let E=this.getThreeJsObjects()[0].geometry.getAttribute("position"),x=E.array;d<u||"px"===this._widthUnits?(this.getThreeJsObjects()[0].position.set(o.x,o.y,o.z),x[0]=0-g.x*m,x[1]=0-g.y*m,x[2]=0-g.z*m,x[3]=0+g.x*m,x[4]=0+g.y*m,x[5]=0+g.z*m,x[6]=_.x*T-g.x*f,x[7]=_.y*T-g.y*f,x[8]=_.z*T-g.z*f,x[9]=_.x*T+g.x*f,x[10]=_.y*T+g.y*f,x[11]=_.z*T+g.z*f,x[12]=_.x-g.x*y,x[13]=_.y-g.y*y,x[14]=_.z-g.z*y,x[15]=_.x+g.x*y,x[16]=_.y+g.y*y,x[17]=_.z+g.z*y):(this.getThreeJsObjects()[0].position.set(l.x,l.y,l.z),x[0]=0-g.x*y,x[1]=0-g.y*y,x[2]=0-g.z*y,x[3]=0+g.x*y,x[4]=0+g.y*y,x[5]=0+g.z*y,x[6]=-_.x*(1-T)-g.x*f,x[7]=-_.y*(1-T)-g.y*f,x[8]=-_.z*(1-T)-g.z*f,x[9]=-_.x*(1-T)+g.x*f,x[10]=-_.y*(1-T)+g.y*f,x[11]=-_.z*(1-T)+g.z*f,x[12]=-_.x-g.x*m,x[13]=-_.y-g.y*m,x[14]=-_.z-g.z*m,x[15]=-_.x+g.x*m,x[16]=-_.y+g.y*m,x[17]=-_.z+g.z*m),E.needsUpdate=!0,E=this.getThreeJsObjects()[0].geometry.getAttribute("uv"),x=E.array,x[0]=0,x[2]=1,x[4]=0,x[6]=1,x[8]=0,x[10]=1,this._textureRepeat?(x[1]=this._textureYOffset+0,x[3]=this._textureYOffset+0,d<u||"px"===this._widthUnits?(x[5]=this._textureYOffset+p*T,x[7]=this._textureYOffset+p*T,x[9]=this._textureYOffset+p,x[11]=this._textureYOffset+p):(x[5]=this._textureYOffset+p*(1-T),x[7]=this._textureYOffset+p*(1-T),x[9]=this._textureYOffset+p,x[11]=this._textureYOffset+p)):d<u||"px"===this._widthUnits?(x[1]=this._textureYOffset+p,x[3]=this._textureYOffset+p,x[5]=this._textureYOffset+p*(1-T),x[7]=this._textureYOffset+p*(1-T),x[9]=this._textureYOffset+0,x[11]=this._textureYOffset+0):(x[1]=this._textureYOffset+0,x[3]=this._textureYOffset+0,x[5]=this._textureYOffset+p*(1-T),x[7]=this._textureYOffset+p*(1-T),x[9]=this._textureYOffset+p,x[11]=this._textureYOffset+p),E.needsUpdate=!0,s.Vector3.pool.release(o),s.Vector3.pool.release(l),s.Vector3.pool.release(_),s.Vector3.pool.release(g)}async __loadResources(){const t=await s.ThreeJsHelper.loadTexture(this,this._textureUrl,!1,!1);if(t.wrapT=s.THREE.RepeatWrapping,this._textureAspectRatio=t.image.width/t.image.height,"loading"!==this.getLoadState())return void t.dispose();const e=this.getEntity().getScene().getEngine().getMaterialManager().getPreloaded("sprite");this.getThreeJsMaterials().push(e),s.ThreeJsHelper.setBlending(this.getThreeJsMaterials()[0],this._blending),s.ThreeJsHelper.setUniformColorRGBA(e,"color",this._colorMultiplier,1),s.ThreeJsHelper.setUniformTexture(e,"colorTexture",t),s.ThreeJsHelper.setUniformNumber(e,"pixelBased","px"===this._widthUnits?1:0);const i=s.ThreeJsHelper.createMeshObject(this,e,[{name:"position",dimensions:3},{name:"uv",dimensions:2}],!1);this.getThreeJsObjects().push(i),s.ThreeJsHelper.setVertices(i.geometry,"position",new Float32Array(18)),s.ThreeJsHelper.setVertices(i.geometry,"uv",new Float32Array(12)),s.ThreeJsHelper.setIndices(i.geometry,new Uint16Array([0,2,3,3,1,0,2,4,5,5,3,2]))}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this)}}const n=ConnectedSpriteComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class DivComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._activeCamera=null,this._fadeWhenCloseToCamera=!0,this._fadeWhenCloseToEntity=new s.EntityRef(this.getEntity().getScene()),this._div=document.createElement("div"),this._div.style.position="absolute",this._div.style.left="0",this._div.style.top="0",this._div.style.transform="translate(0%, 0%);",this._alignment=new s.Vector2(0,.5),this._alignment.freeze(),this._sizeInPx=new s.Vector2(0,0),this._currentHTML="",this.__setRadius(Number.POSITIVE_INFINITY)}getDiv(){return this._div}getActiveCamera(){return this._activeCamera}setActiveCamera(t){this._activeCamera=t,this.resetResources()}getFadeWhenCloseToCamera(){return this._fadeWhenCloseToCamera}setFadeWhenCloseToCamera(t){this._fadeWhenCloseToCamera=t}getFadeWhenCloseToEntity(){return this._fadeWhenCloseToEntity.getName()}setFadeWhenCloseToEntity(t){this._fadeWhenCloseToEntity.setName(t)}getAlignment(){return this._alignment}setAlignment(t){this._alignment.thaw(),this._alignment.copy(t),this._alignment.freeze()}__loadResources(){return Promise.resolve()}__unloadResources(){null!==this._div.parentNode&&this._div.parentNode.removeChild(this._div)}__prepareForRender(t){if(null===this._activeCamera){const t=this.getEntity().getScene().getEngine().getViewport(0);null!==t&&(this._activeCamera=t.getCamera())}if(this._activeCamera!==t||null===this._activeCamera||null===this._activeCamera.getViewport())return;this._activeCamera.getViewport().getDiv()!==this._div.parentNode&&this._activeCamera.getViewport().getDiv().appendChild(this._div);let e=1;if(e>0&&this._fadeWhenCloseToCamera){const i=this.getEntity().getNormalSpaceExtentsRadius(t);e*=s.MathUtils.clamp01((.02-i)/.02)}const i=this.getEntity().getCameraSpacePosition(t);if(e>0){let i=null;if(i=""===this._fadeWhenCloseToEntity.getName()?this.getEntity().getParent():this._fadeWhenCloseToEntity.get(),null!==i){const n=s.Vector3.pool.get();n.sub(this.getEntity().getNormalSpacePosition(t),i.getNormalSpacePosition(t));const r=n.magnitude();s.Vector3.pool.release(n);i.getNormalSpaceExtentsRadius(t)<.02&&(e*=s.MathUtils.clamp01((r-.02)/.02))}}if(e>0&&(null!==this.getEntity().getParent()&&this.getEntity().getParent().isOccludingPosition(t,i)||t.isPositionOccluded(i))&&(e=0),e>0){const i=s.Vector3.pool.get();t.getEntity().getOrientation().getAxis(i,1),i.dot(this.getEntity().getCameraSpacePosition(t))<=0&&(e=0),s.Vector3.pool.release(i)}if(this._div.style.opacity!==""+e&&(this._div.style.opacity=""+e,this._div.style.pointerEvents=0===e?"none":""),e>0){this._currentHTML!==this._div.innerHTML&&(this._sizeInPx.set(this._div.offsetWidth,this._div.offsetHeight),this._currentHTML=this._div.innerHTML);const e=t.getViewport().getBounds(),i=this.getEntity().getPixelSpacePosition(t),s=i.x-this._sizeInPx.x*this._alignment.x-e.origin.x+(e.size.x%2==0?-.5:0),n=i.y-this._sizeInPx.y*this._alignment.y-e.origin.y+(e.size.y%2==0?-.5:0);this._div.style.transform=`translate(${s}px, ${n}px)`}}}const n=DivComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);class DynamicEnvironmentMapComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._faceSize=64,this._threeJsRenderer=this.getEntity().getScene().getEngine().__getThreeJsRenderer(),this._threeJsFaceCameras=[],this._threeJsFaceRenderTargets=[],this._threeJsQuad=new s.THREE.Mesh,this._threeJsScene=new s.THREE.Scene,this._threeJsCubeCamera=new s.THREE.OrthographicCamera(-1,1,-1,1,-1,1),this._envMapTexture=new s.THREE.WebGLRenderTarget(4*this._faceSize,4*this._faceSize,{minFilter:s.THREE.LinearFilter,magFilter:s.THREE.LinearFilter,wrapS:s.THREE.ClampToEdgeWrapping,wrapT:s.THREE.ClampToEdgeWrapping}),this._setupFaceCameras(),this._setupQuad()}getFaceSize(){return this._faceSize}setFaceSize(t){this._faceSize=t,this._envMapTexture.width!==4*this._faceSize&&(this._envMapTexture.setSize(4*this._faceSize,4*this._faceSize),this._threeJsQuad.material.uniforms.faceSize.value=this._faceSize);for(let t=0;t<6;t++)this._threeJsFaceRenderTargets[t].setSize(this._faceSize,this._faceSize)}getTexture(){return this._envMapTexture.texture}__destroy(){this._threeJsQuad.geometry.dispose(),this._threeJsQuad.material.dispose(),this._envMapTexture.dispose();for(let t=0;t<this._threeJsFaceRenderTargets.length;t++)this._threeJsFaceRenderTargets[t].dispose();super.__destroy()}__render(){this._updateProjectionMatrix();const t=.7071067811865476;n.set(0,0,-t,t),this._threeJsFaceCameras[0].setRotationFromQuaternion(n),n.set(0,0,0,1),this._threeJsFaceCameras[1].setRotationFromQuaternion(n),n.set(0,0,t,t),this._threeJsFaceCameras[2].setRotationFromQuaternion(n),n.set(0,0,1,0),this._threeJsFaceCameras[3].setRotationFromQuaternion(n),n.set(.5,-.5,-.5,.5),this._threeJsFaceCameras[4].setRotationFromQuaternion(n),n.set(-.5,.5,-.5,.5),this._threeJsFaceCameras[5].setRotationFromQuaternion(n);for(let t=0;t<6;t++)this._threeJsRenderer.setRenderTarget(this._threeJsFaceRenderTargets[t]),this._threeJsRenderer.render(this.getEntity().getScene().getThreeJsScene(),this._threeJsFaceCameras[t]);this._threeJsRenderer.setRenderTarget(this._envMapTexture),this._threeJsRenderer.render(this._threeJsScene,this._threeJsCubeCamera)}_setupFaceCameras(){for(let t=0;t<6;t++){this._threeJsFaceCameras.push(new s.THREE.PerspectiveCamera(90,1,.1,1e3));const e=new s.THREE.Matrix4;e.set(1,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0),this._threeJsFaceCameras[t].projectionMatrix=e;const i=new s.THREE.Matrix4;i.set(1,0,0,0,0,0,0,1,0,1,0,0,0,0,1,0),this._threeJsFaceCameras[t].projectionMatrixInverse=i,this._threeJsFaceCameras[t].layers.set(1);const n=new s.THREE.WebGLRenderTarget(this._faceSize,this._faceSize,{minFilter:s.THREE.LinearFilter,magFilter:s.THREE.LinearFilter});this._threeJsFaceRenderTargets.push(n)}}_updateProjectionMatrix(){const t=this.getEntity().get("camera");if(null===t)return;const e=1-Number.EPSILON,i=-t.getAutoNearDistance()*(2-Number.EPSILON);for(let t=0;t<6;t++)this._threeJsFaceCameras[t].projectionMatrix.elements[6]=e,this._threeJsFaceCameras[t].projectionMatrix.elements[14]=i,this._threeJsFaceCameras[t].projectionMatrixInverse.elements[11]=1/i,this._threeJsFaceCameras[t].projectionMatrixInverse.elements[15]=-e/i}_setupQuad(){const t=new s.THREE.BufferGeometry,e=new Float32Array([-1,-1,1,-1,1,1,-1,1]),i=new Uint16Array([0,1,2,0,2,3]);t.setAttribute("position",new s.THREE.BufferAttribute(e,2)),t.setIndex(new s.THREE.BufferAttribute(i,1));const n={textures:new s.THREE.Uniform([]),faceSize:new s.THREE.Uniform(this._faceSize)};for(let t=0;t<6;t++)n.textures.value.push(this._threeJsFaceRenderTargets[t].texture);const r=new s.THREE.RawShaderMaterial({uniforms:n,vertexShader:"\n\t\t\t\tattribute vec2 position;\n\t\t\t\tvarying vec2 xy;\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_Position = vec4(position.x, position.y, 0.0, 1.0);\n\t\t\t\t\txy = position;\n\t\t\t\t}",fragmentShader:"\n\t\t\t\tprecision mediump float;\n\t\t\t\tuniform sampler2D textures[6];\n\t\t\t\tuniform float faceSize;\n\n\t\t\t\tvarying vec2 xy;\n\n\t\t\t\tvoid adjustTextureCoordsForBorders(inout int textureIndex, inout vec2 xyInTexture, in float pixelSize) {\n\t\t\t\t\t// Get the pixells in pixel-space.\n\t\t\t\t\tvec2 xyInPixels = xyInTexture * pixelSize;\n\n\t\t\t\t\t// Flip the x since this code is for surface cubes, but we're inside out.\n\t\t\t\t\txyInPixels.x = pixelSize - xyInPixels.x;\n\n\t\t\t\t\t// If it's a border, adjust the pixel it's reading the next pixel in one face over.\n\t\t\t\t\t// This allows for nice linear filtering to happen on the material side of things.\n\t\t\t\t\tif (xyInPixels.x < 0.6 || xyInPixels.x > pixelSize - 0.6 || xyInPixels.y < 0.6 || xyInPixels.y > pixelSize - 0.6) {\n\t\t\t\t\t\tif (0 <= textureIndex && textureIndex <= 3) { // One of the horizontal faces\n\t\t\t\t\t\t\tif (xyInPixels.x > pixelSize - 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.x = 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = (textureIndex + 1);\n\t\t\t\t\t\t\t\tif (textureIndex == 4) {\n\t\t\t\t\t\t\t\t\ttextureIndex = 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (xyInPixels.x < 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.x = pixelSize - 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = textureIndex - 1;\n\t\t\t\t\t\t\t\tif (textureIndex == -1) {\n\t\t\t\t\t\t\t\t\ttextureIndex = 3;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (textureIndex == 0) {\n\t\t\t\t\t\t\tif (xyInPixels.y < 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.y = pixelSize - 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 5;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (xyInPixels.y > pixelSize - 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.y = 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 4;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (textureIndex == 1) {\n\t\t\t\t\t\t\tif (xyInPixels.y < 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.y = pixelSize - xyInPixels.x;\n\t\t\t\t\t\t\t\txyInPixels.x = pixelSize - 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 5;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (xyInPixels.y > pixelSize - 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.y = xyInPixels.x;\n\t\t\t\t\t\t\t\txyInPixels.x = pixelSize - 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 4;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (textureIndex == 2) {\n\t\t\t\t\t\t\tif (xyInPixels.y < 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.x = pixelSize - xyInPixels.x;\n\t\t\t\t\t\t\t\txyInPixels.y = 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 5;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (xyInPixels.y > pixelSize - 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.x = pixelSize - xyInPixels.x;\n\t\t\t\t\t\t\t\txyInPixels.y = pixelSize - 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 4;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (textureIndex == 3) {\n\t\t\t\t\t\t\tif (xyInPixels.y < 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.y = xyInPixels.x;\n\t\t\t\t\t\t\t\txyInPixels.x = 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 5;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (xyInPixels.y > pixelSize - 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.y = pixelSize - xyInPixels.x;\n\t\t\t\t\t\t\t\txyInPixels.x = 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 4;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (textureIndex == 4) {\n\t\t\t\t\t\t\tif (xyInPixels.x < 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.x = pixelSize - xyInPixels.y;\n\t\t\t\t\t\t\t\txyInPixels.y = pixelSize - 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 3;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (xyInPixels.x > pixelSize - 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.x = xyInPixels.y;\n\t\t\t\t\t\t\t\txyInPixels.y = pixelSize - 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (xyInPixels.y < 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.y = pixelSize - 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (xyInPixels.y > pixelSize - 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.x = pixelSize - xyInPixels.x;\n\t\t\t\t\t\t\t\txyInPixels.y = pixelSize - 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (textureIndex == 5) {\n\t\t\t\t\t\t\tif (xyInPixels.x < 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.x = xyInPixels.y;\n\t\t\t\t\t\t\t\txyInPixels.y = 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 3;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (xyInPixels.x > pixelSize - 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.x = pixelSize - xyInPixels.y;\n\t\t\t\t\t\t\t\txyInPixels.y = 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (xyInPixels.y < 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.x = pixelSize - xyInPixels.x;\n\t\t\t\t\t\t\t\txyInPixels.y = 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (xyInPixels.y > pixelSize - 0.6) {\n\t\t\t\t\t\t\t\txyInPixels.y = 1.5;\n\t\t\t\t\t\t\t\ttextureIndex = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Shrink all pixels so that they fit within the border.\n\t\t\t\t\t// The border pixels have already been modified so that they work with this equation.\n\t\t\t\t\txyInPixels.x = ((pixelSize - 1.0) * xyInPixels.x - pixelSize) / (pixelSize - 3.0);\n\t\t\t\t\txyInPixels.y = ((pixelSize - 1.0) * xyInPixels.y - pixelSize) / (pixelSize - 3.0);\n\n\t\t\t\t\t// Flip the x back.\n\t\t\t\t\txyInPixels.x = pixelSize - xyInPixels.x;\n\n\t\t\t\t\t// Go back into unit-space.\n\t\t\t\t\txyInTexture = xyInPixels / pixelSize;\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\t// Make it pink everywhere else for easy debugging.\n\t\t\t\t\tvec3 color = vec3(1.0, 0.0, 0.5);\n\t\t\t\t\t// Get the mip level, size, and offset.\n\t\t\t\t\tfloat level = floor(1.0 - log2(1.0 - xy.y)); // 0 is base, then 1, etc.\n\t\t\t\t\tfloat mipSizeX = pow(2.0, -level); // 1, .5, .25, .125, etc.\n\t\t\t\t\tfloat mipOffsetY = 1.0 - pow(2.0, -level); // 0, .5, .75, .875, etc.\n\t\t\t\t\t// Get the xy within the mip level. Note the x value is * 3 for less computing further on.\n\t\t\t\t\tvec2 xyInMip;\n\t\t\t\t\txyInMip.x = 0.5 * (xy.x + 1.0) / mipSizeX * 4.0;\n\t\t\t\t\txyInMip.y = (xy.y + 1.0 - 2.0 * mipOffsetY) / mipSizeX;\n\t\t\t\t\tif (xyInMip.x <= 3.0) {\n\t\t\t\t\t\tint textureIndex = int(floor(xyInMip.y * 2.0) * 3.0 + floor(xyInMip.x));\n\t\t\t\t\t\t// Get the xy within the face/texture.\n\t\t\t\t\t\tvec2 xyInTexture;\n\t\t\t\t\t\txyInTexture.x = 1.0 - xyInMip.x + floor(xyInMip.x);\n\t\t\t\t\t\txyInTexture.y = 2.0 * (xyInMip.y - floor(xyInMip.y * 2.0) / 2.0);\n\t\t\t\t\t\t// Adjust the coordinates and face to account for borders.\n\t\t\t\t\t\tadjustTextureCoordsForBorders(textureIndex, xyInTexture, faceSize * mipSizeX);\n\t\t\t\t\t\t// Set the color based on the face (textureIndex) and the coords.\n\t\t\t\t\t\tif (textureIndex == 0) {\n\t\t\t\t\t\t\tcolor = texture2D(textures[0], xyInTexture).rgb;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (textureIndex == 1) {\n\t\t\t\t\t\t\tcolor = texture2D(textures[1], xyInTexture).rgb;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (textureIndex == 2) {\n\t\t\t\t\t\t\tcolor = texture2D(textures[2], xyInTexture).rgb;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (textureIndex == 3) {\n\t\t\t\t\t\t\tcolor = texture2D(textures[3], xyInTexture).rgb;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (textureIndex == 4) {\n\t\t\t\t\t\t\tcolor = texture2D(textures[4], xyInTexture).rgb;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (textureIndex == 5) {\n\t\t\t\t\t\t\tcolor = texture2D(textures[5], xyInTexture).rgb;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(color, 1.0);\n\t\t\t\t}",depthTest:!1,depthWrite:!1});this._threeJsQuad=new s.THREE.Mesh(t,r),this._threeJsQuad.frustumCulled=!1,this._threeJsScene.add(this._threeJsQuad)}}const n=new s.THREE.Quaternion,r=DynamicEnvironmentMapComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class GizmoComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._size=void 0,this._relativeToEntity=!0,this._joint="",this._jointObject=null,this._model=null,this._lineMesh=null,this.__setRadius(2*i.getExtentsRadius()),this.__setUsesEntityOrientation(this._relativeToEntity)}getSize(){return void 0!==this._size?this._size:Math.max(1e-4,2*this.getEntity().getExtentsRadius())}setSize(t){this._size=t,this.__setRadius(this.getSize())}isRelativeToEntity(){return this._relativeToEntity}setRelativeToEntity(t){this._relativeToEntity=t,this.__setUsesEntityOrientation(this._relativeToEntity)}setJoint(t,e){if(this._joint=t,e)this._model=e;else{const t=this.getEntity().get("model");null!==t&&(this._model=t)}}__prepareForRender(t){if(""===this._joint||null!==this._jointObject&&this._jointObject.name===this._joint||null===this._model||(this._jointObject=this._model.getThreeJsObjectByName(this._joint)),null!==this._jointObject){const e=s.Vector3.pool.get();let i=this._jointObject;for(GizmoComponent._tempThreeJsVector3.copy(i.position),GizmoComponent._tempThreeJsQuaternion.copy(i.quaternion);null!==i.parent&&i.parent!==this._model.getThreeJsObjects()[0];)i=i.parent,GizmoComponent._tempThreeJsVector3.add(i.position),GizmoComponent._tempThreeJsQuaternion.multiplyQuaternions(i.quaternion,GizmoComponent._tempThreeJsQuaternion);e.copyFromThreeJs(GizmoComponent._tempThreeJsVector3),e.mult(e,.001),e.rotate(this._model.getRotation(),e),s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t,e,!0),s.Vector3.pool.release(e);const n=s.Quaternion.pool.get();n.copyFromThreeJs(GizmoComponent._tempThreeJsQuaternion),n.mult(this._model.getRotation(),n),s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects()[0],this.getEntity(),n),s.Quaternion.pool.release(n)}else this._relativeToEntity?s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects()[0],this.getEntity()):s.ThreeJsHelper.setOrientation(this.getThreeJsObjects()[0],s.Quaternion.Identity),s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t);s.ThreeJsHelper.setScale(this.getThreeJsObjects()[0],this.getSize()),this._lineMesh.prepareForRender(t)}__loadResources(){this._lineMesh=new s.LineMesh(this);const t=[];t.push(new s.Vector3(0,0,0)),t.push(new s.Vector3(1,0,0)),t.push(new s.Vector3(0,0,0)),t.push(new s.Vector3(0,1,0)),t.push(new s.Vector3(0,0,0)),t.push(new s.Vector3(0,0,1)),this._lineMesh.setPositions(t);const e=[];e.push(new s.Color(1,0,0)),e.push(new s.Color(1,0,0)),e.push(new s.Color(0,1,0)),e.push(new s.Color(0,1,0)),e.push(new s.Color(0,0,1)),e.push(new s.Color(0,0,1)),this._lineMesh.setColors(e);const i=[];return i.push(2),i.push(2),i.push(2),i.push(2),i.push(2),i.push(2),this._lineMesh.setWidths(i),Promise.resolve()}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this),this._lineMesh=null}}GizmoComponent._tempThreeJsVector3=new s.THREE.Vector3;const n=GizmoComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class LabelComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._text="<PLACEHOLDER>",this._fontFamily="Arial",this._fontSize=16,this._color=new s.Color,this._color.freeze(),this._ignoreDistance=!1,this._alignment=new s.Vector2(0,.5),this._alignment.freeze(),this._pixelOffset=new s.Vector2(0,0),this._pixelOffset.freeze(),this._pixelSize=new s.Vector2,this._devicePixelRatio=1,this._canvas=null,this._normalSpaceBounds=new Map;const n=i.getScene().getEngine().getConfig().getValue("fontFamily");"string"==typeof n&&(this._fontFamily=n);const r=i.getScene().getEngine().getConfig().getValue("fontSize");"number"==typeof r&&(this._fontSize=r),this.__setRadius(Number.POSITIVE_INFINITY)}getText(){return this._text}setText(t){this._text=t,this._updateText()}getFontFamily(){return this._fontFamily}setFontFamily(t){this._fontFamily=t,this._updateText()}getFontSize(){return this._fontSize}setFontSize(t){this._fontSize=t,this._updateText()}getColor(){return this._color}setColor(t){this._color.thaw(),this._color.copy(t),this._color.freeze()}setIgnoreDistance(t){this._ignoreDistance=t}getAlignment(){return this._alignment}setAlignment(t){this._alignment.thaw(),this._alignment.copy(t),this._alignment.freeze(),this._updateText()}getPixelOffset(){return this._pixelOffset}setPixelOffset(t){this._pixelOffset.thaw(),this._pixelOffset.copy(t),this._pixelOffset.freeze()}getNormalSpaceBounds(t){return this._normalSpaceBounds.get(t)}__prepareForRender(t){const e=this.getEntity().getCameraSpacePosition(t);s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t),s.ThreeJsHelper.setOrientation(this.getThreeJsObjects()[0],s.Quaternion.Identity);let i=1;const n=s.Vector2.pool.get();if("spout"===t.getType()){const e=t;i=4,n.set(e.getRenderWidth(),e.getRenderWidth())}else n.copy(t.getViewport().getBounds().size);const r=s.Vector2.pool.get(),o=s.Vector2.pool.get(),a=s.Vector3.pool.get(),l=s.Vector3.pool.get();if(r.set((this._pixelOffset.x-this._alignment.x*this._canvas.width)*i,(this._pixelOffset.y-this._alignment.y*this._canvas.height)*i),o.set(this._canvas.width*i,this._canvas.height*i),t.getEntity().getOrientation().getAxis(a,2),t.getEntity().getOrientation().getAxis(l,0),s.ThreeJsHelper.setUniformVector2(this.getThreeJsMaterials()[0],"pixelOffset",r),s.ThreeJsHelper.setUniformVector2(this.getThreeJsMaterials()[0],"pixelSize",o),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"renderSize",Math.max(n.x,n.y)),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"renderUp",a),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"renderRight",l),"spout"!==t.getType()){this._normalSpaceBounds.has(t)||this._normalSpaceBounds.set(t,new s.Rect);const e=this._normalSpaceBounds.get(t);e.thaw();const r=this.getEntity().getNormalSpacePosition(t);e.origin.x=r.x+2*(this._pixelOffset.x-this._alignment.x*this._pixelSize.x)*i/n.x,e.origin.y=r.y+2*(this._pixelOffset.y-this._alignment.y*this._pixelSize.y)*i/n.y,e.size.x=2*this._pixelSize.x*i/n.x,e.size.y=2*this._pixelSize.y*i/n.y,e.freeze()}s.Vector2.pool.release(o),s.Vector2.pool.release(r),s.Vector3.pool.release(a),s.Vector3.pool.release(l),s.Vector2.pool.release(n);let h=1;const c=this.getEntity().getNormalSpaceExtentsRadius(t);if(this._ignoreDistance||(h*=s.MathUtils.clamp01((.02-c)/.02)),null!==this.getEntity().getParent()){const i=t.getNormalSpaceRadiusFromRadius(this.getEntity().getPosition().magnitude(),e.magnitude()),n=this.getEntity().getParent().getNormalSpaceExtentsRadius(t);!this._ignoreDistance&&n<.02&&(h*=s.MathUtils.clamp01((i-.02)/.02))}(null!==this.getEntity().getParent()&&this.getEntity().getParent().isOccludingPosition(t,e)||t.isPositionOccluded(e))&&(h=0);const d=s.Color.pool.get();d.copy(this._color),d.a*=h,s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"colorMultiplier",d),s.Color.pool.release(d)}async __loadResources(){0===LabelComponent._useCount&&(LabelComponent._threeJsGeometry=s.ThreeJsHelper.createGeometry([{name:"position",dimensions:2},{name:"uv",dimensions:2}],!1),s.ThreeJsHelper.setVertices(LabelComponent._threeJsGeometry,"position",new Float32Array([0,0,1,0,1,1,0,1])),s.ThreeJsHelper.setVertices(LabelComponent._threeJsGeometry,"uv",new Float32Array([0,1,1,1,1,0,0,0])),s.ThreeJsHelper.setIndices(LabelComponent._threeJsGeometry,new Uint16Array([0,1,2,2,3,0])),LabelComponent._threeJsMaterial=new s.THREE.ShaderMaterial({uniforms:{colorMultiplier:new s.THREE.Uniform(new s.THREE.Vector4(1,1,1,1)),colorTexture:new s.THREE.Uniform(null),pixelOffset:new s.THREE.Uniform(new s.THREE.Vector2(0,0)),pixelSize:new s.THREE.Uniform(new s.THREE.Vector2(1,1)),renderSize:new s.THREE.Uniform(1),renderUp:new s.THREE.Uniform(new s.THREE.Vector3(0,1,0)),renderRight:new s.THREE.Uniform(new s.THREE.Vector3(1,0,0))},vertexShader:"\n\t\t\t\t\tuniform vec2 pixelOffset;\n\t\t\t\t\tuniform vec2 pixelSize;\n\t\t\t\t\tuniform float renderSize;\n\t\t\t\t\tuniform vec3 renderUp;\n\t\t\t\t\tuniform vec3 renderRight;\n\t\t\t\t\tvarying vec2 fUV;\n\n\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\tvarying float fragDepth;\n\t\t\t\t\t#else\n\t\t\t\t\t\tuniform float nearDistance;\n\t\t\t\t\t\tuniform float midDistance;\n\t\t\t\t\t#endif\n\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\t// Get a frame for the label to be on the x-y axis.\n\t\t\t\t\t\tvec3 forward = (modelMatrix * vec4(0, 0, 0, 1.)).xyz;\n\t\t\t\t\t\tfloat distance = length(forward);\n\t\t\t\t\t\tforward = normalize(forward);\n\t\t\t\t\t\tvec3 up = normalize(renderUp);\n\t\t\t\t\t\tvec3 right = normalize(cross(forward, up));\n\n\t\t\t\t\t\t// Setup the up and right vectors.\n\t\t\t\t\t\tup *= (position.y * pixelSize.y + pixelOffset.y) / renderSize * distance;\n\t\t\t\t\t\tright *= (position.x * pixelSize.x + pixelOffset.x) / renderSize * distance * projectionMatrix[1][3];\n\n\t\t\t\t\t\t// Do the transforms.\n\t\t\t\t\t\tvec4 viewPosition = modelViewMatrix * vec4(up + right, 1.);\n\t\t\t\t\t\tgl_Position = projectionMatrix * viewPosition;\n\t\t\t\t\t\tgl_Position.w = viewPosition.y;\n\n\t\t\t\t\t\tfUV = uv;\n\n\t\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\t\tfragDepth = gl_Position.w;\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tfloat z = gl_Position.w;\n\t\t\t\t\t\t\tif (z < midDistance) {\n\t\t\t\t\t\t\t\tgl_Position.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\n\t\t\t\t\t\t\t\tgl_Position.z = log2(z - midDistance + 1.0) * logFactor;\n\t\t\t\t\t\t\t\tgl_Position.z *= gl_Position.w;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}",fragmentShader:"\n\t\t\t\t\tuniform vec4 colorMultiplier;\n\t\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\t\tvarying vec2 fUV;\n\n\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\tuniform mat4 projectionMatrix;\n\t\t\t\t\t\tvarying float fragDepth;\n\t\t\t\t\t#endif\n\n\t\t\t\t\tvoid main(void) {\n\t\t\t\t\t\tgl_FragColor = texture2D(colorTexture, fUV);\n\t\t\t\t\t\tgl_FragColor *= colorMultiplier;\n\n\t\t\t\t\t\t// Log-Depth Buffering\n\t\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\n\t\t\t\t\t\t\tgl_FragDepthEXT = projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}",side:s.THREE.DoubleSide}),s.ThreeJsHelper.setupLogDepthBuffering(LabelComponent._threeJsMaterial)),LabelComponent._useCount+=1;const t=LabelComponent._threeJsMaterial.clone();this.getThreeJsMaterials().push(t),s.ThreeJsHelper.setTransparent(t,!0),s.ThreeJsHelper.setOverlay(t,!0),s.ThreeJsHelper.setUniformColorRGBA(t,"colorMultiplier",this._color);const e=s.ThreeJsHelper.createMeshObjectGivenGeometry(this,t,LabelComponent._threeJsGeometry);this.getThreeJsObjects().push(e),this._canvas=document.createElement("canvas"),this._canvas.width=1,this._canvas.height=1,this._updateText()}__unloadResources(){LabelComponent._useCount-=1,0===LabelComponent._useCount&&(s.ThreeJsHelper.destroyGeometry(LabelComponent._threeJsGeometry),s.ThreeJsHelper.destroyMaterial(LabelComponent._threeJsMaterial));const t=this.getThreeJsObjects()[0];null!==t.parent&&t.parent.remove(t),this.getThreeJsMaterials()[0].dispose(),this._canvas=null}_updateText(){if(null===this._canvas)return;const t=this._canvas.getContext("2d");this._devicePixelRatio=window.devicePixelRatio,t.font=this._fontSize+"px "+this._fontFamily;const e=t.measureText(this._text);this._pixelSize.set(e.width*this._devicePixelRatio,this._fontSize*this._devicePixelRatio);const i=s.MathUtils.ceilPow2(this._pixelSize.x),n=s.MathUtils.ceilPow2(this._pixelSize.y);i===this._canvas.width&&n===this._canvas.height||(this._canvas.width=i,this._canvas.height=n),t.clearRect(0,0,this._canvas.width,this._canvas.height),this._canvas.style.width=i/this._devicePixelRatio+"px",this._canvas.style.height=n/this._devicePixelRatio+"px",t.font=this._pixelSize.y+"px "+this._fontFamily,t.fillStyle="rgba(255, 255, 255, 255)",t.fillText(this._text,(this._canvas.width-this._pixelSize.x)*s.MathUtils.clamp01(this._alignment.x),this._canvas.height-.1875*this._pixelSize.y-(this._canvas.height-this._pixelSize.y)*s.MathUtils.clamp01(this._alignment.y));const r=this.getThreeJsMaterials()[0];s.ThreeJsHelper.setUniformTexture(r,"colorTexture",s.ThreeJsHelper.loadTextureFromCanvas(this._canvas))}}LabelComponent._threeJsMaterial=null,LabelComponent._threeJsGeometry=null,LabelComponent._useCount=0;const n=LabelComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class LightSourceComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._color=new s.Color(1,1,1),this._color.freeze(),this._absoluteMagnitude=1,this.__setRadius(Number.POSITIVE_INFINITY)}getColor(){return this._color}setColor(t){this._color.thaw(),this._color.copy(t),this._color.freeze()}getAbsoluteMagnitude(){return this._absoluteMagnitude}setAbsoluteMagnitude(t){this._absoluteMagnitude=t}__loadResources(){return this.getEntity().getScene().__addLightSource(this.getEntity().getName(),this.getTypeIndex()),Promise.resolve()}__unloadResources(){this.getEntity().getScene().__removeLightSource(this.getEntity().getName(),this.getTypeIndex())}__setTypeIndex(t){"loaded"===this.getLoadState()&&this.getEntity().getScene().__removeLightSource(this.getEntity().getName(),this.getTypeIndex()),super.__setTypeIndex(t),"loaded"===this.getLoadState()&&this.getEntity().getScene().__addLightSource(this.getEntity().getName(),this.getTypeIndex())}}const n=LightSourceComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class ModelComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._url="",this._shadowEntities=[],this._translation=new s.Vector3,this._translation.freeze(),this._rotation=new s.Quaternion,this._rotation.freeze(),this._urlReferenceMap=new Map,this._threeJsAnimationClips=new Map,this._hiddenObjects=new s.FastMap,this._scale=new s.Vector3(.001,.001,.001),this._scale.freeze(),this._modelRadius=NaN,this._environmentCubemapUrl="",this._environmentCylindricalUrl="",this._environmentCubemap=null,this._environmentIntensity=.5,this._dynamicEnvironmentMapComponent=null,this._pixelRadiusVisibleInterval=void 0,this._useCompressedTextures=!1,this._onConfigChanged=this._onConfigChanged.bind(this),this.__setRadius(this.getEntity().getExtentsRadius())}getUrl(){return this._url}setUrl(t){""!==this._url&&this.getEntity().getScene().getEngine().getDownloader().cancel(this._url),this.resetResources(),this._modelRadius=NaN,this._loading=!1,this._url=t}setHiddenObject(t,e){e&&!this._hiddenObjects.has(t)?this._hiddenObjects.set(t,null):!e&&this._hiddenObjects.has(t)&&this._hiddenObjects.delete(t)}getTranslation(){return this._translation}setTranslation(t){this._translation.thaw(),this._translation=t,this._translation.freeze()}getScale(){return this._scale}setScale(t){this._scale.thaw(),"number"==typeof t?this._scale.set(t,t,t):this._scale.copy(t),this._scale.freeze(),s.ThreeJsHelper.setScale(this.getThreeJsObjects()[0],this._scale),isNaN(this._modelRadius)?this.__setRadius(this.getEntity().getExtentsRadius()):this.__setRadius(Math.max(this._scale.x,this._scale.y,this._scale.z)*this._modelRadius)}getRotation(){return this._rotation}setRotation(t){this._rotation.thaw(),this._rotation.copy(t),this._rotation.freeze()}getEnvironmentCubemapUrl(){return this._environmentCubemapUrl}setEnvironmentCubemapUrl(t){this._environmentCubemapUrl=t}getEnvironmentIntensity(){return this._environmentIntensity}setEnvironmentIntensity(t){this._environmentIntensity=t;for(let t=0,e=this.getThreeJsMaterials().length;t<e;t++)s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[t],"environmentIntensity",this._environmentIntensity)}getEnvironmentCylindricalUrl(){return this._environmentCylindricalUrl}setEnvironmentCylindricalUrl(t){this._environmentCylindricalUrl=t}setPixelRadiusVisibleInterval(t){if(void 0!==t)void 0===this._pixelRadiusVisibleInterval?this._pixelRadiusVisibleInterval=new s.Interval(t.min,t.max):this._pixelRadiusVisibleInterval.copy(t);else{this._pixelRadiusVisibleInterval=void 0;for(const t of this.getThreeJsMaterials())s.ThreeJsHelper.setUniformNumber(t,"alphaMultiplier",1)}}setDynamicEnvironmentMapComponent(t){this._dynamicEnvironmentMapComponent=t;for(let e=0,i=this.getThreeJsMaterials().length;e<i;e++){const i=this.getThreeJsMaterials()[e];void 0!==i.uniforms.dynEnvTexture&&(s.ThreeJsHelper.setDefine(i,"dynEnvMap",!0),s.ThreeJsHelper.setUniformTexture(i,"dynEnvTexture",this._dynamicEnvironmentMapComponent.getTexture()),s.ThreeJsHelper.setUniformNumber(i,"dynEnvFaceSize",t.getFaceSize()))}null!==this._environmentCubemap&&(this._environmentCubemap.dispose(),this._environmentCubemap=null)}getUseCompressedTextures(){return this._useCompressedTextures}setUseCompressedTextures(t){this._useCompressedTextures=t}setURLReferenceMap(t){this._urlReferenceMap.clear();for(const e of t)this._urlReferenceMap.set(e[0],e[1])}getAnimationClip(t){return this._threeJsAnimationClips.get(t)||null}getMaterial(t){const e=this.getThreeJsMaterials();for(let i=0,s=e.length;i<s;i++)if(e[i].name===t)return e[i];return null}updateMaterial(t,e){const i=this.getThreeJsMaterials();let n;for(let s=0;s<i.length;s++){const r=i[s];if(r.name===t){n=r,i.splice(s,1),i.push(e);break}}if(!n)throw new Error(`No material with the name ${t} was found in ${this}.`);for(let i=0,r=this.getThreeJsObjects().length;i<r;i++){const r=this.getThreeJsObjects()[i];r instanceof s.THREE.Mesh&&r.material===n&&(r.material=e,r.material.name=t)}}getNumShadowEntities(){return this._shadowEntities.length}getShadowEntity(t){return this._shadowEntities[t]}setShadowEntities(t){this._shadowEntities=t.slice(0);const e=t.length>0;for(let t=0,i=this.getThreeJsMaterials().length;t<i;t++)s.ThreeJsHelper.setDefine(this.getThreeJsMaterials()[t],"shadowEntities",e)}__prepareForRender(t){for(let t=0,e=this._hiddenObjects.size;t<e;t++){const e=this._hiddenObjects.getAt(t);null===e.value&&(e.value=this.getThreeJsObjectByName(e.key)),null!==e.value&&(e.value.visible=!1)}if(void 0!==this._pixelRadiusVisibleInterval){const e=this.getEntity().getPixelSpaceExtentsRadius(t),i=s.MathUtils.clamp01(Math.min(1+2*(e-this._pixelRadiusVisibleInterval.min)/this._pixelRadiusVisibleInterval.min,isFinite(this._pixelRadiusVisibleInterval.max)?1-2*(e-this._pixelRadiusVisibleInterval.max)/this._pixelRadiusVisibleInterval.max:1));for(const t of this.getThreeJsMaterials())s.ThreeJsHelper.setUniformNumber(t,"alphaMultiplier",i)}s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t,this._translation,!0),s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects()[0],this.getEntity(),this._rotation);for(let t=0,e=this._shadowEntities.length;t<e;t++){const e=this._shadowEntities[t];if("string"==typeof e){const i=this.getEntity().getScene().getEntity(e);null!==i&&(this._shadowEntities[t]=i)}}s.MaterialUtils.setUniforms(this.getThreeJsMaterials(),t,this.getEntity(),this._shadowEntities,null,!1)}async __loadResources(){const t=this.getEntity().getScene().getEngine(),e=this._url.startsWith("blob:")||this._url.endsWith(".glb");try{const i=await t.getDownloader().download(this._url,e);if("loading"!==this.getLoadState()||"cancelled"===i.status)return;if("failed"===i.status)throw new Error('Failed to load model component file "'+i.url+'": '+i.errorMessage);if(!i.actualUrl.endsWith(".gltf")&&!i.actualUrl.endsWith(".glb")&&!i.actualUrl.startsWith("blob:"))throw new Error("Unknown model format.");const n=new s.THREE.LoadingManager;0===this._urlReferenceMap.size&&n.addHandler(/.$/,this._useCompressedTextures?t.getTextureLoaderCompressed():t.getTextureLoader()),n.setURLModifier((t=>{const e=t.substring(t.lastIndexOf("/")+1);return this._urlReferenceMap.has(e)?this._urlReferenceMap.get(e):t}));const r=new s.ThreeJsGLTFLoader(n);await new Promise(((e,n)=>{r.parse(i.content,s.THREE.LoaderUtils.extractUrlBase(i.actualUrl),(async i=>{const n=i.scene;this._populateThreeJsObjectsAndMaterials(i.scene),"loading"!==this.getLoadState()&&s.ThreeJsHelper.destroyAllObjectsAndMaterials(this),this._clean(),s.ThreeJsHelper.setupObject(this,n),s.ThreeJsHelper.setScale(n,this._scale);const r=(new s.THREE.Box3).setFromObject(n);this._modelRadius=Math.max(r.min.length(),r.max.length()),this.__setRadius(Math.max(this._scale.x,this._scale.y,this._scale.z)*this._modelRadius);for(let t=0;t<i.animations.length;t++)this._threeJsAnimationClips.set(i.animations[t].name,i.animations[t]);null===this._dynamicEnvironmentMapComponent&&null===this._environmentCubemap&&(""!==this._environmentCubemapUrl?await t.getTextureLoader().loadCubeTexture(this._environmentCubemapUrl,!0).then((e=>{this._environmentCubemap=t.getTextureLoader().generateEnvMap(e)})):""!==this._environmentCylindricalUrl&&await t.getTextureLoader().loadTexture(this._environmentCylindricalUrl,!0).then((e=>{this._environmentCubemap=t.getTextureLoader().generateEnvMap(e)}))),this._updateMaterials(),this.getEntity().getScene().getEngine().getConfig().addEventListener("gammaCorrection",this._onConfigChanged),e()}),(t=>{n(new Error(`Error loading gltf: ${t}`))}))}))}catch(t){throw new Error(`While loading model "${this._url}": ${t}`)}}__unloadResources(){for(let t=0,e=this._hiddenObjects.size;t<e;t++)this._hiddenObjects.getAt(t).value=null;this.getEntity().getScene().getEngine().getConfig().removeEventListener("gammaCorrection",this._onConfigChanged),s.ThreeJsHelper.destroyAllObjectsAndMaterials(this),this._lineMesh=null}_populateThreeJsObjectsAndMaterials(t){if(this.getThreeJsObjects().push(t),t instanceof s.THREE.Mesh){let e=t.material;Array.isArray(e)||(e=[e]);for(const t of e){let e=!1;for(let i=0,s=this.getThreeJsMaterials().length;i<s;i++)if(this.getThreeJsMaterials()[i]===t){e=!0;break}e||this.getThreeJsMaterials().push(t)}}for(let e=0;e<t.children.length;e++)this._populateThreeJsObjectsAndMaterials(t.children[e])}_clean(){const t=/_(lamp|hemi)/i;for(let e=0;e<this.getThreeJsObjects().length;e++){const i=this.getThreeJsObjects()[e];i.name.match(t)&&(i.parent&&i.parent.remove(i),this.getThreeJsObjects().splice(e,1),e--)}for(let t=0,e=this.getThreeJsObjects().length;t<e;t++){let e=!1;const i=this.getThreeJsObjects()[t];i instanceof s.THREE.Mesh&&i.geometry instanceof s.THREE.BufferGeometry&&(i.name.startsWith("_root")&&(e=!0),i instanceof s.THREE.Mesh&&i.material instanceof s.THREE.Material&&"transparent"===i.material.name&&(e=!0),e&&(i.geometry.deleteAttribute("position"),i.geometry.deleteAttribute("normal")))}}_onConfigChanged(){this._updateMaterials()}_updateMaterials(){for(let t=0,e=this.getThreeJsMaterials().length;t<e;t++){const e=this.getThreeJsMaterials()[t];if(!(e instanceof s.THREE.MeshStandardMaterial))continue;const i=this._getNewPioneerMaterial(e);this.getThreeJsMaterials()[t]=i;let n=!1;i.defines.normalMap&&(n=!0);for(const t of this.getThreeJsObjects())if(t instanceof s.THREE.Mesh){let r=!1;if(Array.isArray(t.material))for(let s=0,n=t.material.length;s<n;s++)t.material[s]===e&&(t.material[s]=i,r=!0);else t.material===e&&(t.material=i,r=!0);r&&n&&t.geometry instanceof s.THREE.BufferGeometry&&void 0===t.geometry.getAttribute("tangent")&&s.ThreeJsHelper.computeTangents(t.geometry)}e.dispose()}}_getNewPioneerMaterial(t){const e=s.MaterialUtils.getPBR();if(e.name=t.name,e.transparent=t.transparent,e.depthWrite=t.depthWrite,e.side=t.side,null!==t.map){const i=t.map.ktxFormat;void 0!==i&&(t.map.format=i),e.uniforms.colorTexture.value=t.map,e.defines.colorMap=!0}t.roughnessMap&&(e.uniforms.roughnessTexture.value=t.roughnessMap,e.defines.roughnessMap=!0),t.metalnessMap&&(e.uniforms.metalnessTexture.value=t.metalnessMap,e.defines.metalnessMap=!0),null!==t.normalMap&&(e.uniforms.normalTexture.value=t.normalMap,e.uniforms.normalScale.value=t.normalScale,e.defines.normalMap=!0),e.uniforms.emissiveColor.value.copy(t.emissive),e.uniforms.emissiveColor.value.multiplyScalar(t.emissiveIntensity),null!==t.emissiveMap&&(e.uniforms.emissiveTexture.value=t.emissiveMap,e.defines.emissiveMap=!0),e.uniforms.color.value=t.color,e.uniforms.roughness.value=t.roughness,e.uniforms.metalness.value=t.metalness;let i=0;return null!==this._dynamicEnvironmentMapComponent?(e.defines.dynEnvMap=!0,e.uniforms.dynEnvTexture.value=this._dynamicEnvironmentMapComponent.getTexture(),e.uniforms.dynEnvFaceSize.value=this._dynamicEnvironmentMapComponent.getFaceSize()):null!==this._environmentCubemap&&(e.defines.envMap=!0,e.defines.envIsCubeUV=!0,e.uniforms.envTexture.value=this._environmentCubemap,i=this._environmentCubemap.image.height,e.uniforms.maxMipLevel.value=Math.log(i)*Math.LOG2E),e.uniforms.environmentIntensity.value=this._environmentIntensity,e.uniforms.gammaCorrectionFactor.value=this.getEntity().getScene().getEngine().getConfig().getValue("gammaCorrection"),this._shadowEntities.length>0&&(e.defines.shadowEntities=!0),e.needsUpdate=!0,e}}const n=ModelComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class OrbitalParticlesComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._scaleOfParticles=1,this._loadFunction=null,this._orbitalElementsList=[],this._offsetArray=new Float32Array(0),this._spriteParticles=null,this.__setRadius(100*this.getEntity().getExtentsRadius())}getScaleOfParticles(){return this._scaleOfParticles}setScaleOfParticles(t){this._scaleOfParticles=t,this.resetResources()}setLoadFunction(t){this._loadFunction=t,this.resetResources()}__update(){if(null===this._spriteParticles)return;const t=s.Vector3.pool.get(),e=s.Vector3.pool.get(),i=this.getEntity().getScene().getEngine().getTime();for(let s=0,n=this._orbitalElementsList.length;s<n;s++)this._orbitalElementsList[s].project(t,e,i),this._offsetArray[3*s+0]=t.x,this._offsetArray[3*s+1]=t.y,this._offsetArray[3*s+2]=t.z;s.Vector3.pool.release(t),s.Vector3.pool.release(e),this._spriteParticles.setParticleOffsets(this._offsetArray)}__prepareForRender(t){this._spriteParticles.prepareForRender(t)}async __loadResources(){this._spriteParticles=new s.SpriteParticles(this),this.getThreeJsMaterials().push(this._spriteParticles.getThreeJsMaterial()),this.getThreeJsObjects().push(this._spriteParticles.getThreeJsObject()),await this._initializeParticles()}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this),this._spriteParticles=null}async _initializeParticles(){if(null===this._loadFunction)return;const t=await this._loadFunction(),e=t.orbitalElements.length;this._orbitalElementsList=[];let i=0;for(let n=0,r=e;n<r;n++){const e=new s.OrbitalElements;e.copy(t.orbitalElements[n]),this._orbitalElementsList.push(e);const r=e.semiMajorAxis*(1+e.eccentricity);i=Math.max(i,r)}this.__setRadius(i),this._offsetArray=new Float32Array(3*e);const n=new Float32Array(4*e),r=new Float32Array(1*e);for(let i=0,s=e;i<s;i++)n[4*i+0]=t.colors[i].r,n[4*i+1]=t.colors[i].g,n[4*i+2]=t.colors[i].b,n[4*i+3]=t.colors[i].a,r[1*i+0]=t.scales[i]*this._scaleOfParticles;this._spriteParticles.setParticleColors(n),this._spriteParticles.setParticleScales(r)}}const n=OrbitalParticlesComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class ParticleSprayComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._length=1,this._spread=30,this._numberOfParticles=0,this._speedOfParticles=.1,this._sizeOfParticles=.1,this._particleSpacingRandom=!0,this._colorOfParticles=new s.Color,this._colorOfParticles.freeze(),this._originOffset=new s.Vector3,this._originOffset.freeze(),this._direction=new s.Vector3,this._direction.freeze(),this._relativeToEntityOrientation=!0,this.__setRadius(this._length)}getLength(){return this._length}setLength(t){this._length=t,this.__setRadius(this._length),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"length",this._length),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"totalTime",this._length/this._speedOfParticles)}getSpread(){return this._spread}setSpread(t){this._spread=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"spread",s.MathUtils.degToRad(this._spread))}getNumberOfParticles(){return this._numberOfParticles}setNumberOfParticles(t){this._numberOfParticles=t,this.resetResources()}getSpeedOfParticles(){return this._speedOfParticles}setSpeedOfParticles(t){this._speedOfParticles=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"totalTime",this._length/this._speedOfParticles)}getSizeOfParticles(){return this._sizeOfParticles}setSizeOfParticles(t){this._sizeOfParticles=t,this.resetResources()}getParticleSpacingRandom(){return this._particleSpacingRandom}setParticleSpacingRandom(t){this._particleSpacingRandom=t,this.resetResources()}getColorOfParticles(){return this._colorOfParticles}setColorOfParticles(t){this._colorOfParticles.thaw(),this._colorOfParticles.copy(t),this._colorOfParticles.freeze(),s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"globalColor",this._colorOfParticles)}getOriginOffset(){return this._originOffset}setOriginOffset(t){this._originOffset.thaw(),this._originOffset.copy(t),this._originOffset.freeze(),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"originOffset",this._originOffset)}getDirection(){return this._direction}setDirection(t){this._direction.thaw(),this._direction.normalize(t),this._direction.freeze(),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"direction",this._direction);const e=s.Vector3.pool.get();e.cross(this._direction,s.Vector3.XAxis),e.isZero()&&e.cross(this._direction,s.Vector3.YAxis),e.normalize(e),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"directionPerp",e),s.Vector3.pool.release(e)}getRelativeToEntityOrientation(){return this._relativeToEntityOrientation}setRelativeToEntityOrientation(t){this._relativeToEntityOrientation=t}__prepareForRender(t){const e=s.MathUtils.wrap(this.getEntity().getScene().getEngine().getTime(),0,this._length/this._speedOfParticles);if(s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"time",e),this._relativeToEntityOrientation){const t=s.Vector3.pool.get(),e=s.Vector3.pool.get();t.rotate(this.getEntity().getOrientation(),this._originOffset),e.rotate(this.getEntity().getOrientation(),this._direction),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"originOffset",t),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"direction",e);const i=s.Vector3.pool.get();i.cross(e,s.Vector3.XAxis),i.isZero()&&i.cross(e,s.Vector3.YAxis),i.normalize(i),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"directionPerp",i),s.Vector3.pool.release(i),s.Vector3.pool.release(t),s.Vector3.pool.release(e)}s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t)}async __loadResources(){const t=new s.THREE.RawShaderMaterial({uniforms:{spread:new s.THREE.Uniform(0),originOffset:new s.THREE.Uniform(new s.THREE.Vector3),direction:new s.THREE.Uniform(new s.THREE.Vector3),directionPerp:new s.THREE.Uniform(new s.THREE.Vector3),length:new s.THREE.Uniform(0),time:new s.THREE.Uniform(0),totalTime:new s.THREE.Uniform(0),globalColor:new s.THREE.Uniform(new s.THREE.Vector4(1,1,1,1))},vertexShader:s.ShaderFix.fix(ParticleSprayComponent.vertexShader,"vertex"),fragmentShader:s.ShaderFix.fix(ParticleSprayComponent.fragmentShader,"fragment"),transparent:!0,depthWrite:!1,blending:s.THREE.AdditiveBlending,side:s.THREE.DoubleSide});this.getThreeJsMaterials().push(t);const e=new Float32Array([-1,-1,1,-1,1,1,-1,1]),i=new Float32Array(3*this._numberOfParticles),n=new Float32Array(4*this._numberOfParticles),r=new Float32Array(1*this._numberOfParticles),o=new Uint16Array([0,1,2,2,3,0]),a=new s.THREE.InstancedBufferGeometry;a.setAttribute("position",new s.THREE.BufferAttribute(e,2)),a.setAttribute("params",new s.THREE.InstancedBufferAttribute(i,3)),a.setAttribute("color",new s.THREE.InstancedBufferAttribute(n,4)),a.setAttribute("size",new s.THREE.InstancedBufferAttribute(r,1)),a.setIndex(new s.THREE.BufferAttribute(o,1)),a.instanceCount=this._numberOfParticles;const l=s.ThreeJsHelper.createMeshObjectGivenGeometry(this,t,a);this.getThreeJsObjects().push(l),s.ThreeJsHelper.setOrientation(this.getThreeJsObjects()[0],s.Quaternion.Identity),this._initializeParticles(),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"length",this._length),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"spread",s.MathUtils.degToRad(this._spread)),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"totalTime",this._length/this._speedOfParticles),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"originOffset",this._originOffset),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"direction",this._direction),s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"globalColor",this._colorOfParticles);const h=s.Vector3.pool.get();h.cross(this._direction,s.Vector3.XAxis),h.isZero()&&h.cross(this._direction,s.Vector3.YAxis),h.normalize(h),s.ThreeJsHelper.setUniformVector3(this.getThreeJsMaterials()[0],"directionPerp",h),s.Vector3.pool.release(h)}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this)}_initializeParticles(){const t=this.getThreeJsObjects()[0].geometry.attributes.params,e=this.getThreeJsObjects()[0].geometry.attributes.color,i=this.getThreeJsObjects()[0].geometry.attributes.size,s=t.array,n=e.array,r=i.array;for(let t=0,e=this._numberOfParticles;t<e;t++)s[3*t+0]=2*Math.random()-1,s[3*t+1]=2*Math.random()-1,this._particleSpacingRandom?s[3*t+2]=Math.random():s[3*t+2]=t/this._numberOfParticles,n[4*t+0]=1,n[4*t+1]=1,n[4*t+2]=1,n[4*t+3]=1,r[1*t+0]=this._sizeOfParticles;t.needsUpdate=!0,e.needsUpdate=!0,i.needsUpdate=!0}}ParticleSprayComponent.vertexShader="\n\tattribute vec2 position;\n\tattribute vec3 params; // x, y are in plane made by direction if z were 1, z is 0 to 1 where the particle is in the total length at time = 0\n\tattribute vec4 color;\n\tattribute float size;\n\n\tuniform float spread;\n\tuniform vec3 originOffset; // in model-space\n\tuniform vec3 direction; // in model-space\n\tuniform vec3 directionPerp; // in model-space\n\tuniform float length;\n\tuniform float time;\n\tuniform float totalTime;\n\n\tuniform mat4 modelViewMatrix;\n\tuniform mat4 projectionMatrix;\n\n\tvarying vec2 vPosition;\n\tvarying vec4 vColor;\n\n\t#ifdef L_EXT_frag_depth\n\t\tvarying float fragDepth;\n\t#else\n\t\tuniform float nearDistance;\n\t\tuniform float midDistance;\n\t#endif\n\n\tvoid main() {\n\t\tfloat u = mod(params.z + time / totalTime, 1.0);\n\t\tfloat sinSpread = sin(spread);\n\t\tfloat uSpread = sinSpread > 0.0 ? u : (1.0 - u);\n\t\tfloat sizeAtU = size * max(0.1, uSpread);\n\t\tvec3 directionPerp2 = cross(direction, directionPerp);\n\t\tvec3 modelPosition = originOffset + (directionPerp * params.x * sinSpread * uSpread + directionPerp2 * params.y * sinSpread * uSpread + direction * u) * length;\n\t\tvec4 viewPosition = vec4(position.x * sizeAtU, 0, position.y * sizeAtU, 1) + modelViewMatrix * vec4(modelPosition, 1.0);\n\t\tgl_Position = projectionMatrix * viewPosition;\n\t\tgl_Position.w = viewPosition.y;\n\n\t\t// Set the varying variables.\n\t\tvPosition = position;\n\t\tvColor = color * (1.0 - u);\n\n\t\t// Do log-depth buffering.\n\t\t#ifdef L_EXT_frag_depth\n\t\t\tfragDepth = gl_Position.w;\n\t\t#else\n\t\t\tfloat z = gl_Position.w;\n\t\t\tif (z < midDistance) {\n\t\t\t\tgl_Position.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\n\t\t\t\tgl_Position.z = log2(z - midDistance + 1.0) * logFactor;\n\t\t\t\tgl_Position.z *= gl_Position.w;\n\t\t\t}\n\t\t#endif\n\t}",ParticleSprayComponent.fragmentShader="\n\tuniform vec4 globalColor;\n\n\tvarying vec2 vPosition;\n\tvarying vec4 vColor;\n\n\t#ifdef L_EXT_frag_depth\n\t\tuniform mat4 projectionMatrix;\n\t\tvarying float fragDepth;\n\t#endif\n\n\tvoid main(void) {\n\t\t// Set the color to be a circle tinted by the color and globalColor.\n\t\tgl_FragColor = globalColor * vColor * max(0.0, 1.0 - dot(vPosition, vPosition));\n\n\t\t// Do log-depth buffering.\n\t\t#ifdef L_EXT_frag_depth\n\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\n\t\t\tgl_FragDepthEXT = projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\n\t\t#endif\n\t}";const n=ParticleSprayComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class RingsComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._topTextureUrl="",this._bottomTextureUrl="",this._innerRadius=0,this._outerRadius=0,this._fadeDistance=0,this._shadowEntities=[],this._spheroidComponentRef=new s.ComponentRef(this.getEntity().getScene()),this._spheroidComponentRef.setByType(this.getEntity().getName(),"spheroid"),this._spheroidComponentRef.setRefChangedCallback(this._spheroidRefChangedCallback.bind(this)),this._spheroidChangedCallback=this._spheroidChangedCallback.bind(this),this.__setUsesEntityOrientation(!0)}getTopTextureUrl(){return this._topTextureUrl}setTopTextureUrl(t){this._topTextureUrl=t,s.ThreeJsHelper.loadTextureIntoUniform(this,this.getThreeJsMaterials()[0],"topTexture",this._topTextureUrl,!0,!1)}getBottomTextureUrl(){return this._bottomTextureUrl}setBottomTextureUrl(t){this._bottomTextureUrl=t,s.ThreeJsHelper.loadTextureIntoUniform(this,this.getThreeJsMaterials()[0],"bottomTexture",this._bottomTextureUrl,!0,!1)}getInnerRadius(){return this._innerRadius}setInnerRadius(t){this._innerRadius=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"innerRadius",this._innerRadius)}getOuterRadius(){return this._outerRadius}setOuterRadius(t){this._outerRadius=t,this.__setRadius(this._outerRadius),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"outerRadius",this._outerRadius)}getTopTexture(){const t=this.getThreeJsMaterials()[0];return void 0!==t?t.uniforms.topTexture.value:null}getFadeDistance(){return this._fadeDistance}setFadeDistance(t){this._fadeDistance=t}__destroy(){const t=this._spheroidComponentRef.get();null!==t&&t.removeChangedCallback(this._spheroidChangedCallback),super.__destroy()}__update(){this._spheroidComponentRef.update()}__prepareForRender(t){if(this._fadeDistance>0){const e=s.Vector3.pool.get(),i=s.Quaternion.pool.get(),n=this.getThreeJsObjects()[0].quaternion;i.copyFromThreeJs(n),e.rotateInverse(this.getEntity().getOrientation(),this.getEntity().getCameraSpacePosition(t)),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"alphaFadeMultiplier",s.MathUtils.lerp(0,1,s.MathUtils.clamp01(2*(Math.abs(e.z)/this._fadeDistance-1)+1))),s.Quaternion.pool.release(i),s.Vector3.pool.release(e)}s.MaterialUtils.setLightSourceUniforms(this.getThreeJsMaterials(),this.getEntity(),t),s.MaterialUtils.setUniforms(this.getThreeJsMaterials(),t,this.getEntity(),this._shadowEntities,null,!1),s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects()[0],this.getEntity()),s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t)}async __loadResources(){const t=s.ThreeJsHelper.loadTexture(this,this._topTextureUrl,!0,!1),e=s.ThreeJsHelper.loadTexture(this,this._bottomTextureUrl,!0,!1),[i,n]=await Promise.all([t,e]);if(this.isDestroyed())return i.dispose(),void n.dispose();const r=new s.THREE.ShaderMaterial({uniforms:{ambientLightColor:new s.THREE.Uniform(new s.THREE.Color),lightPositions:new s.THREE.Uniform([new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0),new s.THREE.Vector3(1,0,0)]),lightColors:new s.THREE.Uniform([new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0),new s.THREE.Vector3(0,0,0)]),lightRadii:new s.THREE.Uniform([0,0,0,0,0]),numLights:new s.THREE.Uniform(0),entityPos:new s.THREE.Uniform(new s.THREE.Vector3),innerRadius:new s.THREE.Uniform(this._innerRadius),outerRadius:new s.THREE.Uniform(this._outerRadius),topTexture:new s.THREE.Uniform(i),bottomTexture:new s.THREE.Uniform(n),alphaFadeMultiplier:new s.THREE.Uniform(1),spheroidEquatorialRadius:new s.THREE.Uniform(0),spheroidPolarRadius:new s.THREE.Uniform(0)},vertexShader:RingsComponent.vertexShader,fragmentShader:RingsComponent.fragmentShader,transparent:!0,depthWrite:!1,blending:s.THREE.NormalBlending,side:s.THREE.DoubleSide});this.getThreeJsMaterials().push(r),s.ThreeJsHelper.setupLogDepthBuffering(r);const o=s.ThreeJsHelper.createMeshObject(this,r,[{name:"position",dimensions:3},{name:"normal",dimensions:3}],!1),a=10,l=new Float32Array(300),h=new Float32Array(300),c=new Uint16Array(486);for(let t=0;t<a;t++)for(let e=0;e<a;e++){const i=e+t*a;l[3*i+0]=e/9*2-1,l[3*i+1]=t/9*2-1,l[3*i+2]=0,h[3*i+0]=0,h[3*i+1]=0,h[3*i+2]=1,e+1<a&&t+1<a&&(c[6*(e+9*t)+0]=e+0+(t+0)*a,c[6*(e+9*t)+1]=e+0+(t+1)*a,c[6*(e+9*t)+2]=e+1+(t+0)*a,c[6*(e+9*t)+3]=e+1+(t+0)*a,c[6*(e+9*t)+4]=e+0+(t+1)*a,c[6*(e+9*t)+5]=e+1+(t+1)*a)}s.ThreeJsHelper.setVertices(o.geometry,"position",l),s.ThreeJsHelper.setVertices(o.geometry,"normal",h),s.ThreeJsHelper.setIndices(o.geometry,c),o.material=r,this.getThreeJsObjects().push(o),this._spheroidChangedCallback()}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this)}_spheroidRefChangedCallback(t,e){null!==t&&t.removeChangedCallback(this._spheroidChangedCallback),null!==e&&e.addChangedCallback(this._spheroidChangedCallback),this._spheroidChangedCallback()}_spheroidChangedCallback(){const t=this.getThreeJsMaterials()[0];if(null!==t){const e=this._spheroidComponentRef.get();null!==e?(s.ThreeJsHelper.setUniformNumber(t,"spheroidEquatorialRadius",e.getEquatorialRadius()),s.ThreeJsHelper.setUniformNumber(t,"spheroidPolarRadius",e.getPolarRadius())):(s.ThreeJsHelper.setUniformNumber(t,"spheroidEquatorialRadius",0),s.ThreeJsHelper.setUniformNumber(t,"spheroidPolarRadius",0))}}}RingsComponent.vertexShader="\n\tuniform float outerRadius;\n\n\tvarying vec3 localPosition;\n\tvarying vec3 modelPosition;\n\tvarying vec3 modelNormal;\n\n\t#ifdef L_EXT_frag_depth\n\t\tvarying float fragDepth;\n\t#else\n\t\tuniform float nearDistance;\n\t\tuniform float midDistance;\n\t#endif\n\n\tvoid main() {\n\t\tlocalPosition = position * outerRadius;\n\t\tmodelPosition = (modelMatrix * vec4(localPosition, 1.)).xyz;\n\t\tmodelNormal = (modelMatrix * vec4(normal, 0.)).xyz;\n\t\tvec4 viewPosition = viewMatrix * vec4(modelPosition, 1.);\n\t\tgl_Position = projectionMatrix * viewPosition;\n\t\tgl_Position.w = viewPosition.y;\n\n\t\t#ifdef L_EXT_frag_depth\n\t\t\tfragDepth = gl_Position.w;\n\t\t#else\n\t\t\tfloat z = gl_Position.w;\n\t\t\tif (z < midDistance) {\n\t\t\t\tgl_Position.z = nearDistance *(z - midDistance) / (midDistance - nearDistance);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\n\t\t\t\tgl_Position.z = log2(z - midDistance + 1.0) * logFactor;\n\t\t\t\tgl_Position.z *= gl_Position.w;\n\t\t\t}\n\t\t#endif\n\t}",RingsComponent.fragmentShader="\n\t#ifndef saturate\n\t\t#define saturate(a) clamp(a, 0.0, 1.0)\n\t#endif\n\n\tuniform vec3 ambientLightColor;\n\tuniform vec3 lightPositions[5];\n\tuniform vec3 lightColors[5];\n\tuniform int numLights;\n\n\tuniform float innerRadius;\n\tuniform float outerRadius;\n\tuniform sampler2D topTexture;\n\tuniform sampler2D bottomTexture;\n\tuniform float alphaFadeMultiplier;\n\tuniform float spheroidEquatorialRadius;\n\tuniform float spheroidPolarRadius;\n\tuniform vec3 entityPos;\n\n\t// The varying attributes.\n\tvarying vec3 localPosition;\n\tvarying vec3 modelPosition;\n\tvarying vec3 modelNormal;\n\n\t#ifdef L_EXT_frag_depth\n\t\tuniform mat4 projectionMatrix;\n\t\tvarying float fragDepth;\n\t#endif\n\n\tfloat spheroidShadow(vec3 lightDir, float lightCosAngle, float spheroidScaling, vec3 normal, vec3 ringPos) {\n\t\tvec3 sunDirScaled = normalize(lightDir - (spheroidScaling - 1.0) * lightCosAngle * normal);\n\t\tfloat pDotLScaled = dot(ringPos, sunDirScaled);\n\t\tif(dot(ringPos, ringPos) - pDotLScaled * pDotLScaled < spheroidEquatorialRadius * spheroidEquatorialRadius && pDotLScaled > 0.0) {\n\t\t\treturn 0.0;\n\t\t}\n\t\telse {\n\t\t\treturn 1.0;\n\t\t}\n\t}\n\n\tvoid main(void) {\n\t\tfloat spheroidScaling = spheroidEquatorialRadius / spheroidPolarRadius;\n\t\tvec3 positionDir = normalize(modelPosition);\n\t\tvec3 ringPos = modelPosition - entityPos;\n\t\tvec3 normal = normalize(modelNormal);\n\t\tfloat cameraCosAngle = -dot(positionDir, normal);\n\n\t\t// Calculate the UVs.\n\t\tvec2 uv;\n\t\tuv.x = (length(localPosition) - innerRadius) / (outerRadius - innerRadius);\n\t\tif (uv.x < 0.0 || uv.x > 1.0) {\n\t\t\tgl_FragColor = vec4(0, 0, 0, 0);\n\t\t\treturn;\n\t\t}\n\t\tuv.y = 0.0;\n\n\t\t// Get the pixels at those uvs.\n\t\tvec4 topPixel = texture2D(topTexture, uv);\n\t\tvec4 bottomPixel = texture2D(bottomTexture, uv);\n\n\t\t// For each light,\n\t\tfor (int i = 0; i < 5; i++) {\n\t\t\tif (i >= numLights) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvec3 lightDir = normalize(modelPosition - lightPositions[i]);\n\t\t\tfloat lightCosAngle = -dot(lightDir, normal);\n\n\t\t\tfloat cameraDirDotLight = dot(positionDir, lightDir);\n\t\t\tfloat bottomTopRatio = (1.0 + 0.2 * cameraDirDotLight) * sign(cameraCosAngle) * lightCosAngle;\n\t\t\tfloat shadow = spheroidShadow(lightDir, lightCosAngle, spheroidScaling, normal, ringPos);\n\t\t\tvec3 bottomColor = saturate(ambientLightColor + lightColors[i] * (1.0 - bottomTopRatio) * shadow);\n\t\t\tvec3 topColor = 2.0 * saturate(ambientLightColor + lightColors[i] * bottomTopRatio * shadow);\n\n\t\t\tvec3 color = mix(bottomPixel.rgb * bottomColor, topPixel.rgb * topColor, bottomTopRatio);\n\t\t\tgl_FragColor.rgb += color;\n\t\t}\n\n\t\tgl_FragColor.a = topPixel.a;\n\t\tgl_FragColor.a *= alphaFadeMultiplier;\n\n\t\t// Log-Depth Buffering\n\t\t#ifdef L_EXT_frag_depth\n\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\n\t\t\tgl_FragDepthEXT = projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\n\t\t#endif\n\t}";const n=RingsComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class SkyboxComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._numLatVerts=20,this._textureUrl="",this.__setRadius(1e24),this.__setUsesEntityOrientation(!0)}getTextureUrl(){return this._textureUrl}setTextureUrl(t){this._textureUrl=t,this.resetResources()}__prepareForRender(t){s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects()[0],this.getEntity()),s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t)}async __loadResources(){const t=await s.ThreeJsHelper.loadTexture(this,this._textureUrl,!1,!1);if("loading"!==this.getLoadState())return void t.dispose();const e=s.MaterialUtils.get();this.getThreeJsMaterials().push(e),e.defines.colorMapEmmissive=!0,e.needsUpdate=!0,e.uniforms.colorTexture.value=t;const i=s.ThreeJsHelper.createMeshObject(this,e,[{name:"position",dimensions:3},{name:"uv",dimensions:2}],!1);this.getThreeJsObjects().push(i),s.ThreeJsHelper.useInDynEnvMap(i,!0);const n=s.MathUtils.pi/(this._numLatVerts-1),r=s.MathUtils.pi/this._numLatVerts,o=(2*this._numLatVerts+1)*this._numLatVerts,a=new Float32Array(3*o),l=new Float32Array(2*o),h=new Uint16Array(this._numLatVerts*(this._numLatVerts-1)*12),c=s.Vector3.pool.get(),d=s.LatLonAlt.pool.get();for(let t=0;t<this._numLatVerts;t++)for(let e=0;e<2*this._numLatVerts+1;e++){d.lat=t*n-s.MathUtils.halfPi,d.lon=e*r-s.MathUtils.pi,d.alt=0,c.x=5e23*Math.cos(d.lat)*Math.cos(d.lon),c.y=5e23*Math.cos(d.lat)*Math.sin(d.lon),c.z=5e23*Math.sin(d.lat);const i=t*(2*this._numLatVerts+1)+e;a[3*i+0]=c.x,a[3*i+1]=c.y,a[3*i+2]=c.z,l[2*i+0]=.5-d.lon/s.MathUtils.twoPi,l[2*i+1]=.5-d.lat/s.MathUtils.pi;const o=t*this._numLatVerts*2+e;t<this._numLatVerts-1&&e<2*this._numLatVerts&&(h[6*o+0]=(2*this._numLatVerts+1)*(t+0)+(e+0),h[6*o+1]=(2*this._numLatVerts+1)*(t+1)+(e+0),h[6*o+2]=(2*this._numLatVerts+1)*(t+1)+(e+1),h[6*o+3]=(2*this._numLatVerts+1)*(t+0)+(e+0),h[6*o+4]=(2*this._numLatVerts+1)*(t+1)+(e+1),h[6*o+5]=(2*this._numLatVerts+1)*(t+0)+(e+1))}s.LatLonAlt.pool.release(d),s.Vector3.pool.release(c);const u=this.getThreeJsObjects()[0].geometry;s.ThreeJsHelper.setVertices(u,"position",a),s.ThreeJsHelper.setVertices(u,"uv",l),s.ThreeJsHelper.setIndices(u,h)}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this)}}const n=SkyboxComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class SpheroidComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._equatorialRadius=1,this._polarRadius=1,this._planetographic=!1,this._changed=!0,this._changedCallbacks=new s.FastSet}getEquatorialRadius(){return this._equatorialRadius}setEquatorialRadius(t){this._equatorialRadius=t,this._changed=!0}getPolarRadius(){return this._polarRadius}setPolarRadius(t){this._polarRadius=t,this._changed=!0}isPlanetographic(){return this._planetographic}setPlanetographic(t){this._planetographic=t,this._changed=!0}addChangedCallback(t){this._changedCallbacks.add(t)}removeChangedCallback(t){this._changedCallbacks.delete(t)}__update(){if(this._changed){for(let t=0,e=this._changedCallbacks.size;t<e;t++)this._changedCallbacks.getAt(t)();this._changed=!1}}xyzFromLLA(t,e){const i=Math.cos(e.lat),s=Math.sin(e.lat);if(this._planetographic){const n=1-this._polarRadius*this._polarRadius/(this._equatorialRadius*this._equatorialRadius),r=this._equatorialRadius/Math.sqrt(1-n*s*s);t.x=(r+e.alt)*i*Math.cos(e.lon),t.y=(r+e.alt)*i*Math.sin(e.lon),t.z=((1-n)*r+e.alt)*s}else{const n=this._equatorialRadius,r=this._polarRadius,o=n*r/Math.sqrt(r*r*i*i+n*n*s*s);t.x=(o+e.alt)*i*Math.cos(e.lon),t.y=(o+e.alt)*i*Math.sin(e.lon),t.z=(o+e.alt)*s}}radiusFromXYZ(t,e=5){if(this._planetographic){const i=t.magnitudeXY(),s=1-this._polarRadius*this._polarRadius/(this._equatorialRadius*this._equatorialRadius);let n=Math.atan(t.z/((1-s)*i)),r=0;for(let o=0;o<e;o++){const e=Math.sin(n);r=this._equatorialRadius/Math.sqrt(1-s*e*e),n=Math.atan((t.z+r*s*e)/i)}return r}{const e=t.z*t.z/(t.x*t.x+t.y*t.y),i=1/(1+e),s=e*i,n=this._equatorialRadius,r=this._polarRadius;return n*r/Math.sqrt(r*r*i+n*n*s)}}llaFromXYZ(t,e,i=5){if(this._planetographic){t.lon=Math.atan2(e.y,e.x);const s=e.magnitudeXY(),n=1-this._polarRadius*this._polarRadius/(this._equatorialRadius*this._equatorialRadius);t.lat=Math.atan(e.z/((1-n)*s));let r=0;for(let o=0;o<i;o++){const i=Math.sin(t.lat);r=1/Math.sqrt(1-n*i*i),t.lat=Math.atan((e.z+this._equatorialRadius*r*n*i)/s)}t.alt=s/Math.cos(t.lat)-this._equatorialRadius*r}else{const i=e.magnitudeXY();t.lon=Math.atan2(e.y,e.x),t.lat=Math.atan(e.z/i);const s=Math.cos(t.lat),n=Math.sin(t.lat),r=this._equatorialRadius,o=this._polarRadius,a=r*o/Math.sqrt(o*o*s*s+r*r*n*n);t.alt=e.magnitude()-a}}llaToggleGraphicCentric(t,e){const i=s.Vector3.pool.get();this.xyzFromLLA(i,e),this._planetographic=!this._planetographic,this.llaFromXYZ(t,i),this._planetographic=!this._planetographic,s.Vector3.pool.release(i)}upFromLLA(t,e){const i=s.LatLonAlt.pool.get();this._planetographic?i.copy(e):this.llaToggleGraphicCentric(i,e),t.x=Math.cos(i.lat)*Math.cos(i.lon),t.y=Math.cos(i.lat)*Math.sin(i.lon),t.z=Math.sin(i.lat),s.LatLonAlt.pool.release(i)}eastFromLLA(t,e){t.x=-Math.sin(e.lon),t.y=Math.cos(e.lon),t.z=0}northFromLLA(t,e){const i=s.LatLonAlt.pool.get();this._planetographic?i.copy(e):this.llaToggleGraphicCentric(i,e),t.x=-Math.sin(i.lat)*Math.cos(i.lon),t.y=-Math.sin(i.lat)*Math.sin(i.lon),t.z=Math.cos(i.lat),s.LatLonAlt.pool.release(i)}orientationFromLLA(t,e){const i=s.LatLonAlt.pool.get();this._planetographic?i.copy(e):this.llaToggleGraphicCentric(i,e);const n=Math.sin(i.lat),r=Math.sin(i.lon),o=Math.cos(i.lon);t.w=.5*Math.sqrt((1+n)*(1-r)),t.x=.5*Math.sqrt((1-n)*(1-r)),t.y=.5*Math.sqrt((1-n)*(1+r))*Math.sign(o),t.z=.5*Math.sqrt((1+n)*(1+r))*Math.sign(o),s.LatLonAlt.pool.release(i)}aerFromXYZRelToLLA(t,e,i){const n=s.Vector3.pool.get();this.xyzFromLLA(n,i);const r=s.LatLonAlt.pool.get();this._planetographic?r.copy(i):this.llaFromXYZ(r,n),n.sub(e,n),t.range=n.magnitude(),n.mult(n,1/t.range);const o=s.Vector3.pool.get();this.upFromLLA(o,r);const a=n.dot(o);t.elevation=s.MathUtils.halfPi-Math.acos(a),n.addMult(n,o,-a),s.Vector3.pool.release(o);const l=s.Vector3.pool.get();this.northFromLLA(l,r);const h=s.Vector3.pool.get();this.eastFromLLA(h,r),t.azimuth=Math.atan2(n.dot(h),n.dot(l)),s.Vector3.pool.release(l),s.Vector3.pool.release(h),s.LatLonAlt.pool.release(r),s.Vector3.pool.release(n)}getRayIntersection(t,e,i){const n=this._equatorialRadius/this._polarRadius,r=s.Vector3.pool.get(),o=s.Vector3.pool.get();r.set(e.x,e.y,e.z*n),o.set(i.x,i.y,i.z*n);const a=s.Geometry.getLineSphereIntersectionWithSphereAtOrigin(r,o,this._equatorialRadius);t.addMult(r,o,a),s.Vector3.pool.release(r),s.Vector3.pool.release(o),t.z/=n}getGroundPosition(t,e,i){const n=s.LatLonAlt.pool.get();this.llaFromXYZ(n,e),n.alt=0,this.xyzFromLLA(t,n);const r=s.Vector3.pool.get();this.upFromLLA(r,n),t.addMult(t,r,i),s.LatLonAlt.pool.release(n),s.Vector3.pool.release(r)}}const n=SpheroidComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class SpheroidLODComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._textureUrls=new s.FastMap,this._textureLODs=new s.FastMap,this._textureSizes=new s.FastMap,this._mapping="cylinder",this._longitudinalRotation=0,this._numFaces=1,this._lowerLeftBounds=new s.LatLonAlt(-s.MathUtils.halfPi,-s.MathUtils.pi,0),this._upperRightBounds=new s.LatLonAlt(+s.MathUtils.halfPi,s.MathUtils.pi,0),this._cubeMapFaceFrames=s.CubeMap._defaultCubeMapFaceFrames,this._shadowEntities=[],this._features=new Set,this._useCompression=!1,this._atmosphereComponentRef=new s.ComponentRef(this.getEntity().getScene()),this._atmosphereComponentRef.setByType(this.getEntity().getName(),"atmosphere"),this._spheroidComponentRef=new s.ComponentRef(this.getEntity().getScene()),this._spheroidComponentRef.setByType(this.getEntity().getName(),"spheroid"),this._spheroidComponentRef.setRefChangedCallback(this._spheroidRefChangedCallback.bind(this)),this._spheroidChangedCallback=this._spheroidChangedCallback.bind(this),this.__setUsesEntityOrientation(!0)}getTextureNames(){const t=[];for(let e=0;e<this._textureUrls.size;e++)t.push(this._textureUrls.getAt(e).key);return t}getTextureUrl(t){return this._textureUrls.get(t)}getTextureSizes(t){return this._textureSizes.get(t)}setTexture(t,e,i=[4,512,4096]){SpheroidLODComponent._textureToFeature.has(t)&&this.setFeature(SpheroidLODComponent._textureToFeature.get(t),""!==e),this._textureUrls.set(t,e),this._textureSizes.set(t,[...i]);let n=this._textureLODs.get(t);if(void 0===n){n=[];const e=this.getThreeJsMaterials();for(let i=0,r=this._numFaces;i<r;i++){const r=new s.TextureLOD(this);if(e.length>0){const s=e[i].uniforms[t+"Texture"];void 0!==s&&r.setUniform(s)}n.push(r)}this._textureLODs.set(t,n)}for(let t=0,s=this._numFaces;t<s;t++)n[t].setUrl(e.replace("$FACE",t.toString())),n[t].setSizes(i)}forceTextureSize(t,e){const i=this._textureLODs.get(t);if(void 0===i)throw new Error('No texture named "'+t+'" has been defined.');for(let t=0;t<i.length;t++)i[t].setForcedSize(e)}unsetTexture(t){SpheroidLODComponent._textureToFeature.has(t)&&this.setFeature(SpheroidLODComponent._textureToFeature.get(t),!1),this._textureUrls.delete(t),this._textureLODs.delete(t),this._textureSizes.delete(t);const e=this.getThreeJsMaterials();for(let i=0,s=e.length;i<s;i++){const s=e[i].uniforms[t+"Texture"];void 0!==s&&(s.value.dispose(),s.value=null)}}getTextureCurrentSize(t,e){const i=this._textureLODs.get(t);if(void 0!==i&&void 0!==i[e])return i[e].getCurrentSize()}isFeatureEnabled(t){return this._features.has(t)}setFeature(t,e){const i=this.getThreeJsMaterials();if(e&&!this._features.has(t)){this._features.add(t);for(let e=0,s=i.length;e<s;e++){const s=i[e];s.defines[t]=!0,s.needsUpdate=!0}"normalMap"===t&&this._updateMeshes()}else if(!e&&this._features.has(t)){this._features.delete(t);for(let e=0,s=i.length;e<s;e++){const s=i[e];delete s.defines[t],s.needsUpdate=!0}"normalMap"===t&&this._updateMeshes()}}getMapping(){return this._mapping}setMapping(t){const e=this._numFaces;if("cylinder"===t)this._numFaces=1;else{if("cube"!==t)throw new Error("Invalid mapping type.");this._numFaces=6}if(this._numFaces!==e)for(let t=0;t<this._textureLODs.size;t++){const e=this._textureLODs.getAt(t).key,i=[];for(let t=0,n=this._numFaces;t<n;t++){const n=new s.TextureLOD(this);n.setUrl(this._textureUrls.get(e).replace("$FACE",t.toString())),n.setSizes(this._textureSizes.get(e)),i.push(n)}this._textureLODs.set(e,i)}this._mapping=t,this.resetResources()}setBounds(t,e){this._lowerLeftBounds.copy(t),this._upperRightBounds.copy(e),this.resetResources()}setCubeMapLayout(t){this._cubeMapFaceFrames=[];for(let e=0;e<6;e++){this._cubeMapFaceFrames.push([]);for(let i=0;i<3;i++){let n=null;switch(t[e][i]){case"+x":n=s.Vector3.XAxis;break;case"-x":n=s.Vector3.XAxisNeg;break;case"+y":n=s.Vector3.YAxis;break;case"-y":n=s.Vector3.YAxisNeg;break;case"+z":n=s.Vector3.ZAxis;break;case"-z":n=s.Vector3.ZAxisNeg;break;default:throw new Error("Invalid cubemap layout component.")}this._cubeMapFaceFrames[e][i]=n}}this.resetResources()}getNumShadowEntities(){return this._shadowEntities.length}getShadowEntity(t){return this._shadowEntities[t]}setShadowEntities(t){this._shadowEntities=t.slice(0)}getUseCompression(){return this._useCompression}setUseCompression(t){this._useCompression=t}getLongitudeRotation(){return this._longitudinalRotation}setLongitudeRotation(t){this._longitudinalRotation=t}getLoadedPromise(){const t=[super.getLoadedPromise()];for(let e=0;e<this._textureLODs.size;e++){const i=this._textureLODs.getAt(e).value;for(let e=0,s=i.length;e<s;e++)t.push(i[e].getLoadedPromise())}return Promise.all(t).then()}getColorAtPosition(t,e,i){const n=s.Vector3.pool.get();if("cube"===this._mapping)s.CubeMap.xyzToUVFace(n,e,this._cubeMapFaceFrames);else if("cylinder"===this._mapping){const e=s.LatLonAlt.pool.get();if(null===this._spheroidComponentRef.get())return void t.set(0,0,0);n.set(e.lon/s.MathUtils.twoPi+.5,e.lat/Math.PI+.5,0),s.LatLonAlt.pool.release(e)}const r=this._textureLODs.get(i);if(void 0===r)throw new Error("Invalid texture name.");const o=r[n.z].getUniform().value,a=document.createElement("canvas");a.width=o.image.width,a.height=o.image.height;const l=a.getContext("2d");l.drawImage(o.image,0,0);const h=l.getImageData(0,0,o.image.width,o.image.height),c=o.format===s.THREE.RGBAFormat?4:3,d=(Math.floor((1-n.y)*h.height)*h.width+Math.floor(n.x*h.width))*c;t.set(h.data[d+0],h.data[d+1],h.data[d+2],4===c?h.data[d+3]:1),s.Vector3.pool.release(n)}setSpheroidReference(t){"string"==typeof t?this._spheroidComponentRef.setByName(this.getEntity().getName(),t):this._spheroidComponentRef.setByType(this.getEntity().getName(),"spheroid",t)}__destroy(){const t=this._spheroidComponentRef.get();null!==t&&t.removeChangedCallback(this._spheroidChangedCallback),super.__destroy()}__update(){for(let t=0;t<this._textureLODs.size;t++){const e=this._textureLODs.getAt(t).value;for(let t=0,i=e.length;t<i;t++)e[t].update()}this._spheroidComponentRef.update()}__prepareForRender(t){const e=this.getThreeJsObjects(),i=s.Quaternion.pool.get();i.setFromAxisAngle(s.Vector3.ZAxis,this._longitudinalRotation);for(let n=0;n<e.length;n++)s.ThreeJsHelper.setOrientationToEntity(e[n],this.getEntity(),i),s.ThreeJsHelper.setPositionToEntity(e[n],this.getEntity(),t);s.Quaternion.pool.release(i);for(let t=0,e=this._shadowEntities.length;t<e;t++){let e=this._shadowEntities[t];if("string"==typeof e){const t=this.getEntity().getScene().get(e);t instanceof s.Entity&&(e=t)}null!==e&&(this._shadowEntities[t]=e)}const n=this._atmosphereComponentRef.get();s.MaterialUtils.setUniforms(this.getThreeJsMaterials(),t,this.getEntity(),this._shadowEntities,n,!0)}__loadResources(){for(let t=0;t<this._numFaces;t++){const e=s.MaterialUtils.get();this.getThreeJsMaterials().push(e),s.ThreeJsHelper.setupLogDepthBuffering(e);for(const t of this._features)e.defines[t]=!0,e.needsUpdate=!0;const i=s.ThreeJsHelper.createMeshObject(this,e,[{name:"position",dimensions:3},{name:"normal",dimensions:3},{name:"uv",dimensions:2}],!1);this.getThreeJsObjects().push(i),s.ThreeJsHelper.useInDynEnvMap(i,!0);for(let i=0;i<this._textureLODs.size;i++){const s=this._textureLODs.getAt(i).key,n=e.uniforms[s+"Texture"];void 0!==n&&this._textureLODs.get(s)[t].setUniform(n)}}return this._updateMeshes(),Promise.resolve()}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this);for(let t=0;t<this._textureLODs.size;t++){const e=this._textureLODs.getAt(t).key;for(let t=0;t<this._numFaces;t++)this._textureLODs.get(e)[t].setUniform(null)}}_updateMeshes(){if(0===this.getThreeJsObjects().length)return;const t=this._spheroidComponentRef.get();if(null!==t)if("cylinder"===this._mapping){const e=this._upperRightBounds.lat-this._lowerLeftBounds.lat,i=this._upperRightBounds.lon-this._lowerLeftBounds.lon,n=Math.max(Math.ceil(100*e/s.MathUtils.pi),4),r=Math.max(Math.ceil(200*i/s.MathUtils.twoPi),4),o=e/(n-1),a=i/(r-1),l=r*n,h=new Float32Array(3*l),c=new Float32Array(3*l),d=new Float32Array(2*l),u=new Uint16Array((r-1)*(n-1)*6),_=s.Vector3.pool.get(),g=s.LatLonAlt.pool.get();for(let e=0;e<n;e++)for(let i=0;i<r;i++){g.lat=this._lowerLeftBounds.lat+e*o,g.lon=this._lowerLeftBounds.lon+i*a,g.alt=0;const s=e*r+i;if(t.xyzFromLLA(_,g),h[3*s+0]=_.x,h[3*s+1]=_.y,h[3*s+2]=_.z,t.upFromLLA(_,g),c[3*s+0]=_.x,c[3*s+1]=_.y,c[3*s+2]=_.z,d[2*s+0]=i/(r-1),d[2*s+1]=1-e/(n-1),e+1<n&&i+1<r){const t=e*(r-1)+i;u[6*t+0]=r*(e+0)+(i+0),u[6*t+1]=r*(e+1)+(i+1),u[6*t+2]=r*(e+1)+(i+0),u[6*t+3]=r*(e+0)+(i+0),u[6*t+4]=r*(e+0)+(i+1),u[6*t+5]=r*(e+1)+(i+1)}}s.LatLonAlt.pool.release(g),s.Vector3.pool.release(_);const p=this.getThreeJsObjects()[0];s.ThreeJsHelper.setVertices(p.geometry,"position",h),s.ThreeJsHelper.setVertices(p.geometry,"normal",c),s.ThreeJsHelper.setVertices(p.geometry,"uv",d),s.ThreeJsHelper.setIndices(p.geometry,u),this._features.has("normalMap")&&s.ThreeJsHelper.computeTangents(p.geometry)}else if("cube"===this._mapping){const e=50,i=s.Vector3.pool.get(),n=s.LatLonAlt.pool.get();for(let r=0;r<6;r++){const o=new Float32Array(e*e*3),a=new Float32Array(e*e*3),l=new Float32Array(e*e*2),h=new Uint16Array((e-1)*(e-1)*6);let c=!1;const d=s.Vector3.pool.get();d.cross(this._cubeMapFaceFrames[r][0],this._cubeMapFaceFrames[r][1]),d.x===this._cubeMapFaceFrames[r][2].x&&d.y===this._cubeMapFaceFrames[r][2].y&&d.z===this._cubeMapFaceFrames[r][2].z||(c=!0),s.Vector3.pool.release(d);let u=0,_=0;for(let d=0;d<e;d++)for(let g=0;g<e;g++)i.mult(this._cubeMapFaceFrames[r][0],2*g/(e-1)-1),i.addMult(i,this._cubeMapFaceFrames[r][1],2*d/(e-1)-1),i.addMult(i,this._cubeMapFaceFrames[r][2],1),i.normalize(i),s.Geometry.getLLAFromXYZOnSphere(n,i,0),n.alt=0,t.xyzFromLLA(i,n),o[3*u+0]=i.x,o[3*u+1]=i.y,o[3*u+2]=i.z,t.upFromLLA(i,n),a[3*u+0]=i.x,a[3*u+1]=i.y,a[3*u+2]=i.z,l[2*u+0]=g/(e-1),l[2*u+1]=1-d/(e-1),g<e-1&&d<e-1&&(h[6*_+0]=(d+0)*e+(g+0),h[6*_+3]=(d+1)*e+(g+1),c?(h[6*_+1]=(d+1)*e+(g+1),h[6*_+2]=(d+0)*e+(g+1),h[6*_+4]=(d+0)*e+(g+0),h[6*_+5]=(d+1)*e+(g+0)):(h[6*_+1]=(d+0)*e+(g+1),h[6*_+2]=(d+1)*e+(g+1),h[6*_+4]=(d+1)*e+(g+0),h[6*_+5]=(d+0)*e+(g+0)),_+=1),u+=1;const g=this.getThreeJsObjects()[r];s.ThreeJsHelper.setVertices(g.geometry,"position",o),s.ThreeJsHelper.setVertices(g.geometry,"normal",a),s.ThreeJsHelper.setVertices(g.geometry,"uv",l),s.ThreeJsHelper.setIndices(g.geometry,h),this._features.has("normalMap")&&s.ThreeJsHelper.computeTangents(g.geometry)}s.LatLonAlt.pool.release(n),s.Vector3.pool.release(i)}}_spheroidRefChangedCallback(t,e){null!==t&&t.removeChangedCallback(this._spheroidChangedCallback),null!==e&&e.addChangedCallback(this._spheroidChangedCallback),this._spheroidChangedCallback()}_spheroidChangedCallback(){const t=this._spheroidComponentRef.get();null!==t?this.__setRadius(Math.max(t.getEquatorialRadius(),t.getPolarRadius())):this.__setRadius(0),this.resetResources()}}SpheroidLODComponent._textureToFeature=new Map([["normal","normalMap"],["night","nightMap"],["decal","decalMap"],["specular","specularMap"]]);const n=SpheroidLODComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);class SpoutComponent extends s.CameraComponent{constructor(t,e,i){super(t,e,i),this._renderWidth=2048,this._forGlobe=!1,this._globeDistance=1,this._threeJsFaceCameras=[],this._threeJsFaceRenderTargets=[],this._threeJsQuad=new s.THREE.Mesh,this._threeJsSpoutScene=new s.THREE.Scene,this._threeJsCubeCamera=new s.THREE.OrthographicCamera(-1,1,-1,1,-1,1),this._tagStart=new s.THREE.WebGLRenderTarget(2,3,{minFilter:s.THREE.LinearFilter,magFilter:s.THREE.NearestFilter}),this._tagEnd=new s.THREE.WebGLRenderTarget(3,2,{minFilter:s.THREE.LinearFilter,magFilter:s.THREE.NearestFilter}),this._tagSend=new s.THREE.WebGLRenderTarget(3,3,{minFilter:s.THREE.LinearFilter,magFilter:s.THREE.NearestFilter}),this._spoutTexture=new s.THREE.WebGLRenderTarget(this._renderWidth,this._renderWidth/2,{minFilter:s.THREE.LinearFilter,magFilter:s.THREE.NearestFilter}),this._setupFaceCameras(),this._setupQuad()}getRenderWidth(){return this._renderWidth}setRenderWidth(t){this._renderWidth=t,this._spoutTexture.width!==this._renderWidth&&this._spoutTexture.setSize(this._renderWidth,this._renderWidth/2);for(let t=0;t<6;t++)this._threeJsFaceRenderTargets[t].setSize(this._renderWidth/4,this._renderWidth/4)}setForGlobe(t,e){this._forGlobe!==t&&(this._forGlobe=t,this._globeDistance=e)}__render(){this._updateProjectionMatrices();const t=.7071067811865476,e=this.getEntity().getOrientation();n.set(e.x,e.y,e.z,e.w),this._threeJsFaceCameras[0].setRotationFromQuaternion(n),this._forGlobe?n.set(t*(e.x+e.y),t*(-e.x+e.y),t*(e.w+e.z),t*(e.w-e.z)):n.set(t*(e.x-e.y),t*(e.x+e.y),t*(-e.w+e.z),t*(e.w+e.z)),this._threeJsFaceCameras[1].setRotationFromQuaternion(n),n.set(e.y,-e.x,e.w,-e.z),this._threeJsFaceCameras[2].setRotationFromQuaternion(n),this._forGlobe?n.set(t*(e.x-e.y),t*(e.x+e.y),t*(-e.w+e.z),t*(e.w+e.z)):n.set(t*(e.x+e.y),t*(-e.x+e.y),t*(e.w+e.z),t*(e.w-e.z)),this._threeJsFaceCameras[3].setRotationFromQuaternion(n),n.set(t*(e.w+e.x),t*(e.y+e.z),t*(-e.y+e.z),t*(e.w-e.x)),this._threeJsFaceCameras[4].setRotationFromQuaternion(n),n.set(t*(-e.w+e.x),t*(e.y-e.z),t*(e.y+e.z),t*(e.w+e.x)),this._threeJsFaceCameras[5].setRotationFromQuaternion(n);for(let t=0;t<6;t++)this._threeJsRenderer.setRenderTarget(this._threeJsFaceRenderTargets[t]),this._threeJsRenderer.render(this.getEntity().getScene().getThreeJsScene(),this._threeJsFaceCameras[t]);this._threeJsRenderer.setRenderTarget(this._tagStart),this._threeJsRenderer.clearColor(),this._threeJsRenderer.setRenderTarget(this._spoutTexture),this._threeJsRenderer.clearColor(),this._threeJsRenderer.setRenderTarget(this._tagEnd),this._threeJsRenderer.clearColor(),this._threeJsRenderer.setRenderTarget(this._spoutTexture),this._threeJsRenderer.render(this._threeJsSpoutScene,this._threeJsCubeCamera),this._threeJsRenderer.setRenderTarget(this._tagSend),this._threeJsRenderer.clearColor(),this._threeJsRenderer.setRenderTarget(null)}_setupFaceCameras(){for(let t=0;t<6;t++){this._threeJsFaceCameras.push(new s.THREE.PerspectiveCamera(90,1,.1,1e3));const e=new s.THREE.Matrix4;e.set(1,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0),this._threeJsFaceCameras[t].projectionMatrix=e,this._threeJsFaceCameras[t].projectionMatrixInverse.copy(e).invert();const i=new s.THREE.WebGLRenderTarget(this._renderWidth/4,this._renderWidth/4,{minFilter:s.THREE.LinearFilter,magFilter:s.THREE.LinearFilter});this._threeJsFaceRenderTargets.push(i)}}_updateProjectionMatrices(){if(this._forGlobe){const t=Math.max(.1,.5*this.getEntity().getParent().getOcclusionRadius()),e=this._globeDistance,i=(t+e)*(1-Number.EPSILON)/(t-e),s=-2*t*e*(1-Number.EPSILON)/(t-e);for(let t=0;t<6;t++)this._threeJsFaceCameras[t].projectionMatrix.elements[0]=-1,this._threeJsFaceCameras[t].projectionMatrix.elements[7]=-1,this._threeJsFaceCameras[t].projectionMatrix.elements[11]=1,this._threeJsFaceCameras[t].projectionMatrix.elements[6]=i,this._threeJsFaceCameras[t].projectionMatrix.elements[14]=s}else{const t=this.getAutoNearDistance(),e=Number.EPSILON-1,i=t*(2-Number.EPSILON);for(let t=0;t<6;t++)this._threeJsFaceCameras[t].projectionMatrix.elements[6]=e,this._threeJsFaceCameras[t].projectionMatrix.elements[14]=i}}_setupQuad(){const t=new s.THREE.BufferGeometry,e=new Float32Array([-1,-1,1,-1,1,1,-1,1]),i=new Uint16Array([0,1,2,0,2,3]);t.setAttribute("position",new s.THREE.BufferAttribute(e,2)),t.setIndex(new s.THREE.BufferAttribute(i,1));const n={textures:new s.THREE.Uniform([])};for(let t=0;t<6;t++)n.textures.value.push(this._threeJsFaceRenderTargets[t].texture);const r=new s.THREE.RawShaderMaterial({uniforms:n,vertexShader:"\n\t\t\t\tattribute vec2 position;\n\t\t\t\tvarying vec2 xy;\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_Position = vec4(position.x, -position.y, 0.0, 1.0);\n\t\t\t\t\txy = position;\n\t\t\t\t}",fragmentShader:"\n\t\t\t\tprecision mediump float;\n\t\t\t\tuniform sampler2D textures[6];\n\n\t\t\t\tvarying vec2 xy;\n\t\t\t\tconst float PI = 3.1415926535897932384626433832795;\n\n\t\t\t\tvec3 xyToUvFace(vec2 xy) {\n\t\t\t\t\tvec3 xyz = vec3(\n\t\t\t\t\t\tcos(xy.y * PI / 2.0) * cos(xy.x * PI),\n\t\t\t\t\t\tcos(xy.y * PI / 2.0) * sin(xy.x * PI),\n\t\t\t\t\t\tsin(-xy.y * PI / 2.0));\n\n\t\t\t\t\tvec3 basis[3];\n\t\t\t\t\tfloat face;\n\t\t\t\t\tif (xyz.x * xyz.x >= xyz.y * xyz.y && xyz.x * xyz.x >= xyz.z * xyz.z) {\n\t\t\t\t\t\tif (xyz.x >= 0.0) {\n\t\t\t\t\t\t\tbasis[0] = vec3(0, 1, 0); basis[1] = vec3(0, 0, 1); basis[2] = vec3(1, 0, 0);\n\t\t\t\t\t\t\tface = 0.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tbasis[0] = vec3(0, -1, 0); basis[1] = vec3(0, 0, 1); basis[2] = vec3(-1, 0, 0);\n\t\t\t\t\t\t\tface = 2.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (xyz.y * xyz.y >= xyz.x * xyz.x && xyz.y * xyz.y >= xyz.z * xyz.z) {\n\t\t\t\t\t\tif (xyz.y >= 0.0) {\n\t\t\t\t\t\t\tbasis[0] = vec3(-1, 0, 0); basis[1] = vec3(0, 0, 1); basis[2] = vec3(0, 1, 0);\n\t\t\t\t\t\t\tface = 1.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tbasis[0] = vec3(1, 0, 0); basis[1] = vec3(0, 0, 1); basis[2] = vec3(0, -1, 0);\n\t\t\t\t\t\t\tface = 3.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (xyz.z >= 0.0) {\n\t\t\t\t\t\t\tbasis[0] = vec3(0, 1, 0); basis[1] = vec3(-1, 0, 0); basis[2] = vec3(0, 0, 1);\n\t\t\t\t\t\t\tface = 4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tbasis[0] = vec3(0, 1, 0); basis[1] = vec3(1, 0, 0); basis[2] = vec3(0, 0, -1);\n\t\t\t\t\t\t\tface = 5.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvec3 uv = vec3(\n\t\t\t\t\t\tbasis[0].x * xyz.x + basis[0].y * xyz.y + basis[0].z * xyz.z,\n\t\t\t\t\t\tbasis[1].x * xyz.x + basis[1].y * xyz.y + basis[1].z * xyz.z,\n\t\t\t\t\t\tbasis[2].x * xyz.x + basis[2].y * xyz.y + basis[2].z * xyz.z);\n\t\t\t\t\tuv.x /= uv.z;\n\t\t\t\t\tuv.y /= uv.z;\n\n\t\t\t\t\treturn vec3(0.5 * (uv.x + 1.0), 0.5 * (uv.y + 1.0), face);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec3 uvFace = xyToUvFace(xy);\n\n\t\t\t\t\tvec4 pixel;\n\t\t\t\t\tint face = int(uvFace.z);\n\n\t\t\t\t\tif (face == 0) {\n\t\t\t\t\t\tpixel = texture2D(textures[0], vec2(uvFace.x, uvFace.y));\n\t\t\t\t\t}\n\t\t\t\t\telse if (face == 1) {\n\t\t\t\t\t\tpixel = texture2D(textures[1], vec2(uvFace.x, uvFace.y));\n\t\t\t\t\t}\n\t\t\t\t\telse if (face == 2) {\n\t\t\t\t\t\tpixel = texture2D(textures[2], vec2(uvFace.x, uvFace.y));\n\t\t\t\t\t}\n\t\t\t\t\telse if (face == 3) {\n\t\t\t\t\t\tpixel = texture2D(textures[3], vec2(uvFace.x, uvFace.y));\n\t\t\t\t\t}\n\t\t\t\t\telse if (face == 4) {\n\t\t\t\t\t\tpixel = texture2D(textures[4], vec2(uvFace.x, uvFace.y));\n\t\t\t\t\t}\n\t\t\t\t\telse if (face == 5) {\n\t\t\t\t\t\tpixel = texture2D(textures[5], vec2(uvFace.x, uvFace.y));\n\t\t\t\t\t}\n\n\t\t\t\t\tgl_FragColor = pixel;\n\t\t\t\t}",depthTest:!1,depthWrite:!1,side:s.THREE.DoubleSide});this._threeJsQuad=new s.THREE.Mesh(t,r),this._threeJsQuad.frustumCulled=!1,this._threeJsSpoutScene.add(this._threeJsQuad)}}const n=new s.THREE.Quaternion,r=SpoutComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class SpriteComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._textureUrl="",this._size=new s.Vector2(1,Number.NaN),this._size.freeze(),this._sizeUnits="km",this._colorMultiplier=new s.Color(1,1,1,1),this._colorMultiplier.freeze(),this._alignment=new s.Vector2(.5,.5),this._alignment.freeze(),this._fadeDistance=0,this._transparent=!1,this._blending="normal",this._billboard=!1,this._renderOrder=0}getTextureUrl(){return this._textureUrl}setTextureUrl(t){this._textureUrl=t,this.resetResources()}getSize(){return this._size}setSize(t){this._size.thaw(),this._size.copy(t),this._size.freeze(),this._updateSizeUniform()}getSizeUnits(){return this._sizeUnits}setSizeUnits(t){this._sizeUnits=t,this._updateSizeUniform()}getColorMultiplier(){return this._colorMultiplier}setColorMultiplier(t){this._colorMultiplier.thaw(),this._colorMultiplier.copy(t),this._colorMultiplier.freeze(),s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"colorMultiplier",t)}getAlignment(){return this._alignment}setAlignment(t){this._alignment.thaw(),this._alignment.copy(t),this._alignment.freeze(),s.ThreeJsHelper.setUniformVector2(this.getThreeJsMaterials()[0],"origin",this._alignment)}getFadeDistance(){return this._fadeDistance}setFadeDistance(t){this._fadeDistance=t}isBillboard(){return this._billboard}setBillboard(t){this._billboard=t}getTransparent(){return this._transparent}setTransparent(t){this._transparent=t,s.ThreeJsHelper.setTransparent(this.getThreeJsMaterials()[0],this._transparent)}setBlending(t){this._blending=t,s.ThreeJsHelper.setBlending(this.getThreeJsMaterials()[0],this._blending)}getRenderOrder(){return this._renderOrder}setRenderOrder(t){this._renderOrder=t,s.ThreeJsHelper.setRenderOrder(this.getThreeJsObjects()[0],this._renderOrder)}__prepareForRender(t){if("pixels"===this._sizeUnits){const e=s.Vector2.pool.get(),i=this.getEntity().getExtentsRadius()/this.getEntity().getPixelSpaceExtentsRadius(t);e.mult(this._size,i),s.ThreeJsHelper.setUniformVector2(this.getThreeJsMaterials()[0],"size",e),s.Vector2.pool.release(e)}if(this.getThreeJsObjects().length>0&&(this._billboard?s.ThreeJsHelper.setOrientationToBillboard(this.getThreeJsObjects()[0],this.getEntity(),t):s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects()[0],this.getEntity())),this._fadeDistance>0){const e=s.Vector3.pool.get(),i=s.Quaternion.pool.get(),n=this.getThreeJsObjects()[0].quaternion;i.copyFromThreeJs(n),e.rotateInverse(this.getEntity().getOrientation(),this.getEntity().getCameraSpacePosition(t)),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"alphaFadeMultiplier",s.MathUtils.lerp(0,1,s.MathUtils.clamp01(2*(Math.abs(e.z)/this._fadeDistance-1)+1))),s.Quaternion.pool.release(i),s.Vector3.pool.release(e)}s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t)}async __loadResources(){const t=await s.ThreeJsHelper.loadTexture(this,this._textureUrl,!1,!1);if("loading"!==this.getLoadState())return void t.dispose();0===SpriteComponent._useCount&&(SpriteComponent._threeJsGeometry=s.ThreeJsHelper.createGeometry([{name:"position",dimensions:3},{name:"uv",dimensions:2}],!1),s.ThreeJsHelper.setVertices(SpriteComponent._threeJsGeometry,"position",new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0])),s.ThreeJsHelper.setVertices(SpriteComponent._threeJsGeometry,"uv",new Float32Array([0,1,1,1,1,0,0,0])),s.ThreeJsHelper.setIndices(SpriteComponent._threeJsGeometry,new Uint16Array([0,1,2,2,3,0])),SpriteComponent._threeJsMaterial=new s.THREE.ShaderMaterial({uniforms:{colorMultiplier:new s.THREE.Uniform(new s.THREE.Vector4(1,1,1,1)),alphaFadeMultiplier:new s.THREE.Uniform(1),size:new s.THREE.Uniform(new s.THREE.Vector2(1,1)),colorTexture:new s.THREE.Uniform(null),origin:new s.THREE.Uniform(new s.THREE.Vector2(0,0))},vertexShader:"\n\t\t\t\t\tuniform vec2 size;\n\t\t\t\t\tuniform vec2 origin;\n\t\t\t\t\tvarying vec2 fUV;\n\n\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\tvarying float fragDepth;\n\t\t\t\t\t#else\n\t\t\t\t\t\tuniform float nearDistance;\n\t\t\t\t\t\tuniform float midDistance;\n\t\t\t\t\t#endif\n\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvec4 viewPosition = modelViewMatrix * vec4((position.x - origin.x) * size.x, (position.y - origin.y) * size.y, 0.0, 1.0);\n\t\t\t\t\t\tgl_Position = projectionMatrix * viewPosition;\n\t\t\t\t\t\tgl_Position.w = viewPosition.y;\n\t\t\t\t\t\tfUV = uv;\n\n\t\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\t\tfragDepth = gl_Position.w;\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tfloat z = gl_Position.w;\n\t\t\t\t\t\t\tif (z < midDistance) {\n\t\t\t\t\t\t\t\tgl_Position.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\n\t\t\t\t\t\t\t\tgl_Position.z = log2(z - midDistance + 1.0) * logFactor;\n\t\t\t\t\t\t\t\tgl_Position.z *= gl_Position.w;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}",fragmentShader:"\n\t\t\t\t\tuniform vec4 colorMultiplier;\n\t\t\t\t\tuniform float alphaFadeMultiplier;\n\t\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\t\tvarying vec2 fUV;\n\n\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\tuniform mat4 projectionMatrix;\n\t\t\t\t\t\tvarying float fragDepth;\n\t\t\t\t\t#endif\n\n\t\t\t\t\tvoid main(void) {\n\t\t\t\t\t\tgl_FragColor = texture2D(colorTexture, fUV);\n\t\t\t\t\t\tgl_FragColor *= colorMultiplier;\n\t\t\t\t\t\tgl_FragColor.a *= alphaFadeMultiplier;\n\n\t\t\t\t\t\t// Log-Depth Buffering\n\t\t\t\t\t\t#ifdef L_EXT_frag_depth\n\t\t\t\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\n\t\t\t\t\t\t\tgl_FragDepthEXT = projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}",side:s.THREE.DoubleSide}),s.ThreeJsHelper.setupLogDepthBuffering(SpriteComponent._threeJsMaterial)),SpriteComponent._useCount+=1;const e=SpriteComponent._threeJsMaterial.clone();this.getThreeJsMaterials().push(e),s.ThreeJsHelper.setTransparent(e,this._transparent),s.ThreeJsHelper.setBlending(e,this._blending),s.ThreeJsHelper.setUniformColorRGBA(e,"colorMultiplier",this._colorMultiplier),s.ThreeJsHelper.setUniformNumber(e,"alphaFadeMultiplier",1),s.ThreeJsHelper.setUniformVector2(e,"origin",this._alignment),s.ThreeJsHelper.setUniformTexture(e,"colorTexture",t);const i=s.ThreeJsHelper.createMeshObjectGivenGeometry(this,e,SpriteComponent._threeJsGeometry);this.getThreeJsObjects().push(i),s.ThreeJsHelper.setRenderOrder(i,this._renderOrder),this._updateSizeUniform()}__unloadResources(){s.ThreeJsHelper.destroyMaterial(this.getThreeJsMaterials()[0]);const t=this.getThreeJsObjects()[0];void 0!==t.parent&&t.parent.remove(t),SpriteComponent._useCount-=1,0===SpriteComponent._useCount&&(s.ThreeJsHelper.destroyGeometry(SpriteComponent._threeJsGeometry),s.ThreeJsHelper.destroyMaterial(SpriteComponent._threeJsMaterial))}_updateSizeUniform(){if(this.getThreeJsMaterials().length>0){const t=this.getThreeJsMaterials()[0].uniforms.colorTexture.value;if(null!==t){const e=t.image.width/t.image.height,i=s.Vector2.pool.get();Number.isNaN(this._size.x)?i.set(this._size.y*e,this._size.y):Number.isNaN(this._size.y)?i.set(this._size.x,this._size.x/e):i.set(this._size.x,this._size.y),s.ThreeJsHelper.setUniformVector2(this.getThreeJsMaterials()[0],"size",i),s.Vector2.pool.release(i),"km"===this._sizeUnits?this.__setRadius(Math.max(i.x,i.y)):this.__setRadius(Number.POSITIVE_INFINITY)}}else"km"===this._sizeUnits?Number.isNaN(this._size.x)||Number.isNaN(this._size.y)?this.__setRadius(this._size.y):this.__setRadius(Math.max(this._size.x,this._size.y)):this.__setRadius(Number.POSITIVE_INFINITY)}}SpriteComponent._threeJsMaterial=null,SpriteComponent._threeJsGeometry=null,SpriteComponent._useCount=0;const n=SpriteComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);const n=new s.Quaternion(.9791532214288992,.2031230389823101,0,0);class Star{constructor(){this.mag=0,this.absMag=0,this.color=new s.Color,this.position=new s.Vector3,this.particle=null}}class StarfieldComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._url="",this.__setRadius(1e24)}getUrl(){return this._url}setUrl(t){this._url=t,this.resetResources()}__prepareForRender(t){const e=s.Vector2.pool.get();if("spout"===t.getType()){const i=t;e.set(i.getRenderWidth(),.5*i.getRenderWidth())}else e.copy(t.getViewport().getBounds().size);const i=Math.sqrt(Math.max(e.x,e.y)*window.devicePixelRatio)/60;s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"resolutionFactor",i),s.Vector2.pool.release(e),s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t)}async __loadResources(){const t=await this._loadStars();if(this.isDestroyed())return;const e=new s.THREE.ShaderMaterial({vertexShader:StarfieldComponent.vertexShader,fragmentShader:StarfieldComponent.fragmentShader,transparent:!0,blending:s.THREE.AdditiveBlending,depthWrite:!1,uniforms:{resolutionFactor:new s.THREE.Uniform(1),nearDistance:new s.THREE.Uniform(0),midDistance:new s.THREE.Uniform(0)}});s.ThreeJsHelper.setupLogDepthBuffering(e),this.getThreeJsMaterials().push(e);const i=new s.THREE.BufferGeometry;i.setAttribute("position",new s.THREE.BufferAttribute(new Float32Array(0),3)),i.setAttribute("color",new s.THREE.BufferAttribute(new Float32Array(0),4)),i.setIndex(new s.THREE.BufferAttribute(new Uint16Array(0),1));const n=new s.THREE.Points(i,e);s.ThreeJsHelper.setupObject(this,n),n.renderOrder=-2,this.getThreeJsObjects().push(n);const r=new Float32Array(3*t.length),o=new Float32Array(4*t.length),a=new Uint16Array(t.length);for(let e=0;e<t.length;e++){const i=t[e];r[3*e+0]=i.position.x,r[3*e+1]=i.position.y,r[3*e+2]=i.position.z,o[4*e+0]=i.color.r,o[4*e+1]=i.color.g,o[4*e+2]=i.color.b,o[4*e+3]=i.absMag,a[e]=e}s.ThreeJsHelper.setVertices(i,"position",r),s.ThreeJsHelper.setVertices(i,"color",o),s.ThreeJsHelper.setIndices(i,a)}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this)}_loadStars(){return this.getEntity().getScene().getEngine().getDownloader().download(this._url,!0).then((t=>{if("cancelled"===t.status)return Promise.resolve([]);if("failed"===t.status)return Promise.reject(new Error('Failed to load starfield component file "'+t.url+'": '+t.errorMessage));if(!(t.content instanceof ArrayBuffer))return Promise.reject(new Error('Failed to load starfield component file "'+t.url+'": Not a binary file.'));const e=new s.Reader(t.content),i=e.readInt32(),r=[];for(let t=0;t<i;t++){const t=new Star;t.mag=e.readFloat32(),t.absMag=e.readFloat32(),t.color.r=e.readByte()/255,t.color.g=e.readByte()/255,t.color.b=e.readByte()/255,t.color.div(t.color,t.color.max()),t.position.y=-e.readFloat32(),t.position.z=e.readFloat32(),t.position.x=e.readFloat32(),t.position.rotate(n,t.position),r.push(t)}return r}))}}StarfieldComponent.vertexShader="\n\t#define PI 3.1415926538\n\n\tattribute vec4 color;\n\tvarying vec4 fColor;\n\n\tuniform float resolutionFactor;\n\n\t#ifdef L_EXT_frag_depth\n\t\tvarying float fragDepth;\n\t#else\n\t\tuniform float nearDistance;\n\t\tuniform float midDistance;\n\t#endif\n\n\t// Returns the watts per km^2.\n\tfloat absoluteMagnitudeToFlux(float absoluteMagnitude, float distance) {\n\t\tfloat luminosityInWatts = 3.0128e28 * pow(10.0, absoluteMagnitude / -2.5);\n\t\treturn luminosityInWatts / (4.0 * PI * distance * distance);\n\t}\n\n\tvoid main() {\n\t\tvec4 viewPosition = modelViewMatrix * vec4(position, 1.0);\n\t\tgl_Position = projectionMatrix * viewPosition;\n\t\tgl_Position.w = viewPosition.y;\n\t\tfColor = color;\n\n\t\t// Get the flux and brightness of the star at the camera's point.\n\t\tfloat absMag = color.a;\n\t\tfloat distance = length(viewPosition);\n\t\tfloat flux = absoluteMagnitudeToFlux(absMag, distance);\n\t\tfloat brightness = 2.0 * log(1.0 + flux * 1e4);\n\n\t\t// Adjust the color and size so that it is visually pleasing.\n\t\tfColor.a = clamp(brightness * resolutionFactor, 0.05, 1.0);\n\t\tgl_PointSize = clamp(brightness * 4.0 * resolutionFactor, 5.0, 24.0);\n\n\t\t// If it is too close, fade the star.\n\t\tfColor.a = mix(0.0, fColor.a, clamp((distance - 1.0e12) / 9.0e12, 0.0, 1.0));\n\n\t\t#ifdef L_EXT_frag_depth\n\t\t\tfragDepth = gl_Position.w;\n\t\t#else\n\t\t\tfloat z = gl_Position.w;\n\t\t\tif (z < midDistance) {\n\t\t\t\tgl_Position.z = nearDistance * (z - midDistance) / (midDistance - nearDistance);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1e24 - midDistance + 1.0)\n\t\t\t\tgl_Position.z = log2(z - midDistance + 1.0) * logFactor;\n\t\t\t\tgl_Position.z *= gl_Position.w;\n\t\t\t}\n\t\t#endif\n\t}",StarfieldComponent.fragmentShader="\n\tvarying vec4 fColor;\n\n\t#ifdef L_EXT_frag_depth\n\t\tuniform mat4 projectionMatrix;\n\t\tvarying float fragDepth;\n\t#endif\n\n\tvoid main(void) {\n\t\tfloat distanceFromEdge = clamp(1.0 - 2.0 * length(gl_PointCoord - vec2(0.5, 0.5)), 0.0, 1.0);\n\t\tfloat a = pow(distanceFromEdge, 5.0);\n\t\tgl_FragColor.rgb = fColor.rgb;\n\t\tgl_FragColor.a = fColor.a * a;\n\n\t\t// Log-Depth Buffering\n\t\t#ifdef L_EXT_frag_depth\n\t\t\tfloat logFactor = 0.01254291648; // 1 / log2(1 + 1e24)\n\t\t\tgl_FragDepthEXT = projectionMatrix[1][3] * log2(1.0 + fragDepth) * logFactor + projectionMatrix[2][3];\n\t\t#endif\n\t}";const r=StarfieldComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class Point{constructor(){this.time=0,this.position=new s.Vector3,this.velocity=new s.Vector3}}class TrailComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._color=new s.Color(1,1,1,1),this._color.freeze(),this._alphaFade=0,this._widthMin=0,this._widthMax=2,this._ignoreDistance=!1,this._startTime=void 0,this._endTime=0,this._relativeStartTime=!0,this._relativeEndTime=!0,this._relativeToEntity=new s.EntityRef(this.getEntity().getScene()),this._relativeToEntityOrientation=!1,this._angleCurveThreshold=.05235987755,this._initialTimeStep=void 0,this._points=[],this._pointsStart=0,this._pointsCount=0,this._currentRelativeToEntity=new s.EntityRef(this.getEntity().getScene()),this._dashLength=1,this._dashGapLength=0,this._glowWidth=0,this._dashOffsetTime=0,this.__setRadius(Number.POSITIVE_INFINITY)}getColor(){return this._color}setColor(t){this._color.thaw(),this._color.copy(t),this._color.freeze(),s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"color",this._color)}getAlphaFade(){return this._alphaFade}setWidths(t,e){this._widthMin=t,this._widthMax=e,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"widthMin",t),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"widthMax",e)}setAlphaFade(t){this._alphaFade=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"alphaFade",t)}setDashLength(t,e){this._dashLength=t,this._dashGapLength=e,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"dashLength",t),s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"dashGapLength",e)}setGlowWidth(t){this._glowWidth=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"glowWidth",this._glowWidth)}getStartTime(){return this._startTime}setStartTime(t){this._startTime=t}getEndTime(){return this._endTime}setEndTime(t){this._endTime=t}isRelativeStartTime(){return this._relativeStartTime}setRelativeStartTime(t){this._relativeStartTime=t,this.resetPoints()}isRelativeEndTime(){return this._relativeEndTime}setRelativeEndTime(t){this._relativeEndTime=t,this.resetPoints()}getRelativeToEntity(){return this._relativeToEntity.getName()}setRelativeToEntity(t){this._relativeToEntity.setName(t),this._currentRelativeToEntity.setName(t),this.resetPoints()}isRelativeToEntityOrientation(){return this._relativeToEntityOrientation}setRelativeToEntityOrientation(t){this._relativeToEntityOrientation=t,t||s.ThreeJsHelper.setOrientation(this.getThreeJsObjects(),s.Quaternion.Identity),this.resetPoints()}getAngleCurveThreshold(){return this._angleCurveThreshold}setAngleCurveThreshold(t){this._angleCurveThreshold=t,this.resetPoints()}getInitialTimeStep(){return this._initialTimeStep}setInitialTimeStep(t){this._initialTimeStep=t,this.resetPoints()}setIgnoreDistance(t){this._ignoreDistance=t}resetPoints(){if(this._points=[],this._pointsCount=0,this._pointsStart=0,this.getThreeJsObjects().length>0){const t=this.getThreeJsObjects()[0].geometry,e=new Float32Array(0),i=new s.THREE.InterleavedBuffer(e,TrailComponent.VERTEX_SIZE);t.setAttribute("position",new s.THREE.InterleavedBufferAttribute(i,3,0,!1)),t.setAttribute("positionPrev",new s.THREE.InterleavedBufferAttribute(i,3,3,!1)),t.setAttribute("positionNext",new s.THREE.InterleavedBufferAttribute(i,3,6,!1)),t.setAttribute("side",new s.THREE.InterleavedBufferAttribute(i,1,9,!1)),t.setAttribute("index",new s.THREE.InterleavedBufferAttribute(i,1,10,!1)),t.setAttribute("dashOffset",new s.THREE.InterleavedBufferAttribute(i,1,11,!1)),t.setIndex(new s.THREE.BufferAttribute(new Uint16Array(0),1))}}__loadResources(){const t=this.getEntity().getScene().getEngine().getMaterialManager().getPreloaded("trail");this.getThreeJsMaterials().push(t),t.uniforms.dashLength.value=this._dashLength,t.uniforms.dashGapLength.value=this._dashGapLength,t.uniforms.indexStart.value=0,t.uniforms.indexCount.value=0,t.uniforms.indexLength.value=0,t.uniforms.color.value.set(this._color.r,this._color.g,this._color.b,this._color.a),t.uniforms.widthMin.value=this._widthMin,t.uniforms.widthMax.value=this._widthMax,t.uniforms.glowWidth.value=this._glowWidth,t.uniforms.alphaFade.value=this._alphaFade;const e=s.ThreeJsHelper.createMeshObject(this,t,[{name:"position",dimensions:3},{name:"positionPrev",dimensions:3},{name:"positionNext",dimensions:3},{name:"side",dimensions:1},{name:"index",dimensions:1},{name:"dashOffset",dimensions:1}],!0);return this.getThreeJsObjects().push(e),Promise.resolve()}__unloadResources(){this.getEntity().getScene().getEngine().getMaterialManager().release(this.getThreeJsMaterials()[0]),s.ThreeJsHelper.destroyAllObjectsAndMaterials(this),this._points=[],this._pointsCount=0,this._pointsStart=0}__prepareForRender(t){if(""===this._relativeToEntity.getName()&&null!==this.getEntity().getParent()&&this._currentRelativeToEntity.get()!==this.getEntity().getParent()&&(this._currentRelativeToEntity.setName(this.getEntity().getParent().getName()),this.resetPoints()),null===this._currentRelativeToEntity)return;this._updatePoints();const e=this.getThreeJsMaterials()[0];e.uniforms.indexStart.value=this._pointsStart,e.uniforms.indexCount.value=this._pointsCount,e.uniforms.indexLength.value=this._points.length;let i=1;if(!this._ignoreDistance){i*=(.02-this.getEntity().getNormalSpaceExtentsRadius(t))/.02;const e=this.getEntity().getCameraSpacePosition(t).magnitude()/this.getEntity().getPosition().magnitude();i*=s.MathUtils.clamp01(1e3*e)}s.ThreeJsHelper.setUniformNumber(e,"alphaMultiplier",i);const n=s.Vector2.pool.get();t instanceof s.SpoutComponent?n.set(.1*t.getRenderWidth(),.5*t.getRenderWidth()*.1):n.copy(t.getViewport().getBounds().size),s.ThreeJsHelper.setUniformVector2(e,"pixelSize",n),s.Vector2.pool.release(n);const r=this._currentRelativeToEntity.get();null!==r&&(s.ThreeJsHelper.setPosition(this.getThreeJsObjects(),r.getCameraSpacePosition(t)),this._relativeToEntityOrientation&&s.ThreeJsHelper.setOrientation(this.getThreeJsObjects(),r.getOrientation()))}_updatePoints(){const t=s.Interval.pool.get();if(this._getIntervalForUpdate(t),isNaN(t.min)||isNaN(t.max))return void s.Interval.pool.release(t);const e=this._initialTimeStep??t.length()*this._angleCurveThreshold/(2*Math.PI),i=s.Interval.pool.get();for(i.set(Number.POSITIVE_INFINITY,0),this._relativeStartTime&&this._pointsCount>0&&this._points[this._pointsStart].time!==t.min&&this._popFrontPoint(i);this._pointsCount>0&&this._points[this._pointsStart].time<t.min;)this._popFrontPoint(i);const n=s.Quaternion.pool.get();for(;(0===this._pointsCount||this._points[this._pointsStart].time>t.min)&&!(this._pointsCount>=16e3&&this._relativeStartTime);){this._pushFrontPoint(i);const s=this._points[this._pointsStart];let r=0,o=Number.POSITIVE_INFINITY,a=e;this._pointsCount>2&&(a=this._points[(this._pointsStart+2)%this._points.length].time-this._points[(this._pointsStart+1)%this._points.length].time);let l=0;for(;l<20;){let e=t.max;if(this._pointsCount>1&&(e=this._points[(this._pointsStart+1)%this._points.length].time-a),e<t.min&&(e=t.min),s.time=e,this._getPositionAndVelocity(s.position,s.velocity,s.time),s.position.isNaN()||this._relativeToEntityOrientation&&n.isNaN())break;let i=0;if(this._pointsCount>=2&&(i=this._points[(this._pointsStart+1)%this._points.length].velocity.angle(s.velocity)),i>this._angleCurveThreshold)o=a,a=(r+a)/2;else{if(!(this._pointsCount>1&&i<this._angleCurveThreshold/3&&e!==t.min))break;r=a,o===Number.POSITIVE_INFINITY?a*=2:a=(a+o)/2}l++}if(s.position.isNaN()||this._relativeToEntityOrientation&&n.isNaN()){this._popFrontPoint(i);break}}for(this._relativeEndTime&&this._pointsCount>0&&this._points[(this._pointsStart+this._pointsCount-1)%this._points.length].time!==t.max&&this._popBackPoint(i);this._pointsCount>0&&this._points[(this._pointsStart+this._pointsCount-1)%this._points.length].time>t.max;)this._popBackPoint(i);for(;(0===this._pointsCount||this._points[(this._pointsStart+this._pointsCount-1)%this._points.length].time<t.max)&&!(this._pointsCount>=16e3&&this._relativeEndTime);){this._pushBackPoint(i);const s=this._points[(this._pointsStart+this._pointsCount-1)%this._points.length];let r=0,o=Number.POSITIVE_INFINITY,a=e;this._pointsCount>2&&(a=this._points[(this._pointsStart+this._pointsCount-2)%this._points.length].time-this._points[(this._pointsStart+this._pointsCount-3)%this._points.length].time);let l=0;for(;l<20;){let e=t.min;if(this._pointsCount>1&&(e=this._points[(this._pointsStart+this._pointsCount-2)%this._points.length].time+a),e>t.max&&(e=t.max),s.time=e,this._getPositionAndVelocity(s.position,s.velocity,s.time),s.position.isNaN()||this._relativeToEntityOrientation&&n.isNaN())break;let i=0;if(this._pointsCount>=2&&(i=this._points[(this._pointsStart+this._pointsCount-2)%this._points.length].velocity.angle(s.velocity)),i>this._angleCurveThreshold)o=a,a=(r+a)/2;else{if(!(this._pointsCount>1&&i<this._angleCurveThreshold/3&&e!==t.max))break;r=a,o===Number.POSITIVE_INFINITY?a*=2:a=(a+o)/2}l++}if(s.position.isNaN()||this._relativeToEntityOrientation&&n.isNaN()){this._popBackPoint(i);break}}s.Interval.pool.release(t),s.Quaternion.pool.release(n);const r=this.getThreeJsObjects()[0].geometry.attributes.position.data,o=r.array;for(let t=i.min,e=Math.min(this._points.length-1,i.max);t<=e;t++){const e=this._points[t].position,i=isNaN(this._points[(t+this._points.length-1)%this._points.length].position.x)?e:this._points[(t+this._points.length-1)%this._points.length].position,s=isNaN(this._points[(t+1)%this._points.length].position.x)?e:this._points[(t+1)%this._points.length].position;o[2*t*TrailComponent.VERTEX_SIZE+0]=e.x,o[2*t*TrailComponent.VERTEX_SIZE+1]=e.y,o[2*t*TrailComponent.VERTEX_SIZE+2]=e.z,o[(2*t+1)*TrailComponent.VERTEX_SIZE+0]=e.x,o[(2*t+1)*TrailComponent.VERTEX_SIZE+1]=e.y,o[(2*t+1)*TrailComponent.VERTEX_SIZE+2]=e.z,o[2*t*TrailComponent.VERTEX_SIZE+3]=i.x,o[2*t*TrailComponent.VERTEX_SIZE+4]=i.y,o[2*t*TrailComponent.VERTEX_SIZE+5]=i.z,o[(2*t+1)*TrailComponent.VERTEX_SIZE+3]=i.x,o[(2*t+1)*TrailComponent.VERTEX_SIZE+4]=i.y,o[(2*t+1)*TrailComponent.VERTEX_SIZE+5]=i.z,o[2*t*TrailComponent.VERTEX_SIZE+6]=s.x,o[2*t*TrailComponent.VERTEX_SIZE+7]=s.y,o[2*t*TrailComponent.VERTEX_SIZE+8]=s.z,o[(2*t+1)*TrailComponent.VERTEX_SIZE+6]=s.x,o[(2*t+1)*TrailComponent.VERTEX_SIZE+7]=s.y,o[(2*t+1)*TrailComponent.VERTEX_SIZE+8]=s.z,o[2*t*TrailComponent.VERTEX_SIZE+9]=1,o[(2*t+1)*TrailComponent.VERTEX_SIZE+9]=-1,o[2*t*TrailComponent.VERTEX_SIZE+10]=t,o[(2*t+1)*TrailComponent.VERTEX_SIZE+10]=t,o[2*t*TrailComponent.VERTEX_SIZE+11]=this._points[t].time-this._dashOffsetTime,o[(2*t+1)*TrailComponent.VERTEX_SIZE+11]=this._points[t].time-this._dashOffsetTime}r.needsUpdate=!0,r.updateRange.offset=i.max<i.min?0:2*i.min*TrailComponent.VERTEX_SIZE,r.updateRange.count=i.max<i.min?-1:2*(i.length()+1)*TrailComponent.VERTEX_SIZE,s.Interval.pool.release(i)}_getIntervalForUpdate(t){const e=this._relativeStartTime||this._relativeEndTime?this.getEntity().getScene().getEngine().getTime():void 0;if(this._relativeStartTime)if(void 0!==this._startTime)t.min=e-this._startTime;else{let i=null;for(let t=0;;t++){const s=this.getEntity().getControllerByType("dynamo",t);if(null===s)break;"orb"===s.getPointType()&&s.getCoverage().contains(e)&&(i=s)}if(null!==i){const s=i.getSemiMajorAxis(e),n=i.getEccentricity(e),r=i.getHeaderValue("gravitationalParameter1")+i.getHeaderValue("gravitationalParameter2"),o=s*(n<1?1:16*Math.min(100,n)),a=2*Math.PI*o*Math.sqrt(o/r);t.min=e-a}else t.min=e-2*Math.PI*this.getEntity().getPosition().magnitude()/this.getEntity().getVelocity().magnitude()}else t.min=this._startTime;if(this._relativeEndTime)if(void 0!==this._endTime)t.max=e+this._endTime;else{let i=this.getEntity().getPosition().magnitude();for(let t=0;;t++){const s=this.getEntity().getControllerByType("dynamo",t);if(null===s)break;if(s.getCoverage().contains(e)){const t=s.getSemiMajorAxis(e);if(!isNaN(t)){i=t*Math.sqrt((2*t-i)/i);break}}}t.max=e+2*Math.PI*i/this.getEntity().getVelocity().magnitude()}else t.max=this._endTime;t.intersection(t,this.getEntity().getPositionCoverage())}_popFrontPoint(t){this._pointsCount>0&&(this._resize(this._pointsCount-1,t),t.expandTo(this._pointsStart),this._pointsCount>1&&t.expandTo((this._pointsStart+1)%this._points.length),this._points[this._pointsStart].position.x=NaN,this._pointsStart=(this._pointsStart+1)%this._points.length,this._pointsCount-=1)}_popBackPoint(t){this._pointsCount>0&&(this._resize(this._pointsCount-1,t),this._pointsCount-=1,t.expandTo((this._pointsStart+this._pointsCount)%this._points.length),this._pointsCount>0&&t.expandTo((this._pointsStart+this._pointsCount-1)%this._points.length),this._points[(this._pointsStart+this._pointsCount)%this._points.length].position.x=NaN)}_pushFrontPoint(t){this._resize(this._pointsCount+1,t),this._pointsStart=(this._pointsStart+this._points.length-1)%this._points.length,t.expandTo(this._pointsStart),this._pointsCount>0&&t.expandTo((this._pointsStart+1)%this._points.length),this._pointsCount+=1}_pushBackPoint(t){this._resize(this._pointsCount+1,t),this._pointsCount+=1,t.expandTo((this._pointsStart+this._pointsCount-1)%this._points.length),this._pointsCount>1&&t.expandTo((this._pointsStart+this._pointsCount-2)%this._points.length)}_resize(t,e){let i=!1,n=this._points.length;if((t+1>this._points.length||t<=this._points.length/4&&t>=8)&&(i=!0),i){n=Math.max(8,s.MathUtils.ceilPow2(t+1));const i=[];for(let t=0,e=this._pointsCount;t<e;t++)i.push(this._points[(this._pointsStart+t)%this._points.length]);this._pointsStart=0;for(let t=this._pointsCount,e=n;t<e;t++){const t=new Point;t.position.x=Number.NaN,i.push(t)}this._points=i;const r=this.getThreeJsObjects()[0].geometry,o=new Float32Array(2*this._points.length*TrailComponent.VERTEX_SIZE),a=new s.THREE.InterleavedBuffer(o,TrailComponent.VERTEX_SIZE);r.setAttribute("position",new s.THREE.InterleavedBufferAttribute(a,3,0,!1)),r.setAttribute("positionPrev",new s.THREE.InterleavedBufferAttribute(a,3,3,!1)),r.setAttribute("positionNext",new s.THREE.InterleavedBufferAttribute(a,3,6,!1)),r.setAttribute("side",new s.THREE.InterleavedBufferAttribute(a,1,9,!1)),r.setAttribute("index",new s.THREE.InterleavedBufferAttribute(a,1,10,!1)),r.setAttribute("dashOffset",new s.THREE.InterleavedBufferAttribute(a,1,11,!1));const l=new Uint16Array(6*this._points.length);for(let t=0;t<this._points.length;t++)l[6*t+0]=(2*t+0)%(2*this._points.length),l[6*t+1]=(2*t+2)%(2*this._points.length),l[6*t+2]=(2*t+3)%(2*this._points.length),l[6*t+3]=(2*t+3)%(2*this._points.length),l[6*t+4]=(2*t+1)%(2*this._points.length),l[6*t+5]=(2*t+0)%(2*this._points.length);r.setIndex(new s.THREE.BufferAttribute(l,1)),this._dashOffsetTime=this._points[this._pointsStart].time,e.min=0,e.max=n}}_getPositionAndVelocity(t,e,i){const n=""!==this._relativeToEntity.getName()?this._relativeToEntity.get():this.getEntity().getParent();if(""===this._relativeToEntity.getName()){this.getEntity().getPositionAtTime(t,i),this.getEntity().getVelocityAtTime(e,i);const n=this.getEntity().getParentAtTime(i),r=this._currentRelativeToEntity.get();if(null!==r&&""!==n&&n!==r.getName()){const o=this.getEntity().getScene().getEntity(n);null!==o?(o.getPositionRelativeToEntity(t,t,r,i),o.getVelocityRelativeToEntity(e,e,r,i)):(t.copy(s.Vector3.NaN),e.copy(s.Vector3.NaN))}}else null!==n?(this.getEntity().getPositionRelativeToEntity(t,s.Vector3.Zero,n,i),this.getEntity().getVelocityRelativeToEntity(e,s.Vector3.Zero,n,i)):(t.copy(s.Vector3.NaN),e.copy(s.Vector3.NaN));if(this._relativeToEntityOrientation&&null!==n){const r=s.Quaternion.pool.get();n.getOrientationAtTime(r,i),t.rotateInverse(r,t),e.rotateInverse(r,e),s.Quaternion.pool.release(r)}}}TrailComponent.VERTEX_SIZE=12;const n=TrailComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class BaseController extends s.EntityItem{constructor(t,e,i){super(t,e,i),this._coverage=new s.Interval(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),this._coverage.freeze(),this._modifiedStates=new Set,this._dependentStates=new Set,this.getEntity().getScene().getControllerDependencyGraph().addItem(this)}__destroy(){this.getEntity().getScene().getControllerDependencyGraph().removeItem(this),super.__destroy()}addModifiedState(t){this._modifiedStates.has(t)||(this._modifiedStates.add(t),this.getEntity().getScene().getControllerDependencyGraph().needsSorting(),"position"!==t&&"orientation"!==t||this.getEntity().__updateCoverage())}removeModifiedState(t){this._modifiedStates.delete(t)&&(this.getEntity().getScene().getControllerDependencyGraph().needsSorting(),"position"!==t&&"orientation"!==t||this.getEntity().__updateCoverage())}hasModifiedState(t){return this._modifiedStates.has(t)}addDependentState(t,e){this._dependentStates.has(t+"."+e)||(this._dependentStates.add(t+"."+e),this.getEntity().getScene().getControllerDependencyGraph().needsSorting())}removeDependentState(t,e){this._dependentStates.delete(t+"."+e)&&this.getEntity().getScene().getControllerDependencyGraph().needsSorting()}hasDependentState(t,e){return this._dependentStates.has(t+"."+e)}get __modifiedStates(){return this._modifiedStates}getCoverage(){return this._coverage}setCoverage(t){this._coverage.thaw(),this._coverage.copy(t),this._coverage.freeze(),this.getEntity().__updateCoverage()}__updatePositionAtTime(t,e){}__updateVelocityAtTime(t,e){}__updateOrientationAtTime(t,e){}toString(){let t=0;for(let e=0,i=this.getEntity().getNumControllers();e<i;e++){const i=this.getEntity().getController(e);if(this===i)break;this.getType()===i.getType()&&(t+=1)}return this.getEntity().getName()+"."+this.getType()+"."+t}}const n=BaseController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class AlignController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._primaryAlignType="none",this._primaryAxis=new s.Vector3(1,0,0),this._primaryAxis.freeze(),this._primaryTargetEntity=new s.EntityRef(this.getEntity().getScene()),this._primaryTargetEntity.setRefChangedCallback(((t,e)=>{this._removeDependentStates(t,this._primaryAlignType),this._addDependentStates(e,this._primaryAlignType)})),this._primaryTargetAxis=new s.Vector3(1,0,0),this._primaryTargetAxis.freeze(),this._secondaryAlignType="none",this._secondaryAxis=new s.Vector3(0,1,0),this._secondaryAxis.freeze(),this._secondaryTargetEntity=new s.EntityRef(this.getEntity().getScene()),this._secondaryTargetEntity.setRefChangedCallback(((t,e)=>{this._removeDependentStates(t,this._secondaryAlignType),this._addDependentStates(e,this._secondaryAlignType)})),this._secondaryTargetAxis=new s.Vector3(0,1,0),this._secondaryTargetAxis.freeze(),this._joint="",this._jointObject=null,this._model=null,this._modelRootId=0,this.addModifiedState("orientation")}getPrimaryAlignType(){return this._primaryAlignType}setPrimaryAlignType(t){this._primaryAlignType!==t&&(this._removeDependentStates(this._primaryTargetEntity.get(),this._primaryAlignType),this._primaryAlignType=t,this._addDependentStates(this._primaryTargetEntity.get(),this._primaryAlignType))}getPrimaryAxis(){return this._primaryAxis}setPrimaryAxis(t){this._primaryAxis.thaw(),this._primaryAxis.copy(t),this._primaryAxis.freeze()}getPrimaryTargetEntity(){return this._primaryTargetEntity.getName()}setPrimaryTargetEntity(t){this._primaryTargetEntity.setName(t)}getPrimaryTargetAxis(){return this._primaryTargetAxis}setPrimaryTargetAxis(t){this._primaryTargetAxis.thaw(),this._primaryTargetAxis.copy(t),this._primaryTargetAxis.freeze()}getSecondaryAlignType(){return this._secondaryAlignType}setSecondaryAlignType(t){this._secondaryAlignType!==t&&(this._removeDependentStates(this._secondaryTargetEntity.get(),this._secondaryAlignType),this._secondaryAlignType=t,this._addDependentStates(this._secondaryTargetEntity.get(),this._secondaryAlignType))}getSecondaryAxis(){return this._secondaryAxis}setSecondaryAxis(t){this._secondaryAxis.thaw(),this._secondaryAxis.copy(t),this._secondaryAxis.freeze()}getSecondaryTargetEntity(){return this._secondaryTargetEntity.getName()}setSecondaryTargetEntity(t){this._secondaryTargetEntity.setName(t)}getSecondaryTargetAxis(){return this._secondaryTargetAxis}setSecondaryTargetAxis(t){this._secondaryTargetAxis.thaw(),this._secondaryTargetAxis.copy(t),this._secondaryTargetAxis.freeze()}setJoint(t,e){if(this._joint=t,e)this._model=e;else{const t=this.getEntity().get("model");null!==t&&(this._model=t)}""!==this._joint?(this.addDependentState(this.getEntity().getName(),"orientation"),this.removeModifiedState("orientation")):(this.removeDependentState(this.getEntity().getName(),"orientation"),this.addModifiedState("orientation"))}__updateOrientationAtTime(t,e){""===this._joint&&this._getOrientation(t,e)}__update(){const t=s.Quaternion.pool.get();this._jointObject,t.copy(this.getEntity().getOrientation()),this._getOrientation(t),null!==this._jointObject?this._jointObject.quaternion.set(t.x,t.y,t.z,t.w):this.getEntity().setOrientation(t),s.Quaternion.pool.release(t)}_getOrientation(t,e){if(""!==this._joint&&null!==this._model){const t=this._model.getThreeJsObjects()[0];if(void 0!==t&&(null===this._jointObject||this._jointObject.name!==this._joint||t.id!==this._modelRootId)){const e=this._model.getThreeJsObjectByName(this._joint);null!==e&&(this._jointObject=e,this._modelRootId=t.id)}if(null===this._jointObject)return}const i=s.Vector3.pool.get(),n=s.Vector3.pool.get(),r=s.Quaternion.pool.get(),o=s.Quaternion.pool.get();if(null!==this._jointObject){let e=this._jointObject;for(AlignController._tempThreeJsQuaternion.set(0,0,0,1);null!==e.parent&&e.parent!==this._model.getThreeJsObjects()[0];)e=e.parent,AlignController._tempThreeJsQuaternion.multiplyQuaternions(e.quaternion,AlignController._tempThreeJsQuaternion);o.copyFromThreeJs(AlignController._tempThreeJsQuaternion),o.mult(this._model.getRotation(),o),o.mult(t,o)}else o.copy(t);if(o.isNaN()&&o.copy(s.Quaternion.Identity),n.rotate(o,this._primaryAxis),this._getAxis(i,this._primaryAlignType,this._primaryTargetEntity,this._primaryTargetAxis,n,e),i.isNaN()&&i.set(1,0,0),r.setFromVectorFromTo(n,i),t.mult(r,o),t.isNaN()&&t.copy(s.Quaternion.Identity),s.Vector3.pool.release(n),s.Quaternion.pool.release(r),"none"!==this._secondaryAlignType&&null!==this._secondaryTargetEntity&&(this._getAxis(i,this._secondaryAlignType,this._secondaryTargetEntity,this._secondaryTargetAxis,n,e),!i.isNaN())){const e=s.Quaternion.pool.get(),n=s.Vector3.pool.get(),r=s.Vector3.pool.get();n.rotate(t,this._primaryAxis),r.rotate(t,this._secondaryAxis);const o=r.angleAroundAxis(i,n);e.setFromAxisAngle(n,o),t.mult(e,t),s.Quaternion.pool.release(e),s.Vector3.pool.release(n),s.Vector3.pool.release(r)}t.normalize(t),null!==this._jointObject&&t.multInverseL(o,t),s.Quaternion.pool.release(o),s.Vector3.pool.release(i)}_getAxis(t,e,i,n,r,o){const a=i.get();if("align"===e&&null!==a){const e=s.Quaternion.pool.get();a.getOrientationAtTime(e,o),t.rotate(e,n),s.Quaternion.pool.release(e)}else"velocity"===e&&null!==a?(a.getVelocityAtTime(t,o),t.normalize(t)):"point"===e&&null!==a?(a.getPositionRelativeToEntity(t,s.Vector3.Zero,this.getEntity(),o),t.normalize(t)):"position"===e&&null!==a?t.normalize(a.getPosition()):t.copy(r)}_removeDependentStates(t,e){null!==t&&("align"===e?this.removeDependentState(t.getName(),"orientation"):"velocity"===e?this.removeDependentState(t.getName(),"velocity"):"point"===e?(this.removeDependentState(this.getEntity().getName(),"position"),this.removeDependentState(t.getName(),"position")):"position"===e&&this.removeDependentState(t.getName(),"position"))}_addDependentStates(t,e){null!==t&&("align"===e?this.addDependentState(t.getName(),"orientation"):"velocity"===e?this.addDependentState(t.getName(),"velocity"):"point"===e?(this.addDependentState(this.getEntity().getName(),"position"),this.addDependentState(t.getName(),"position")):"position"===e&&this.addDependentState(t.getName(),"position"))}}AlignController._tempThreeJsQuaternion=new s.THREE.Quaternion;const n=AlignController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);const n=new s.Quaternion(.9791532214288992,.2031230389823101,0,0);class State{read(t){}interpolate(t,e,i,s){}}class PosState extends State{constructor(){super(),this.position=new s.Vector3,this.velocity=new s.Vector3}read(t){this.position.y=-t.readFloat64(),this.position.z=t.readFloat64(),this.position.x=t.readFloat64(),this.velocity.y=-t.readFloat64(),this.velocity.z=t.readFloat64(),this.velocity.x=t.readFloat64(),this.position.rotate(n,this.position),this.velocity.rotate(n,this.velocity)}interpolate(t,e,i,s){const n=1-s,r=n*n,o=s*s,a=(1+2*s)*r,l=s*r,h=o*(3-2*s),c=o*-n;this.position.mult(t.position,a),this.position.addMult(this.position,t.velocity,i*l),this.position.addMult(this.position,e.position,h),this.position.addMult(this.position,e.velocity,i*c);const d=6*(o-s),u=d,_=3*o-4*s+1,g=-d,p=3*o-2*s;this.velocity.mult(t.position,u/i),this.velocity.addMult(this.velocity,t.velocity,_),this.velocity.addMult(this.velocity,e.position,g/i),this.velocity.addMult(this.velocity,e.velocity,p)}}class OriState extends State{constructor(){super(),this.orientation=new s.Quaternion}read(t){this.orientation.y=t.readFloat32(),this.orientation.z=-t.readFloat32(),this.orientation.x=-t.readFloat32(),this.orientation.w=t.readFloat32(),this.orientation.mult(n,this.orientation)}interpolate(t,e,i,s){this.orientation.slerp(t.orientation,e.orientation,s)}}class DataPoint{constructor(t){this.interval=new s.Interval,this.state=t.__getNewState()}read(t){this.interval.min=t.readFloat64(),this.interval.max=t.readFloat64(),this.state.read(t)}}class AnimdataFile{constructor(t,e,i){this.interval=new s.Interval,this.dataPoints=[];const n=t.getUrl()+"/"+t.getStateType()+"_data/"+("00"+e).slice(-3)+"."+("000"+(i+1)).slice(-4)+".animdata";this.promise=t.getEntity().getScene().getEngine().getDownloader().download(n,!0).then((async e=>{if("cancelled"===e.status)return Promise.resolve();if("failed"===e.status)return Promise.reject(new Error('Failed to load animdata controller file "'+e.url+'": '+e.errorMessage));if(!(e.content instanceof ArrayBuffer))return Promise.reject(new Error('Failed to load animdata controller file "'+e.url+'": Not a binary file.'));const i=new s.Reader(e.content);this.interval.min=i.readFloat64(),this.interval.max=i.readFloat64();const n=i.readInt32();for(let e=0;e<n;e++){const e=new DataPoint(t);e.read(i),this.dataPoints.push(e)}}))}}class FileOverlap{constructor(){this.fileIndex=0,this.interval=new s.Interval}}class BucketOverlap{constructor(){this.fileIndex=0,this.dataPointIndices=[]}}class Bucket{constructor(){this.bucketOverlaps=[]}}class AniminfoFile{constructor(t,e,i){this.fileOverlaps=new Map,this.buckets=[];const n=t.getUrl()+"/"+t.getStateType()+"_info/"+("00"+e).slice(-3)+"."+("000"+i).slice(-4)+".animinfo";this.promise=t.getEntity().getScene().getEngine().getDownloader().download(n,!0).then((async t=>{if("cancelled"===t.status)return Promise.resolve();if("failed"===t.status)return Promise.reject(new Error('Failed to load animdata controller file "'+t.url+'": '+t.errorMessage));if(!(t.content instanceof ArrayBuffer))return Promise.reject(new Error('Failed to load animdata controller file "'+t.url+'": Not a binary file.'));const e=new s.Reader(t.content),i=e.readInt16();for(let t=0;t<i;t++){const t=new FileOverlap;t.fileIndex=e.readInt16(),t.interval.min=e.readFloat64(),t.interval.max=e.readFloat64(),this.fileOverlaps.set(t.fileIndex,t)}const n=e.readInt16();for(let t=0;t<n;t++){const t=new Bucket,i=e.readInt16();for(let s=0;s<i;s++){const i=new BucketOverlap;i.fileIndex=e.readInt16();const s=e.readInt16();for(let t=0;t<s;t++)i.dataPointIndices.push(e.readInt16());t.bucketOverlaps.push(i)}this.buckets.push(t)}}))}}class Coverage{constructor(){this.interval=new s.Interval,this.numDataFiles=0,this.numBuckets=0,this.bucketStepSize=0,this.numBucketsPerAniminfoFile=0,this.animinfos=new Map,this.animdatas=new Map}}class AnimdefFile{constructor(t){this.coverages=[];const e=t.getUrl()+"/"+t.getStateType()+".animdef";this.promise=t.getEntity().getScene().getEngine().getDownloader().download(e,!0).then((async e=>{if("cancelled"===e.status)return Promise.resolve();if("failed"===e.status)return Promise.reject(new Error('Failed to load animdata controller file "'+e.url+'": '+e.errorMessage));if(!(e.content instanceof ArrayBuffer))return Promise.reject(new Error('Failed to load animdata controller file "'+e.url+'": Not a binary file.'));const i=new s.Reader(e.content),n=i.readInt16();for(let t=0;t<n;t++){const t=new Coverage;t.interval.min=i.readFloat64(),t.interval.max=i.readFloat64(),t.numDataFiles=i.readInt16(),t.numBuckets=i.readInt32(),t.bucketStepSize=i.readFloat64(),t.numBucketsPerAniminfoFile=i.readInt16(),this.coverages.push(t)}t.__updateCoverage()}))}}class AnimdataController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._baseUrl="",this._stateType="",this._animdef=null,this._currentDataPoint=null,this._tempDataPoint=null,this._engine=this.getEntity().getScene().getEngine(),this._forcedCoverage=new s.Interval,this._forcedCoverage.copy(this.getCoverage())}getUrl(){return this._baseUrl}getStateType(){return this._stateType}setBaseUrlAndStateType(t,e){this._baseUrl=t,this._stateType=e,this._currentDataPoint=new DataPoint(this),this._tempDataPoint=new DataPoint(this),this._animdef=new AnimdefFile(this),"pos"===this._stateType?(this.addModifiedState("position"),this.addModifiedState("velocity")):"ori"===this._stateType&&this.addModifiedState("orientation")}setCoverage(t){this._forcedCoverage.copy(t),this.__updateCoverage()}__updateCoverage(){const t=s.Interval.pool.get();if(null!==this._animdef&&this._animdef.coverages.length>0){t.copy(this._animdef.coverages[0].interval);for(let e=1;e<this._animdef.coverages.length;e++)t.union(t,this._animdef.coverages[e].interval);t.intersection(t,this._forcedCoverage)}else t.copy(this._forcedCoverage),t.max=t.min;super.setCoverage(t),s.Interval.pool.release(t)}__updatePositionAtTime(t,e){if("pos"===this._stateType){const i=this._tempDataPoint.state;this._tempDataPoint.interval.min!==e?this._getDataPointAtTime(this._tempDataPoint,e)&&t.copy(i.position):t.copy(i.position)}}__updateVelocityAtTime(t,e){if("pos"===this._stateType){const i=this._tempDataPoint.state;this._tempDataPoint.interval.min!==e?this._getDataPointAtTime(this._tempDataPoint,e)&&t.copy(i.velocity):t.copy(i.velocity)}}__updateOrientationAtTime(t,e){if("ori"===this._stateType){const i=this._tempDataPoint.state;this._getDataPointAtTime(this._tempDataPoint,e)&&t.copy(i.orientation)}}getLoadedPromise(){return this.downloadDataForInterval(new s.Interval(this._engine.getTime(),this._engine.getTime()))}downloadDataForInterval(t){return null===this._animdef?null:this._animdef.promise.then((async()=>{const e=[];for(let i=0;i<this._animdef.coverages.length;i++){const s=this._animdef.coverages[i];if(s.interval.intersects(t)){const n=Math.floor((Math.max(t.min,s.interval.min)-s.interval.min)/s.bucketStepSize/s.numBucketsPerAniminfoFile),r=Math.floor((Math.min(t.max,s.interval.max)-1e-4-s.interval.min)/s.bucketStepSize/s.numBucketsPerAniminfoFile);for(let o=n;o<=r;o++){s.animinfos.has(o)||s.animinfos.set(o,new AniminfoFile(this,i,o));const n=s.animinfos.get(o);e.push(n.promise.then((()=>{const e=[];for(const r of n.fileOverlaps.values())if(r.interval.intersects(t)){const t=r.fileIndex;s.animdatas.has(t)||s.animdatas.set(t,new AnimdataFile(this,i,t));const n=s.animdatas.get(t);e.push(n.promise)}return Promise.all(e).then()})))}return Promise.all(e).then()}}}))}__getNewState(){return"pos"===this._stateType?new PosState:"ori"===this._stateType?new OriState:null}__update(){if(null!==this._currentDataPoint&&this._getDataPointAtTime(this._currentDataPoint,this._engine.getTime())){if("pos"===this._stateType){const t=this._currentDataPoint.state;this.getEntity().setPosition(t.position),this.getEntity().setVelocity(t.velocity)}if("ori"===this._stateType){const t=this._currentDataPoint.state;this.getEntity().setOrientation(t.orientation)}}}_getDataPointAtTime(t,e){for(let i=0;i<this._animdef.coverages.length;i++){const s=this._animdef.coverages[i];if(s.interval.contains(e)){const n=Math.floor((e-s.interval.min)/s.bucketStepSize/s.numBucketsPerAniminfoFile);if(s.animinfos.has(n)){const r=s.animinfos.get(n),o=Math.floor((e-s.interval.min)/s.bucketStepSize)-n*s.numBucketsPerAniminfoFile,a=r.buckets[o];if(void 0===a)return!1;for(let n=0;n<a.bucketOverlaps.length;n++){const o=a.bucketOverlaps[n],l=o.fileIndex;if(r.fileOverlaps.get(l).interval.contains(e)){if(s.animdatas.has(l)){const i=s.animdatas.get(l);for(let s=0;s<o.dataPointIndices.length;s++){const n=o.dataPointIndices[s],r=i.dataPoints[n];if(void 0===r)return!1;if(r.interval.contains(e)){const s=(e-r.interval.min)/r.interval.length();return t.interval.min=e,t.interval.max=e,t.state.interpolate(r.state,i.dataPoints[n+1].state,r.interval.length(),s),!0}}return!1}return s.animdatas.set(l,new AnimdataFile(this,i,l)),!1}}return!1}return s.animinfos.set(n,new AniminfoFile(this,i,n)),!1}}return!1}}const r=AnimdataController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class Coverage{constructor(t,e,i,n){this.timeInterval=new s.Interval(t.min,t.max),this.timeInterval.freeze(),this.enterFunction=e,this.exitFunction=i,this.updateFunction=n,this.active=!1}}class CoverageController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._coverages=[]}addCoverage(t,e,i,s){this._coverages.push(new Coverage(t,e,i,s))}clearCoverages(){this._coverages=[]}getStartOfAllCoverages(){let t=Number.POSITIVE_INFINITY;for(let e=0,i=this._coverages.length;e<i;e++)t>this._coverages[e].timeInterval.min&&(t=this._coverages[e].timeInterval.min);return t}getEndOfAllCoverages(){let t=Number.NEGATIVE_INFINITY;for(let e=0,i=this._coverages.length;e<i;e++)t<this._coverages[e].timeInterval.max&&(t=this._coverages[e].timeInterval.max);return t}coverageContains(t,e){const i=this._coverages[t];return void 0!==i&&i.timeInterval.contains(e)}__update(){const t=this.getEntity().getScene().getEngine().getTime();for(let e=0,i=this._coverages.length;e<i;e++){const i=this._coverages[e],s=i.timeInterval.contains(t);i.active&&!s&&(i.exitFunction&&i.exitFunction(this.getEntity()),i.active=s)}for(let e=0,i=this._coverages.length;e<i;e++){const i=this._coverages[e],s=i.timeInterval.contains(t);!i.active&&s&&(i.enterFunction&&i.enterFunction(this.getEntity()),i.active=s),s&&i.updateFunction&&i.updateFunction(this.getEntity())}}}const n=CoverageController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(3);let n=null,r=null;class Point{load(t){this.time=t.readFloat64()}calculate(t,e,i,s,n){}apply(t){}isNaN(t){return!1}setNaN(t){}static readHeader(t){return{}}}class PosPoint extends Point{constructor(){super(),this.position=new s.Vector3,this.velocity=new s.Vector3}load(t){super.load(t),this.position=new s.Vector3(t.readFloat64(),t.readFloat64(),t.readFloat64()),this.velocity=new s.Vector3(t.readFloat64(),t.readFloat64(),t.readFloat64())}calculate(t,e,i,n,r){this.time=i;const o=s.MathUtils.clamp01((i-t.time)/(e.time-t.time)),a=s.Vector3.pool.get(),l=s.Vector3.pool.get();a.addMult(t.position,t.velocity,i-t.time),l.addMult(e.position,e.velocity,i-e.time),this.position.lerp(a,l,o),s.Vector3.pool.release(a),s.Vector3.pool.release(l),this.velocity.lerp(t.velocity,e.velocity,o)}apply(t){t.setPosition(this.position),t.setVelocity(this.velocity)}isNaN(t){return t.getPosition().isNaN()}setNaN(t){t.setPosition(s.Vector3.NaN),t.setVelocity(s.Vector3.NaN)}static readHeader(t){return{}}}class OriPoint extends Point{constructor(){super(),this.orientation=new s.Quaternion,this.angularVelocity=new s.Vector3}load(t){super.load(t),this.orientation=new s.Quaternion(t.readFloat64(),t.readFloat64(),t.readFloat64(),t.readFloat64()),this.angularVelocity=new s.Vector3(t.readFloat64(),t.readFloat64(),t.readFloat64())}calculate(t,e,i,n,r){this.time=i;const o=s.Quaternion.pool.get(),a=s.Quaternion.pool.get(),l=(i-t.time)/(e.time-t.time);t._project(o,i,r),e._project(a,i,r),this.orientation.slerp(o,a,l),s.Quaternion.pool.release(o),s.Quaternion.pool.release(a),this.angularVelocity.slerp(t.angularVelocity,e.angularVelocity,l),this.angularVelocity.neg(this.angularVelocity),this.angularVelocity.rotate(this.orientation,this.angularVelocity)}apply(t){t.setOrientation(this.orientation),t.setAngularVelocity(this.angularVelocity)}_project(t,e,i){const n=s.Vector3.pool.get(),r=s.Quaternion.pool.get();n.normalize(this.angularVelocity),r.setFromAxisAngle(n,this.angularVelocity.magnitude()*(e-this.time)),s.Vector3.pool.release(n),i?(r.multInverseR(this.orientation,r),t.mult(t,r)):t.multInverseR(this.orientation,r),s.Quaternion.pool.release(r)}isNaN(t){return t.getOrientation().isNaN()}setNaN(t){t.setOrientation(s.Quaternion.NaN),t.setAngularVelocity(s.Vector3.NaN)}static readHeader(t){return{}}}class QuatPoint extends Point{constructor(){super(),this.orientation=new s.Quaternion,this.angularVelocity=new s.Vector3}load(t){super.load(t),this.orientation=new s.Quaternion(t.readFloat64(),t.readFloat64(),t.readFloat64(),t.readFloat64())}calculate(t,e,i,n,r){this.time=i;const o=s.MathUtils.clamp01((i-t.time)/(e.time-t.time));this.orientation.slerp(t.orientation,e.orientation,o)}apply(t){t.setOrientation(this.orientation),t.setAngularVelocity(s.Vector3.Zero)}isNaN(t){return t.getOrientation().isNaN()}setNaN(t){t.setOrientation(s.Quaternion.NaN),t.setAngularVelocity(s.Vector3.NaN)}static readHeader(t){return{}}}class OrbPoint extends Point{constructor(){super(),this.oe=new s.OrbitalElements,this.oe.orbitOrientation.freeze(),this.position=new s.Vector3,this.velocity=new s.Vector3}load(t){super.load(t),this.oe.epoch=this.time,this.oe.semiMajorAxis=t.readFloat64(),this.oe.eccentricity=t.readFloat64(),this.oe.meanAngularMotion=t.readFloat64(),this.oe.meanAnomalyAtEpoch=t.readFloat64(),this.oe.orbitOrientation.thaw(),this.oe.orbitOrientation.set(t.readFloat64(),t.readFloat64(),t.readFloat64(),t.readFloat64()),this.oe.orbitOrientation.freeze()}calculate(t,e,i,n,r){this.time=i,this.oe.epoch=i;const o=s.Vector3.pool.get(),a=s.Vector3.pool.get(),l=s.Vector3.pool.get(),h=s.Vector3.pool.get(),c=s.MathUtils.clamp01((i-t.time)/(e.time-t.time));t._project(o,l,i,n,r),e._project(a,h,i,n,r),this.position.lerp(o,a,c),this.velocity.lerp(l,h,c),s.Vector3.pool.release(o),s.Vector3.pool.release(a),s.Vector3.pool.release(l),s.Vector3.pool.release(h)}apply(t){t.setPosition(this.position),t.setVelocity(this.velocity)}_project(t,e,i,n,r){const o=s.Vector3.pool.get(),a=s.Vector3.pool.get();this.oe.project(o,a,i);let l=1;1===n.body?l=n.gravitationalParameter2/(n.gravitationalParameter1+n.gravitationalParameter2):2===n.body&&(l=-n.gravitationalParameter1/(n.gravitationalParameter1+n.gravitationalParameter2)),o.mult(o,l),a.mult(a,l),r?t.add(o,t):t.copy(o),e.copy(a),s.Vector3.pool.release(o),s.Vector3.pool.release(a)}isNaN(t){return t.getPosition().isNaN()}setNaN(t){t.setPosition(s.Vector3.NaN),t.setVelocity(s.Vector3.NaN)}static readHeader(t){return{gravitationalParameter1:t.readFloat64(),gravitationalParameter2:t.readFloat64()}}}class PointSet{constructor(t,e,i,n){this._PointClass=t,this._version=e,this._numberOfDigits=i,this._name=n,this._pointSets=[],this._points=[],this._hintIndex=0,this._interval=new s.Interval(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY),this._loadedState=PointSet.State.NOT_LOADED,this._accessedTime=Number.POSITIVE_INFINITY}getName(){return this._name}getLoadedState(){return this._loadedState}getLoadedTime(){return this._accessedTime}hasPointSets(){return 0!==this._pointSets.length}hasPoints(){return 0!==this._points.length}load(t){let e=!0;if((2===this._version||1===this._version&&"def"===this._name)&&(e=1===t.readByte()),e){const e=t.readInt32();for(let i=0;i<e;i++){const e=new this._PointClass;e.load(t),this._points.push(e)}this._points.length>0&&(this._interval.min=this._points[0].time,this._interval.max=this._points[this._points.length-1].time)}else{const e=t.readInt32();1===this._version&&(this._numberOfDigits=Math.ceil(Math.log10(e)));for(let i=0;i<e;i++){let e="";e="def"===this._name?(i+"").padStart(this._numberOfDigits,"0"):this._name+"_"+(i+"").padStart(this._numberOfDigits,"0");const s=new PointSet(this._PointClass,this._version,this._numberOfDigits,e);s._interval.min=t.readFloat64(),1===this._version?s._interval.max=t.readFloat64():i>0&&(this._pointSets[i-1]._interval.max=s._interval.min),this._pointSets.push(s)}2===this._version&&this._pointSets.splice(this._pointSets.length-1,1),this._pointSets.length>0&&(this._interval.min=this._pointSets[0]._interval.min,this._interval.max=this._pointSets[this._pointSets.length-1]._interval.max)}this._loadedState=PointSet.State.LOADED,this._accessedTime=Date.now()}loadFromUrl(t,e){this._loadedState=PointSet.State.LOADING,t.download(e+"/"+this._name+".dyn",!0).then((async t=>{if("cancelled"===t.status)return Promise.resolve();if("failed"===t.status)return Promise.reject(new Error('Failed to load dynamo controller file "'+t.url+'": '+t.errorMessage));if(!(t.content instanceof ArrayBuffer))return Promise.reject(new Error('Failed to load dynamo controller file "'+t.url+'": Not a binary file.'));const e=new s.Reader(t.content);this.load(e)}))}unloadOldPointSet(){for(let t=0,e=this._pointSets.length;t<e;t++){const e=this._pointSets[t];if(e._loadedState===PointSet.State.LOADED){if(Date.now()-e._accessedTime>15e3)return e.unload(),!0;if(e.unloadOldPointSet())return!0}}return!1}unload(){this._loadedState=PointSet.State.NOT_LOADED,this._accessedTime=Number.POSITIVE_INFINITY,this._pointSets=[],this._points=[]}getPointSet(t){if(this._accessedTime=Date.now(),0===this._pointSets.length)return null;if(this._pointSets[this._hintIndex]._interval.contains(t));else if(this._hintIndex-1>=0&&this._pointSets[this._hintIndex-1]._interval.contains(t))this._hintIndex-=1;else if(this._hintIndex+1<this._pointSets.length&&this._pointSets[this._hintIndex+1]._interval.contains(t))this._hintIndex+=1;else{let e=0,i=this._pointSets.length-1,s=0;for(;e!==i;)s=Math.ceil((e+i)/2),t<this._pointSets[s]._interval.min?i=s-1:e=s;this._hintIndex=e}return this._pointSets[this._hintIndex]}getPoints(t){if(this._accessedTime=Date.now(),0===this._points.length)return n=null,void(r=null);if(this._hintIndex+1<this._points.length&&this._points[this._hintIndex].time<=t&&t<this._points[this._hintIndex+1].time);else if(this._hintIndex-1>=0&&this._points[this._hintIndex-1].time<=t&&t<this._points[this._hintIndex].time)this._hintIndex-=1;else if(this._hintIndex+2<this._points.length&&this._points[this._hintIndex+1].time<=t&&t<this._points[this._hintIndex+2].time)this._hintIndex+=1;else{let e=0,i=this._points.length-2,s=0;for(;e!==i;)s=Math.ceil((e+i)/2),t<this._points[s].time?i=s-1:e=s;this._hintIndex=e}n=this._points[this._hintIndex],r=this._points[this._hintIndex+1]}}PointSet.State={NOT_LOADED:0,LOADING:1,LOADED:2};class DynamoController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._baseUrl="",this._dataLoadedAtCurrentTime=!1,this._timeOffset=0,this._version=0,this._pointType="",this._PointClass=null,this._numberOfDigits=0,this._header={body:0},this._incremental=!1,this._pointSet=null,this._downloader=i.getScene().getEngine().getDownloader(),this._lastP0=null,this._lastP1=null,this._lastTime=Number.NaN,this._pCalc=null,this._userCoverage=new s.Interval(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),this._userCoverage.freeze()}getPointType(){return this._pointType}getHeaderValue(t){return this._header[t]}setHeaderValue(t,e){this._header[t]=e}isIncremental(){return this._incremental}setIncremental(t){this._incremental=t}getBaseUrl(){return this._baseUrl}setBaseUrl(t){""!==this._baseUrl&&(this._downloader.cancel(this._baseUrl+"/def.dyn"),this._pointSet=null,this._PointClass=null,this._userCoverage.thaw(),this._userCoverage=new s.Interval(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),this._userCoverage.freeze(),super.setCoverage(new s.Interval(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY)),this.addModifiedState("position"),this.addModifiedState("velocity"),this.addModifiedState("orientation"),this.addModifiedState("angularVelocity"),this._dataLoadedAtCurrentTime=!1),this._baseUrl=t,this._baseUrl.endsWith("/")&&(this._baseUrl=this._baseUrl.slice(0,-1)),this._loadDef()}getLoadedPromise(){return new Promise((t=>{const e=this.getEntity().getScene().getEngine(),callback=()=>{const i=e.getTime();(this.isDestroyed()||!this.isEnabled()||!this.getEntity().isEnabled()||""===this._baseUrl||null!==this._pointSet&&!this.getCoverage().contains(i)||this._dataLoadedAtCurrentTime)&&(e.removeCallback(callback),t())};e.addCallback(callback,!0)}))}getTimeOffset(){return this._timeOffset}setTimeOffset(t){const e=this._timeOffset;this._timeOffset=t;const i=new s.Interval;i.copy(this.getCoverage()),i.min+=this._timeOffset-e,i.max+=this._timeOffset-e,super.setCoverage(i)}setCoverage(t){this._userCoverage.thaw(),this._userCoverage.copy(t),this._userCoverage.freeze();const e=s.Interval.pool.get();null!==this._pointSet?e.intersection(this._userCoverage,this._pointSet._interval):e.copy(new s.Interval(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)),e.min+=this._timeOffset,e.max+=this._timeOffset,super.setCoverage(e),s.Interval.pool.release(e)}getOrbitalElements(t,e){if(this._PointClass===OrbPoint&&null!==this._pointSet&&(this._getPointsAtTime(e),null!==n&&(this._lastP0=n,this._lastP1=r),null!==this._lastP0)){const i=this._lastP0.oe,n=this._lastP1.oe,r=s.MathUtils.clamp01((e-this._lastP0.time)/(this._lastP1.time-this._lastP0.time));t.eccentricity=s.MathUtils.lerp(i.eccentricity,n.eccentricity,r),t.semiMajorAxis=s.MathUtils.lerp(i.semiMajorAxis,n.semiMajorAxis,r),t.epoch=s.MathUtils.lerp(i.epoch,n.epoch,r),t.meanAngularMotion=s.MathUtils.lerp(i.meanAngularMotion,n.meanAngularMotion,r),t.meanAnomalyAtEpoch=s.MathUtils.lerpAngle(i.meanAnomalyAtEpoch,n.meanAnomalyAtEpoch,r),t.orbitOrientation.slerp(i.orbitOrientation,n.orbitOrientation,r)}}getEccentricity(t){if(this._PointClass===OrbPoint&&null!==this._pointSet&&(this._getPointsAtTime(t),null!==n&&(this._lastP0=n,this._lastP1=r),null!==this._lastP0)){const e=s.MathUtils.clamp01((t-this._lastP0.time)/(this._lastP1.time-this._lastP0.time));return s.MathUtils.lerp(this._lastP0.oe.eccentricity,this._lastP1.oe.eccentricity,e)}return Number.NaN}getSemiMajorAxis(t){if(this._PointClass===OrbPoint&&null!==this._pointSet&&(this._getPointsAtTime(t),null!==n&&(this._lastP0=n,this._lastP1=r),null!==this._lastP0)){const e=s.MathUtils.clamp01((t-this._lastP0.time)/(this._lastP1.time-this._lastP0.time));return s.MathUtils.lerp(this._lastP0.oe.semiMajorAxis,this._lastP1.oe.semiMajorAxis,e)}return Number.NaN}getOrbitOrientation(t,e){if(this._PointClass===OrbPoint&&null!==this._pointSet&&(this._getPointsAtTime(e),null!==n&&(this._lastP0=n,this._lastP1=r),null!==this._lastP0)){const i=s.MathUtils.clamp01((e-this._lastP0.time)/(this._lastP1.time-this._lastP0.time));t.slerp(this._lastP0.oe.orbitOrientation,this._lastP1.oe.orbitOrientation,i)}}__destroy(){""!==this._baseUrl&&this._downloader.cancel(this._baseUrl+"/def.dyn"),super.__destroy()}__updatePositionAtTime(t,e){if(null!==this._pointSet){if(void 0!==this._pCalc.position&&this.getCoverage().contains(e)){if(this._pCalc.time!==e){if(this._getPointsAtTime(e),null===n)return void t.copy(s.Vector3.NaN);this._pCalc.calculate(n,r,e-this._timeOffset,this._header,this._incremental)}t.copy(this._pCalc.position)}}else t.copy(s.Vector3.NaN)}__updateVelocityAtTime(t,e){if(null!==this._pointSet){if(void 0!==this._pCalc.velocity&&this.getCoverage().contains(e)){if(this._pCalc.time!==e){if(this._getPointsAtTime(e),null===n)return void t.copy(s.Vector3.NaN);this._pCalc.calculate(n,r,e-this._timeOffset,this._header,this._incremental)}t.copy(this._pCalc.velocity)}}else t.copy(s.Vector3.NaN)}__updateOrientationAtTime(t,e){if(null!==this._pointSet){if(void 0!==this._pCalc.orientation&&this.getCoverage().contains(e)){if(this._pCalc.time!==e){if(this._getPointsAtTime(e),null===n)return void t.copy(s.Quaternion.NaN);this._pCalc.calculate(n,r,e-this._timeOffset,this._header,this._incremental)}t.copy(this._pCalc.orientation)}}else t.copy(s.Quaternion.NaN)}__update(){const t=this.getEntity(),e=t.getScene().getEngine(),i=e.getTime();if(null!==this._pointSet)if(this._pointSet.unloadOldPointSet(),this._getPointsAtTime(i),null!==n)this._pCalc.calculate(n,r,i-this._timeOffset,this._header,this._incremental),this._pCalc.apply(t),this._lastP0=n,this._lastP1=r,this._dataLoadedAtCurrentTime=!0;else if(this._pCalc.isNaN(t))this._dataLoadedAtCurrentTime=!1;else{Math.abs(i-(this._lastTime+e.getTimeRate()*e.getDeltaTime()))>Math.abs(e.getTimeRate()*e.getDeltaTime()*2)?this._pCalc.apply(t):null!==this._lastP0&&(this._pCalc.calculate(this._lastP0,this._lastP1,i-this._timeOffset,this._header,this._incremental),this._pCalc.apply(t)),this._dataLoadedAtCurrentTime=!1}else this.getEntity().setPosition(s.Vector3.NaN),this.getEntity().setVelocity(s.Vector3.NaN),this.getEntity().setOrientation(s.Quaternion.NaN),this.getEntity().setAngularVelocity(s.Vector3.NaN),this._dataLoadedAtCurrentTime=!1;this._lastTime=i}async _loadDef(){const t=this._baseUrl;return this._downloader.download(this._baseUrl+"/def.dyn",!0).then((async t=>{if("cancelled"===t.status)return Promise.resolve();if("failed"===t.status)return Promise.reject(new Error('Failed to load dynamo controller file "'+t.url+'": '+t.errorMessage));if(!(t.content instanceof ArrayBuffer))return Promise.reject(new Error('Failed to load dynamo controller file "'+t.url+'": Not a binary file.'));const e=new s.Reader(t.content);if(this._version=e.readInt16(),1!==this._version&&2!==this._version)throw new Error(t.url+" is not Dynamo version 1 or 2");this._pointType=e.readString(),"pos"===this._pointType?this._PointClass=PosPoint:"ori"===this._pointType?this._PointClass=OriPoint:"quat"===this._pointType?this._PointClass=QuatPoint:"orb"===this._pointType&&(this._PointClass=OrbPoint),this._pCalc=new this._PointClass,this._PointClass===PosPoint||this._PointClass===OrbPoint?(this.addModifiedState("position"),this.addModifiedState("velocity"),this.removeModifiedState("orientation"),this.removeModifiedState("angularVelocity")):this._PointClass!==OriPoint&&this._PointClass!==QuatPoint||(this.addModifiedState("orientation"),this.addModifiedState("angularVelocity"),this.removeModifiedState("position"),this.removeModifiedState("velocity")),2===this._version&&(this._numberOfDigits=e.readByte()),this._header=Object.assign(this._header,this._PointClass.readHeader(e)),this._pointSet=new PointSet(this._PointClass,this._version,this._numberOfDigits,"def"),this._pointSet.load(e);const i=s.Interval.pool.get();i.intersection(this._userCoverage,this._pointSet._interval),i.min+=this._timeOffset,i.max+=this._timeOffset,super.setCoverage(i),s.Interval.pool.release(i)})).catch((e=>{throw new Error(`While loading dynamo "${t}/def.dyn": ${e}`)}))}_getPointsAtTime(t){let e=this._pointSet;for(;;){if(e.hasPoints())return void e.getPoints(t-this._timeOffset);if(e.getLoadedState()!==PointSet.State.LOADED)return e.getLoadedState()===PointSet.State.NOT_LOADED?(e.loadFromUrl(this._downloader,this._baseUrl),n=null,void(r=null)):(n=null,void(r=null));if(e=e.getPointSet(t-this._timeOffset),null===e)return n=null,void(r=null)}}}DynamoController.maxLoadedPointSetsPerController=5;const o=DynamoController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class FixedController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._position=null,this._orientation=null}getPosition(){return this._position}setPosition(t){null!==t?(null===this._position&&(this._position=new s.Vector3),this._position.thaw(),this._position.copy(t),this._position.freeze()):this._position=null,null!==t?(this.addModifiedState("position"),this.addModifiedState("velocity")):(this.removeModifiedState("position"),this.removeModifiedState("velocity"))}getOrientation(){return this._orientation}setOrientation(t){null!==t?(null===this._orientation&&(this._orientation=new s.Quaternion),this._orientation.thaw(),this._orientation.copy(t),this._orientation.freeze()):this._orientation=null,null!==t?this.addModifiedState("orientation"):this.removeModifiedState("orientation")}__updatePositionAtTime(t,e){null!==this._position&&t.copy(this._position)}__updateVelocityAtTime(t,e){null!==this._position&&t.set(0,0,0)}__updateOrientationAtTime(t,e){null!==this._orientation&&t.copy(this._orientation)}__update(){null!==this._position&&(this.getEntity().setPosition(this._position),this.getEntity().setVelocity(s.Vector3.Zero)),null!==this._orientation&&this.getEntity().setOrientation(this._orientation)}}const n=FixedController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class FixedToParentController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._lastParentOrientation=new s.Quaternion;const n=this.getEntity().getParent();null!==n&&this._lastParentOrientation.copy(n.getOrientation()),this.addModifiedState("position"),this.addModifiedState("orientation"),this.addDependentState("parent","orientation")}__update(){const t=this.getEntity().getParent();if(null!==t){const e=s.Quaternion.pool.get();e.inverse(this._lastParentOrientation),e.mult(t.getOrientation(),e);const i=s.Vector3.pool.get(),n=s.Quaternion.pool.get();i.rotate(e,this.getEntity().getPosition()),this.getEntity().setPosition(i),n.mult(e,this.getEntity().getOrientation()),this.getEntity().setOrientation(n),s.Quaternion.pool.release(n),s.Vector3.pool.release(i),s.Quaternion.pool.release(e),this._lastParentOrientation.copy(t.getOrientation())}}}const n=FixedToParentController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class FreeFlyController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._dragSensitivity=.01,this._dragSmoothness=.8,this._moveSmoothedValue=new s.Vector3(0,0,0),this._changeParentToNearestEntity=!0,this._forcedMoving=new s.Vector3,this._isMoving=!1,this.addModifiedState("position"),this.addDependentState("parent","orientation"),this.addDependentState("parent","radius")}getDragSensitivity(){return this._dragSensitivity}setDragSensitivity(t){this._dragSensitivity=t}getDragSmoothness(){return this._dragSmoothness}setDragSmoothness(t){this._dragSmoothness=t}getChangeParentToNearestEntity(){return this._changeParentToNearestEntity}setChangeParentToNearestEntity(t){this._changeParentToNearestEntity=t}getForcedMoving(){return this._forcedMoving}setForcedMoving(t){this._forcedMoving=t}__update(){if(null===this.getEntity().getParent())return;if(this._changeParentToNearestEntity&&(null===this.getEntity().getParent()||this._isMoving)){const t=this.getEntity().getScene(),e=this.getEntity().get("camera");let i=null,s=Number.POSITIVE_INFINITY;for(let n=0,r=t.getNumEntities();n<r;n++){const r=t.getEntity(n);if(r===this.getEntity()||!r.canOcclude())continue;const o=r.getCameraSpacePosition(e).magnitude()-r.getOcclusionRadius();s>o&&(s=o,i=r)}null!==i&&i!==this.getEntity().getParent()&&this.getEntity().setParent(i)}this.getEntity().getOrientation().isNaN()&&this.getEntity().setOrientation(s.Quaternion.Identity),this.getEntity().getPosition().isNaN()&&this.getEntity().setPosition(new s.Vector3(0,-1,0));const t=s.Vector3.pool.get();t.set(0,0,0);const e=this.getEntity().getScene().getEngine().getInput(),i=e.getActiveViewport();if(null!==i){const s=i.getCamera();if(null!==s&&s.getEntity()===this.getEntity()){let i=1;e.isKeyPressed("x")&&(i=.05),e.isShiftPressed()&&(i=5);const s=e.getZoomedOffset();0!==s&&(t.y+=-s*this._dragSensitivity*i),e.isKeyPressed("w")&&(t.y+=this._dragSensitivity*i),e.isKeyPressed("s")&&(t.y-=this._dragSensitivity*i),e.isKeyPressed("d")&&(t.x+=this._dragSensitivity*i),e.isKeyPressed("a")&&(t.x-=this._dragSensitivity*i),e.isKeyPressed("e")&&(t.z+=this._dragSensitivity*i),e.isKeyPressed("q")&&(t.z-=this._dragSensitivity*i)}}t.add(t,this._forcedMoving),this._isMoving=t.magnitudeSqr()>0,this._moveSmoothedValue.lerp(t,this._moveSmoothedValue,this._dragSmoothness),!this._isMoving&&this._moveSmoothedValue.magnitudeSqr()<1e-7&&this._moveSmoothedValue.set(0,0,0),s.Vector3.pool.release(t);let n=Number.POSITIVE_INFINITY;const r=this.getEntity().getParent().getComponentByType("spheroid");if(null===r||this.getEntity().getParent().getOrientation().isNaN())n=Math.min(n,this.getEntity().getPosition().magnitude()-this.getEntity().getParent().getOcclusionRadius());else{const t=s.Vector3.pool.get();t.rotateInverse(this.getEntity().getParent().getOrientation(),this.getEntity().getPosition());const e=s.LatLonAlt.pool.get();r.llaFromXYZ(e,t),n=Math.min(n,e.alt),s.LatLonAlt.pool.release(e),s.Vector3.pool.release(t)}n=Math.max(.1,n);const o=this.getEntity().getPosition(),a=s.Vector3.pool.get(),l=s.Vector3.pool.get();l.rotate(this.getEntity().getOrientation(),this._moveSmoothedValue),a.addMult(o,l,n),this.getEntity().setPosition(a),s.Vector3.pool.release(l),s.Vector3.pool.release(a)}}const n=FreeFlyController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);class GroundClampController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._groundComponentRef=new s.ComponentRef(this.getEntity().getScene()),this._distanceFromGround=0,this.addModifiedState("position")}setGroundComponentRef(t,e,i){this._groundComponentRef.setByType(t,e,i)}getDistanceFromGround(){return this._distanceFromGround}setDistanceFromGround(t){this._distanceFromGround=t}__updatePositionAtTime(t,e){const i=this._groundComponentRef.get();if(null===i)return;const n=i.getEntity(),r=this.getEntity().getParentAtTime(e),o=this.getEntity().getScene().getEntity(r);if(null===o)return;const a=s.Vector3.pool.get(),l=s.Quaternion.pool.get();n.getOrientationAtTime(l,e),o.getPositionRelativeToEntity(a,t,n,e),a.rotateInverse(l,a),void 0!==i.getGroundPosition&&i.getGroundPosition(a,a,this._distanceFromGround),a.rotate(l,a),n.getPositionRelativeToEntity(t,a,o,e),s.Vector3.pool.release(a),s.Quaternion.pool.release(l)}__update(){const t=this._groundComponentRef.get();if(null===t)return;const e=t.getEntity(),i=n;this.getEntity().getPositionRelativeToEntity(i,s.Vector3.Zero,e),i.rotateInverse(e.getOrientation(),i),void 0!==t.getGroundPosition&&t.getGroundPosition(i,i,this._distanceFromGround),i.rotate(e.getOrientation(),i),e.getPositionRelativeToEntity(i,i,this.getEntity().getParent()),this.getEntity().setPosition(i)}}const n=new s.Vector3,r=GroundClampController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class KeyframeController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._positionKeyframes=[],this._orientationKeyframes=[],this._timesAreRealTime=!1,this._timeOfFirstUpdate=NaN,this.setCoverage(new s.Interval(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)),this._position0=new s.Vector3,this._position1=new s.Vector3,this._orientation0=new s.Quaternion,this._orientation1=new s.Quaternion,this._newPosition=new s.Vector3,this._newVelocity=new s.Vector3,this._newOrientation=new s.Quaternion,this._tangent0=new s.Vector3,this._tangent1=new s.Vector3,this._tempA=new s.Vector3,this._tempB=new s.Vector3}addPositionKeyframe(t,e,i,n,r,o){const a=[t,{position:e,relativeToEntityPosition:i?new s.EntityRef(this.getEntity().getScene(),i):void 0,relativeToEntityPositionTime:n,relativeToEntityOrientation:r?new s.EntityRef(this.getEntity().getScene(),r):void 0,relativeToEntityOrientationTime:o}];s.Sort.add(a,this._positionKeyframes,isLessAdd),1===this._positionKeyframes.length&&(this.addModifiedState("position"),this.addModifiedState("velocity")),this._updateCoverage()}removePositionKeyframe(t){const e=s.Sort.remove(t,this._positionKeyframes,isLess,isEqual);return e&&(0===this._positionKeyframes.length&&(this.removeModifiedState("position"),this.removeModifiedState("velocity")),this._updateCoverage()),e}addOrientationKeyframe(t,e,i,n){const r=[t,{orientation:e,relativeToEntityOrientation:i?new s.EntityRef(this.getEntity().getScene(),i):void 0,relativeToEntityOrientationTime:n}];s.Sort.add(r,this._orientationKeyframes,isLessAdd),1===this._orientationKeyframes.length&&this.addModifiedState("orientation"),this._updateCoverage()}removeOrientationKeyframe(t){const e=s.Sort.remove(t,this._orientationKeyframes,isLess,isEqual);return e&&(0===this._orientationKeyframes.length&&this.removeModifiedState("orientation"),this._updateCoverage()),e}areTimesRealTime(){return this._timesAreRealTime}setTimesAreRealTime(t){this._timesAreRealTime=t,this._updateCoverage()}__updatePositionAtTime(t,e){this._getPositionAtTime(t,e)}__updateVelocityAtTime(t,e){this._getVelocityAtTime(t,e)}__updateOrientationAtTime(t,e){this._getOrientationAtTime(t,e)}__update(){const t=this.getEntity().getScene().getEngine();let e=0;this._timesAreRealTime?isNaN(this._timeOfFirstUpdate)?this._timeOfFirstUpdate=Date.now()/1e3:e=Date.now()/1e3-this._timeOfFirstUpdate:e=t.getTime(),this._getPositionAtTime(this._newPosition,e)&&this.getEntity().setPosition(this._newPosition),this._getVelocityAtTime(this._newVelocity,e)&&this.getEntity().setVelocity(this._newVelocity),this._getOrientationAtTime(this._newOrientation,e)&&this.getEntity().setOrientation(this._newOrientation)}_getPositionAtTime(t,e){const i=s.Sort.getIndex(e,this._positionKeyframes,isLess);if(i<this._positionKeyframes.length){if(0!==i){const s=i-1,n=i,r=this._positionKeyframes[s][0],o=this._positionKeyframes[n][0];if(this._getPositionOfKeyframe(this._position0,this._positionKeyframes[s]),this._getPositionOfKeyframe(this._position1,this._positionKeyframes[n]),s>0){const t=this._positionKeyframes[s-1][0];this._getPositionOfKeyframe(this._tempA,this._positionKeyframes[s-1]),this._tempA.sub(this._position0,this._tempA),this._tempB.sub(this._position1,this._position0),this._tempB.mult(this._tempB,.5),this._tangent0.addMult(this._tempB,this._tempA,.5*(o-r)/(r-t))}else this._tangent0.sub(this._position1,this._position0);if(n<this._positionKeyframes.length-1){const t=this._positionKeyframes[n+1][0];this._getPositionOfKeyframe(this._tempB,this._positionKeyframes[n+1]),this._tempA.sub(this._position1,this._position0),this._tempB.sub(this._tempB,this._position1),this._tempA.mult(this._tempA,.5),this._tangent1.addMult(this._tempA,this._tempB,.5*(o-r)/(t-o))}else this._tangent1.sub(this._position1,this._position0);const a=(e-r)/(o-r);return this._cubicHermiteSpline(t,this._position0,this._position1,this._tangent0,this._tangent1,a),!0}if(this._positionKeyframes[0][0]===e)return this._getPositionOfKeyframe(t,this._positionKeyframes[0]),!0}return!1}_getVelocityAtTime(t,e){const i=s.Sort.getIndex(e,this._positionKeyframes,isLess);if(i<this._positionKeyframes.length){if(0!==i){const s=i-1,n=i,r=this._positionKeyframes[s][0],o=this._positionKeyframes[n][0];if(this._getPositionOfKeyframe(this._position0,this._positionKeyframes[s]),this._getPositionOfKeyframe(this._position1,this._positionKeyframes[n]),s>0){const t=this._positionKeyframes[s-1][0];this._getPositionOfKeyframe(this._tempA,this._positionKeyframes[s-1]),this._tempA.sub(this._position0,this._tempA),this._tempB.sub(this._position1,this._position0),this._tempB.mult(this._tempB,.5),this._tangent0.addMult(this._tempB,this._tempA,.5*(o-r)/(r-t))}else this._tangent0.sub(this._position1,this._position0);if(n<this._positionKeyframes.length-1){const t=this._positionKeyframes[n+1][0];this._getPositionOfKeyframe(this._tempB,this._positionKeyframes[n+1]),this._tempA.sub(this._position1,this._position0),this._tempB.sub(this._tempB,this._position1),this._tempA.mult(this._tempA,.5),this._tangent1.addMult(this._tempA,this._tempB,.5*(o-r)/(t-o))}else this._tangent1.sub(this._position1,this._position0);const a=(e-r)/(o-r);return this._cubicHermiteSplineDerivative(t,this._position0,this._position1,this._tangent0,this._tangent1,a),t.div(t,o-r),!0}if(this._positionKeyframes[0][0]===e){if(this._positionKeyframes.length>1){const e=this._positionKeyframes[0][0],i=this._positionKeyframes[1][0];this._getPositionOfKeyframe(this._position0,this._positionKeyframes[0]),this._getPositionOfKeyframe(this._position1,this._positionKeyframes[1]),t.sub(this._position1,this._position0),t.div(t,i-e)}else t.set(0,0,0);return!0}}return!1}_getOrientationAtTime(t,e){const i=s.Sort.getIndex(e,this._orientationKeyframes,isLess);if(i<this._orientationKeyframes.length){if(0!==i){const s=i-1,n=i,r=this._orientationKeyframes[s][0];this._getOrientationOfKeyframe(this._orientation0,this._orientationKeyframes[s]);const o=this._orientationKeyframes[n][0];return this._getOrientationOfKeyframe(this._orientation1,this._orientationKeyframes[n]),t.slerp(this._orientation0,this._orientation1,(e-r)/(o-r)),!0}if(this._orientationKeyframes[0][0]===e)return this._getOrientationOfKeyframe(t,this._orientationKeyframes[0]),!0}return!1}_getPositionOfKeyframe(t,e){const i=e[1];if(t.copy(i.position),void 0!==i.relativeToEntityOrientation){const n=void 0!==e[1].relativeToEntityOrientationTime?e[1].relativeToEntityOrientationTime:e[0],r=i.relativeToEntityOrientation.get();if(null!==r){const e=s.Quaternion.pool.get();r.getOrientationAtTime(e,n),t.rotate(e,t),s.Quaternion.pool.release(e)}else t.copy(s.Vector3.NaN)}if(void 0!==i.relativeToEntityPosition){const n=void 0!==e[1].relativeToEntityPositionTime?e[1].relativeToEntityPositionTime:e[0],r=s.Vector3.pool.get(),o=i.relativeToEntityPosition.get();null!==o?(o.getPositionRelativeToEntity(r,s.Vector3.Zero,this.getEntity().getParent(),n),t.add(r,t),s.Vector3.pool.release(r)):t.copy(s.Vector3.NaN)}}_getOrientationOfKeyframe(t,e){const i=e[1];if(void 0!==i.relativeToEntityOrientation){const n=void 0!==e[1].relativeToEntityOrientationTime?e[1].relativeToEntityOrientationTime:e[0],r=i.relativeToEntityOrientation.get();null!==r?(r.getOrientationAtTime(t,n),t.mult(t,i.orientation)):t.copy(s.Quaternion.NaN)}else t.copy(i.orientation)}_updateCoverage(){if(this._timesAreRealTime)this.setCoverage(s.Interval.Infinite);else{const t=new s.Interval(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY);this._positionKeyframes.length>0&&(t.min=Math.min(t.min,this._positionKeyframes[0][0]),t.max=Math.max(t.max,this._positionKeyframes[this._positionKeyframes.length-1][0])),this._orientationKeyframes.length>0&&(t.min=Math.min(t.min,this._orientationKeyframes[0][0]),t.max=Math.max(t.max,this._orientationKeyframes[this._orientationKeyframes.length-1][0])),this.setCoverage(t)}}_cubicHermiteSpline(t,e,i,s,n,r){const o=r*r,a=r*o,l=2*a-3*o+1,h=a-2*o+r,c=-2*a+3*o,d=a-o;t.x=l*e.x+h*s.x+c*i.x+d*n.x,t.y=l*e.y+h*s.y+c*i.y+d*n.y,t.z=l*e.z+h*s.z+c*i.z+d*n.z}_cubicHermiteSplineDerivative(t,e,i,s,n,r){const o=r*r,a=6*o-6*r,l=3*o-4*r+1,h=-6*o+6*r,c=3*o-2*r;t.x=a*e.x+l*s.x+h*i.x+c*n.x,t.y=a*e.y+l*s.y+h*i.y+c*n.y,t.z=a*e.z+l*s.z+h*i.z+c*n.z}}const isLessAdd=(t,e)=>t[0]<e[0],isLess=(t,e)=>t[0]<e,isEqual=(t,e)=>t[0]===e,n=KeyframeController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class LookController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._dragSensitivity=.01,this._dragSmoothness=.8,this._yawAngleSmoothedValue=0,this._pitchAngleSmoothedValue=0,this._yawAxisType="none",this._yawAxisEntity=null,this.addModifiedState("orientation")}getDragSensitivity(){return this._dragSensitivity}setDragSensitivity(t){this._dragSensitivity=t}getDragSmoothness(){return this._dragSmoothness}setDragSmoothness(t){this._dragSmoothness=t}getYawAxisType(){return this._yawAxisType}setYawAxisType(t){this._yawAxisType!==t&&(null!==this._yawAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._yawAxisType)?this.removeDependentState(this._yawAxisEntity.getName(),"orientation"):"position"===this._yawAxisType&&this.removeDependentState(this._yawAxisEntity.getName(),"position")),this._yawAxisType=t,null!==this._yawAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._yawAxisType)?this.addDependentState(this._yawAxisEntity.getName(),"orientation"):"position"===this._yawAxisType&&this.addDependentState(this._yawAxisEntity.getName(),"position")))}getYawAxisEntity(){return this._yawAxisEntity}setYawAxisEntity(t){this._yawAxisEntity!==t&&(null!==this._yawAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._yawAxisType)?this.removeDependentState(this._yawAxisEntity.getName(),"orientation"):"position"===this._yawAxisType&&this.removeDependentState(this._yawAxisEntity.getName(),"position")),this._yawAxisEntity=t,null!==this._yawAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._yawAxisType)?this.addDependentState(this._yawAxisEntity.getName(),"orientation"):"position"===this._yawAxisType&&this.addDependentState(this._yawAxisEntity.getName(),"position")))}__update(){null===this._yawAxisEntity&&(this._yawAxisEntity=this.getEntity().getParent(),null!==this._yawAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._yawAxisType)?this.addDependentState(this._yawAxisEntity.getName(),"orientation"):"position"===this._yawAxisType&&this.addDependentState(this._yawAxisEntity.getName(),"position"))),this.getEntity().getOrientation().isNaN()&&this.getEntity().setOrientation(s.Quaternion.Identity);const t=this.getEntity().getScene().getEngine().getInput();let e=1;t.isKeyPressed("x")&&(e=.05);const i=this.getEntity().getComponentByType("camera");null!==i&&(e*=Math.min(1,i.getFieldOfView()));let n=0,r=0;const o=t.getActiveViewport();if(null!==o){const i=o.getCamera();if(null!==i&&i.getEntity()===this.getEntity()){const i=t.getDraggedOffset();n=-i.x*this._dragSensitivity*e,r=-i.y*this._dragSensitivity*e}}this._yawAngleSmoothedValue=s.MathUtils.lerp(n,this._yawAngleSmoothedValue,this._dragSmoothness),this._pitchAngleSmoothedValue=s.MathUtils.lerp(r,this._pitchAngleSmoothedValue,this._dragSmoothness),Math.abs(this._yawAngleSmoothedValue)<1e-4*e&&(this._yawAngleSmoothedValue=0),Math.abs(this._pitchAngleSmoothedValue)<1e-4*e&&(this._pitchAngleSmoothedValue=0);const a=s.Vector3.pool.get();"x-axis"===this._yawAxisType&&null!==this._yawAxisEntity?this._yawAxisEntity.getOrientation().getAxis(a,0):"y-axis"===this._yawAxisType&&null!==this._yawAxisEntity?this._yawAxisEntity.getOrientation().getAxis(a,1):"z-axis"===this._yawAxisType&&null!==this._yawAxisEntity?this._yawAxisEntity.getOrientation().getAxis(a,2):"position"===this._yawAxisType&&null!==this._yawAxisEntity?a.normalize(this._yawAxisEntity.getPosition()):this.getEntity().getOrientation().getAxis(a,2),a.isNaN()&&this.getEntity().getOrientation().getAxis(a,2);const l=s.Quaternion.pool.get();l.copy(this.getEntity().getOrientation());const h=s.Quaternion.pool.get(),c=s.Vector3.pool.get(),d=s.Vector3.pool.get();this.getEntity().getOrientation().getAxis(d,1),this.getEntity().getOrientation().getAxis(c,2);const u=c.angleAroundAxis(a,d);h.setFromAxisAngle(d,u),h.normalize(h),l.mult(h,l),s.Vector3.pool.release(c),s.Vector3.pool.release(d);const _=s.Vector3.pool.get();l.getAxis(_,0),h.setFromAxisAngle(_,this._pitchAngleSmoothedValue),l.mult(h,l),s.Vector3.pool.release(_),h.setFromAxisAngle(a,this._yawAngleSmoothedValue),l.mult(h,l),s.Vector3.pool.release(a),s.Quaternion.pool.release(h),this.getEntity().setOrientation(l),s.Quaternion.pool.release(l)}}const n=LookController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class ModelAnimateController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._animations=[]}setAnimation(t,e,i,s){if(null===t)throw new Error("Null model specified.");this._animations.push({model:t,jointName:e,animationName:i,interval:s,animationClip:null,rootObject:null,jointObject:null,animationMixer:null})}__update(){const t=this.getEntity().getScene().getEngine().getTime();for(let e=0,i=this._animations.length;e<i;e++){const i=this._animations[e];if(i.model.isDestroyed())this._animations.splice(e,1),e--;else if(null!==i.model.getThreeJsObjects()[0]){if(i.rootObject!==i.model.getThreeJsObjects()[0]&&(i.rootObject=i.model.getThreeJsObjects()[0],i.animationClip=null,i.jointObject=null,i.animationMixer=null),null===i.animationClip&&(i.animationClip=i.model.getAnimationClip(i.animationName)),null===i.jointObject){const t=i.model.getThreeJsObjectByName(i.jointName);null!==t&&(i.jointObject=t)}if(null===i.animationMixer&&null!==i.animationClip&&null!==i.jointObject&&(i.animationMixer=new s.THREE.AnimationMixer(i.jointObject),i.animationMixer.clipAction(i.animationClip).play()),null!==i.animationMixer){const e=s.MathUtils.clamp01((t-i.interval.min)/(i.interval.max-i.interval.min)),n=i.animationClip.duration*e*(i.animationClip.tracks[0].times.length-1)/i.animationClip.tracks[0].times.length;i.animationMixer.setTime(n),i.animationMixer.update(0)}}else i.rootObject=null}}}const n=ModelAnimateController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class OrbitController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._dragSensitivity=.01,this._dragSmoothness=.8,this._yawChangeSmoothedValue=0,this._pitchChangeSmoothedValue=0,this._yawAxisType="none",this._yawAxisEntity=null,this._pitchAxisType="none",this._pitchAxisEntity=null,this._slowWhenCloseToParent=!1,this._yawAngleLimits=new s.Interval(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),this._yawAngleLimits.freeze(),this._pitchAngleLimits=new s.Interval(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),this._pitchAngleLimits.freeze(),this.addModifiedState("position"),this.addModifiedState("orientation")}getDragSensitivity(){return this._dragSensitivity}setDragSensitivity(t){this._dragSensitivity=t}getDragSmoothness(){return this._dragSmoothness}setDragSmoothness(t){this._dragSmoothness=t}getYawAxisType(){return this._yawAxisType}setYawAxisType(t){this._yawAxisType!==t&&(null!==this._yawAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._yawAxisType)?this.removeDependentState(this._yawAxisEntity.getName(),"orientation"):"position"===this._yawAxisType&&this.removeDependentState(this._yawAxisEntity.getName(),"position")),this._yawAxisType=t,null!==this._yawAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._yawAxisType)?this.addDependentState(this._yawAxisEntity.getName(),"orientation"):"position"===this._yawAxisType&&this.addDependentState(this._yawAxisEntity.getName(),"position")))}getPitchAxisType(){return this._pitchAxisType}setPitchAxisType(t){this._pitchAxisType!==t&&(null!==this._pitchAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._pitchAxisType)?this.removeDependentState(this._pitchAxisEntity.getName(),"orientation"):"position"===this._pitchAxisType&&this.removeDependentState(this._pitchAxisEntity.getName(),"position")),this._pitchAxisType=t,null!==this._pitchAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._pitchAxisType)?this.addDependentState(this._pitchAxisEntity.getName(),"orientation"):"position"===this._pitchAxisType&&this.addDependentState(this._pitchAxisEntity.getName(),"position")))}getYawAxisEntity(){return this._yawAxisEntity}setYawAxisEntity(t){this._yawAxisEntity!==t&&(null!==this._yawAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._yawAxisType)?this.removeDependentState(this._yawAxisEntity.getName(),"orientation"):"position"===this._yawAxisType&&this.removeDependentState(this._yawAxisEntity.getName(),"position")),this._yawAxisEntity=t,null!==this._yawAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._yawAxisType)?this.addDependentState(this._yawAxisEntity.getName(),"orientation"):"position"===this._yawAxisType&&this.addDependentState(this._yawAxisEntity.getName(),"position")))}getPitchAxisEntity(){return this._pitchAxisEntity}setPitchAxisEntity(t){this._pitchAxisEntity!==t&&(null!==this._pitchAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._pitchAxisType)?this.removeDependentState(this._pitchAxisEntity.getName(),"orientation"):"position"===this._pitchAxisType&&this.removeDependentState(this._pitchAxisEntity.getName(),"position")),this._pitchAxisEntity=t,null!==this._pitchAxisEntity&&(["x-axis","y-axis","z-axis"].includes(this._pitchAxisType)?this.addDependentState(this._pitchAxisEntity.getName(),"orientation"):"position"===this._pitchAxisType&&this.addDependentState(this._pitchAxisEntity.getName(),"position")))}getYawAngleLimits(){return this._yawAngleLimits}setYawAngleLimits(t){this._yawAngleLimits.thaw(),this._yawAngleLimits.copy(t),this._yawAngleLimits.freeze()}getPitchAngleLimits(){return this._pitchAngleLimits}setPitchAngleLimits(t){this._pitchAngleLimits.thaw(),this._pitchAngleLimits.copy(t),this._pitchAngleLimits.freeze()}isSlowWhenCloseToParent(){return this._slowWhenCloseToParent}slowWhenCloseToParent(t){this._slowWhenCloseToParent=t}__update(){if(null===this.getEntity().getParent())return;this.getEntity().getOrientation().isNaN()&&this.getEntity().setOrientation(s.Quaternion.Identity),this.getEntity().getPosition().isNaN()&&this.getEntity().setPosition(new s.Vector3(0,-1,0));const t=this.getEntity().getScene().getEngine().getInput();let e=1;t.isKeyPressed("x")&&(e=.05),t.isShiftPressed()&&(e=5);const i=this.getEntity().getComponentByType("camera");null!==i&&(e*=Math.min(1,i.getFieldOfView()));let n=0,r=0;const o=t.getActiveViewport();if(null!==o){const i=o.getCamera();if(null!==i&&i.getEntity()===this.getEntity()){const i=t.getDraggedOffset();n=-i.x*this._dragSensitivity*e,r=i.y*this._dragSensitivity*e,t.isKeyPressed("d")&&(n+=this._dragSensitivity*e),t.isKeyPressed("a")&&(n-=this._dragSensitivity*e),t.isKeyPressed("e")&&(r-=this._dragSensitivity*e),t.isKeyPressed("q")&&(r+=this._dragSensitivity*e)}}this._yawChangeSmoothedValue=s.MathUtils.lerp(n,this._yawChangeSmoothedValue,this._dragSmoothness),this._pitchChangeSmoothedValue=s.MathUtils.lerp(r,this._pitchChangeSmoothedValue,this._dragSmoothness),Math.abs(this._yawChangeSmoothedValue)<1e-4*e&&(this._yawChangeSmoothedValue=0),Math.abs(this._pitchChangeSmoothedValue)<1e-4*e&&(this._pitchChangeSmoothedValue=0);const a=s.Vector3.pool.get();null===this._yawAxisEntity&&(this._yawAxisEntity=this.getEntity().getParent()),"x-axis"===this._yawAxisType&&null!==this._yawAxisEntity?this._yawAxisEntity.getOrientation().getAxis(a,0):"y-axis"===this._yawAxisType&&null!==this._yawAxisEntity?this._yawAxisEntity.getOrientation().getAxis(a,1):"z-axis"===this._yawAxisType&&null!==this._yawAxisEntity?this._yawAxisEntity.getOrientation().getAxis(a,2):"position"===this._yawAxisType&&null!==this._yawAxisEntity?a.normalize(this._yawAxisEntity.getPosition()):this.getEntity().getOrientation().getAxis(a,2),(a.isNaN()||a.isZero())&&this.getEntity().getOrientation().getAxis(a,2);const l=s.Vector3.pool.get();null===this._pitchAxisEntity&&(this._pitchAxisEntity=this.getEntity().getParent()),"x-axis"===this._pitchAxisType&&null!==this._pitchAxisEntity?this._pitchAxisEntity.getOrientation().getAxis(l,0):"y-axis"===this._pitchAxisType&&null!==this._pitchAxisEntity?this._pitchAxisEntity.getOrientation().getAxis(l,1):"z-axis"===this._pitchAxisType&&null!==this._pitchAxisEntity?this._pitchAxisEntity.getOrientation().getAxis(l,2):"position"===this._pitchAxisType&&null!==this._pitchAxisEntity?l.normalize(this._pitchAxisEntity.getPosition()):this.getEntity().getOrientation().getAxis(l,0),(l.isNaN()||l.isZero())&&this.getEntity().getOrientation().getAxis(l,0),l.setNormalTo(a,l);const h=s.Quaternion.pool.get();h.setFromAxes(l,void 0,a),s.Vector3.pool.release(l),s.Vector3.pool.release(a);const c=s.Vector3.pool.get();c.rotateInverse(h,this.getEntity().getPosition());let d=1;if(this._slowWhenCloseToParent){const t=this.getEntity().getParent().getOcclusionRadius();d=s.MathUtils.clamp((c.magnitude()-t)/t,.001,1)}const u=s.LatLonAlt.pool.get();s.Geometry.getLLAFromXYZOnSphere(u,c,0),u.lat+=this._pitchChangeSmoothedValue*d,u.lon+=this._yawChangeSmoothedValue*d,u.lat<1e-4-s.MathUtils.halfPi&&(u.lat=1e-4-s.MathUtils.halfPi),u.lat>s.MathUtils.halfPi-1e-4&&(u.lat=s.MathUtils.halfPi-1e-4),u.lat<this._pitchAngleLimits.min&&(u.lat=this._pitchAngleLimits.min),u.lat>this._pitchAngleLimits.max&&(u.lat=this._pitchAngleLimits.max),u.lon<this._yawAngleLimits.min&&(u.lon=this._yawAngleLimits.min),u.lon>this._yawAngleLimits.max&&(u.lon=this._yawAngleLimits.max),s.Geometry.getXYZFromLLAOnSphere(c,u,0),s.LatLonAlt.pool.release(u),c.rotate(h,c),s.Quaternion.pool.release(h),this.getEntity().setPosition(c),s.Vector3.pool.release(c)}}const n=OrbitController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class OrbitKeyframeController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._positionKeyframes=[],this._focusKeyframes=[],this._upKeyframes=[],this._timeOfFirstUpdate=NaN,this._directionOfFirstUpdate=new s.Vector3,this._resolvePromise=null,this._rejectPromise=null,this._endPromise=new Promise(((t,e)=>{this._resolvePromise=t,this._rejectPromise=e})),this.addModifiedState("position"),this.addModifiedState("velocity"),this.addModifiedState("orientation"),this.addModifiedState("angularVelocity")}setPositionKeyframe(t,e,i){if(void 0!==e){const n=new PositionKeyframe(this.getEntity().getScene());n.time=t,n.position.copy(e),n.relativeTo.setName(i),s.Sort.add(n,this._positionKeyframes,isLess)}else{const e=s.Sort.getIndex(t,this._positionKeyframes,isLessThanTime);e<this._positionKeyframes.length&&t===this._positionKeyframes[e].time&&this._positionKeyframes.splice(e,1)}}setFocusKeyframe(t,e){if(void 0!==e){const i=new FocusKeyframe(this.getEntity().getScene());i.time=t,i.focus.setName(e),s.Sort.add(i,this._focusKeyframes,isLess)}else{const e=s.Sort.getIndex(t,this._focusKeyframes,isLessThanTime);e<this._focusKeyframes.length&&t===this._focusKeyframes[e].time&&this._focusKeyframes.splice(e,1)}}setUpKeyframe(t,e){if(void 0!==e){const i=new UpKeyframe;i.time=t,i.up.copy(e),s.Sort.add(i,this._upKeyframes,isLess)}else{const e=s.Sort.getIndex(t,this._upKeyframes,isLessThanTime);e<this._upKeyframes.length&&t===this._upKeyframes[e].time&&this._upKeyframes.splice(e,1)}}getEndPromise(){return this._endPromise}__destroy(){super.__destroy(),null!==this._rejectPromise&&this._rejectPromise()}__update(){const t=this.getEntity();let e=0;if(isNaN(this._timeOfFirstUpdate)){const e=t.getParent();if(null===e)return;this._timeOfFirstUpdate=Date.now()/1e3,t.getOrientation().getAxis(this._directionOfFirstUpdate,1);const i=new PositionKeyframe(t.getScene());i.time=0,i.position.copy(t.getPosition()),i.relativeTo.setName(e.getName()),s.Sort.add(i,this._positionKeyframes,isLess);const n=new FocusKeyframe(t.getScene());n.time=0,n.focus.setName(""),s.Sort.add(n,this._focusKeyframes,isLess);const r=new UpKeyframe;r.time=0,t.getOrientation().getAxis(r.up,2),s.Sort.add(r,this._upKeyframes,isLess)}else e=Date.now()/1e3-this._timeOfFirstUpdate;let i=!1;const n=s.Sort.getIndex(e,this._positionKeyframes,isLessThanTime);if(n>0&&n<this._positionKeyframes.length){const i=this._positionKeyframes[n-1],r=this._positionKeyframes[n],o=i.relativeTo.get(),a=r.relativeTo.get();if(null!==o&&null!==a){let n=(e-i.time)/(r.time-i.time),l=o;n>=.5&&(l=a),t.getParent()!==l&&t.setParent(l);const h=s.Vector3.pool.get(),c=s.Vector3.pool.get();o.getPositionRelativeToEntity(h,i.position,a),a.getPositionRelativeToEntity(c,r.position,o);let d=Math.max(0,i.position.magnitude()-o.getOcclusionRadius()),u=Math.max(0,c.magnitude()-o.getOcclusionRadius()),_=Math.max(0,h.magnitude()-a.getOcclusionRadius()),g=Math.max(0,r.position.magnitude()-a.getOcclusionRadius());if(d=Math.max(d,u/1e4),u=Math.max(u,d/1e4),_=Math.max(_,g/1e4),g=Math.max(g,u/1e4),d!==u&&_!==g){const t=(Math.pow(u,n)*Math.pow(d,1-n)-d)/(u-d),e=(Math.pow(g,n)*Math.pow(_,1-n)-_)/(g-_);n=s.MathUtils.lerp(t,e,n)}const p=n*n;n=p/(2*(p-n)+1),o.getPositionRelativeToEntity(h,i.position,l),a.getPositionRelativeToEntity(c,r.position,l);const m=s.Vector3.pool.get();o===a?m.slerp(h,c,n):m.lerp(h,c,n),t.setPosition(m),s.Vector3.pool.release(m),s.Vector3.pool.release(h),s.Vector3.pool.release(c)}}else if(n===this._positionKeyframes.length){const e=this._positionKeyframes[this._positionKeyframes.length-1],s=e.relativeTo.get();t.getParent()!==s&&t.setParent(s),t.setPosition(e.position),i=!0}const r=s.Vector3.pool.get();r.setMagnitude(t.getPosition(),-1);const o=s.Vector3.pool.get();t.getOrientation().getAxis(o,2);let a=!1;const l=s.Sort.getIndex(e,this._focusKeyframes,isLessThanTime);if(l>0&&l<this._focusKeyframes.length){const i=this._focusKeyframes[l-1],n=this._focusKeyframes[l],o=i.focus.get(),a=n.focus.get(),h=t.getParent();if(!(""!==i.focus.getName()&&null===o||""!==n.focus.getName()&&null===a||null===h)){let l=(e-i.time)/(n.time-i.time);const c=l*l;l=c/(2*(c-l)+1);const d=s.Vector3.pool.get(),u=s.Vector3.pool.get();""!==i.focus.getName()?(h.getPositionRelativeToEntity(d,t.getPosition(),o),d.setMagnitude(d,-1)):d.copy(this._directionOfFirstUpdate),""!==n.focus.getName()?(h.getPositionRelativeToEntity(u,t.getPosition(),a),u.setMagnitude(u,-1)):u.copy(this._directionOfFirstUpdate),r.slerp(d,u,l),s.Vector3.pool.release(d),s.Vector3.pool.release(u)}}else if(l===this._focusKeyframes.length){const e=this._focusKeyframes[this._focusKeyframes.length-1],i=e.focus.get(),s=t.getParent();""!==e.focus.getName()&&null===i||null===s||(s.getPositionRelativeToEntity(r,t.getPosition(),i),r.setMagnitude(r,-1)),a=!0}else{const e=this._focusKeyframes[0],i=e.focus.get(),s=t.getParent();""!==e.focus.getName()&&null===i||null===s||(""!==e.focus.getName()?(s.getPositionRelativeToEntity(r,t.getPosition(),i),r.setMagnitude(r,-1)):r.copy(this._directionOfFirstUpdate))}let h=!1;const c=s.Sort.getIndex(e,this._upKeyframes,isLessThanTime);if(c>0&&c<this._upKeyframes.length){const t=this._upKeyframes[c-1],i=this._upKeyframes[c];let s=(e-t.time)/(i.time-t.time);const n=s*s;s=n/(2*(n-s)+1),o.slerp(t.up,i.up,s)}else if(c===this._upKeyframes.length){const t=this._upKeyframes[this._upKeyframes.length-1];o.copy(t.up),h=!0}const d=s.Quaternion.pool.get();o.setNormalTo(r,o),d.setFromAxes(void 0,r,o),t.setOrientation(d),s.Quaternion.pool.release(d),s.Vector3.pool.release(r),i&&a&&h&&(this._rejectPromise=null,this._resolvePromise())}}class Keyframe{constructor(){this.time=NaN}}class PositionKeyframe extends Keyframe{constructor(t){super(),this.position=new s.Vector3,this.relativeTo=new s.EntityRef(t)}}class FocusKeyframe extends Keyframe{constructor(t){super(),this.focus=new s.EntityRef(t)}}class UpKeyframe extends Keyframe{constructor(){super(),this.up=new s.Vector3}}function isLess(t,e){return t.time<e.time}function isLessThanTime(t,e){return t.time<e}const n=OrbitKeyframeController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(3);class OrbitalElementsController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._orbitalElementsKeyFrames=[],this.setCoverage(new s.Interval(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)),this.addModifiedState("position"),this.addModifiedState("velocity")}getNumOrbitalElements(){return this._orbitalElementsKeyFrames.length}getOrbitalElements(t){return this._orbitalElementsKeyFrames[t]}addOrbitalElements(t,e){s.Sort.add({time:t,oe:e},this._orbitalElementsKeyFrames,isLessAdd,isEqualAdd),this._updateCoverage()}removeOrbitalElements(t){if(t<0||this._orbitalElementsKeyFrames.length<=t)throw new Error(`Invalid index for ${this}.removeOrbitalElements`);this._orbitalElementsKeyFrames.splice(t,1),this._updateCoverage()}__updatePositionAtTime(t,e){this._getPositionAtTime(t,e)}__updateVelocityAtTime(t,e){this._getVelocityAtTime(t,e)}__update(){const t=this.getEntity().getScene().getEngine().getTime();this._getPositionAtTime(n,t)&&this.getEntity().setPosition(n),this._getVelocityAtTime(r,t)&&this.getEntity().setVelocity(r)}_getPositionAtTime(t,e){const i=s.Sort.getIndex(e,this._orbitalElementsKeyFrames,isLess),n=this._orbitalElementsKeyFrames[Math.max(i-1,0)],o=this._orbitalElementsKeyFrames[Math.min(i,this._orbitalElementsKeyFrames.length-1)],a=s.Vector3.pool.get(),l=s.Vector3.pool.get();n.oe.project(a,r,e),o.oe.project(l,r,e);const h=s.MathUtils.clamp01(o.time!==n.time?(e-n.time)/(o.time-n.time):0);return t.slerp(a,l,h),s.Vector3.pool.release(a),s.Vector3.pool.release(l),!0}_getVelocityAtTime(t,e){const i=s.Sort.getIndex(e,this._orbitalElementsKeyFrames,isLess),r=this._orbitalElementsKeyFrames[Math.max(i-1,0)],o=this._orbitalElementsKeyFrames[Math.min(i,this._orbitalElementsKeyFrames.length-1)],a=s.Vector3.pool.get(),l=s.Vector3.pool.get();r.oe.project(n,a,e),o.oe.project(n,l,e);const h=s.MathUtils.clamp01(o.time!==r.time?(e-r.time)/(o.time-r.time):0);return t.slerp(a,l,h),s.Vector3.pool.release(a),s.Vector3.pool.release(l),!0}_updateCoverage(){const t=new s.Interval(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY);this._orbitalElementsKeyFrames.length>1&&(t.min=Math.min(t.min,this._orbitalElementsKeyFrames[0].time),t.max=Math.max(t.max,this._orbitalElementsKeyFrames[this._orbitalElementsKeyFrames.length-1].time)),this.setCoverage(t)}}const isLessAdd=(t,e)=>t.time<e.time,isLess=(t,e)=>t.time<e,isEqualAdd=(t,e)=>t.time===e.time,n=new s.Vector3,r=new s.Vector3,o=OrbitalElementsController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class PickController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._pickedEntity=null,this._callback=null,this._triggerOnHover=!1,this._pickedPosition=new s.Vector3,this._pickedPosition.freeze()}getPickedEntity(){return this._pickedEntity}setPickedEntity(t){this._pickedEntity=t}getCallback(){return this._callback}setCallback(t){this._callback=t}getTriggerOnHover(){return this._triggerOnHover}setTriggerOnHover(t){this._triggerOnHover=t}getPickedPosition(){return this._pickedPosition}__update(){const t=this.getEntity().getScene().getEngine().getInput();if((t.isSelected()||this._triggerOnHover)&&null!==this._callback&&null!==this._pickedEntity){const e=t.getActiveViewport();if(null!==e){const i=e.getCamera();if(null!==i&&i.getEntity()===this.getEntity()){const n=s.Vector3.pool.get();e.getNormalSpacePositionFromPixelSpacePosition(n,t.getCursorPosition()),i.getCameraSpacePositionFromNormalSpacePosition(n,n),n.normalize(n);const r=s.Interval.pool.get(),o=this.getEntity().getParent().getComponentByType("spheroid");if(null!==o){const t=o.getEquatorialRadius()/o.getPolarRadius();n.rotateInverse(this._pickedEntity.getOrientation(),n),n.z*=t;const e=s.Vector3.pool.get();e.copy(this._pickedEntity.getCameraSpacePosition(i)),e.rotateInverse(this._pickedEntity.getOrientation(),e),e.z*=t,s.Geometry.getLineSphereIntersectionWithLineStartAtOrigin(r,n,e,o.getEquatorialRadius()),n.z/=t,n.rotate(this._pickedEntity.getOrientation(),n),s.Vector3.pool.release(e)}else{const t=this._pickedEntity.getCameraSpacePosition(i);s.Geometry.getLineSphereIntersectionWithLineStartAtOrigin(r,n,t,this._pickedEntity.getOcclusionRadius())}Number.isNaN(r.min)||(this._pickedPosition.thaw(),this._pickedPosition.mult(n,r.min),i.getEntity().getPositionRelativeToEntity(this._pickedPosition,this._pickedPosition,this._pickedEntity),this._pickedPosition.freeze(),this.getEntity().getScene().getEngine().addCallback(this._callback.bind(void 0,this._pickedPosition),!1)),s.Interval.pool.release(r),s.Vector3.pool.release(n)}}}}}const n=PickController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class RollController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._rollSensitivity=.01,this._rollSmoothness=.8,this._rollAngleSmoothedValue=0,this.addModifiedState("orientation")}getRollSensitivity(){return this._rollSensitivity}setRollSensitivity(t){this._rollSensitivity=t}getRollSmoothness(){return this._rollSmoothness}setRollSmoothness(t){this._rollSmoothness=t}__update(){this.getEntity().getOrientation().isNaN()&&this.getEntity().setOrientation(s.Quaternion.Identity);let t=0;const e=this.getEntity().getScene().getEngine().getInput(),i=e.getActiveViewport();if(null!==i){const n=i.getCamera();if(null!==n&&n.getEntity()===this.getEntity()){let i=1;e.isKeyPressed("x")&&(i=.05),e.isShiftPressed()&&(i=5);const n=e.getRotatedOffset();0!==n&&(t+=s.MathUtils.clamp(n*this._rollSensitivity*i,-.1,.1)),e.isKeyPressed("c")&&(t+=this._rollSensitivity*i),e.isKeyPressed("z")&&(t-=this._rollSensitivity*i)}}if(this._rollAngleSmoothedValue=s.MathUtils.lerp(t,this._rollAngleSmoothedValue,this._rollSmoothness),Math.abs(this._rollAngleSmoothedValue)<1e-4&&(this._rollAngleSmoothedValue=0),0!==this._rollAngleSmoothedValue){const t=s.Quaternion.pool.get(),e=s.Quaternion.pool.get();e.setFromAxisAngle(s.Vector3.YAxis,this._rollAngleSmoothedValue),t.mult(this.getEntity().getOrientation(),e),this.getEntity().setOrientation(t),s.Quaternion.pool.release(t),s.Quaternion.pool.release(e)}}}const n=RollController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class RotateController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._rotation=new s.Quaternion,this._rotation.freeze(),this._rotatingPosition=!0,this._rotatingOrientation=!0,this.addModifiedState("position"),this.addModifiedState("orientation")}getRotation(){return this._rotation}setRotation(t){this._rotation.thaw(),this._rotation.copy(t),this._rotation.freeze()}isRotatingPosition(){return this._rotatingPosition}setRotatingPosition(t){this._rotatingPosition=t,t?this.addModifiedState("position"):this.removeModifiedState("position")}isRotatingOrientation(){return this._rotatingOrientation}setRotatingOrientation(t){this._rotatingOrientation=t,t?this.addModifiedState("orientation"):this.removeModifiedState("orientation")}__updatePositionAtTime(t,e){this._rotatingPosition&&t.rotate(this._rotation,t)}__updateVelocityAtTime(t,e){this._rotatingPosition&&t.rotate(this._rotation,t)}__updateOrientationAtTime(t,e){this._rotatingOrientation&&t.mult(this._rotation,t)}__update(){if(this._rotatingPosition){const t=s.Vector3.pool.get();t.rotate(this._rotation,this.getEntity().getPosition()),this.getEntity().setPosition(t),s.Vector3.pool.release(t)}if(this._rotatingOrientation){const t=s.Quaternion.pool.get();t.mult(this._rotation,this.getEntity().getOrientation()),this.getEntity().setOrientation(t),s.Quaternion.pool.release(t)}}}const n=RotateController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class RotateByEntityOrientationController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._entityRef=new s.EntityRef(this.getEntity().getScene()),this._rotatingPosition=!0,this._rotatingOrientation=!0,this.addModifiedState("position"),this.addModifiedState("orientation")}setEntityForOrientation(t){""!==this._entityRef.getName()&&this.addDependentState(this._entityRef.getName(),"orientation"),this._entityRef.setName(t),this.addDependentState(t,"orientation")}isRotatingPosition(){return this._rotatingPosition}setRotatingPosition(t){this._rotatingPosition=t,t?this.addModifiedState("position"):this.removeModifiedState("position")}isRotatingOrientation(){return this._rotatingOrientation}setRotatingOrientation(t){this._rotatingOrientation=t,t?this.addModifiedState("orientation"):this.removeModifiedState("orientation")}__updatePositionAtTime(t,e){if(this._rotatingPosition){const i=""!==this._entityRef.getName()?this._entityRef.get():this.getEntity().getScene().getEntity(this.getEntity().getParentAtTime(e));if(null!==i){const n=s.Quaternion.pool.get();i.getOrientationAtTime(n,e),t.rotate(n,t),s.Quaternion.pool.release(n)}}}__updateVelocityAtTime(t,e){if(this._rotatingPosition){const i=""!==this._entityRef.getName()?this._entityRef.get():this.getEntity().getScene().getEntity(this.getEntity().getParentAtTime(e));if(null!==i){const n=s.Quaternion.pool.get();i.getOrientationAtTime(n,e),t.rotate(n,t),s.Quaternion.pool.release(n)}}}__updateOrientationAtTime(t,e){if(this._rotatingOrientation){const i=""!==this._entityRef.getName()?this._entityRef.get():this.getEntity().getScene().getEntity(this.getEntity().getParentAtTime(e));if(null!==i){const n=s.Quaternion.pool.get();i.getOrientationAtTime(n,e),t.mult(n,t),s.Quaternion.pool.release(n)}}}__update(){const t=""!==this._entityRef.getName()?this._entityRef.get():this.getEntity().getParent();if(null!==t){if(this._rotatingPosition){const e=s.Vector3.pool.get();e.rotate(t.getOrientation(),this.getEntity().getPosition()),this.getEntity().setPosition(e),s.Vector3.pool.release(e)}if(this._rotatingOrientation){const e=s.Quaternion.pool.get();e.mult(t.getOrientation(),this.getEntity().getOrientation()),this.getEntity().setOrientation(e),s.Quaternion.pool.release(e)}}}}const n=RotateByEntityOrientationController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class ScaleController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._scale=1,this.addModifiedState("position")}getScale(){return this._scale}setScale(t){this._scale=t}__updatePositionAtTime(t,e){t.mult(t,this._scale)}__updateVelocityAtTime(t,e){t.mult(t,this._scale)}__update(){const t=s.Vector3.pool.get();t.mult(this.getEntity().getPosition(),this._scale),this.getEntity().setPosition(t),s.Vector3.pool.release(t)}}const n=ScaleController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class SelectController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._callback=null}getCallback(){return this._callback}setCallback(t){this._callback=t}__update(){const t=this.getEntity().getScene().getEngine().getInput();if(t.isSelected()&&null!==this._callback){const e=t.getActiveViewport();if(null!==e){const i=e.getCamera();if(null!==i&&i.getEntity()===this.getEntity()){const n=s.Vector3.pool.get();e.getNormalSpacePositionFromPixelSpacePosition(n,t.getSelectedPosition());let r=null,o=0;const a=s.Vector2.pool.get();a.set(n.x,n.y);const l=this.getEntity().getScene().getNumEntities();for(let t=0;t<l;t++){const e=this.getEntity().getScene().getEntity(t);if(e.isEnabled()){const t=e.getComponentByType("label");if(null!==t&&"loaded"===t.getLoadState()){const s=t.getNormalSpaceBounds(i);if(void 0!==s&&s.contains(a)){const t=e.getCameraSpacePosition(i).magnitude();(null===r||o>t)&&(r=e,o=t)}}}}s.Vector2.pool.release(a),null===r&&(i.getCameraSpacePositionFromNormalSpacePosition(n,n),n.mult(n,1/n.magnitude()),r=i.getNearestIntersectingEntity(n)),s.Vector3.pool.release(n),this.getEntity().getScene().getEngine().addCallback(this._callback.bind(null,r),!1)}}}}}const n=SelectController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class SetParentController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._parent=new s.EntityRef(this.getEntity().getScene())}getParent(){return this._parent.getName()}setParent(t){""!==this._parent.getName()&&this.removeDependentState(this._parent.getName(),"position"),this._parent.setName(t),""!==this._parent.getName()&&this.addDependentState(this._parent.getName(),"position")}__update(){const t=this._parent.get();this.getEntity().setParent(t)}}const n=SetParentController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);class SpinController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._axis=new s.Vector3(0,0,1),this._axis.freeze(),this._axisRelativeToEntity=!0,this._rate=0,this._referenceAngle=0,this._referenceTime=void 0,this._clampedToRealTime=!1,this._usingRealTime=!1,this._rotatingPosition=!1,this._joint="",this._jointObject=null,this._model=null,this._lastTime=i.getScene().getEngine().getTime(),this.addModifiedState("orientation")}getAxis(){return this._axis}isAxisRelativeToEntity(){return this._axisRelativeToEntity}setAxis(t,e){this._axis.thaw(),this._axis.copy(t),this._axis.freeze(),this._axisRelativeToEntity=e}getRate(){return this._rate}setRate(t){this._rate=t}getReferenceAngle(){return this._referenceAngle}setReferenceAngle(t){this._referenceAngle=t}getReferenceTime(){return this._referenceTime}setReferenceTime(t){this._referenceTime=t}isClampedToRealTime(){return this._clampedToRealTime}setClampedToRealTime(t){this._clampedToRealTime=t}isUsingRealTime(){return this._usingRealTime}setUsingRealTime(t){this._usingRealTime=t}isRotatingPosition(){return this._rotatingPosition}setRotatingPosition(t){this._rotatingPosition=t,t?this.addModifiedState("position"):this.removeModifiedState("position")}setJoint(t,e){if(this._joint=t,e)this._model=e;else{const t=this.getEntity().get("model");null!==t&&(this._model=t)}""!==this._joint?this.removeModifiedState("orientation"):this.addModifiedState("orientation")}__updatePositionAtTime(t,e){if(this._rotatingPosition){let i=0;this._usingRealTime||void 0!==this._referenceTime&&(i=e-this._referenceTime,i-=this._referenceAngle/this._rate);const n=s.Quaternion.pool.get();if(n.setFromAxisAngle(this._axis,this._rate*i),null===this._jointObject){if(this._axisRelativeToEntity){const t=s.Quaternion.pool.get();this.getEntity().getOrientationAtTime(t,e),n.mult(t,n),n.multInverseR(n,t),s.Quaternion.pool.release(t)}t.rotate(n,t)}s.Quaternion.pool.release(n)}}__updateOrientationAtTime(t,e){t.isNaN()&&t.copy(s.Quaternion.Identity);let i=0;this._usingRealTime||void 0!==this._referenceTime&&(i=e-this._referenceTime,i-=this._referenceAngle/this._rate);const n=s.Quaternion.pool.get();n.setFromAxisAngle(this._axis,this._rate*i),null===this._jointObject&&(this._axisRelativeToEntity&&(n.mult(t,n),n.multInverseR(n,t)),t.mult(n,t),t.normalize(t)),s.Quaternion.pool.release(n)}__update(){this.getEntity().getOrientation().isNaN()&&this.getEntity().setOrientation(s.Quaternion.Identity);const t=this.getEntity().getScene().getEngine();let e=0;if(this._usingRealTime)e=t.getDeltaTime();else if(void 0!==this._referenceTime)e=t.getTime()-this._referenceTime,e-=this._referenceAngle/this._rate;else if(e=t.getTime()-this._lastTime,this._clampedToRealTime){const i=t.getDeltaTime();e=s.MathUtils.clamp(e,-i,i)}const i=s.Quaternion.pool.get();if(i.setFromAxisAngle(this._axis,this._rate*e),null!==this._jointObject&&null!==this._model.getThreeJsObjects()[0]&&(this._jointObject=null),""!==this._joint&&(null===this._jointObject||this._jointObject.name!==this._joint)&&null!==this._model){const t=this._model.getThreeJsObjectByName(this._joint);null!==t&&(this._jointObject=t)}const r=this.getEntity().getOrientation();if(null!==this._jointObject)this._axisRelativeToEntity||(i.multInverseL(r,i),i.mult(i,r)),n.set(i.x,i.y,i.z,i.w),this._jointObject.quaternion.multiplyQuaternions(n,this._jointObject.quaternion),this._rotatingPosition&&this._jointObject.position.applyQuaternion(n);else{const t=s.Quaternion.pool.get();this._axisRelativeToEntity&&(i.mult(r,i),i.multInverseR(i,r)),t.mult(i,r),t.normalize(t);const e=s.Vector3.pool.get();if(e.mult(this._axis,this._rate),this._axisRelativeToEntity&&e.rotate(t,e),this.getEntity().setOrientation(t),this.getEntity().setAngularVelocity(e),s.Vector3.pool.release(e),s.Quaternion.pool.release(t),this._rotatingPosition){const t=s.Vector3.pool.get();t.rotate(i,this.getEntity().getPosition()),this.getEntity().setPosition(t),s.Vector3.pool.release(t)}}s.Quaternion.pool.release(i),this._lastTime=t.getTime()}}const n=new s.THREE.Quaternion,r=SpinController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class TapController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._tapCallback=null}getTapCallback(){return this._tapCallback}setTapCallback(t){this._tapCallback=t}__update(){const t=this.getEntity().getScene().getEngine().getInput();!t.isSelected()&&t.getDraggedOffset().isZero()||null!==this._tapCallback&&this._tapCallback()}}const n=TapController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(3);class TLEController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._satrec=null,this.addModifiedState("position"),this.addModifiedState("velocity")}setSource(t,e){this.getEntity().getScene().getEngine().getDownloader().download(e,!0).then((async e=>{if("cancelled"===e.status)return Promise.resolve();if("failed"===e.status)return Promise.reject(new Error('Failed to load TLE controller file "'+e.url+'": '+e.errorMessage));if(!(e.content instanceof ArrayBuffer))return Promise.reject(new Error('Failed to load TLE controller file "'+e.url+'": Not a binary file.'));const i=new s.Reader(e.content);for(;;){let e="";try{e=i.readLine()}catch(t){throw new Error("Could not find entry.")}if(0===e.length)break;const n=i.readLine(),r=i.readLine();if(e.includes(t)||n.includes(t)){this._satrec=s.SatelliteJs.twoline2satrec(n,r);break}}})).catch((i=>{throw new Error(`While loading TLE "${t}" from "${e}": ${i}`)}))}__updatePositionAtTime(t,e){if(null!==this._satrec){n.setTime(1e3*s.TimeUtils.etToUnix(e));const i=s.SatelliteJs.propagate(this._satrec,n);"boolean"!=typeof i.position&&t.set(i.position.x,i.position.y,i.position.z)}}__updateVelocityAtTime(t,e){if(null!==this._satrec){n.setTime(1e3*s.TimeUtils.etToUnix(e));const i=s.SatelliteJs.propagate(this._satrec,n);"boolean"!=typeof i.velocity&&t.set(i.velocity.x,i.velocity.y,i.velocity.z)}}__update(){const t=s.Vector3.pool.get();if(t.copy(this.getEntity().getScene().getEntity("earth").getPosition()),null!==this._satrec&&!isNaN(t.x)){n.setTime(1e3*s.TimeUtils.etToUnix(this.getEntity().getScene().getEngine().getTime()));const t=s.SatelliteJs.propagate(this._satrec,n);if("boolean"!=typeof t.position&&"boolean"!=typeof t.velocity){const e=s.Vector3.pool.get(),i=s.Vector3.pool.get();e.set(t.position.x,t.position.y,t.position.z),i.set(t.velocity.x,t.velocity.y,t.velocity.z),this.getEntity().setPosition(e),this.getEntity().setVelocity(i),s.Vector3.pool.release(e),s.Vector3.pool.release(i)}}s.Vector3.pool.release(t)}}const n=new Date,r=TLEController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class TransitionController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._initialPosition=new s.Vector3,this._initialPosition.copy(i.getPosition()),this._initialOrientation=new s.Quaternion,this._initialOrientation.copy(i.getOrientation()),this._initialParent=new s.EntityRef(this.getEntity().getScene()),this._transitionStart=Number.NaN,this._transitionTime=1,this._transitionFunction=this._lerpTransitionFunction,this._resolvePromise=null,this._rejectPromise=null,this._endPromise=new Promise(((t,e)=>{this._resolvePromise=t,this._rejectPromise=e}));const n=this.getEntity().getParent();null!==n&&this._initialParent.setName(n.getName()),this.getEntity().addController("setParent","transitionSetParent",this.getEntity().getController(0))}getTransitionTime(){return this._transitionTime}setTransitionTime(t){this._transitionTime=t}setTransitionFunction(t){this._transitionFunction=t}getParent(){const t=this.getEntity().getController("transitionSetParent");if(null!==t)return t.getName();{const t=this.getEntity().getParent();return null!==t?t.getName():null}}setParent(t){const e=this.getEntity().getController("transitionSetParent");null!==e&&e.setParent(t)}getEndPromise(){return this._endPromise}__destroy(){if(super.__destroy(),0!==this._transitionTime){const t=this.getEntity().getController("transitionSetParent");null!==t&&this.getEntity().removeController(t),this._rejectPromise("Transition controller was destroyed before completing.")}}__update(){const t=this._initialParent.get(),e=this.getEntity().getParent();null===e&&(this._transitionTime=0,this.getEntity().removeController(this),this._rejectPromise("The final parent was destroyed or disabled before the transition could complete.")),Number.isNaN(this._transitionStart)&&(this._transitionStart=Date.now()/1e3);const i=this.getEntity().getController("transitionSetParent");if(null!==i){if(null===t)return void this.getEntity().getScene().getEngine().addCallback((()=>{this._transitionTime=0,this.getEntity().removeController(this),""!==this._initialParent.getName()?this._rejectPromise(`The initial parent "${this._initialParent.getName()}" was destroyed or disabled before the first half of the transition could complete.`):this._resolvePromise()}),!1);Date.now()/1e3-this._transitionStart>=this._transitionTime/2||t===e?(this.getEntity().removeController(i),t!==e&&null!==t&&null!==e&&t.getPositionRelativeToEntity(this._initialPosition,this._initialPosition,e)):this.getEntity().setParent(t)}const n=this.getEntity().getPosition(),r=this.getEntity().getOrientation();let o=s.MathUtils.clamp01((Date.now()/1e3-this._transitionStart)/this._transitionTime);Number.isNaN(o)&&(o=1),this._transitionFunction(this.getEntity(),this._initialPosition,n,this._initialOrientation,r,o),Date.now()/1e3-this._transitionStart>=this._transitionTime&&this.getEntity().getScene().getEngine().addCallback((()=>{this._transitionTime=0,this.getEntity().removeController(this),this._resolvePromise()}),!1)}_lerpTransitionFunction(t,e,i,n,r,o){const a=s.Vector3.pool.get(),l=s.Quaternion.pool.get();a.lerp(e,i,o),l.slerp(n,r,o),t.setPosition(a),t.setOrientation(l),s.Vector3.pool.release(a),s.Quaternion.pool.release(l)}}const n=TransitionController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class TranslateController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._translation=new s.Vector3(0,0,0),this._translation.freeze(),this._relativeToOrientation=!1,this.addModifiedState("position")}getTranslation(){return this._translation}setTranslation(t){this._translation.thaw(),this._translation.copy(t),this._translation.freeze()}setRelativeToOrientation(t){this._relativeToOrientation=t}__updatePositionAtTime(t,e){const i=s.Vector3.pool.get();if(this._relativeToOrientation){const t=s.Quaternion.pool.get();this.getEntity().getOrientationAtTime(t,e),i.rotate(t,this._translation),s.Quaternion.pool.release(t)}else i.copy(this._translation);t.add(i,t),s.Vector3.pool.release(i)}__update(){const t=s.Vector3.pool.get();this._relativeToOrientation?t.rotate(this.getEntity().getOrientation(),this._translation):t.copy(this._translation),t.add(t,this.getEntity().getPosition()),this.getEntity().setPosition(t),s.Vector3.pool.release(t)}}const n=TranslateController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class ZoomController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._zoomSensitivity=.05,this._zoomSmoothness=.8,this._zoomSmoothedValue=1,this._distanceClamp=new s.Interval(.001,Number.POSITIVE_INFINITY),this._distanceClamp.freeze(),this._useSpheroidRadiusForDistance=!1,this.addModifiedState("position")}getZoomSensitivity(){return this._zoomSensitivity}setZoomSensitivity(t){this._zoomSensitivity=t}getZoomSmoothness(){return this._zoomSmoothness}setZoomSmoothness(t){this._zoomSmoothness=t}getDistanceClamp(){return this._distanceClamp}setDistanceClamp(t){this._distanceClamp.thaw(),this._distanceClamp.copy(t),this._distanceClamp.freeze()}getUseSpheroidRadiusForDistance(){return this._useSpheroidRadiusForDistance}setUseSpheroidRadiusForDistance(t){this._useSpheroidRadiusForDistance=t}__update(){const t=this.getEntity().getScene().getEngine().getInput();let e=1;const i=t.getActiveViewport();if(null!==i){const s=i.getCamera();if(null!==s&&s.getEntity()===this.getEntity()){let i=1;t.isKeyPressed("x")&&(i=.05),t.isShiftPressed()&&(i=5);const s=t.getZoomedOffset();0!==s&&(e*=Math.pow(2,s*this._zoomSensitivity*i)),t.isKeyPressed("w")&&(e/=Math.pow(2,this._zoomSensitivity*i)),t.isKeyPressed("s")&&(e*=Math.pow(2,this._zoomSensitivity*i))}}this._zoomSmoothedValue=s.MathUtils.clamp(s.MathUtils.lerp(e,this._zoomSmoothedValue,this._zoomSmoothness),.8,1.25),Math.abs(1-this._zoomSmoothedValue)<1e-7&&(this._zoomSmoothedValue=1);let n=1;const r=s.LatLonAlt.pool.get();if(this._useSpheroidRadiusForDistance&&null!==this.getEntity().getParent()){const t=this.getEntity().getParent().getComponentByType("spheroid");if(null!==t){const e=s.Vector3.pool.get();e.rotateInverse(this.getEntity().getParent().getOrientation(),this.getEntity().getPosition()),t.llaFromXYZ(r,e),n=r.alt,s.Vector3.pool.release(e)}else n=this.getEntity().getPosition().magnitude()-this.getEntity().getParent().getOcclusionRadius()}else n=this.getEntity().getPosition().magnitude();Number.isNaN(n)&&(n=1),n*=this._zoomSmoothedValue,n<this._distanceClamp.min&&(n=this._distanceClamp.min,this._zoomSmoothedValue=1),n>this._distanceClamp.max&&(n=this._distanceClamp.max,this._zoomSmoothedValue=1);const o=s.Vector3.pool.get();let a=n;if(this._useSpheroidRadiusForDistance&&null!==this.getEntity().getParent()){const t=this.getEntity().getParent().getComponentByType("spheroid");null!==t?(r.alt=n,t.xyzFromLLA(o,r),a=o.magnitude()):a=n+this.getEntity().getParent().getOcclusionRadius()}o.normalize(this.getEntity().getPosition()),o.mult(o,a),this.getEntity().setPosition(o),s.Vector3.pool.release(o),s.LatLonAlt.pool.release(r)}}const n=ZoomController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(3);class Types{}Types.Components=new Map,Types.Components.set("atmosphere",s.AtmosphereComponent),Types.Components.set("camera",s.CameraComponent),Types.Components.set("cmts",s.CMTSComponent),Types.Components.set("cometTail",s.CometTailComponent),Types.Components.set("connectedSprite",s.ConnectedSpriteComponent),Types.Components.set("div",s.DivComponent),Types.Components.set("dynEnvMap",s.DynamicEnvironmentMapComponent),Types.Components.set("gizmo",s.GizmoComponent),Types.Components.set("label",s.LabelComponent),Types.Components.set("lightSource",s.LightSourceComponent),Types.Components.set("model",s.ModelComponent),Types.Components.set("orbitalParticles",s.OrbitalParticlesComponent),Types.Components.set("particleSpray",s.ParticleSprayComponent),Types.Components.set("rings",s.RingsComponent),Types.Components.set("skybox",s.SkyboxComponent),Types.Components.set("spheroid",s.SpheroidComponent),Types.Components.set("spheroidLOD",s.SpheroidLODComponent),Types.Components.set("spout",s.SpoutComponent),Types.Components.set("sprite",s.SpriteComponent),Types.Components.set("starfield",s.StarfieldComponent),Types.Components.set("trail",s.TrailComponent),Types.Controllers=new Map,Types.Controllers.set("align",s.AlignController),Types.Controllers.set("animdata",s.AnimdataController),Types.Controllers.set("coverage",s.CoverageController),Types.Controllers.set("dynamo",s.DynamoController),Types.Controllers.set("fixed",s.FixedController),Types.Controllers.set("fixedToParent",s.FixedToParentController),Types.Controllers.set("freeFly",s.FreeFlyController),Types.Controllers.set("groundClamp",s.GroundClampController),Types.Controllers.set("keyframe",s.KeyframeController),Types.Controllers.set("look",s.LookController),Types.Controllers.set("modelAnimate",s.ModelAnimateController),Types.Controllers.set("orbit",s.OrbitController),Types.Controllers.set("orbitKeyframe",s.OrbitKeyframeController),Types.Controllers.set("orbitalElements",s.OrbitalElementsController),Types.Controllers.set("pick",s.PickController),Types.Controllers.set("roll",s.RollController),Types.Controllers.set("rotate",s.RotateController),Types.Controllers.set("rotateByEntityOrientation",s.RotateByEntityOrientationController),Types.Controllers.set("scale",s.ScaleController),Types.Controllers.set("select",s.SelectController),Types.Controllers.set("setParent",s.SetParentController),Types.Controllers.set("spin",s.SpinController),Types.Controllers.set("tap",s.TapController),Types.Controllers.set("tle",s.TLEController),Types.Controllers.set("transition",s.TransitionController),Types.Controllers.set("translate",s.TranslateController),Types.Controllers.set("zoom",s.ZoomController);const n=Types},(t,e,i)=>{"use strict";i.r(e),i.d(e,{AnnulusComponent:()=>d.default,Cameras:()=>s.default,CelestialGridComponent:()=>u.default,Comets:()=>S.default,Comparison:()=>k.default,ConstellationsComponent:()=>_.default,DateTime:()=>n.default,DiscGridComponent:()=>g.default,EarthMoon:()=>I.default,EarthSpacecraft:()=>L.default,Entity:()=>r.default,Features:()=>o.default,JupiterIrregularMoons:()=>w.default,JupiterRegularMoons:()=>C.default,KeyframePointingController:()=>y.default,KeyframeSpinController:()=>T.default,LunarSpacecraft:()=>F.default,MarsMoons:()=>A.default,MarsSpacecraft:()=>O.default,MercurySpacecraft:()=>z.default,MinorPlanets:()=>b.default,NeptuneMoons:()=>N.default,OrbitLineComponent:()=>p.default,OuterPlanetSpacecraft:()=>U.default,Parenting:()=>a.default,Placemarks:()=>l.default,PlanetsAndStars:()=>v.default,PositionSumController:()=>E.default,SaturnMajorMoons:()=>R.default,SaturnMinorMoons:()=>M.default,SceneHelpers:()=>h.default,SmallBodySpacecraft:()=>D.default,SolarSpacecraft:()=>j.default,TorusComponent:()=>m.default,Transitions:()=>c.default,UranusMajorMoons:()=>P.default,UranusMinorMoons:()=>V.default,VenusSpacecraft:()=>H.default,WMTSComponent:()=>f.default,ZoomFitController:()=>x.default});var s=i(126),n=i(127),r=i(128),o=i(129),a=i(130),l=i(131),h=i(132),c=i(133),d=i(134),u=i(135),_=i(136),g=i(137),p=i(138),m=i(139),f=i(140),y=i(233),T=i(234),E=i(235),x=i(236),v=i(237),b=i(238),S=i(239),I=i(241),C=i(242),w=i(243),A=i(244),N=i(245),R=i(246),M=i(247),P=i(248),V=i(249),L=i(250),F=i(251),O=i(252),z=i(253),U=i(254),D=i(255),j=i(257),H=i(258),k=i(259)},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);const n=class Cameras{static createFullSizeViewportAndCamera(t,e="main",i="camera"){const s=t.getEngine().addViewport(e);s.getDiv().style.width="100%",s.getDiv().style.height="100%";const n=t.addEntity(i).addComponent("camera");s.setCamera(n)}static focusOnEntity(t,e,{up:i=!0,orbiter:n=!1}){const r=t.addController("align");r.setPrimaryAlignType("point"),r.setPrimaryAxis(s.Vector3.YAxis),r.setPrimaryTargetEntity(e.getName()),i&&(n?(r.setSecondaryAlignType("position"),r.setSecondaryAxis(s.Vector3.ZAxis),r.setSecondaryTargetEntity(e.getName())):(r.setSecondaryAlignType("align"),r.setSecondaryAxis(s.Vector3.ZAxis),r.setSecondaryTargetEntity(e.getName()),r.setSecondaryTargetAxis(s.Vector3.ZAxis)))}static async lookAtEntity(t,e,{duration:i=.5,finalUp:n,finalUpRelativeEntity:r,finalUpPosition:o=!1}){if(t.getPosition().isNaN())return;const a=new s.Vector3;e.getPositionRelativeToEntity(a,s.Vector3.Zero,t),a.normalize(a);for(let e=0;e<t.getNumControllers();e++)t.getController(e).hasModifiedState("orientation")&&(t.removeController(e),e--);const l=t.addController("align");l.setPrimaryAlignType("point"),l.setPrimaryAxis(s.Vector3.YAxis),l.setPrimaryTargetEntity(e.getName()),void 0!==n&&(void 0===r&&(r=e),o?(l.setSecondaryAlignType("position"),l.setSecondaryAxis(s.Vector3.ZAxis),l.setSecondaryTargetEntity(r.getName())):(l.setSecondaryAlignType("align"),l.setSecondaryAxis(s.Vector3.ZAxis),l.setSecondaryTargetEntity(r.getName()),l.setSecondaryTargetAxis(n)));const h=t.addController("transition");h.setTransitionTime(i),await h.getEndPromise()}static async goToEntity(t,e,{up:i=!0,orbiter:n=!1,fixedToParent:r=!1,duration:o=1,distance:a,zoom:l=!0,destination:h,destinationUp:c,destinationInFocusFrame:d=!1,transitionFunction:u}){a||(a=5*e.getExtentsRadius()),(t.getPosition().isNaN()||t.getOrientation().isNaN())&&(t.setParent(e),void 0===h?t.setPosition(new s.Vector3(0,-a,0)):t.setPosition(h),t.setOrientation(s.Quaternion.Identity),o=0),void 0===h&&(h=new s.Vector3,t.getPositionRelativeToEntity(h,s.Vector3.Zero,e),h.normalize(h),h.mult(h,a),h.isNaN()&&h.set(0,-a,0)),t.clearControllers();const _=t.addController("fixed");if(_.setPosition(h),void 0!==c){const t=new s.Vector3,e=new s.Vector3;t.neg(h),t.normalize(t),e.setNormalTo(t,c);const i=new s.Quaternion;i.setFromAxes(void 0,t,e),_.setOrientation(i)}if(d){const e=t.addController("rotateByEntityOrientation");void 0===c&&e.setRotatingOrientation(!1)}this.focusOnEntity(t,e,{up:i,orbiter:n});const g=t.addController("transition");g.setTransitionTime(o),g.setParent(e.getName()),u&&g.setTransitionFunction(u),await g.getEndPromise(),t.clearControllers();const p=t.addController("orbit");i?n?p.setYawAxisType("position"):p.setYawAxisType("z-axis"):t.addController("roll"),r&&t.addController("fixedToParent"),l&&t.addController("zoom"),this.focusOnEntity(t,e,{up:i,orbiter:n})}static pickOnEntity(t,e,i){const n=t.addController("pick");n.setPickedEntity(e),n.setCallback((t=>{const n=e.getComponentByType("spheroid");if(null!==n){const r=s.Vector3.pool.get();r.rotateInverse(e.getOrientation(),t);const o=s.LatLonAlt.pool.get();n.llaFromXYZ(o,r),i(r,o),s.LatLonAlt.pool.release(o),s.Vector3.pool.release(r)}}))}static getDistanceToFitEntities(t,e,i,n){const r=t.getComponentByType("camera");if(null===r)return NaN;let o=0;const a=s.Vector3.pool.get(),l=Math.sin(r.getHorizontalFieldOfView()/2),h=Math.sin(r.getVerticalFieldOfView()/2),c=Math.tan(r.getHorizontalFieldOfView()/2),d=Math.tan(r.getVerticalFieldOfView()/2);for(let t=0;t<n.length;t++){const r=n[t];let u=0;const _=r.get("rings");null!==_&&(u=_.getOuterRadius()),r.getPositionRelativeToEntity(a,s.Vector3.Zero,i),a.rotateInverse(e,a),o=Math.max(o,Math.abs(a.x)/c+Math.max(r.getExtentsRadius(),u)/l-a.y),o=Math.max(o,Math.abs(a.z)/d+Math.max(r.getExtentsRadius(),u)/h-a.y)}return s.Vector3.pool.release(a),o}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(2);const n=[31,28,31,30,31,30,31,31,30,31,30,31],r=new Date,o=class DateTime{constructor(t=1,e=1,i=1,s=0,n=0,r=0,o=0){this.year=t,this.month=e,this.day=i,this.hour=s,this.minute=n,this.second=r,this.millisecond=o}copy(t){this.year=t.year,this.month=t.month,this.day=t.day,this.hour=t.hour,this.minute=t.minute,this.second=t.second,this.millisecond=t.millisecond}fromET(t){const e=s.TimeUtils.etToUnix(t);r.setTime(1e3*e),this.year=r.getUTCFullYear(),this.month=r.getUTCMonth()+1,this.day=r.getUTCDate(),this.hour=r.getUTCHours(),this.minute=r.getUTCMinutes(),this.second=r.getUTCSeconds(),this.millisecond=r.getUTCMilliseconds();for(let i=0,n=s.TimeUtils.leapSeconds.length;i<n;i++)if(Math.floor(e)===s.TimeUtils.leapSeconds[i]&&e===s.TimeUtils.etToUnix(t-1)){this.second+=1;break}}toET(){r.setUTCFullYear(this.year),r.setUTCMonth(this.month-1),r.setUTCDate(this.day),r.setUTCHours(this.hour),r.setUTCMinutes(this.minute),r.setUTCSeconds(this.second),r.setUTCMilliseconds(this.millisecond);const t=r.getTime()/1e3;let e=s.TimeUtils.unixToEt(t);if(60===this.second)for(let i=0,n=s.TimeUtils.leapSeconds.length;i<n;i++)if(Math.floor(t)===s.TimeUtils.leapSeconds[i]+1){e-=1;break}return e}fromDOY(t,e,i=0,s=0,n=0,r=0){let o=0;this.year=t,this.month=1,this.hour=i,this.minute=s,this.second=n,this.millisecond=r;let a=this.getDaysInMonth();for(;e>o+a&&this.month<12;)o+=a,this.month+=1,a=this.getDaysInMonth();this.day=e-o}toDOY(){const t=this.month;let e=0;for(this.month=1;this.month<t;this.month++)e+=this.getDaysInMonth();return this.month=t,e+=this.day,e}isLeapYear(){return this.year%4==0&&this.year%100!=0||this.year%400==0}getDaysInMonth(){let t=n[this.month-1];return 2===this.month&&this.isLeapYear()&&(t+=1),t}parse(t){this.year=parseInt(t.substring(0,4)),t.length>5?this.month=parseInt(t.substring(5,7)):this.month=1,t.length>8?this.day=parseInt(t.substring(8,10)):this.day=1,t.length>11?(this.hour=parseInt(t.substring(11,13)),this.minute=parseInt(t.substring(14,16))):(this.hour=0,this.minute=0),t.length>17?this.second=parseInt(t.substring(17,19)):this.second=0,t.length>20?this.millisecond=parseInt(t.substring(20))*Math.pow(10,23-t.length):this.millisecond=0}parseDOY(t){const e=parseInt(t.substring(0,4));let i=1;t.length>5&&(i=parseInt(t.substring(5,8))),this.fromDOY(e,i),t.length>9?(this.hour=parseInt(t.substring(9,11)),this.minute=parseInt(t.substring(12,14))):(this.hour=0,this.minute=0),t.length>15?this.second=parseInt(t.substring(15,17)):this.second=0,t.length>18?this.millisecond=parseInt(t.substring(18))*Math.pow(10,21-t.length):this.millisecond=0}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")} ${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}.${Math.floor(1e3*this.millisecond).toString().padStart(6,"0")}`}toStringDOY(){return`${this.year.toString().padStart(4,"0")}-${this.toDOY().toString().padStart(3,"0")}`}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);class Entity{static register(t){for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&this._entities.set(e,t[e])}static create(t,e,i){const s=Entity._entities.get(t);if(void 0===s)throw new Error("Could not find the options for the entity with name "+t);return this.createFromOptions(t,s,e,i)}static createFromOptions(t,e,i,n){let r=t;n&&(n.namePrefix&&(r=n.namePrefix+r),n.nameSuffix&&(r+=n.nameSuffix));let o=i.getEntity(r);if(null!==o)return o;o=i.addEntity(r);try{e.radius&&(o.setOcclusionRadius(e.radius),o.setExtentsRadius(e.radius)),e.occlusionRadius&&o.setOcclusionRadius(e.occlusionRadius),e.extentsRadius&&o.setExtentsRadius(e.extentsRadius);for(const[t,i]of e.parents)o.addParentingTableEntry(t,i);if(e.coverages){let t=o.get("coverage");null===t&&(t=o.addController("coverage"));for(let i=0,n=e.coverages.length;i<n;i++)t.addCoverage(new s.Interval(e.coverages[i].coverage[0],e.coverages[i].coverage[1]),e.coverages[i].enter,e.coverages[i].exit,e.coverages[i].update)}if(e.label){const t=o.addComponent("div").getDiv();t.innerHTML=e.label,t.className="pioneer-label-div"}if(e.labelFadeEntity){const t=o.getComponentByType("div");if(null===t)throw new Error("There is no label.");t.setFadeWhenCloseToEntity(e.labelFadeEntity)}if(e.trail){const t=o.addComponent("trail");if(t.setStartTime(e.trail.length),e.trail.color?t.setColor(new s.Color(e.trail.color[0],e.trail.color[1],e.trail.color[2],e.trail.color[3])):t.setColor(new s.Color(1,1,1,.5)),e.trail.relativeTo&&t.setRelativeToEntity(e.trail.relativeTo),e.trail.lengthCoverages){let t=o.getController("trail_length_coverage");null===t&&(t=o.addController("coverage","trail_length_coverage",o.getController(0)));for(let i=0,n=e.trail.lengthCoverages.length;i<n;i++){const n=e.trail.lengthCoverages[i];t.addCoverage(new s.Interval(n[1],n[2]),(t=>{t.get("trail").setStartTime(n[0])}),(t=>{t.get("trail").setStartTime(e.trail.length)}))}}this._processCoverages(o,t,e.trail.coverages)}if(e.spheroid){const t=o.addComponent("spheroid");t.setEquatorialRadius(e.spheroid.equatorialRadius),t.setPolarRadius(e.spheroid.polarRadius),t.setPlanetographic(e.spheroid.planetographic)}if(e.spheroidLOD){const t=o.addComponent("spheroidLOD");if(e.spheroidLOD.features)for(let i=0,s=e.spheroidLOD.features.length;i<s;i++)t.setFeature(e.spheroidLOD.features[i],!0);if(e.spheroidLOD.textures){t.setMapping("cube");for(const i in e.spheroidLOD.textures)t.setTexture(i,"$STATIC_ASSETS_URL/maps/"+e.spheroidLOD.textures[i].url,e.spheroidLOD.textures[i].sizes)}e.spheroidLOD.shadowEntities&&t.setShadowEntities(e.spheroidLOD.shadowEntities),this._processCoverages(o,t,e.spheroidLOD.coverages)}if(e.cmts){const t=o.addComponent("cmts");if(e.cmts.textures){for(const i in e.cmts.textures){const s=e.cmts.textures[i];t.setBaseUrl(i,s)}t.setMaxLevel(e.cmts.maxLevel||0),this._processCoverages(o,t,e.cmts.coverages)}e.cmts.shadowEntities&&t.setShadowEntities(e.cmts.shadowEntities),this._processCoverages(o,t,e.cmts.coverages)}if(e.model){const t=o.addComponent("model");if(t.setUrl(e.model.url),e.model.rotate){const i=new s.Quaternion;i.set(1,0,0,0);for(let t=0,n=e.model.rotate.length;t<n;t++){let n,r;const o=e.model.rotate[t];if(void 0!==o.x)n=new s.Vector3(1,0,0),r=o.x;else if(void 0!==o.y)n=new s.Vector3(0,1,0),r=o.y;else{if(void 0===o.z)throw new Error("Invalid model rotate axis.");n=new s.Vector3(0,0,1),r=o.z}r=s.MathUtils.degToRad(r);const a=new s.Quaternion;a.setFromAxisAngle(n,r),i.mult(a,i)}t.setRotation(i)}if(e.model.scale){const i=e.model.scale;Array.isArray(i)?t.setScale(new s.Vector3(i[0],i[1],i[2])):t.setScale(i)}!0===e.model.useCompressedTextures&&t.setUseCompressedTextures(!0),e.model.shadowEntities&&t.setShadowEntities(e.model.shadowEntities),e.model.environmentMap&&(e.model.environmentMap.cubemap?(t.setEnvironmentCubemapUrl(e.model.environmentMap.cubemap),t.setEnvironmentCylindricalUrl("")):e.model.environmentMap.cylindrical&&(t.setEnvironmentCylindricalUrl(e.model.environmentMap.cylindrical),t.setEnvironmentCubemapUrl(""))),this._processCoverages(o,t,e.model.coverages)}if(e.comet){const t=o.addComponent("cometTail");void 0!==e.comet.timeLength&&t.setTimeLength(e.comet.timeLength),t.setLightSource("sun");const i=o.addComponent("cometTail");i.setTimeLength(.5*t.getTimeLength()),i.setColor(new s.Color(.214,.235,.371,.5)),i.setStarAccelerationMultiplier(10),i.setLightSource("sun");const n=o.addComponent("cometTail");n.setStarAccelerationMultiplier(0),n.setColor(new s.Color(1,1,1,10)),n.setNumberOfParticles(1),n.setLightSource("sun")}if(e.fixed){const t=o.addController("fixed");if(e.fixed.position&&t.setPosition(e.fixed.position),e.fixed.orientation&&t.setOrientation(e.fixed.orientation),e.fixed.relativeToEntity){const t=o.addController("rotateByEntityOrientation");t.setEntityForOrientation(e.fixed.relativeToEntity),e.fixed.coverage&&2===e.fixed.coverage.length&&t.setCoverage(new s.Interval(e.fixed.coverage[0],e.fixed.coverage[1]))}if(e.fixed.llaOnSpheroid){const n=e.parents[0][1],r=i.getEntity(n);if(null!==r){const i=r.get("spheroid");if(null===i)throw new Error("Missing spheroid component.");e.fixed.coverage&&2===e.fixed.coverage.length&&t.setCoverage(new s.Interval(e.fixed.coverage[0],e.fixed.coverage[1]));const n=new s.Vector3;i.xyzFromLLA(n,e.fixed.llaOnSpheroid),t.setPosition(n);const a=new s.Quaternion;i.orientationFromLLA(a,e.fixed.llaOnSpheroid),t.setOrientation(a);o.addController("rotateByEntityOrientation").setCoverage(new s.Interval(e.fixed.coverage[0],e.fixed.coverage[1]))}}e.fixed.coverage&&2===e.fixed.coverage.length&&t.setCoverage(new s.Interval(e.fixed.coverage[0],e.fixed.coverage[1]))}if(e.dynamo)for(let t=0,i=e.dynamo.length;t<i;t++){const i=e.dynamo[t],n=o.addController("dynamo");i.customUrl?n.setBaseUrl(i.url):n.setBaseUrl("$DYNAMIC_ASSETS_URL/dynamo/"+i.url),i.parentIsBarycenter&&n.setHeaderValue("body",1),i.coverage&&2===i.coverage.length&&n.setCoverage(new s.Interval(i.coverage[0],i.coverage[1]))}if(e.animdata)for(let t=0,i=e.animdata.length;t<i;t++){const i=e.animdata[t],n=o.addController("animdata");n.setBaseUrlAndStateType("$ANIMDATA_URL/"+i.url,i.type),i.coverage&&2===i.coverage.length&&n.setCoverage(new s.Interval(i.coverage[0],i.coverage[1]))}if(e.tle){const t=o.addController("tle");t.setSource(e.tle.tleName,e.tle.url),e.tle.coverage&&2===e.tle.coverage.length&&t.setCoverage(new s.Interval(e.tle.coverage[0],e.tle.coverage[1]))}if(e.align){let t=null;if(e.dynamo)for(let i=0;i<e.dynamo.length;i++){const s=e.dynamo[i].url;if(s.includes("/ori")||s.includes("/quat")){t=o.getControllerByType("dynamo",i);break}}const i=o.addController("align",void 0,t);i.setPrimaryAlignType(e.align.primary.type),i.setPrimaryTargetEntity(e.align.primary.target),i.setPrimaryAxis(e.align.primary.axis),e.align.primary.targetAxis&&i.setPrimaryTargetAxis(e.align.primary.targetAxis),e.align.secondary&&(i.setSecondaryAlignType(e.align.secondary.type),i.setSecondaryTargetEntity(e.align.secondary.target),i.setSecondaryAxis(e.align.secondary.axis),e.align.secondary.targetAxis&&i.setSecondaryTargetAxis(e.align.secondary.targetAxis)),e.align.coverage&&2===e.align.coverage.length&&i.setCoverage(new s.Interval(e.align.coverage[0],e.align.coverage[1]))}if(e.spin){const t=o.addController("spin");t.setAxis(e.spin.axis,!0),t.setRate(s.MathUtils.twoPi/(3600*e.spin.periodInHours)),void 0!==e.spin.relativeToTime&&t.setReferenceTime(e.spin.relativeToTime),e.spin.coverage&&2===e.spin.coverage.length&&t.setCoverage(new s.Interval(e.spin.coverage[0],e.spin.coverage[1]))}e.postCreateFunction&&e.postCreateFunction(o,n)}catch(t){throw null!==o&&i.removeEntity(o),new Error(`While creating "${r}": ${t}`)}return o}static getEntityOptions(t){return Entity._entities.get(t)}static getEntityNamesInGroup(t){const e=new Set;if(""!==t){const i=t.split(",").map((t=>t.trim()));for(const[t,s]of Entity._entities){const n=s.groups;if(!n)continue;let r=!0;for(const t of i)n.includes(t)||(r=!1);r&&e.add(t)}}else for(const t of Entity._entities.keys())e.add(t);return e}static getGroups(){const t=new Set;for(const e of this._entities.values()){const i=e.groups;if(void 0!==i)for(let e=0;e<i.length;e++)t.add(i[e])}return t}static createGroup(t,e,i){const s=this.getEntityNamesInGroup(t);for(const t of s)this.create(t,e,i)}static _processCoverages(t,e,i){if(void 0===i)return;let n=t.get("coverage");null===n&&(n=t.addController("coverage",void 0,t.getController(0)));let r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let t=0,a=i.length;t<a;t++)n.addCoverage(new s.Interval(i[t][0],i[t][1]),(()=>{e.setEnabled(!0)}),(()=>{e.setEnabled(!1)})),r=Math.min(r,i[t][0]),o=Math.max(o,i[t][1]);e instanceof s.BaseController&&e.setCoverage(new s.Interval(r,o))}}Entity._entities=new Map;const n=Entity},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>Features});var s=i(2),n=i(128);class Features{static setEnabled(t,e,i,s){const n=r[e];if(!n)throw new Error(`Attempted to access unavailable feature ${i} for ${e}.`);const o=n[i];if(!o)throw new Error(`Attempted to access unavailable feature ${i} for ${e}.`);o(t,s)}static isEnabled(t,e,i){const s=o[e];if(!s)throw new Error(`Attempted to access unavailable feature ${i} for ${e}.`);const n=s[i];if(!n)throw new Error(`Attempted to access unavailable feature ${i} for ${e}.`);return n(t)}static setEnabledJupiterAuroras(t,e){e?Features._createJupiterModelComponent(t,"auroras","auroras"):!1===e&&t.getEntity("jupiter").removeComponent("auroras")}static isEnabledJupiterAuroras(t){return null!==t.getEntity("jupiter").getComponent("auroras")}static setEnabledJupiterMagnetosphere(t,e){e?Features._createJupiterModelComponent(t,"magnetosphere","magnetosphere"):t.getEntity("jupiter").removeComponent("magnetosphere")}static isEnabledJupiterMagnetosphere(t){return null!==t.getEntity("jupiter").getComponent("magnetosphere")}static setEnabledJupiterRadiationBelt(t,e){if(e)Features._createJupiterModelComponent(t,"radiation_belt_1","radbelt1"),Features._createJupiterModelComponent(t,"radiation_belt_2","radbelt2"),Features._createJupiterModelComponent(t,"radiation_belt_3","radbelt3"),Features._createJupiterModelComponent(t,"radiation_belt_4","radbelt4");else{const e=t.getEntity("jupiter");e.removeComponent("radiation_belt_1"),e.removeComponent("radiation_belt_2"),e.removeComponent("radiation_belt_3"),e.removeComponent("radiation_belt_4")}}static isEnabledJupiterRadiationBelt(t){const e=t.getEntity("jupiter");return null!==e.getComponent("radiation_belt_1")&&null!==e.getComponent("radiation_belt_2")&&null!==e.getComponent("radiation_belt_3")&&null!==e.getComponent("radiation_belt_4")}static setEnabledSaturnMagnetosphere(t,e){e?n.default.createFromOptions("saturn_magnetosphere",{radius:5027500,parents:[[Number.NEGATIVE_INFINITY,"saturn"]],fixed:{position:s.Vector3.Zero},align:{primary:{type:"align",target:"saturn",axis:s.Vector3.ZAxis,targetAxis:s.Vector3.ZAxis},secondary:{type:"point",target:"sun",axis:s.Vector3.XAxis}},model:{url:"$STATIC_ASSETS_URL/models/saturn/magnetosphere/saturn_magnetosphere.gltf",scale:1078.27002124,rotate:[{x:90}]},postCreateFunction:t=>{t.setCanOcclude(!1);const e=t.addComponent("model");e.setUrl("$STATIC_ASSETS_URL/models/saturn/magnetosphere_thin/saturn_magnetosphere_thin.gltf"),e.setScale(1078.27002124),e.setRotation(new s.Quaternion(Math.sqrt(.5),Math.sqrt(.5),0,0)),e.setPixelRadiusVisibleInterval(new s.Interval(4e3,Number.POSITIVE_INFINITY)),e.setResourcesLoadedCallback((()=>{e.getThreeJsObjects()[0].renderOrder=-1}));const i=t.getComponentByType("model");i.setPixelRadiusVisibleInterval(new s.Interval(0,4e3)),i.setResourcesLoadedCallback((()=>{i.getThreeJsObjects()[0].renderOrder=-1}))}},t):t.removeEntity("saturn_magnetosphere")}static isEnabledSaturnMagnetosphere(t){return null!==t.getEntity("saturn_magnetosphere")}static _createJupiterModelComponent(t,e,i){const n=t.getEntity("jupiter").addComponent("model",e);n.setUrl(`$STATIC_ASSETS_URL/models/jupiter/${e}/jupiter_${i}.gltf`),n.setScale(1337.08);const r=new s.Quaternion(Math.SQRT1_2,Math.SQRT1_2,0,0),o=new s.Quaternion(Math.SQRT1_2,0,0,Math.SQRT1_2);r.mult(o,r),n.setRotation(r)}}const r={jupiter:{auroras:Features.setEnabledJupiterAuroras,magnetosphere:Features.setEnabledJupiterMagnetosphere,radiationBelt:Features.setEnabledJupiterRadiationBelt},saturn:{magnetosphere:Features.setEnabledSaturnMagnetosphere}},o={jupiter:{auroras:Features.isEnabledJupiterAuroras,magnetosphere:Features.isEnabledJupiterMagnetosphere,radiationBelt:Features.isEnabledJupiterRadiationBelt},saturn:{magnetosphere:Features.isEnabledSaturnMagnetosphere}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>Parenting});var s=i(128),n=i(2);class Parenting{static getParentOfEntity(t,e){const i=s.default.getEntityOptions(t);if(void 0===i)throw new Error(`There are no entity options for ${t}.`);const r=i.parents,o=n.Sort.getIndex(e,r,isStartTimeLessThanTime);return o<r.length&&e===r[o][0]?r[o][1]:o>0?r[o-1][1]:""}static getAllAncestorsOfEntity(t){const e=new Set;return this._getAllAncestorsOfEntityRecursed(t,e),e}static _getAllAncestorsOfEntityRecursed(t,e){const i=s.default.getEntityOptions(t);if(void 0===i||void 0===i.parents)return;const n=i.parents;for(const t of n){const i=t[1];e.has(i)||(e.add(i),this._getAllAncestorsOfEntityRecursed(i,e))}}}function isStartTimeLessThanTime(t,e){return t[0]<e}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);const n=class Placemarks{static addPlacemark(t,e,i,n,r,o,a=!1){const l=i.getScene().addEntity(t);l.setParent(i),l.setCanOcclude(!1),l.setExtentsRadius(1);const h=l.addComponent("div");return h.setAlignment(new s.Vector2(.5,.5)),h.getDiv().innerHTML=e,l.addController("fixed"),l.addController("rotateByEntityOrientation"),this.updateLLA(l,n,r,o,a),l}static updateLLA(t,e,i,n,r=!1){const o=t.getParent(),a=t.get("fixed"),l=o.getComponentByType("spheroid");if(null===a||null===l)throw new Error("No fixed controller and/or spheroid component.");const h=s.LatLonAlt.pool.get(),c=s.Vector3.pool.get();if(h.set(s.MathUtils.degToRad(e),s.MathUtils.degToRad(i),n),l.xyzFromLLA(c,h),a.setPosition(c),s.Vector3.pool.release(c),r){const t=s.Quaternion.pool.get(),e=s.Vector3.pool.get(),i=s.Vector3.pool.get();l.eastFromLLA(e,h),l.northFromLLA(i,h),t.setFromAxes(e,i,void 0),a.setOrientation(t),s.Vector3.pool.release(e),s.Vector3.pool.release(i),s.Quaternion.pool.release(t)}s.LatLonAlt.pool.release(h)}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(2),n=i(128);class SceneHelpers{static getEclipJ2000ToJ2000Rotation(){return this.eclipJ2000ToJ2000Rotation}static async waitTillEntitiesInPlace(t,e,i,n=5,r=.03){const o=new Set;for(const i of e){const e=t.getEntity(i);if(null===e)throw new Error('Entity "'+i+'" not added yet. Use Entity.create to add the entity.');o.add(e)}const a=[];for(const t of o)for(let e=0;e<t.getNumControllers();e++)a.push(t.getController(e).getLoadedPromise());return await Promise.all(a),void 0===i&&(i=t.getEngine().getTime()),new Promise(((t,e)=>{let a=0;const l=setInterval((()=>{const h=s.Vector3.pool.get(),c=s.Quaternion.pool.get();for(const t of o){const e=t.getPositionCoverage().contains(i);t.getPositionAtTime(h,i),t.getOrientationAtTime(c,i);const s=!h.isNaN()&&!c.isNaN();e&&!s||o.delete(t)}if(s.Quaternion.pool.release(c),s.Vector3.pool.release(h),0===o.size&&(clearInterval(l),t()),a+=r,a>=n){clearInterval(l);let t="";for(const e of o)""!==t&&(t+=", "),t+="'"+e.getName()+"'";e(new Error("Timed out ("+n+" seconds) while waiting for entities to be in place. The remaining entities were ["+t+"]."))}}),1e3*r)})).then((()=>t.getEngine().waitUntilNextFrame()))}static llaToXYZ(t,e,i,s){const n=e.get("spheroid");null!==n&&(n.xyzFromLLA(t,i),s||t.rotate(e.getOrientation(),t))}static xyzToLLA(t,e,i,n){const r=e.get("spheroid");if(null!==r){const o=s.Vector3.pool.get();n?o.copy(i):o.rotateInverse(e.getOrientation(),i),r.llaFromXYZ(t,o),s.Vector3.pool.release(o)}}static getDependentEntities(t){const e=new Set;return this._getDependentEntitiesRecursed(t,e),e.delete(t),e}static _getDependentEntitiesRecursed(t,e){const i=n.default.getEntityOptions(t);if(void 0===i)return;const s=new Set,r=i.parents;for(const t of r)""!==t[1]&&s.add(t[1]);void 0!==i.lightSource&&s.add(i.lightSource),void 0!==i.trail&&void 0!==i.trail.relativeTo&&s.add(i.trail.relativeTo),void 0!==i.align&&(void 0!==i.align.primary.target&&s.add(i.align.primary.target),void 0!==i.align.secondary&&void 0!==i.align.secondary.target&&s.add(i.align.secondary.target)),i.labelFadeEntity&&s.add(i.labelFadeEntity);for(const t of s)e.has(t)||(e.add(t),this._getDependentEntitiesRecursed(t,e))}}SceneHelpers.eclipJ2000ToJ2000Rotation=new s.Quaternion(.9791532214288992,.2031230389823101,0,0),SceneHelpers.eclipJ2000ToJ2000Rotation.freeze();const r=SceneHelpers},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);class Transitions{static jumpToLocationOnSphere(t,e,i,n,r,o,a,l,h,c){t<=0&&(t=.001),c=Transitions.easeInOut(c),void 0===n&&(n=r.getParent());const d=s.Vector3.pool.get(),u=s.Vector3.pool.get();null!==r.getParent()?(r.getParent().getPositionRelativeToEntity(d,o,n),r.getParent().getPositionRelativeToEntity(u,a,n)):(d.copy(o),u.copy(a));const _=d.magnitude()-e,g=u.magnitude()-e,p=s.Vector3.pool.get();i&&n?n.getOrientation().getAxis(p,2):p.cross(d,u),p.normalize(p),p.isZero()&&p.set(0,0,1);let m=0;const f=s.Vector3.pool.get(),y=s.Vector3.pool.get(),T=s.Quaternion.pool.get();T.setFromAxis(p,2),f.rotateInverse(T,d),y.rotateInverse(T,u);const E=s.LatLonAlt.pool.get(),x=s.LatLonAlt.pool.get();s.Geometry.getLLAFromXYZOnSphere(E,f,0),s.Geometry.getLLAFromXYZOnSphere(x,y,0),s.Vector3.pool.release(y),s.Vector3.pool.release(f);let v=E.lon*Math.cos(E.lat),b=x.lon*Math.cos(x.lat);v+Math.PI<b&&(v+=2*Math.PI),b+Math.PI<v&&(b+=2*Math.PI),m=e*t*Math.sqrt((b-v)*(b-v)+(x.lat-E.lat)*(x.lat-E.lat));const S=s.Vector2.pool.get();Transitions._jumpOnCircle(S,m,_,g,c);const I=S.x,C=S.y;s.Vector2.pool.release(S);const w=s.Vector3.pool.get();w.normalize(d),w.mult(w,C+e);const A=s.LatLonAlt.pool.get();let N;N=0!==m?(m-I)/m:0,A.lat=s.MathUtils.lerp(E.lat,x.lat,N),A.lon=s.MathUtils.lerpAngle(E.lon,x.lon,N),A.alt=C,s.Geometry.getXYZFromLLAOnSphere(w,A,e),w.rotate(T,w),s.LatLonAlt.pool.release(A),s.LatLonAlt.pool.release(E),s.LatLonAlt.pool.release(x),s.Quaternion.pool.release(T),w.isNaN()&&w.copy(u),null!==r.getParent()&&n.getPositionRelativeToEntity(w,w,r.getParent()),r.setPosition(w),s.Vector3.pool.release(w),s.Vector3.pool.release(p);const R=s.Vector3.pool.get();n.getPositionRelativeToEntity(R,s.Vector3.Zero,r),R.normalize(R);const M=s.Vector3.pool.get(),P=s.Quaternion.pool.get();i?n.getOrientation().getAxis(M,2):(P.slerp(l,h,c),P.getAxis(M,2)),M.setNormalTo(R,M),P.setFromAxes(void 0,R,M),r.setOrientation(P),s.Vector3.pool.release(M),s.Quaternion.pool.release(P),s.Vector3.pool.release(R),s.Vector3.pool.release(d),s.Vector3.pool.release(u)}static easeInOut(t){const e=t*t;return e/(2*(e-t)+1)}static _jumpOnCircle(t,e,i,s,n){let r=0,o=0;if(Math.abs(e/(s-i))>1e-6){const t=(s-i)/-e*(s+i)/2+e/2,a=Math.sign(e)*Math.acos((i*s+(e-t)*-t)/Math.sqrt(i*i+(e-t)*(e-t))/Math.sqrt(s*s+t*t)),l=Math.cos(n*a),h=Math.sin(n*a);r=(e-t)*h+i*l,o=t+(e-t)*l-i*h}else r=n*s+(1-n)*i,o=(1-n)*e;1===n&&(r=s,o=0),t.set(o,r)}}const n=Transitions},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);class AnnulusComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._sizeInner=1,this._sizeOuter=1,this._ignoreDistance=!1,this._minDistanceM=0,this._minDistanceB=0,this._maxDistanceM=0,this._maxDistanceB=0,this._color=new s.Color(1,1,1,1),this._color.freeze(),this._alphaMultiplier=1,this._numPointsOnCircle=200,this._meshDirty=!0,this.__setRadius(this._sizeOuter),this.__setUsesEntityOrientation(!0)}getInnerRadius(){return this._sizeInner}setInnerRadius(t){this._sizeInner=t,this._meshDirty=!0}getOuterRadius(){return this._sizeOuter}setOuterRadius(t){this._sizeOuter=t,this._meshDirty=!0,this.__setRadius(t)}setIgnoreDistance(t){this._ignoreDistance=t,this._alphaMultiplier=1,s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"color",this._color,this._alphaMultiplier)}setMinDistance(t){this._minDistanceM=1/(t-t/1.1),this._minDistanceB=-1*this._minDistanceM*t/1.1}setMaxDistance(t){this._maxDistanceM=-1/(1.1*t-t),this._maxDistanceB=-1*this._maxDistanceM*t*1.1}getColor(){return this._color}setColor(t){this._color.thaw(),this._color.copy(t),this._color.freeze(),s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"color",this._color,this._alphaMultiplier)}__prepareForRender(t){if(s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects()[0],this.getEntity()),s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t),this._meshDirty&&this._updateMesh(),!this._ignoreDistance){const e=this.getEntity().getCameraSpacePosition(t).magnitude(),i=this._minDistanceM*e+this._minDistanceB,n=this._maxDistanceM*e+this._maxDistanceB;this._alphaMultiplier=s.MathUtils.clamp01(Math.min(i,n)),s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"color",this._color,this._alphaMultiplier)}}__loadResources(){const t=this.getEntity().getScene().getEngine().getMaterialManager().getPreloaded("basic_alpha");this.getThreeJsMaterials().push(t),s.ThreeJsHelper.setUniformColorRGBA(t,"color",this._color,this._alphaMultiplier);const e=s.ThreeJsHelper.createMeshObject(this,t,[{name:"position",dimensions:3}],!1);return this.getThreeJsObjects().push(e),Promise.resolve()}__unloadResources(){s.ThreeJsHelper.destroyObject(this.getThreeJsObjects()[0]),s.ThreeJsHelper.destroyMaterial(this.getThreeJsMaterials()[0])}_updateMesh(){const t=new Float32Array(4*this._numPointsOnCircle*3),e=new Uint16Array(6*this._numPointsOnCircle);let i=0,n=0;const r=new s.Vector3,o=new s.Vector3,a=this._sizeOuter,l=this._sizeInner/this._sizeOuter;for(let h=0;h<this._numPointsOnCircle;h++){const c=h/this._numPointsOnCircle*s.MathUtils.twoPi,d=(h+1)%this._numPointsOnCircle/this._numPointsOnCircle*s.MathUtils.twoPi;r.set(a*Math.cos(c),a*Math.sin(c),0),o.set(a*Math.cos(d),a*Math.sin(d),0),t[i+0]=r.x*l,t[i+1]=r.y*l,t[i+2]=r.z*l,t[i+3]=r.x,t[i+4]=r.y,t[i+5]=r.z,t[i+6]=o.x,t[i+7]=o.y,t[i+8]=o.z,t[i+9]=o.x*l,t[i+10]=o.y*l,t[i+11]=o.z*l,e[n+0]=i/3+0,e[n+1]=i/3+1,e[n+2]=i/3+2,e[n+3]=i/3+2,e[n+4]=i/3+3,e[n+5]=i/3+0,i+=12,n+=6}const h=this.getThreeJsObjects()[0].geometry;s.ThreeJsHelper.setVertices(h,"position",t),s.ThreeJsHelper.setIndices(h,e),this._meshDirty=!1}}const n=AnnulusComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);class CelestialGridComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._degreesPerLine=10,this._color=new s.Color(1,1,1,1),this._color.freeze(),this._lineMesh=null,this._meshDirty=!0}setRadius(t){this.__setRadius(t),s.ThreeJsHelper.setScale(this.getThreeJsObjects(),this.getRadius())}getColor(){return this._color}setColor(t){this._color.thaw(),this._color.copy(t),this._color.freeze(),this._meshDirty=!0}getDegreesPerLine(){return this._degreesPerLine}setDegreesPerLine(t){this._degreesPerLine=t,this._meshDirty=!0}__prepareForRender(t){this._meshDirty&&this._updateMesh(),s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects(),this.getEntity(),t),this._lineMesh.prepareForRender(t)}__loadResources(){return this._lineMesh=new s.LineMesh(this),this._updateMesh(),Promise.resolve()}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this),this._lineMesh=null}_updateMesh(){const t=[];for(let e=0;e<360;e+=this._degreesPerLine){const i=Math.min(e+this._degreesPerLine,360),n=s.MathUtils.degToRad(e),r=s.MathUtils.degToRad(i);for(let e=-90;e<90;e+=this._degreesPerLine){const i=Math.min(e+this._degreesPerLine,90),o=s.MathUtils.degToRad(e),a=s.MathUtils.degToRad(i);-90<e&&e<90&&(t.push(new s.Vector3(Math.sin(n)*Math.cos(o),Math.cos(n)*Math.cos(o),Math.sin(o))),t.push(new s.Vector3(Math.sin(r)*Math.cos(o),Math.cos(r)*Math.cos(o),Math.sin(o)))),t.push(new s.Vector3(Math.sin(n)*Math.cos(o),Math.cos(n)*Math.cos(o),Math.sin(o))),t.push(new s.Vector3(Math.sin(n)*Math.cos(a),Math.cos(n)*Math.cos(a),Math.sin(a)))}}const e=[];for(let i=0,s=t.length;i<s;i++)e.push(this._color);const i=[];for(let e=0,s=t.length;e<s;e++)i.push(2);this._lineMesh.setPositions(t),this._lineMesh.setColors(e),this._lineMesh.setWidths(i),s.ThreeJsHelper.setOrientation(this.getThreeJsObjects(),s.Quaternion.Identity),s.ThreeJsHelper.setScale(this.getThreeJsObjects(),this.getRadius()),this._meshDirty=!1}}const n=CelestialGridComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(132),n=i(2);class ConstellationsComponent extends n.BaseComponent{constructor(t,e,i){super(t,e,i),this._url="",this._database=[],this._numVertices=[],this._labelEntities=[],this._color=new n.Color,this._lineWidth=2,this._glowWidth=0,this._highlightedIndex=void 0,this._highlightColor=new n.Color,this._highlightWidth=0,this._lineMeshes=[],this.__setRadius(Number.POSITIVE_INFINITY)}setColor(t){this._color.copy(t);for(let t=0;t<this._lineMeshes.length;t++){const e=[];for(let i=0;i<this._numVertices[t];i++)e.push(this._color);this._lineMeshes[t].setColors(e)}}setLineWidth(t){this._lineWidth=t;for(let e=0;e<this._lineMeshes.length;e++)this._lineMeshes[e].setWidths(t)}setGlowWidth(t){this._glowWidth=t;for(let t=0,e=this._lineMeshes.length;t<e;t++)this._lineMeshes[t].setGlowWidth(this._glowWidth)}setUrl(t){this._url=t,this.resetResources()}getNames(){const t=[];for(let e=0,i=this._database.length;e<i;e++)t.push(this._database[e].name);return t}setHighlight(t,e,i){if(this._lineMeshes.length>0&&void 0!==this._highlightedIndex){const t=[];for(let e=0,i=this._numVertices[this._highlightedIndex];e<i;e++)t.push(this._color);this._lineMeshes[this._highlightedIndex].setColors(t),this._lineMeshes[this._highlightedIndex].setWidths(this._lineWidth)}if(this._highlightedIndex=t,this._highlightColor.copy(e),this._highlightWidth=i,this._lineMeshes.length>0&&void 0!==this._highlightedIndex){const t=[];for(let e=0,i=this._numVertices[this._highlightedIndex];e<i;e++)t.push(this._highlightColor);this._lineMeshes[this._highlightedIndex].setColors(t),this._lineMeshes[this._highlightedIndex].setWidths(this._highlightWidth)}}getNearestConstellationIndex(t,e){let i,s=Number.POSITIVE_INFINITY;for(let n=0,r=this._labelEntities.length;n<r;n++){const r=t.distance(this._labelEntities[n].getPixelSpacePosition(e));r<s&&(s=r,i=n)}return i}__prepareForRender(t){n.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects(),this.getEntity(),t);for(let e=0;e<this._lineMeshes.length;e++)this._lineMeshes[e].prepareForRender(t)}async __loadResources(){this._labelEntities=[],this._lineMeshes=[],this._numVertices=[];const t=await this.getEntity().getScene().getEngine().getDownloader().download(this._url,!0);if("completed"===t.status&&t.content instanceof ArrayBuffer){const e=new n.Reader(t.content);for(;!e.isAtEnd();){const t={name:"",stars:[],segments:[],color:[]};t.name=e.readString(e.readByte()),t.color=[e.readByte(),e.readByte(),e.readByte(),e.readByte()];const i=e.readByte();for(let s=0;s<i;s++)t.stars.push([e.readFloat32(),e.readFloat32(),e.readFloat32()]);const s=2*e.readByte();for(let i=0;i<s;i++)t.segments.push(e.readByte());this._database.push(t)}}for(let t=0;t<this._database.length;t++){const e=this._database[t].stars,i=this._database[t].segments,s=[],r=[],o=[];for(let a=0;a<i.length;a++){const l=i[a];s.push(new n.Vector3(e[l][2],-e[l][0],e[l][1])),r.push(t===this._highlightedIndex?this._highlightColor:this._color),o.push(t===this._highlightedIndex?this._highlightWidth:this._lineWidth)}const a=new n.LineMesh(this);a.setPositions(s),a.setColors(r),a.setWidths(o),a.setGlowWidth(this._glowWidth),this._lineMeshes.push(a),this._numVertices.push(i.length)}n.ThreeJsHelper.setOrientation(this.getThreeJsObjects(),s.default.getEclipJ2000ToJ2000Rotation());for(let t=0;t<this._database.length;t++){const e=this._database[t].stars,i=new n.Vector3(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),r=new n.Vector3(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),o=Math.sqrt(e[0][0]*e[0][0]+e[0][1]*e[0][1]+e[0][2]*e[0][2]);for(let t=0;t<e.length;t++){const a=e[t],l=new n.Vector3;l.set(a[2],-a[0],a[1]),l.rotate(s.default.getEclipJ2000ToJ2000Rotation(),l),l.normalize(l),l.mult(l,o),i.x>l.x&&(i.x=l.x),r.x<l.x&&(r.x=l.x),i.y>l.y&&(i.y=l.y),r.y<l.y&&(r.y=l.y),i.z>l.z&&(i.z=l.z),r.z<l.z&&(r.z=l.z)}const a=new n.Vector3;a.add(i,r),a.mult(a,.5);const l=this.getEntity().getScene().addEntity("constellation_label_"+this._database[t].name);l.setParent(this.getEntity()),l.setOrientation(n.Quaternion.Identity),l.setPosition(a);const h=l.addComponent("div");h.setAlignment(new n.Vector2(.5,.5));const c=h.getDiv();c.classList.add("pioneer-constellation-label"),c.innerHTML=this._database[t].name,this._labelEntities.push(l)}}__unloadResources(){for(let t=0;t<this._labelEntities.length;t++)this.getEntity().getScene().removeEntity(this._labelEntities[t]);n.ThreeJsHelper.destroyAllObjectsAndMaterials(this),this._lineMeshes=[],this._database=[]}}const r=ConstellationsComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);class DiscGridComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._size=1,this._color=new s.Color(1,1,1,1),this._color.freeze(),this._lineWidth=1,this._numCircles=10,this._numSpokes=20,this._radialPower=1,this._ignoreDistance=!1,this._lineMesh=null,this._meshDirty=!0,this.__setRadius(this._size),this.__setUsesEntityOrientation(!0)}getSize(){return this._size}setSize(t){this._size=t,this.__setRadius(this._size),null!==this._lineMesh&&this._lineMesh.setScale(this._size)}getColor(){return this._color}setColor(t){this._color.thaw(),this._color.copy(t),this._color.freeze(),this._meshDirty=!0}getLineWidth(){return this._lineWidth}setLineWidth(t){this._lineWidth=t,null!==this._lineMesh&&this._lineMesh.setWidths(this._lineWidth)}getNumCircles(){return this._numCircles}setNumCircles(t){this._numCircles=t,this._meshDirty=!0}getNumSpokes(){return this._numSpokes}setNumSpokes(t){this._numSpokes=t,this._meshDirty=!0}getRadialPower(){return this._radialPower}setRadialPower(t){this._radialPower=t,this._meshDirty=!0}setIgnoreDistance(t){this._ignoreDistance=t}__prepareForRender(t){if(this._meshDirty&&this._updateMesh(),!this._ignoreDistance){const e=(.02-this.getEntity().getNormalSpaceExtentsRadius(t))/.02;this._lineMesh.setAlphaMultiplier(e)}this._lineMesh.prepareForRender(t);for(let e=0,i=this.getThreeJsObjects().length;e<i;e++)s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects()[e],this.getEntity()),s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[e],this.getEntity(),t)}__loadResources(){return this._lineMesh=new s.LineMesh(this),this._updateMesh(),this._lineMesh.setScale(this._size),Promise.resolve()}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this),this._lineMesh=null}_updateMesh(){const t=[];for(let e=1;e<=this._numCircles;e++){const i=1!==this._radialPower?Math.pow(this._radialPower,e-this._numCircles):e/this._numCircles,n=50;for(let e=0;e<n;e++){const r=e/n*s.MathUtils.twoPi,o=(e+1)%n/n*s.MathUtils.twoPi;t.push(new s.Vector3(i*Math.cos(r),i*Math.sin(r),0)),t.push(new s.Vector3(i*Math.cos(o),i*Math.sin(o),0))}}for(let e=0;e<this._numSpokes;e++){const i=e/this._numSpokes*s.MathUtils.twoPi;t.push(s.Vector3.Zero),t.push(new s.Vector3(Math.cos(i),Math.sin(i),0))}const e=[];for(let i=0,s=t.length;i<s;i++)e.push(this._color);this._lineMesh.setPositions(t),this._lineMesh.setColors(e),this._lineMesh.setWidths(this._lineWidth),this._meshDirty=!1}}const n=DiscGridComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(2);class OrbitLineComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._color=new s.Color(1,1,1,1),this._color.freeze(),this._farSideAlphaFade=1,this._lineWidth=5,this._glowWidth=0,this._lineMesh=null,this._positions=[],this._colors=[],this._widths=[],this._pixelSpaceRadiiAlphaFade=[5,1],this.__setRadius(Number.POSITIVE_INFINITY)}getColor(){return this._color}setColor(t){if(this._color.thaw(),this._color.copy(t),this._color.freeze(),null!==this._lineMesh){for(let t=0,e=this._colors.length;t<e;t++)this._colors[t].copy(this._color);this._lineMesh.setColors(this._colors)}}getFarSideAlphaFade(){return this._farSideAlphaFade}setFarSideAlphaFade(t){this._farSideAlphaFade=t}getLineWidth(){return this._lineWidth}setLineWidth(t){if(this._lineWidth=t,null!==this._lineMesh){for(let t=0,e=this._widths.length;t<e;t++)this._widths[t]=this._lineWidth;this._lineMesh.setWidths(this._widths)}}setGlowWidth(t){this._glowWidth=t,s.ThreeJsHelper.setUniformNumber(this.getThreeJsMaterials()[0],"glowWidth",this._glowWidth)}setPixelSpaceRadiiAlphaFade(t,e){this._pixelSpaceRadiiAlphaFade[0]=t,this._pixelSpaceRadiiAlphaFade[1]=e}__prepareForRender(t){this._updateMesh();const e=this.getEntity().getPixelSpaceExtentsRadius(t);if(isNaN(e))this._lineMesh.setAlphaMultiplier(1);else{const t=(e-this._pixelSpaceRadiiAlphaFade[0])/(this._pixelSpaceRadiiAlphaFade[1]-this._pixelSpaceRadiiAlphaFade[0]);this._lineMesh.setAlphaMultiplier(s.MathUtils.lerp(0,1,s.MathUtils.clamp01(t)))}s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects(),this.getEntity(),t),this._lineMesh.prepareForRender(t)}__loadResources(){this._lineMesh=new s.LineMesh(this);for(let t=0,e=720;t<e;t++)this._positions.push(new s.Vector3),this._colors.push(new s.Color),this._colors[t].copy(this._color),this._widths.push(this._lineWidth);return this._lineMesh.setColors(this._colors),this._lineMesh.setWidths(this._widths),this._lineMesh.setGlowWidth(this._glowWidth),Promise.resolve()}__unloadResources(){this._positions=[],this._colors=[],this._widths=[],s.ThreeJsHelper.destroyAllObjectsAndMaterials(this),this._lineMesh=null}_updateMesh(){const t=this.getEntity(),e=t.getScene().getEngine().getTime();let i=0;for(let s=t.getNumControllers()-1;s>=0;s--){const n=t.getController(s);if(n.getCoverage().contains(e)&&"dynamo"===n.getType()){const t=n;if("orb"===t.getPointType()){i=t.getHeaderValue("gravitationalParameter1")+t.getHeaderValue("gravitationalParameter2");break}}}n.setFromPositionAndVelocity(t.getPosition(),t.getVelocity(),e,i);const o=t.getPosition(),a=n.getTrueAnomalyFromPosition(o),l=n.getEccentricAnomalyFromTrueAnomaly(a);let h=!1;for(let t=0;t<360;t+=1){const e=2*t,i=(2*t-1+this._positions.length)%this._positions.length;let a=n.getEccentricAnomalyFromTrueAnomaly(s.MathUtils.degToRad(t-180));const c=n.getEccentricAnomalyFromTrueAnomaly(s.MathUtils.degToRad(t+1-180));(a<l&&l<c||c<l&&l<a)&&(a=l);const d=n.getMeanAnomalyFromEccentricAnomaly(a),u=n.epoch+(d-n.meanAnomalyAtEpoch)/n.meanAngularMotion,_=this._positions[e];if(n.project(_,r,u),_.sub(_,o),this._positions[i].copy(_),isNaN(d)){h=!0;const t=(e+1)%this._positions.length,s=(i-1+this._positions.length)%this._positions.length;this._positions[e].set(0,0,0),this._positions[i].set(0,0,0),this._positions[t].set(0,0,0),this._positions[s].set(0,0,0),this._colors[e].a=0,this._colors[i].a=0,this._colors[t].a=0,this._colors[s].a=0;continue}let g=0;g=s.MathUtils.angle(a,l)/Math.PI,g=s.MathUtils.clamp01(g);const p=s.MathUtils.lerp(1,this._farSideAlphaFade,g);this._colors[e].mult(this._color,p),h||this._colors[i].mult(this._color,p),h=!1}n.eccentricity>=1&&(this._positions[this._positions.length-2].copy(this._positions[this._positions.length-3]),this._positions[this._positions.length-1].copy(this._positions[this._positions.length-3]),this._colors[this._colors.length-2].a=0,this._colors[this._colors.length-1].a=0),this._lineMesh.setPositions(this._positions),this._lineMesh.setColors(this._colors)}}const n=new s.OrbitalElements,r=new s.Vector3,o=OrbitLineComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);class TorusComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._color=new s.Color(1,1,1,1),this._color.freeze(),this._innerRadius=1,this._outerRadius=10,this._visibleDistanceInterval=new s.Interval(0,Number.POSITIVE_INFINITY),this._visibleDistanceInterval.freeze(),this._alphaMultiplier=1,this.__setRadius(this._outerRadius),this.__setUsesEntityOrientation(!0)}getColor(){return this._color}setColor(t){this._color.thaw(),this._color.copy(t),this._color.freeze(),s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"color",this._color,this._alphaMultiplier)}getInnerRadius(){return this._innerRadius}setInnerRadius(t){this._innerRadius=t,this.resetResources()}getOuterRadius(){return this._outerRadius}setOuterRadius(t){this._outerRadius=t,this.__setRadius(this._outerRadius),this.resetResources()}getVisibleDistanceInterval(){return this._visibleDistanceInterval}setVisibleDistanceInterval(t){this._visibleDistanceInterval.thaw(),this._visibleDistanceInterval.copy(t),this._visibleDistanceInterval.freeze()}__prepareForRender(t){s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects()[0],this.getEntity()),s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects()[0],this.getEntity(),t);const e=this.getEntity().getCameraSpacePosition(t).magnitude(),i=.5*(this._visibleDistanceInterval.max-this._visibleDistanceInterval.min),n=Math.min(.5*this._visibleDistanceInterval.min,i),r=Math.min(.5*this._visibleDistanceInterval.max,i);e<this._visibleDistanceInterval.min+n?this._alphaMultiplier=Math.max(0,(e-this._visibleDistanceInterval.min)/n):e>this._visibleDistanceInterval.max-r?this._alphaMultiplier=Math.max(0,(this._visibleDistanceInterval.max-e)/r):this._alphaMultiplier=1,s.ThreeJsHelper.setUniformColorRGBA(this.getThreeJsMaterials()[0],"color",this._color,this._alphaMultiplier)}__loadResources(){const t=this.getEntity().getScene().getEngine().getMaterialManager().getPreloaded("basic_alpha");this.getThreeJsMaterials().push(t),s.ThreeJsHelper.setUniformColorRGBA(t,"color",this._color,this._alphaMultiplier);const e=s.ThreeJsHelper.createMeshObject(this,t,[{name:"position",dimensions:3}],!1);return this.getThreeJsObjects().push(e),this._createMesh(),Promise.resolve()}__unloadResources(){s.ThreeJsHelper.destroyAllObjectsAndMaterials(this)}_createMesh(){const t=100,e=20,i=new Float32Array(6e3),n=new Uint16Array(12e3),r=(this._outerRadius+this._innerRadius)/2,o=(this._outerRadius-this._innerRadius)/2;for(let a=0;a<t;a++){const l=a/t*s.MathUtils.twoPi,h=Math.cos(l),c=Math.sin(l);for(let l=0;l<e;l++){const d=l/e*s.MathUtils.twoPi,u=Math.cos(d),_=Math.sin(d),g=3*(a*e+l);i[g+0]=h*(r+o*u),i[g+1]=c*(r+o*u),i[g+2]=o*_;const p=6*(a*e+l),m=(a+1)%t,f=(l+1)%e;n[p+0]=a*e+l,n[p+1]=m*e+l,n[p+2]=a*e+f,n[p+3]=m*e+f,n[p+4]=a*e+f,n[p+5]=m*e+l}}const a=this.getThreeJsObjects()[0].geometry;s.ThreeJsHelper.setVertices(a,"position",i),s.ThreeJsHelper.setIndices(a,n)}}const n=TorusComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(2),n=i(141);class WMTSComponent extends s.BaseComponent{constructor(t,e,i){super(t,e,i),this._capabilities=null,this._endPoint="",this._layerIdentifier="",this._tileMatrixSetIdentifier="",this._style="",this._dimensionValues=new Map,this._minLevel=Number.NEGATIVE_INFINITY,this._maxLevel=Number.POSITIVE_INFINITY,this._splitJoinThresholdFactor=512,this._layer=null,this._tileMatrixSet=null,this._tileUrl="",this._shadowEntities=[],this._engine=this.getEntity().getScene().getEngine(),this._cameraPositions=[],this._rootTile=null,this._tilePixelSize=void 0,this._tilesLoadedPromise=null,this._transitionsCompleteCallback=null,this._loadsThisFrame=0,this._atmosphereComponentRef=new s.ComponentRef(this.getEntity().getScene()),this._atmosphereComponentRef.setByType(this.getEntity().getName(),"atmosphere"),this._spheroidComponentRef=new s.ComponentRef(this.getEntity().getScene()),this._spheroidComponentRef.setByType(this.getEntity().getName(),"spheroid"),this._spheroidComponentRef.setRefChangedCallback(this._spheroidRefChangedCallback.bind(this)),this._spheroidChangedCallback=this._spheroidChangedCallback.bind(this),this.__setUsesEntityOrientation(!0)}async setEndPoint(t){this._endPoint=t,this.resetResources()}setLayer(t){this._layerIdentifier=t,this.resetResources()}setTileMatrixSet(t){this._tileMatrixSetIdentifier=t,this.resetResources()}setStyle(t){this._style=t,this.resetResources()}setDimensionValue(t,e){this._dimensionValues.set(t,e),this.resetResources()}getLayers(){return null!==this._capabilities?this._capabilities.layers:new Map}getMinLevel(){return this._minLevel}setMinLevel(t){this._minLevel=t}getMaxLevel(){return this._maxLevel}setMaxLevel(t){this._maxLevel=t}getTilesLoadedPromise(){return this._tilesLoadedPromise||Promise.resolve()}setSpheroidReference(t){"string"==typeof t?this._spheroidComponentRef.setByName(this.getEntity().getName(),t):this._spheroidComponentRef.setByType(this.getEntity().getName(),"spheroid",t)}__getLayer(){return this._layer}__getTileMatrixSet(){return this._tileMatrixSet}__getTileUrl(){return this._tileUrl}__getLayerBounds(){return null!==this._layer?this._layer.boundingBox:null}__getMaxLevel(){return this._maxLevel}__getMinLevel(){return this._minLevel}__getSplitJoinFactor(){return this._splitJoinThresholdFactor}__getTilePixelSize(){return this._tilePixelSize}__setTilePixelSize(t){this._tilePixelSize=t}__getLoadsThisFrame(){return this._loadsThisFrame}__incLoadsThisFrame(){this._loadsThisFrame+=1}__getCameraPositions(){return this._cameraPositions}__getSpheroidComponent(){return this._spheroidComponentRef.get()}__destroy(){const t=this._spheroidComponentRef.get();null!==t&&t.removeChangedCallback(this._spheroidChangedCallback),super.__destroy()}__update(){if(this._spheroidComponentRef.update(),null===this._rootTile)return;for(;this._cameraPositions.length>this._engine.getNumViewports();)this._cameraPositions.pop();for(;this._cameraPositions.length<this._engine.getNumViewports();)this._cameraPositions.push(new s.Vector3);const t=s.Vector3.pool.get();for(let e=0,i=this._engine.getNumViewports();e<i;e++)t.neg(this.getEntity().getCameraSpacePosition(this._engine.getViewport(e).getCamera())),this._cameraPositions[e].rotateInverse(this.getEntity().getOrientation(),t);s.Vector3.pool.release(t),this._loadsThisFrame=0;const e=this._rootTile.update();if(null===this._tilesLoadedPromise&&e&&(this._tilesLoadedPromise=new Promise((t=>{this._transitionsCompleteCallback=t}))),null!==this._tilesLoadedPromise&&!e){const t=this._transitionsCompleteCallback;this._tilesLoadedPromise=null,this._transitionsCompleteCallback=null,t()}}__prepareForRender(t){s.ThreeJsHelper.setOrientationToEntity(this.getThreeJsObjects(),this.getEntity()),s.ThreeJsHelper.setPositionToEntity(this.getThreeJsObjects(),this.getEntity(),t);const e=this._atmosphereComponentRef.get();s.MaterialUtils.setUniforms(this.getThreeJsMaterials(),t,this.getEntity(),this._shadowEntities,e,!0)}async __loadResources(){if(""!==this._endPoint){this._capabilities=new n.Capabilities(this._endPoint,this._engine),await this._capabilities.readyPromise;let t=this._layerIdentifier;if(""===t){const e=this._capabilities.layers;if(1===e.size)for(const[,i]of e)t=i}if(""===t)return;if(this._layer=this._capabilities.getLayer(t),null===this._layer)throw new Error('Invalid layer: "'+t+'".');let e=this._tileMatrixSetIdentifier;if(""===e){const t=this._layer.tileMatrixSets;if(1===t.size)for(const i of t)e=i}if(this._tileMatrixSet=this._capabilities.getTileMatrixSet(e),null===this._tileMatrixSet)throw new Error('Invalid tile matrix set: "'+e+'".');await this._tileMatrixSet.readyPromise;const i=new s.Rect;i.copy(this._tileMatrixSet.boundingBox),1===this._tileMatrixSet.getNumTiles(0).x&&(i.size.x*=2),1===this._tileMatrixSet.getNumTiles(0).y&&(i.origin.y-=i.size.y,i.size.y*=2);let r=this._style;""===r&&(r=this._layer.defaultStyle);for(const[t,e]of this._layer.dimensions)this._dimensionValues.has(t)||this._dimensionValues.set(t,e);this._tileUrl=this._layer.url,this._tileUrl=this._tileUrl.replace("{TileMatrixSet}",this._tileMatrixSet.identifier),this._tileUrl=this._tileUrl.replace("{Style}",r),this._dimensionValues.forEach(((t,e)=>{this._tileUrl=this._tileUrl.replace("{"+e+"}",t)})),this._rootTile=new WMTSTile(this,null,-1,0,0,i)}}__unloadResources(){this._capabilities=null,this._layer=null,this._tileMatrixSet=null,this._tileUrl="",this._rootTile.destroy(),this._rootTile=null}_spheroidRefChangedCallback(t,e){null!==t&&t.removeChangedCallback(this._spheroidChangedCallback),null!==e&&e.addChangedCallback(this._spheroidChangedCallback),this._spheroidChangedCallback()}_spheroidChangedCallback(){const t=this._spheroidComponentRef.get();null!==t?this.__setRadius(Math.max(t.getEquatorialRadius(),t.getPolarRadius())):this.__setRadius(0),this.resetResources()}}class WMTSTile extends s.Tile{constructor(t,e,i,n,r,o){super(e),this._component=t,this._level=i,this._row=n,this._col=r,this._tileBounds=new s.Rect,this._tileBounds.copy(o),this._center=new s.Vector3,this._radius=0,this._threeJsMaterial=null,this._threeJsObject=null;const a=t.__getSpheroidComponent(),l=this._component.__getTileMatrixSet(),h=new s.Vector3;l.crsUnitsToXYZ(h,this._tileBounds.origin,a);const c=new s.Vector2;c.add(this._tileBounds.origin,this._tileBounds.size);const d=new s.Vector3;l.crsUnitsToXYZ(d,c,a);const u=new s.Vector2;u.addMult(this._tileBounds.origin,this._tileBounds.size,.5),l.crsUnitsToXYZ(this._center,u,a);const _=new s.Vector3,g=new s.Vector3;_.x=Math.min(h.x,d.x,this._center.x),_.y=Math.min(h.y,d.y,this._center.y),_.z=Math.min(h.z,d.z,this._center.z),g.x=Math.max(h.x,d.x,this._center.x),g.y=Math.max(h.y,d.y,this._center.y),g.z=Math.max(h.z,d.z,this._center.z),this._center.add(_,g),this._center.mult(this._center,.5);const p=new s.Vector3;p.sub(this._center,_),this._radius=p.magnitude()}createNewTile(t,e,i){const n=t._level+1,r=2*t._row+e,o=2*t._col+i,a=t._component.__getTileMatrixSet().getNumTiles(t._level+1);if(r>=a.y||o>=a.x)return null;const l=new s.Rect;return l.origin.set(t._tileBounds.origin.x+.5*i*t._tileBounds.size.x,t._tileBounds.origin.y+.5*(1-e)*t._tileBounds.size.y),l.size.set(.5*t._tileBounds.size.x,.5*t._tileBounds.size.y),new WMTSTile(t._component,t,n,r,o,l)}checkSplit(){if(this._level>=this._component.__getTileMatrixSet().numLevels-1)return!1;if(!this._tileBounds.intersects(this._component.__getLayerBounds()))return!1;if(this._level>=this._component.__getMaxLevel())return!1;if(this._component.__getLoadsThisFrame()>=1)return!1;if(this._level<this._component.__getMinLevel())return!0;if(-1===this._level)return!0;let t=this._component.__getTilePixelSize();if(void 0===t&&null!==this._threeJsMaterial){if(t=this._threeJsMaterial.uniforms.colorTexture.value.image.width,1===t)return!1;this._component.__setTilePixelSize(t)}return this._getNearestDistance()<this._component.__getSplitJoinFactor()*this._radius/t}checkJoin(){if(-1===this._level)return!1;if(this._component.__getLoadsThisFrame()>=1)return!1;if(this._level>this._component.__getMaxLevel())return!0;if(this._level<=this._component.__getMinLevel())return!1;let t=this._component.__getTilePixelSize();return void 0===t&&null!==this._threeJsMaterial&&(t=this._threeJsMaterial.uniforms.colorTexture.value.image.width,this._component.__setTilePixelSize(t)),this._getNearestDistance()>this._component.__getSplitJoinFactor()*this._radius*4/t}async load(){if(-1===this._level)return Promise.resolve();if(this._component.__incLoadsThisFrame(),null!==this._threeJsMaterial)throw new Error("Tile already has material.");if(this._tileBounds.intersects(this._component.__getLayerBounds())){this._threeJsMaterial=s.MaterialUtils.get(),this._component.getThreeJsMaterials().push(this._threeJsMaterial);let t=this._component.__getTileUrl();t=t.replace("{TileMatrix}",""+this._level),t=t.replace("{TileRow}",""+this._row),t=t.replace("{TileCol}",""+this._col);try{await s.ThreeJsHelper.loadTextureIntoUniform(this._component,this._threeJsMaterial,"colorTexture",t,!1,!1)}catch(t){await s.ThreeJsHelper.loadTextureIntoUniform(this._component,this._threeJsMaterial,"colorTexture","gray",!1,!1)}}}async unload(){if(-1!==this._level){if(null!==this._threeJsMaterial){const t=this._component.getThreeJsMaterials();for(let e=0,i=t.length;e<i;e++)if(t[e]===this._threeJsMaterial){t.splice(e,1);break}this._threeJsMaterial.uniforms.colorTexture.value&&this._threeJsMaterial.uniforms.colorTexture.value.dispose(),this._threeJsMaterial.dispose(),this._threeJsMaterial=null}this._threeJsMaterial=null}}async activate(){if(-1===this._level)return;this._threeJsObject=s.ThreeJsHelper.createMeshObject(this._component,this._threeJsMaterial,[{name:"position",dimensions:3},{name:"normal",dimensions:3},{name:"uv",dimensions:2}],!1),this._component.getThreeJsObjects().push(this._threeJsObject),s.ThreeJsHelper.useInDynEnvMap(this._threeJsObject,!0);const t=21,e=new Float32Array(1323),i=new Float32Array(1323),n=new Float32Array(882),r=new Uint16Array(2520),o=this._component.__getLayer().boundingBox,a=new s.Vector2,l=new s.Vector2,h=new s.Vector3;for(let c=0;c<21;c++){let d=1-c/20;a.y=s.MathUtils.lerp(this._tileBounds.origin.y,this._tileBounds.origin.y+this._tileBounds.size.y,d),l.y=s.MathUtils.clamp(a.y,o.origin.y,o.origin.y+o.size.y),d+=(l.y-a.y)/this._tileBounds.size.y;for(let u=0;u<t;u++){let _=u/20;a.x=s.MathUtils.lerp(this._tileBounds.origin.x,this._tileBounds.origin.x+this._tileBounds.size.x,_),l.x=s.MathUtils.clamp(a.x,o.origin.x,o.origin.x+o.size.x),_+=(l.x-a.x)/this._tileBounds.size.x,this._component.__getTileMatrixSet().crsUnitsToXYZ(h,l,this._component.__getSpheroidComponent());const g=c*t+u;e[3*g+0]=h.x,e[3*g+1]=h.y,e[3*g+2]=h.z,h.normalize(h),i[3*g+0]=h.x,i[3*g+1]=h.y,i[3*g+2]=h.z,n[2*g+0]=_,n[2*g+1]=1-d;const p=c*t+u;u<20&&c<20&&(r[6*p+0]=t*(c+0)+(u+0),r[6*p+1]=t*(c+1)+(u+0),r[6*p+2]=t*(c+1)+(u+1),r[6*p+3]=t*(c+0)+(u+0),r[6*p+4]=t*(c+1)+(u+1),r[6*p+5]=t*(c+0)+(u+1))}}s.ThreeJsHelper.setVertices(this._threeJsObject.geometry,"position",e),s.ThreeJsHelper.setVertices(this._threeJsObject.geometry,"normal",i),s.ThreeJsHelper.setVertices(this._threeJsObject.geometry,"uv",n),s.ThreeJsHelper.setIndices(this._threeJsObject.geometry,r)}async deactivate(){if(-1===this._level)return;const t=this._component.getThreeJsObjects();for(let e=0,i=t.length;e<i;e++)if(t[e]===this._threeJsObject){t.splice(e,1);break}s.ThreeJsHelper.destroyObject(this._threeJsObject),this._threeJsObject=null}update(){let t=this.check();for(let e=0,i=this.children.length;e<i;e++)t=this.children[e].update()||t;return t}_getNearestDistance(){let t=Number.POSITIVE_INFINITY;const e=s.Vector3.pool.get();for(let i=0,s=this._component.__getCameraPositions().length;i<s;i++){const s=this._component.__getCameraPositions()[i];e.sub(this._center,s);const n=Math.max(0,e.magnitude()-this._radius);t>n&&(t=n)}return s.Vector3.pool.release(e),t}toString(){return this._level+"-"+this._row+"-"+this._col}}const r=WMTSComponent},(t,e,i)=>{"use strict";i.r(e),i.d(e,{Capabilities:()=>Capabilities,Layer:()=>Layer,TileMatrixSet:()=>TileMatrixSet});var s=i(2),n=i(142);class Capabilities{constructor(t,e){this._endPoint=t,this._capabilitiesXML=null,this._layers=new Map,this._readyPromise=null,this._readyPromise=e.getDownloader().download(this._endPoint+"/1.0.0/WMTSCapabilities.xml",!1).then((t=>{if("string"==typeof t.content&&(this._capabilitiesXML=(new DOMParser).parseFromString(t.content,"application/xml")),null!==this._capabilitiesXML){const t=this._capabilitiesXML.querySelectorAll("Contents > Layer");for(const e of t){const t=e.querySelector("*|Title").textContent,i=e.querySelector("*|Identifier").textContent;this._layers.set(t,i)}}}))}get readyPromise(){return this._readyPromise}get endPoint(){return this._endPoint}get layers(){return this._layers}getLayer(t){let e=null;if(null!==this._capabilitiesXML){const i=this._capabilitiesXML.querySelectorAll("Contents > Layer");for(const s of i){t===s.querySelector("*|Identifier").textContent&&(e=new Layer(s,this._endPoint+"/1.0.0"))}}return e}getTileMatrixSet(t){let e=null;if(null!==this._capabilitiesXML){const i=this._capabilitiesXML.querySelectorAll("Contents > TileMatrixSet");for(const s of i){t===s.querySelector("*|Identifier").textContent&&(e=new TileMatrixSet(s))}}return e}}class Layer{constructor(t,e){this._baseUrl=e,this._title=t.querySelector("*|Title").textContent,this._identifier=t.querySelector("*|Identifier").textContent,this._styles=new Map,this._defaultStyle="",this._boundingBox=new s.Rect,this._dimensions=new Map,this._tileMatrixSets=new Set,this._url="";const i=t.querySelectorAll("Style");for(const t of i){const e=t.querySelector("*|Title").textContent,i=t.querySelector("*|Identifier").textContent;this._styles.set(e,i),"true"===t.getAttribute("isDefault")&&(this._defaultStyle=i)}let n=t.querySelector("*|BoundingBox");if(null===n&&(n=t.querySelector("*|WGS84BoundingBox")),null===n)throw new Error('Layer "'+this._identifier+'" missing a BoundingBox or a WGS84BoundingBox tag.');const r=n.querySelector("*|LowerCorner").textContent.split(" "),o=n.querySelector("*|UpperCorner").textContent.split(" ");this._boundingBox.origin.set(Number.parseFloat(r[0]),Number.parseFloat(r[1])),this._boundingBox.size.set(Number.parseFloat(o[0])-this._boundingBox.origin.x,Number.parseFloat(o[1])-this._boundingBox.origin.y);const a=t.querySelectorAll("Dimension");for(const t of a){const e=t.querySelector("*|Identifier").textContent,i=t.querySelector("Default").textContent;this._dimensions.set(e,i)}const l=t.querySelectorAll("TileMatrixSetLink");for(const t of l){const e=t.querySelector("TileMatrixSet").textContent;this._tileMatrixSets.add(e)}const h=t.querySelector("ResourceURL");this._url=h.getAttribute("template"),/^(?:[a-z]+:)?\/\//i.test(this._url)||(this._url=this._baseUrl+this._url)}get title(){return this._title}get identifier(){return this._identifier}get styles(){return this._styles}get defaultStyle(){return this._defaultStyle}get boundingBox(){return this._boundingBox}get dimensions(){return this._dimensions}get tileMatrixSets(){return this._tileMatrixSets}get url(){return this._url}}class TileMatrixSet{constructor(t){let e;this._identifier=t.querySelector("*|Identifier").textContent,this._crs=t.querySelector("*|SupportedCRS").textContent,this._boundingBox=new s.Rect,this._numTiles=[],this._readyPromise=null;let i=0;for(const n of t.querySelectorAll("TileMatrix")){const t=n.querySelector("ScaleDenominator");if(!t)throw new Error("ScaleDenominator tag not found for TileMatrix "+i+".");const r=parseFloat(t.innerHTML);if(void 0!==e&&Math.abs(2*r-e)/r>.01)throw new Error("ScaleDenominator for TileMatrix "+i+" must be half of the next higher level, but is not.");e=r,this._numTiles[i]=new s.Vector2(parseFloat(n.querySelector("MatrixWidth").innerHTML),parseFloat(n.querySelector("MatrixHeight").innerHTML)),i+=1}this._numLevels=i;const r=t.querySelector("TileMatrix"),o=Number.parseFloat(r.querySelector("ScaleDenominator").textContent),a=new s.Vector2(Number.parseFloat(r.querySelector("TileWidth").textContent),Number.parseFloat(r.querySelector("TileHeight").textContent)),l=28e-8*o,h=new s.Vector2(l*a.x,l*a.y),c=new s.Vector2(h.x*this._numTiles[0].x,h.y*this._numTiles[0].y),d=r.querySelector("TopLeftCorner").textContent.split(" ");this._boundingBox.origin.set(Number.parseFloat(d[0]),Number.parseFloat(d[1])),this._readyPromise=TileMatrixSet.setCRS(this._crs).then((t=>{this._crs=t;let e=1e3;const i=n.default.defs(this._crs);i.to_meter?e=1e3/i.to_meter:"degrees"===i.units?e=.00898315284:"feet"!==i.units&&"us feet"!==i.units||(e=3280.83333335),this._boundingBox.size.x=Math.round(c.x*e*1e6)/1e6,this._boundingBox.size.y=Math.round(c.y*e*1e6)/1e6,this._boundingBox.origin.y=this._boundingBox.origin.y-this._boundingBox.size.y}))}get readyPromise(){return this._readyPromise}get identifier(){return this._identifier}get boundingBox(){return this._boundingBox}get numLevels(){return this._numLevels}getNumTiles(t){return this._numTiles[t]}crsUnitsToXYZ(t,e,i){const r=s.LatLonAlt.pool.get(),o=s.MathUtils.clamp(e.x,this._boundingBox.origin.x,this._boundingBox.origin.x+this._boundingBox.size.x),a=s.MathUtils.clamp(e.y,this._boundingBox.origin.y,this._boundingBox.origin.y+this._boundingBox.size.y),l=(0,n.default)(this._crs,"WGS84",[o,a]);r.set(s.MathUtils.degToRad(l[1]),s.MathUtils.degToRad(l[0]),0),i.xyzFromLLA(t,r),s.LatLonAlt.pool.release(r)}static async setCRS(t){t.startsWith("urn:ogc:def:crs:")&&(t=t.substring("urn:ogc:def:crs:".length));let e=r.get(t);if(void 0===e&&t.startsWith("EPSG::")){const i="https://epsg.io/"+t.substring("EPSG::".length)+".proj4",s=await fetch(i);e=await s.text()}return n.default.defs(t,e),t}}const r=new Map;r.set("EPSG::104903",'GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]'),r.set("EPSG::104905",'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]'),r.set("EPSG::4326","+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"),r.set("EPSG::3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs"),r.set("OGC:1.3:84",n.default.defs("WGS84")),r.set("OGC:1.3:CRS84",n.default.defs("WGS84")),r.set("OGC:2:84",n.default.defs("WGS84"))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);class KeyframePointingController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._keyframes=[],this._direction=new s.Vector3(1,0,0),this.addModifiedState("orientation")}setKeyframes(t){for(let t=0,e=this._keyframes.length;t<e;t++){let e=this._keyframes[t][1];e.startsWith("-")&&(e=e.substring(1)),"velocity"===e?this.removeDependentState(this.getEntity().getName(),"velocity"):this.removeDependentState(e,"position")}this._keyframes=[];for(let e=0,i=t.length;e<i;e++){this._keyframes.push([t[e][0],t[e][1]]);let i=this._keyframes[e][1];i.startsWith("-")&&(i=i.substring(1)),"velocity"===i?this.addDependentState(this.getEntity().getName(),"velocity"):this.addDependentState(i,"position")}this._keyframes.sort(((t,e)=>t[0]-e[0]))}setDirection(t){this._direction.copy(t)}__updateOrientationAtTime(t,e){t.isNaN()&&t.copy(s.Quaternion.Identity),this._getNewOrientation(t,e,t)}__update(){if(0===this._keyframes.length)return;const t=this.getEntity(),e=t.getScene().getEngine().getTime();t.getOrientation().isNaN()&&t.setOrientation(s.Quaternion.Identity);const i=s.Quaternion.pool.get();this._getNewOrientation(i,e,t.getOrientation()),t.setOrientation(i),s.Quaternion.pool.release(i)}_getNewOrientation(t,e,i){const n=s.Sort.getIndex(e,this._keyframes,((t,e)=>t[0]<e));let r=0,o=0;n===this._keyframes.length?(r=this._keyframes.length-1,o=this._keyframes.length-1):n>0&&(r=n-1,o=n);const a=this._keyframes[r],l=this._keyframes[o],h=l[0]>a[0]?(e-a[0])/(l[0]-a[0]):0,c=s.Vector3.pool.get(),d=s.Vector3.pool.get();this._getDirection(c,e,a[1]),this._getDirection(d,e,l[1]),d.slerp(c,d,h),d.normalize(d),c.rotate(i,this._direction);const u=s.Quaternion.pool.get();u.setFromVectorFromTo(c,d),t.mult(u,i),s.Quaternion.pool.release(u),s.Vector3.pool.release(d),s.Vector3.pool.release(c)}_getDirection(t,e,i){const n=this.getEntity(),r=i.startsWith("-");if(r&&(i=i.substring(1)),i.startsWith("velocity"))if((i=i.substring(8)).startsWith(" rel ")){i=i.substring(5);const r=n.getScene().getEntity(i);null!==r&&n.getVelocityRelativeToEntity(t,s.Vector3.Zero,r,e)}else n.getVelocityAtTime(t,e);else{const r=n.getScene().getEntity(i);null!==r?r.getPositionRelativeToEntity(t,s.Vector3.Zero,n,e):t.copy(s.Vector3.NaN)}t.normalize(t),r&&t.mult(t,-1)}}const n=KeyframePointingController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);class KeyframeSpinController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._keyframes=[],this._axis=new s.Vector3(1,0,0),this._startingAngle=0,this.addModifiedState("orientation")}setKeyframes(t){this._keyframes=[];let e=0;for(let i=0,n=t.length;i<n;i++)i>0&&(e=s.MathUtils.wrap(e+(t[i][0]-t[i-1][0])*(t[i-1][1]+t[i][1])*.5,0,2*Math.PI)),this._keyframes.push([t[i][0],t[i][1],e]);this._keyframes.sort(((t,e)=>t[0]-e[0]))}setAxis(t){this._axis.copy(t)}setStartingAngle(t){this._startingAngle=t}__updateOrientationAtTime(t,e){t.isNaN()&&t.copy(s.Quaternion.Identity),this._getNewOrientation(t,e,t)}__update(){if(0===this._keyframes.length)return;const t=this.getEntity(),e=t.getScene().getEngine().getTime();t.getOrientation().isNaN()&&t.setOrientation(s.Quaternion.Identity);const i=s.Quaternion.pool.get();this._getNewOrientation(i,e,t.getOrientation()),t.setOrientation(i),s.Quaternion.pool.release(i)}_getNewOrientation(t,e,i){const n=s.Sort.getIndex(e,this._keyframes,((t,e)=>t[0]<e));let r=0,o=0;n===this._keyframes.length?(r=this._keyframes.length-1,o=this._keyframes.length-1):n>0&&(r=n-1,o=n);const a=this._keyframes[r],l=this._keyframes[o],h=l[0]>a[0]?(e-a[0])/(l[0]-a[0]):0,c=s.MathUtils.wrap(this._startingAngle+a[2]+(e-a[0])*(a[1]+h*l[1])/(1+h),0,2*Math.PI),d=s.Vector3.pool.get();d.rotate(i,this._axis);const u=s.Quaternion.pool.get();u.setFromAxisAngle(d,c),t.mult(u,i),s.Vector3.pool.release(d),s.Quaternion.pool.release(u)}}const n=KeyframeSpinController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);class PositionSumController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._entities=new s.FastMap,this.addModifiedState("position")}addEntity(t,e,i){const n=new s.EntityRef(this.getEntity().getScene());n.setName(t),this._entities.set(t,{ref:n,mult:e,add:i}),this.addDependentState(t,"position")}removeEntity(t){this._entities.delete(t),this.removeDependentState(t,"position")}__update(){const t=s.Vector3.pool.get(),e=s.Vector3.pool.get();t.set(0,0,0);for(let i=0,n=this._entities.size;i<n;i++){const n=this._entities.getAt(i).value,r=n.ref.get();if(null===r)continue;r.getPositionRelativeToEntity(e,s.Vector3.Zero,this.getEntity().getParent());const o=e.magnitude();t.addMult(t,e,n.mult+(o>0?n.add/o:0))}this.getEntity().setPosition(t),s.Vector3.pool.release(t),s.Vector3.pool.release(e)}}const n=PositionSumController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);class ZoomFitController extends s.BaseController{constructor(t,e,i){super(t,e,i),this._entities=new s.FastMap,this._tightFit=!1,this._zoomOutOnly=!1,this._edgeSize=0,this.addModifiedState("position")}addEntity(t){const e=new s.EntityRef(this.getEntity().getScene());e.setName(t),this._entities.set(t,{ref:e}),this.addDependentState(t,"position")}removeEntity(t){this._entities.delete(t),this.removeDependentState(t,"position")}setTightFit(t){this._tightFit=t}setZoomOutOnly(t){this._zoomOutOnly=t}setEdgeSize(t){this._edgeSize=t}__update(){let t=1;const e=this.getEntity().getComponentByType("camera");if(null!==e){const i=Math.min(e.getHorizontalFieldOfView(),e.getVerticalFieldOfView());this._tightFit&&(t=Math.tan(i/2)),t=Math.tan(i/2)}const i=s.Vector3.pool.get();i.normalize(this.getEntity().getPosition()),0===i.magnitudeSqr()&&(this.getEntity().getOrientation().getAxis(i,1),i.neg(i)),i.isNaN()&&i.copy(s.Vector3.YAxisNeg);const n=(1+this._edgeSize/(.5-this._edgeSize))/t;let r=0;const o=s.Vector3.pool.get();for(let t=0,e=this._entities.size;t<e;t++){const e=this._entities.getAt(t).value.ref.get();if(null===e)continue;e.getPositionRelativeToEntity(o,s.Vector3.Zero,this.getEntity().getParent());const a=e.getExtentsRadius();let l=0;if(this._tightFit){const t=o.dot(i);o.addMult(o,i,-t);l=t+n*o.magnitude()+a*Math.sqrt(n*n+1)}else l=o.magnitude()+a;r=Math.max(r,l)}s.Vector3.pool.release(o),this._tightFit||(r*=Math.sqrt(n*n+1)),(!this._zoomOutOnly||r>this.getEntity().getPosition().magnitude())&&(i.mult(i,r),this.getEntity().setPosition(i)),s.Vector3.pool.release(i)}}const n=ZoomFitController},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(128),n=i(132),r=i(2);s.default.register({observable_universe:{groups:["stars"],radius:5e23,systemRadius:5e23,label:"Observable Universe",parents:[],fixed:{position:r.Vector3.Zero,orientation:r.Quaternion.Identity},postCreateFunction:t=>{t.setCanOcclude(!1)}},milky_way:{groups:["stars"],radius:1e18,systemRadius:13e18,label:"Milky Way",parents:[[Number.NEGATIVE_INFINITY,"observable_universe"]],fixed:{position:r.Vector3.Zero,orientation:r.Quaternion.Identity},postCreateFunction:(t,e)=>{t.setCanOcclude(!1);const i=t.get("fixed"),s=new r.Vector3,n=192.85948120833*Math.PI/180,o=27.12825119444*Math.PI/180;s.x=Math.cos(n)*Math.cos(o),s.y=Math.sin(n)*Math.cos(o),s.z=Math.sin(o);const a=new r.Vector3,l=266.40499625*Math.PI/180,h=-28.93617241667*Math.PI/180;a.x=Math.cos(l)*Math.cos(h),a.y=Math.sin(l)*Math.cos(h),a.z=Math.sin(h);const c=new r.Quaternion;if(c.setFromAxes(a,void 0,s),i.setOrientation(c),e&&e.milkyWaySprite){const e=t.addComponent("sprite");e.setTextureUrl("$STATIC_ASSETS_URL/sprites/milky_way.png"),e.setSize(new r.Vector2(12e17,12e17)),e.setTransparent(!0),e.setBlending("normal"),e.setFadeDistance(12e15)}const d=t.addController("spin");d.setAxis(new r.Vector3(-.8676661356982597,-.19807638974470915,.45598379452940485),!1),d.setRate(-2192686e-23),d.setReferenceAngle(0),d.setReferenceTime(0)}},sun:{groups:["stars"],radius:695500,systemRadius:2991957e7,label:"Sun",parents:[[Number.NEGATIVE_INFINITY,"milky_way"]],spheroid:{equatorialRadius:695500,polarRadius:695500,planetographic:!1},spheroidLOD:{features:["colorMapEmmissive"],textures:{color:{url:"sun/color_$SIZE_$FACE.png",sizes:[4,512]}}},fixed:{position:r.Vector3.Zero,orientation:r.Quaternion.Identity},postCreateFunction:(t,e)=>{t.addComponent("lightSource").setAbsoluteMagnitude(4.83);const i=t.addComponent("atmosphere");i.setEmissivity(1),i.setScaleHeight(2e5),i.setDensity(8e-7),i.setColor(new r.Color(1,1,64/255));const s=t.addComponent("sprite");s.setBillboard(!0),s.setTextureUrl("$STATIC_ASSETS_URL/sprites/sun_glow.png"),s.setSize(new r.Vector2(100,100)),s.setSizeUnits("pixels"),s.setTransparent(!0),s.setColorMultiplier(new r.Color(1,1,.5)),s.setRenderOrder(-2);const o=t.addController("orbitalElements"),a=new r.OrbitalElements;if(a.epoch=0,a.eccentricity=0,a.semiMajorAxis=246237071e9,a.meanAngularMotion=-2192686e-23,a.meanAnomalyAtEpoch=Math.PI,a.orbitOrientation.set(-.48894750765094835,-.4832106839985283,.19625375824756275,.6992297419646486),o.addOrbitalElements(-1e100,a),o.addOrbitalElements(1e100,a),void 0!==e&&!0===e.skybox){t.addComponent("skybox").setTextureUrl("$STATIC_ASSETS_URL/textures/starmap_"+(e.skyboxResolution||2048)+".jpg")}if(void 0===e||!0===e.skybox&&!0===e.starfield||!1!==e.starfield){t.addComponent("starfield").setUrl("$STATIC_ASSETS_URL/stars/galaxies.0.bin");for(let e=0;e<6;e++){t.addComponent("starfield").setUrl("$STATIC_ASSETS_URL/stars/stars."+e+".bin")}}if(void 0!==e&&e.heliosphere){const e=t.addComponent("model");e.setUrl("$STATIC_ASSETS_URL/models/heliosphere/voyager_heliosphere.gltf"),e.setScale(new r.Vector3(201e6,19e7,19e7)),e.setForceLoaded(!0);const i=new r.LatLonAlt(0,-105*Math.PI/180,0),s=new r.Vector3;r.Geometry.getXYZFromLLAOnSphere(s,i,1),s.rotate(n.default.getEclipJ2000ToJ2000Rotation(),s),s.normalize(s);const o=new r.Quaternion;o.setFromVectorFromTo(new r.Vector3(.9937396508197329,.11171728072160429,.0008692392338424033),s),e.setRotation(o)}}},mercury:{groups:["planets"],radius:2439.4,systemRadius:292764,label:"Mercury",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:7600654,color:[.6,.6,.6,.7]},spheroid:{equatorialRadius:2439.4,polarRadius:2439.4,planetographic:!1},spheroidLOD:{textures:{color:{url:"mercury/color_$SIZE_$FACE.png",sizes:[4,512,4096]}}},dynamo:[{url:"mercury/sun/orb"},{url:"mercury/ori"}]},venus:{groups:["planets"],radius:6051.8,systemRadius:726216,label:"Venus",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:19408261,color:[.9,.8,.45,.7]},spheroid:{equatorialRadius:6051.8,polarRadius:6051.8,planetographic:!1},spheroidLOD:{textures:{color:{url:"venus/color_$SIZE_$FACE.png",sizes:[4,512]}}},dynamo:[{url:"venus/sun/orb"},{url:"venus/ori"}],postCreateFunction:t=>{const e=t.addComponent("atmosphere");e.setScaleHeight(15),e.setDensity(.001),e.setColor(new r.Color(213/255,160/255,94/255)),e.setSunBrightness(.25)}},earth:{groups:["planets"],radius:6378.1,systemRadius:765372,label:"Earth",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:31558149,color:[0,.6,.8,.7]},spheroid:{equatorialRadius:6378.137,polarRadius:6356.752,planetographic:!0},spheroidLOD:{features:["normalMap","specularMap","nightMap","decalMap","nightMapEmmissive","shadowEntities"],textures:{color:{url:"earth/color_$SIZE_$FACE.png",sizes:[16,512,4096]},normal:{url:"earth/normal_$SIZE_$FACE.png",sizes:[16,512,4096]},specular:{url:"earth/specular_$SIZE_$FACE.png",sizes:[16,512,4096]},night:{url:"earth/night_$SIZE_$FACE.png",sizes:[16,512,4096]},decal:{url:"earth/cloud_$SIZE_$FACE.png",sizes:[16,512,4096]}},shadowEntities:["moon"]},dynamo:[{url:"earth/sun/orb"},{url:"earth/ori"}],postCreateFunction:(t,e)=>{if(e&&!1===e.clouds){t.get("spheroidLOD").setTexture("decal","")}const i=t.addComponent("atmosphere");i.setScaleHeight(8),i.setDensity(.0015),i.setColor(new r.Color(214.5/255,267/255,1.5)),i.setSunBrightness(2),i.setSunsetColor(new r.Color(1,.65,0)),i.setSunsetIntensity(1.2)}},mars:{groups:["planets"],radius:3396.2,systemRadius:46922,label:"Mars",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:59360879,color:[.89,.51,.35,.7]},spheroid:{equatorialRadius:3396.19,polarRadius:3376.2,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"mars/color_$SIZE_$FACE.png",sizes:[4,512,4096]}},shadowEntities:["phobos","deimos"]},dynamo:[{url:"mars/sun/orb"},{url:"mars/ori"}],postCreateFunction:t=>{const e=t.addComponent("atmosphere");e.setScaleHeight(10.8),e.setDensity(.001),e.setColor(new r.Color(225/255,178/255,112/255)),e.setSunBrightness(.8),e.setSunsetColor(new r.Color(10/255,75/255,140/255)),e.setSunsetIntensity(1)}},jupiter:{groups:["planets"],radius:71492,systemRadius:3782501,label:"Jupiter",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:374279653,color:[.95,.71,.64,.7]},spheroid:{equatorialRadius:71492,polarRadius:66854,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"jupiter/color_$SIZE_$FACE.jpg",sizes:[16,512,4096]}},shadowEntities:["io","europa","ganymede","callisto"]},dynamo:[{url:"jupiter/sun/orb"},{url:"jupiter/ori"}],postCreateFunction:t=>{const e=t.addComponent("atmosphere");e.setScaleHeight(200),e.setDensity(5e-5),e.setColor(new r.Color(234/255,202/255,170/255)),e.setSunBrightness(.25);const i=t.addController("coverage"),s=[[-1136116758,15],[-1037534358,28],[-938951958,22],[-867931156,0],[-812721554,12],[-744292752,47],[-639143949,62],[-533822346,48],[-483883145,27],[-391953544,15],[102427264,85],[315576066,138],[615211269,312],[660052869,347]];let n=0;t.addController("rotate").setRotatingPosition(!1);const o=(s[s.length-1][1]-s[s.length-2][1])/(s[s.length-1][0]-s[s.length-2][0]);i.addCoverage(r.Interval.Infinite,void 0,void 0,(t=>{if(t.getOrientation().isNaN())return;if(null===t.get("rotate"))return;const e=t.getScene().getEngine().getTime();let i=o,a=n;if(e<s[a][0]||a<s.length-1&&s[a+1][0]<=e)if(e>=s[s.length-1][0])a=s.length-1;else if(e<s[0][0])a=0,i=0;else for(let t=s.length-2;t>=0;t--)s[t][0]<=e&&e<s[t+1][0]&&(a=t,i=(s[t+1][1]-s[t][1])/(s[t+1][0]-s[t][0]));else a<s.length-1&&(i=(s[a+1][1]-s[a][1])/(s[a+1][0]-s[a][0]));n=a;const l=s[a][1]+(e-s[a][0])*i,h=r.MathUtils.wrap(305-(l+-60.38-313.47)+-3074e-9*(e-617098056),0,360),c=t.getComponentByType("spheroidLOD");null!==c&&c.setLongitudeRotation(r.MathUtils.degToRad(h))}))}},saturn:{groups:["planets"],radius:60268,systemRadius:7184413,label:"Saturn",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:929703084,color:[.72,.65,.52,.7]},spheroid:{equatorialRadius:60268,polarRadius:54364,planetographic:!1},spheroidLOD:{features:["shadowEntities","shadowRings"],textures:{color:{url:"saturn/color_$SIZE_$FACE.png",sizes:[4,512]}},shadowEntities:["iapetus","dione","rhea","tethys","titan"]},dynamo:[{url:"saturn/sun/orb"},{url:"saturn/ori"}],postCreateFunction:t=>{const e=t.addComponent("rings");e.setInnerRadius(74270.580913),e.setOuterRadius(140478.924731),e.setTopTextureUrl("$STATIC_ASSETS_URL/sprites/saturn_rings_top.png"),e.setBottomTextureUrl("$STATIC_ASSETS_URL/sprites/saturn_rings_bottom.png"),e.setFadeDistance(250);const i=t.addComponent("atmosphere");i.setScaleHeight(200),i.setDensity(5e-5),i.setColor(new r.Color(234/255,202/255,151/255))}},uranus:{groups:["planets"],radius:25559,systemRadius:1164893,label:"Uranus",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:2651200139,color:[.67,.92,1,.7]},spheroid:{equatorialRadius:25559,polarRadius:24973,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"uranus/color_$SIZE_$FACE.png",sizes:[4,256]}},shadowEntities:["titania","oberon","umbriel","ariel","miranda"]},dynamo:[{url:"uranus/sun/orb"},{url:"uranus/ori"}],postCreateFunction:t=>{const e=t.addComponent("atmosphere");e.setScaleHeight(200),e.setDensity(5e-5),e.setColor(new r.Color(147/255,183/255,201/255)),e.setSunsetColor(new r.Color(164/255,168/255,.4)),e.setSunsetIntensity(1)}},neptune:{groups:["planets"],radius:24764,systemRadius:43213894,label:"Neptune",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:5200783038,color:[.48,.69,1,.7]},spheroid:{equatorialRadius:24764,polarRadius:24341,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"neptune/color_$SIZE_$FACE.png",sizes:[4,256]}},shadowEntities:["triton","proteus","despina","galatea","larissa"]},dynamo:[{url:"neptune/sun/orb"},{url:"neptune/ori"}],postCreateFunction:t=>{const e=t.addComponent("rings");e.setInnerRadius(40900),e.setOuterRadius(62964),e.setTopTextureUrl("$STATIC_ASSETS_URL/sprites/neptune_rings.png"),e.setBottomTextureUrl("$STATIC_ASSETS_URL/sprites/neptune_rings.png"),e.setFadeDistance(250);const i=t.addComponent("atmosphere");i.setScaleHeight(200),i.setDensity(5e-5),i.setColor(new r.Color(138/255,160/255,1))}}});const o={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(128),n=i(2);s.default.register({"1_ceres":{groups:["dwarf planets"],radius:473,label:"Ceres",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:145250858},spheroid:{equatorialRadius:482.6,polarRadius:445.6,planetographic:!1},spheroidLOD:{textures:{color:{url:"1_ceres/color_$SIZE_$FACE.jpg",sizes:[16,512,4096]}}},dynamo:[{url:"1_ceres/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"101955_bennu":{groups:["asteroids","NEOs","PHAs"],radius:.246,label:"Bennu",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:37856546},model:{url:"$STATIC_ASSETS_URL/models/101955_bennu/Bennu.gltf",rotate:[{x:83},{z:-168}],scale:[9957e-7,9957e-7,9957e-7]},dynamo:[{url:"101955_bennu/sun/orb"},{url:"101955_bennu/ori"}]},"11351_leucus":{groups:["asteroids"],radius:17.0775,label:"Leucus",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:384622403.174},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:17.0775},dynamo:[{url:"11351_leucus/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:445.732}},"12923_zephyr":{groups:["asteroids","NEOs","PHAs"],radius:1.03,label:"Zephyr",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:86659200},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[1.03,1.03,1.03]},dynamo:[{url:"12923_zephyr/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:3.891}},"134340_pluto":{groups:["dwarf planets","moons","134340_pluto_barycenter"],radius:1187,label:"Pluto",labelFadeEntity:"sun",parents:[[Number.NEGATIVE_INFINITY,"134340_pluto_barycenter"]],trail:{length:551857},spheroid:{equatorialRadius:1187,polarRadius:1187,planetographic:!1},spheroidLOD:{textures:{color:{url:"134340_pluto/color_$SIZE_$FACE.png",sizes:[4,512,4096]}}},dynamo:[{url:"134340_pluto/134340_pluto_barycenter/orb"}],align:{primary:{type:"point",axis:n.Vector3.XAxis,target:"charon"},secondary:{type:"velocity",axis:n.Vector3.YAxis,target:"charon"}}},"134340_pluto_barycenter":{groups:["134340_pluto","barycenters"],occlusionRadius:.001,extentsRadius:28e3,systemRadius:130153,label:"Barycenter",labelFadeEntity:"134340_pluto",trail:{length:7826284800},parents:[[Number.NEGATIVE_INFINITY,"sun"]],fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"134340_pluto_barycenter/sun/orb"}],postCreateFunction:t=>{t.getComponentByType("div").setFadeWhenCloseToCamera(!1),t.setCanOcclude(!1)}},"136108_haumea":{groups:["dwarf planets","TNOs"],radius:816,label:"Haumea",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:8966073600},model:{url:"$STATIC_ASSETS_URL/models/136108_haumea/haumea.gltf",scale:[1,1,1]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"136108_haumea/sun/orb"}]},"136199_eris":{groups:["dwarf planets","TNOs"],radius:1163,label:"Eris",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:17610912e3},spheroid:{equatorialRadius:1163,polarRadius:1163,planetographic:!1},spheroidLOD:{textures:{color:{url:"136199_eris/color_$SIZE_$FACE.png",sizes:[4,512]}}},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"136199_eris/sun/orb"}]},"136472_makemake":{groups:["dwarf planets","TNOs"],radius:715,label:"Makemake",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:9754300800},spheroid:{equatorialRadius:717,polarRadius:710,planetographic:!1},spheroidLOD:{textures:{color:{url:"136472_makemake/color_$SIZE_$FACE.png",sizes:[4,512]}}},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"136472_makemake/sun/orb"}]},"14827_hypnos":{groups:["asteroids","NEOs","PHAs"],radius:.4535,label:"Hypnos",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:151113600},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.4535,.4535,.4535]},dynamo:[{url:"14827_hypnos/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"15094_polymele":{groups:["asteroids"],radius:10.5375,label:"Polymele",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:371396335.107},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:10.5375},dynamo:[{url:"15094_polymele/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:5.8607}},"1566_icarus":{groups:["asteroids","NEOs","PHAs"],radius:.805,label:"Icarus",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:35326368},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.805,.8,.585]},dynamo:[{url:"1566_icarus/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:2.2726}},"16_psyche":{groups:["asteroids"],radius:125,label:"16 Psyche",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:157517136},model:{url:"$STATIC_ASSETS_URL/models/16_psyche/psycheAsteroid.gltf",scale:[100,100,100],rotate:[{x:90}]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"16_psyche/sun/orb"}]},"1620_geographos":{groups:["asteroids","NEOs","PHAs"],radius:2.5,label:"Geographos",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:43891200},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[2.5,1,1.05]},dynamo:[{url:"1620_geographos/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:5.224}},"162173_ryugu":{groups:["asteroids","NEOs","PHAs"],radius:.45,label:"Ryugu",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:40953600},model:{url:"$STATIC_ASSETS_URL/models/162173_ryugu/ryugu.gltf",rotate:[{x:-90}]},dynamo:[{url:"ssd/162173_ryugu/sun/orb"},{url:"162173_ryugu/ori"}]},"1862_apollo":{groups:["asteroids","NEOs","PHAs"],radius:.75,label:"Apollo",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:56259360},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.75,.75,.75]},dynamo:[{url:"1862_apollo/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:3.065}},"1981_midas":{groups:["asteroids","NEOs","PHAs"],radius:.975,label:"Midas",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:74649600},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.975,.975,.975]},dynamo:[{url:"1981_midas/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:5.22}},"1991_vg":{groups:["asteroids","NEOs"],radius:.00425,label:"1991 VG",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:33100012},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.00425,.00425,.00425]},dynamo:[{url:"1991_vg/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"1993_hd":{groups:["asteroids","asteroid belt"],radius:.005,label:"1993 HD",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:100388764},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.005,.005,.005]},dynamo:[{url:"1993_hd/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"1994_cc_a":{groups:["asteroids","NEOs","PHAs"],radius:.325,label:"1994 CC",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:66137990},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.325,.325,.325]},dynamo:[{url:"1994_cc_a/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:2.3886}},"1996_xb27":{groups:["asteroids","NEOs"],radius:.042,label:"1996 XB<sub>27</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:40909104},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.042,.042,.042]},dynamo:[{url:"1996_xb27/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:1.195}},"1998_ky26":{groups:["asteroids","NEOs"],radius:.015,label:"1998 KY<sub>26</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:43202073},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.015,.015,.015]},dynamo:[{url:"1998_ky26/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:.1784}},"1998_ml14":{groups:["asteroids","NEOs","PHAs"],radius:.5,label:"1998 ML<sub>14</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:117917856},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.5,.5,.5]},dynamo:[{url:"1998_ml14/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:14.28}},"1998_qe2":{groups:["asteroids","NEOs","PHAs"],radius:1.375,label:"1998 QE<sub>2</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:119104300},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[1.375,1.375,1.375]},dynamo:[{url:"1998_qe2/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:4.749}},"1999_ao10":{groups:["asteroids","NEOs"],radius:.025,label:"1999 AO<sub>10</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:27475200},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.025,.025,.025]},dynamo:[{url:"1999_ao10/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"1999_cg9":{groups:["asteroids","NEOs"],radius:.005,label:"1999 CG<sub>9</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:34535808},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"1999_cg9/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"1999_vx25":{groups:["asteroids","NEOs"],radius:.005,label:"1999 VX<sub>25</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:26941680},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.005,.005,.005]},dynamo:[{url:"1999_vx25/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"1i_oumuamua":{groups:["asteroid","interstellar"],occlusionRadius:.03,extentsRadius:.225,label:"ʻOumuamua",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:174195800},model:{url:"$STATIC_ASSETS_URL/models/1i_oumuamua/oumuamua.gltf"},spin:{axis:new n.Vector3(.57735026919,.57735026919,.57735026919),periodInHours:8.1},dynamo:[{url:"1i_oumuamua/sun/orb"}]},"2_pallas":{groups:["asteroids","asteroid belt"],radius:291,label:"Pallas",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:145683878},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[291,278,250]},dynamo:[{url:"2_pallas/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:7.8132}},"2000_ae205":{groups:["asteroids","NEOs"],radius:.005,label:"2000 AE<sub>205</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:39660827},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2000_ae205/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2000_lg6":{groups:["asteroids","NEOs"],radius:.005,label:"2000 LG<sub>6</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:27724710},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2000_lg6/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2000_sg344":{groups:["asteroids","NEOs"],radius:.0185,label:"2000 SG<sub>344</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:30497305},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.0185,.0185,.0185]},dynamo:[{url:"2000_sg344/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2001_bb16":{groups:["asteroids","NEOs"],radius:.005,label:"2001 BB<sub>16</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:24933552},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2001_bb16/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2001_fr85":{groups:["asteroids","NEOs"],radius:.005,label:"2001 FR<sub>85</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:30752213},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2001_fr85/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2001_gp2":{groups:["asteroids","NEOs"],radius:.005,label:"2001 GP<sub>2</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:33351128},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2001_gp2/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2001_qj142":{groups:["asteroids","NEOs"],radius:.005,label:"2001 QJ<sub>142</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:34542533},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2001_qj142/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2001_sn263_a":{groups:["asteroids","NEOs"],radius:1.45,label:"(153591) 2001 SN<sub>263</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:88379117},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[1.4,1.35,1.45]},dynamo:[{url:"2001_sn263_a/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:3.423}},"2003_sm84":{groups:["asteroids","NEOs"],radius:.005,label:"2003 SM<sub>84</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:37674723},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2003_sm84/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2003_uv11":{groups:["asteroids","NEOs"],radius:.13,label:"(503941) 2003 UV<sub>11</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:55302063},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.13,.13,.13]},dynamo:[{url:"2003_uv11/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:18.25}},"2003_yn107":{groups:["asteroids","NEOs"],radius:.01,label:"2003 YN<sub>107</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:31024602},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.01,.01,.01]},dynamo:[{url:"2003_yn107/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2005_er95":{groups:["asteroids","NEOs"],radius:.005,label:"2003 ER<sub>95</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:42691438},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2005_er95/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2005_lc":{groups:["asteroids","NEOs"],radius:.005,label:"2005 LC",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:38109231},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2005_lc/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2005_qp87":{groups:["asteroids","NEOs"],radius:.005,label:"2005 QP<sub>87</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:43182130},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2005_qp87/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2005_yu55":{groups:["asteroids","NEOs"],radius:.18,label:"2005 YU<sub>55</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:39279986},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.18,.18,.18]},dynamo:[{url:"2005_yu55/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:18}},"2006_bz147":{groups:["asteroids","NEOs"],radius:.005,label:"2006 BZ<sub>147</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:32672193},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2006_bz147/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2006_jy26":{groups:["asteroids","NEOs"],radius:.00475,label:"2006 JY<sub>26</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:32046056},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.00475,.00475,.00475]},dynamo:[{url:"2006_jy26/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2006_qq56":{groups:["asteroids","NEOs"],radius:.005,label:"2006 QQ<sub>56</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:30849279},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2006_qq56/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2006_rh120":{groups:["asteroids","NEOs"],radius:.00125,label:"2006 RH<sub>120</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:31646355},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.00125,.00125,.00125]},dynamo:[{url:"2006_rh120/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:.04583}},"2006_ub17":{groups:["asteroids","NEOs"],radius:.005,label:"2006 UB<sub>17</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:38423813},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2006_ub17/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2007_tf15":{groups:["asteroids","NEOs"],radius:.005,label:"2007 TF<sub>15</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:36848420},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2007_tf15/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2007_un12":{groups:["asteroids","NEOs"],radius:.005,label:"2007 UN<sub>12</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:34141598},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2007_un12/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2007_vu6":{groups:["asteroids","NEOs"],radius:.005,label:"2007 VU<sub>6</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:30439348},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2007_vu6/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2008_bt2":{groups:["asteroids","NEOs"],radius:.005,label:"2008 BT<sub>2</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:40099605},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2008_bt2/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2008_cx118":{groups:["asteroids","NEOs"],radius:.005,label:"2008 CX<sub>118</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:38642620},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2008_cx118/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2008_ea9":{groups:["asteroids","NEOs"],radius:.005,label:"2008 EA<sub>9</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:34399094},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2008_ea9/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2008_el":{groups:["asteroids","NEOs"],radius:.005,label:"2008 EL",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:36567037},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2008_el/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2008_hu4":{groups:["asteroids","NEOs"],radius:.005,label:"2008 HU<sub>4</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:35000582},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2008_hu4/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2008_jl24":{groups:["asteroids","NEOs"],radius:.005,label:"2008 JL<sub>24</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:33383926},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2008_jl24/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:.05385}},"2008_kt":{groups:["asteroids","NEOs"],radius:.005,label:"2008 KT",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:32084467},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2008_kt/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2008_tc3":{groups:["asteroids","NEOs"],radius:.00205,label:"2008 TC<sub>3</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:47219992},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.00205,.00205,.00205]},dynamo:[{url:"2008_tc3/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:.0269409}},"2008_ts10":{groups:["asteroids","NEOs"],radius:.005,label:"2008 TS<sub>10</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:44550003},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2008_ts10/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2008_ua202":{groups:["asteroids","NEOs"],radius:.025,label:"2008 UA<sub>202</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:33141727},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.025,.025,.025]},dynamo:[{url:"2008_ua202/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2009_bd":{groups:["asteroids","NEOs"],radius:.0055,label:"2009 BD",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:32021453},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.0055,.0055,.0055]},dynamo:[{url:"2009_bd/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2009_os5":{groups:["asteroids","NEOs"],radius:.005,label:"2009 OS<sub>5</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:38627939},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2009_os5/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2009_rt1":{groups:["asteroids","NEOs"],radius:.005,label:"2009 RT<sub>1</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:39197194},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2009_rt1/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2009_yf":{groups:["asteroids","NEOs"],radius:.005,label:"2009 YF",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:28573741},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2009_yf/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2010_an61":{groups:["asteroids","NEOs"],radius:.005,label:"2010 AN<sub>61</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:39265990},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2010_an61/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2010_dj":{groups:["asteroids","NEOs"],radius:.005,label:"2010 DJ",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:41893712},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2010_dj/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2010_jw34":{groups:["asteroids","NEOs"],radius:.005,label:"2010 JW<sub>34</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:30671447},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2010_jw34/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2010_tg19":{groups:["asteroids","NEOs"],radius:.005,label:"2010 TG<sub>19</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:96734965},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2010_tg19/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2010_tn167":{groups:["asteroids","NEOs"],radius:.005,label:"2010 TN<sub>167</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:70146852},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2010_tn167/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2010_ub":{groups:["asteroids","NEOs"],radius:.005,label:"2010 UB",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:93215413},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.005,.005,.005]},dynamo:[{url:"2010_ub/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2063_bacchus":{groups:["asteroids","NEOs"],radius:.555,label:"Bacchus",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:35315957},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.555,.265,.25]},dynamo:[{url:"2063_bacchus/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:14.904}},"21_lutetia":{groups:["asteroids","asteroid belt"],radius:60.5,label:"Lutetia",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:119908344},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[60.5,50.5,37.5]},dynamo:[{url:"21_lutetia/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:8.1655}},"2101_adonis":{groups:["asteroids","NEOs","PHAs"],radius:.2615,label:"Adonis",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:80974175},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.2615,.2615,.2615]},dynamo:[{url:"2101_adonis/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"2102_tantalus":{groups:["asteroids","NEOs","PHAs"],radius:.8245,label:"Tantalus",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:46243117},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.8245,.8245,.8245]},dynamo:[{url:"2102_tantalus/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:2.384}},"2135_aristaeus":{groups:["asteroids","NEOs","PHAs"],radius:.5,label:"Aristaeus",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:63842351},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.5,.5,.5]},dynamo:[{url:"2135_aristaeus/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"216_kleopatra":{groups:["asteroids","asteroid belt"],radius:138,label:"Kleopatra",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:147366495},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[138,47,39]},dynamo:[{url:"216_kleopatra/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:5.385}},"21900_orus":{groups:["asteroids"],radius:25.405,label:"Orus",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:366046968.426},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:25.405},dynamo:[{url:"21900_orus/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:13.45}},"225088_2007_or10":{groups:["dwarf planets","TNOs"],radius:615,label:"2007 OR<sub>10</sub>",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:17453038503},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[615,615,596.55]},dynamo:[{url:"225088_2007_or10/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:22.4}},"2340_hathor":{groups:["asteroids","NEOs","PHAs"],radius:.105,label:"Hathor",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:24462116},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.105,.105,.105]},dynamo:[{url:"2340_hathor/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:3.35}},"243_ida":{groups:["asteroids","asteroid belt"],radius:29.9,label:"Ida",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:152692978},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[18.6*1.3,25.4*1.3,77.74],rotate:[{y:90}]},dynamo:[{url:"243_ida/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:4.634}},"25143_itokawa":{groups:["asteroids","NEOs","PHAs"],radius:.165,label:"Itokawa",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:48085521},model:{url:"$STATIC_ASSETS_URL/models/25143_itokawa/itokawa.gltf",rotate:[{x:90}]},dynamo:[{url:"25143_itokawa/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12.132}},"253_mathilde":{groups:["asteroids","asteroid belt"],radius:33,label:"Mathilde",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:136059532},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[33,24,23]},dynamo:[{url:"253_mathilde/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:417.7}},"2867_steins":{groups:["asteroids","asteroid belt"],radius:3.415,label:"Šteins",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:114690676},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[3.415,2.85,2.21]},dynamo:[{url:"2867_steins/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:6.049}},"3_juno":{groups:["asteroids","asteroid belt"],radius:160,label:"Juno",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:137616821},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[160,133.5,100]},dynamo:[{url:"3_juno/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:7.21}},"3122_florence":{groups:["asteroids","NEOs","PHAs"],radius:2.2,label:"Florence",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:74244319},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[2.2,2.2,2.2]},dynamo:[{url:"3122_florence/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:2.3581}},"3200_phaethon":{groups:["asteroids","NEOs","PHAs"],radius:2.9,label:"Phaethon",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:45239890},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[2.9,2.9,2.9]},dynamo:[{url:"3200_phaethon/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:3.604}},"3362_khufu":{groups:["asteroids","NEOs","PHAs"],radius:.35,label:"Khufu",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:31064230},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.35,.35,.35]},dynamo:[{url:"3362_khufu/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"3548_eurybates":{groups:["asteroids"],radius:31.9425,label:"Eurybates",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:374226349.15},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:31.9425},dynamo:[{url:"3548_eurybates/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:8.711}},"367943_duende":{groups:["asteroids","NEOs"],radius:.02,label:"Duende",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:27409492},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.01,.01,.02]},dynamo:[{url:"367943_duende/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:9.485}},"37655_illapa":{groups:["asteroids","NEOs","PHAs"],radius:.75,label:"Illapa",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:56696394},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.75,.75,.75]},dynamo:[{url:"37655_illapa/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:2.6556}},"4_vesta":{groups:["asteroids","asteroid belt"],radius:262.7,label:"Vesta",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:114544800},model:{url:"$STATIC_ASSETS_URL/models/4_vesta/4_vesta.gltf",rotate:[{x:90}]},dynamo:[{url:"4_vesta/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"4015_wilson-harrington":{groups:["asteroids","NEOs","PHAs"],radius:2,label:"Wilson-Harrington",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:134340178},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[2,2,2]},dynamo:[{url:"4015_wilson-harrington/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:3.5736}},"4179_toutatis":{groups:["asteroids","NEOs","PHAs"],radius:2.13,label:"Toutatis",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:127994167},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[1.35,1.015,2.13]},dynamo:[{url:"4179_toutatis/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:176}},"4183_cuno":{groups:["asteroids","NEOs","PHAs"],radius:1.8255,label:"Cuno",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:88105665},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[1.8255,1.8255,1.89255]},dynamo:[{url:"4183_cuno/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:3.5595}},"433_eros":{groups:["asteroids","NEOs"],radius:8.42,label:"Eros",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:55564653},model:{url:"$STATIC_ASSETS_URL/models/433_eros/433_eros.gltf"},dynamo:[{url:"433_eros/sun/orb"},{url:"433_eros/ori"}]},"4450_pan":{groups:["asteroids","NEOs","PHAs"],radius:.5,label:"Pan",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:54661485},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.5,.5,.5]},dynamo:[{url:"4450_pan/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:56.48}},"4486_mithra":{groups:["asteroids","NEOs","PHAs"],radius:1.175,label:"Mithra",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:102956005},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[1.175,.825,.72]},dynamo:[{url:"4486_mithra/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:67.5}},"4769_castalia":{groups:["asteroids","NEOs","PHAs"],radius:.9,label:"Castalia",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:34594967},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.4,.4,.9]},dynamo:[{url:"4769_castalia/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:4.095}},"486958_arrokoth":{groups:["TNOs"],radius:15,label:"Arrokoth",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:9354873600},model:{url:"$STATIC_ASSETS_URL/models/486958_arrokoth/mu69.gltf",scale:[1,1,1],rotate:[{x:-110},{y:180}]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"486958_arrokoth/sun/orb"}],spin:{axis:new n.Vector3(-6.121453676996425e-10,.9396926211599973,.34202014229786787),periodInHours:13},postCreateFunction:t=>{const e=t.get("spin");null!==e&&(e.setReferenceAngle(0),e.setReferenceTime(599590968))}},"5011_ptah":{groups:["asteroids","NEOs","PHAs"],radius:.78,label:"Ptah",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:66011009},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.78,.78,.78]},dynamo:[{url:"5011_ptah/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:12}},"52246_donaldjohanson":{groups:["asteroids"],radius:1.9475,label:"Donaldjohanson",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:116208e3},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:1.9475},dynamo:[{url:"52246_donaldjohanson/sun/orb"}],fixed:{orientation:n.Quaternion.Identity}},"5535_annefrank":{groups:["asteroids"],radius:2.412,label:"Annefrank",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:103852800},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:2.412},dynamo:[{url:"5535_annefrank/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:15.12}},"617_patroclus":{groups:["asteroids","617_patroclus_barycenter"],radius:64,label:"Patroclus",labelFadeEntity:"sun",parents:[[Number.NEGATIVE_INFINITY,"617_patroclus_barycenter"]],trail:{length:183600},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[64,58,49],shadowEntities:["menoetius"]},align:{primary:{type:"point",axis:n.Vector3.XAxis,target:"menoetius"}},postCreateFunction:t=>{const e=t.addController("orbitalElements",void 0,t.getControllerByType("align")),i=new n.OrbitalElements;i.epoch=0,i.eccentricity=0,i.semiMajorAxis=664,i.meanAngularMotion=1697791e-11,i.meanAnomalyAtEpoch=Math.PI,i.setOrbitOrientationFromElements(1.97244894756,0,0),e.addOrbitalElements(-1e100,i),e.addOrbitalElements(1e100,i)}},"617_patroclus_barycenter":{groups:["asteroids"],radius:664,label:"Patroclus",labelFadeEntity:"617_patroclus",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:375567312.149},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"617_patroclus/sun/orb"}],postCreateFunction:t=>{t.setCanOcclude(!1)}},"6239_minos":{groups:["asteroids","NEOs","PHAs"],radius:.237,label:"Minos",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:38987872},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.237,.237,.237]},dynamo:[{url:"6239_minos/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:3.5558}},"6489_golevka":{groups:["asteroids","NEOs","PHAs"],radius:.265,label:"Golevka",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:124929936},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.265,.265,.265]},dynamo:[{url:"6489_golevka/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:6.026}},"65803_didymos":{groups:["asteroids","NEOs","PHAs"],radius:.39,label:"Didymos",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/65803_didymos/Didymos.gltf",rotate:[{z:180},{x:-90}]},fixed:{orientation:new n.Quaternion(0,1,0,0)},dynamo:[{url:"65803_didymos/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:2.2593,relativeToTime:0}},"66391_moshup":{groups:["asteroids","NEOs","PHAs"],radius:.766,label:"Moshup",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:16241014},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.766,.7475,.6735]},dynamo:[{url:"66391_moshup/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:2.7645}},"69230_hermes":{groups:["asteroids","NEOs","PHAs"],radius:.425,label:"Hermes",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:67203045},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[.425,.425,.425]},dynamo:[{url:"69230_hermes/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:13.894}},"90377_sedna":{groups:["dwarf planets","TNOs"],radius:497.5,label:"Sedna",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:331511477985},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[497.5,497.5,497.5]},dynamo:[{url:"90377_sedna/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:10.273}},"951_gaspra":{groups:["asteroids","asteroid belt"],radius:9.1,label:"Gaspra",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:17262935},model:{url:"$STATIC_ASSETS_URL/models/951_gaspra/gaspra.gltf"},dynamo:[{url:"951_gaspra/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:7.042}},"9969_braille":{groups:["asteroids","asteroid belt"],radius:1.05,label:"Braille",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:113087113},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[1.05,.5,.5]},dynamo:[{url:"9969_braille/sun/orb"}],spin:{axis:n.Vector3.ZAxis,periodInHours:226.4}},"99942_apophis":{groups:["asteroids","NEOs","PHAs"],radius:.225,label:"Apophis",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:27958776},model:{url:"$STATIC_ASSETS_URL/models/99942_apophis/apophis.gltf"},dynamo:[{url:"99942_apophis/sun/orb"}],spin:{axis:new n.Vector3(.20112425201023415,.46925803805904115,.8598522715968735),periodInHours:30.4}},charon:{groups:["134340_pluto","moons","134340_pluto_barycenter"],radius:603.5,label:"Charon",parents:[[Number.NEGATIVE_INFINITY,"134340_pluto_barycenter"]],trail:{length:551857},spheroid:{equatorialRadius:603.5,polarRadius:603.5,planetographic:!1},spheroidLOD:{textures:{color:{url:"charon/color_$SIZE_$FACE.png",sizes:[4,512,2048]}}},dynamo:[{url:"charon/134340_pluto_barycenter/orb"}],align:{primary:{type:"point",axis:n.Vector3.XAxis,target:"134340_pluto"},secondary:{type:"velocity",axis:n.Vector3.YAxis,target:"134340_pluto"}}},dactyl:{groups:["243_ida","moons"],radius:.7,label:"Dactyl",parents:[[Number.NEGATIVE_INFINITY,"243_ida"]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[.8,.7,.6],rotate:[{z:90}]},align:{primary:{type:"point",axis:n.Vector3.XAxis,target:"243_ida"}},postCreateFunction:t=>{const e=t.addController("orbitalElements",void 0,t.getControllerByType("align")),i=new n.OrbitalElements;i.epoch=0,i.eccentricity=0,i.semiMajorAxis=90,i.meanAngularMotion=8726646e-11,i.meanAnomalyAtEpoch=0,i.orbitOrientation.set(.8728453580255966,.1876084386162498,-.08948587100888229,.4415159494547423),e.addOrbitalElements(-1e100,i),e.addOrbitalElements(1e100,i)}},dimorphos:{groups:["65803_didymos","moons"],radius:.085,label:"Dimorphos",parents:[[Number.NEGATIVE_INFINITY,"65803_didymos"]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/dimorphos/Dimorphos.gltf"},align:{primary:{type:"point",axis:n.Vector3.XAxis,target:"65803_didymos"},secondary:{type:"align",axis:n.Vector3.ZAxis,target:"65803_didymos",targetAxis:n.Vector3.ZAxis}},dynamo:[{url:"dimorphos/65803_didymos/orb"}]},hiiaka:{groups:["136108_haumea","moons"],radius:160,label:"Hi'iaka",parents:[[Number.NEGATIVE_INFINITY,"136108_haumea"]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[160,160,160]},align:{primary:{type:"point",axis:n.Vector3.XAxis,target:"136108_haumea"}},postCreateFunction:t=>{const e=t.addController("orbitalElements",void 0,t.getControllerByType("align")),i=new n.OrbitalElements;i.epoch=0,i.eccentricity=.0513,i.semiMajorAxis=49880,i.meanAngularMotion=148049e-11,i.meanAnomalyAtEpoch=0,i.setOrbitOrientationFromElements(2.20532822965,0,0),e.addOrbitalElements(-1e100,i),e.addOrbitalElements(1e100,i)}},hydra:{groups:["134340_pluto","moons","134340_pluto_barycenter"],radius:25,label:"Hydra",parents:[[Number.NEGATIVE_INFINITY,"134340_pluto_barycenter"]],trail:{length:3300633},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[25,25,25],shadowEntities:["134340_pluto"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"hydra/134340_pluto_barycenter/orb"}]},kerberos:{groups:["134340_pluto","moons","134340_pluto_barycenter"],radius:8.25,label:"Kerberos",parents:[[Number.NEGATIVE_INFINITY,"134340_pluto_barycenter"]],trail:{length:2779277},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[8.25,8.25,8.25],shadowEntities:["134340_pluto"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"kerberos/134340_pluto_barycenter/orb"}]},menoetius:{groups:["617_patroclus_barycenter","moons"],radius:58,label:"Menoetius",parents:[[Number.NEGATIVE_INFINITY,"617_patroclus_barycenter"]],trail:{length:183600},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[58,54,45],shadowEntities:["617_patroclus"]},align:{primary:{type:"point",axis:n.Vector3.XAxis,target:"617_patroclus"}},postCreateFunction:t=>{const e=t.addController("orbitalElements",void 0,t.getControllerByType("align")),i=new n.OrbitalElements;i.epoch=0,i.eccentricity=0,i.semiMajorAxis=664,i.meanAngularMotion=1697791e-11,i.meanAnomalyAtEpoch=0,i.setOrbitOrientationFromElements(1.97244894756,0,0),e.addOrbitalElements(-1e100,i),e.addOrbitalElements(1e100,i)}},namaka:{groups:["136108_haumea","moons"],radius:85,label:"Nāmaka",parents:[[Number.NEGATIVE_INFINITY,"136108_haumea"]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[85,85,85]},align:{primary:{type:"point",axis:n.Vector3.XAxis,target:"136108_haumea"}},postCreateFunction:t=>{const e=t.addController("orbitalElements",void 0,t.getControllerByType("align")),i=new n.OrbitalElements;i.epoch=0,i.eccentricity=.249,i.semiMajorAxis=25657,i.meanAngularMotion=39786e-10,i.meanAnomalyAtEpoch=0,i.setOrbitOrientationFromElements(1.97244894756,0,0),e.addOrbitalElements(-1e100,i),e.addOrbitalElements(1e100,i)}},nix:{groups:["134340_pluto","moons","134340_pluto_barycenter"],radius:24,label:"Nix",parents:[[Number.NEGATIVE_INFINITY,"134340_pluto_barycenter"]],trail:{length:2147440},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[24,24,24],shadowEntities:["134340_pluto"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"nix/134340_pluto_barycenter/orb"}]},styx:{groups:["134340_pluto","moons","134340_pluto_barycenter"],radius:5.5,label:"Styx",parents:[[Number.NEGATIVE_INFINITY,"134340_pluto_barycenter"]],trail:{length:1741958},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[5.5,5.5,5.5],shadowEntities:["134340_pluto"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"styx/134340_pluto_barycenter/orb"}]}});const r={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(128),n=i(240),r=i(2);s.default.register({"1p_halley":{groups:["comets"],radius:6,label:"Halley (1P/Halley)",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:2376918432},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[6,6,6]},comet:{},dynamo:[{url:"1p_halley/sun/orb"}],postCreateFunction:t=>{const e=t.addController("spin");e.setAxis(r.Vector3.ZAxis,!1),e.setRate(3356402e-11)}},"103p_hartley_2":{groups:["comets"],radius:2,label:"Hartley 2 (103P/Hartley)",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:203862096},model:{url:"$STATIC_ASSETS_URL/models/103p_hartley_2/hartley_2.gltf"},comet:{},dynamo:[{url:"103p_hartley_2/sun/orb"},{url:"103p_hartley_2/ori"}]},"9p_tempel_1":{groups:["comets"],radius:5,label:"Tempel 1 (9P/Tempel)",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:176091408},model:{url:"$STATIC_ASSETS_URL/models/9p_tempel_1/9p_tempel.gltf",rotate:[{y:90}]},comet:{},dynamo:[{url:"9p_tempel_1/sun/orb"},{url:"9p_tempel_1/ori"}]},"81p_wild_2":{groups:["comets"],radius:2.5,label:"Wild 2 (81P/Wild)",parents:[[Number.NEGATIVE_INFINITY,"sun"],[-800047271,"jupiter"],[-797029475,"sun"]],trail:{length:1356976800,lengthCoverages:[[1356976800,Number.NEGATIVE_INFINITY,-611927948.817],[189345600,-611927948.817,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[2.5,2.5,2.5]},comet:{},fixed:{orientation:r.Quaternion.Identity},dynamo:[{url:"81p_wild_2/sun/1/orb"},{url:"81p_wild_2/jupiter/orb"},{url:"81p_wild_2/sun/2/orb"}]},"67p_churyumov_gerasimenko":{groups:["comets"],radius:4.1,label:"Churyumov–Gerasimenko (67P/C-G)",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:203230944},model:{url:"$STATIC_ASSETS_URL/models/67p_churyumov_gerasimenko/67p_churyumov_gerasimenko.gltf",rotate:[{x:90}],scale:.00124},comet:{},dynamo:[{url:"67p_churyumov_gerasimenko/sun/orb"},{url:"67p_churyumov_gerasimenko/ori"}],postCreateFunction:t=>{t.setOrientation(new r.Quaternion(.26732846830704055,.017948528101847026,.22012096235022358,.9379552773483394));const e=t.get("dynamo");if(null!==e){const i=t.addController("spin",void 0,e);i.setAxis(new r.Vector3(.15191127889562422,.404099951782066,.9020123016422935),!1),i.setRate(.00014477940709946253)}n.EntityUtils.addGeyser(t,1,1,100,1,1,[1,-.25,1.2],[0,0,1]),n.EntityUtils.addGeyser(t,2,.5,100,1,1,[-1.2,-.25,.6],[.2,-.5,1]),n.EntityUtils.addGeyser(t,1,.07,100,1,10,[-1.2,.1,.6],[.2,-.5,1]),n.EntityUtils.addGeyser(t,1,1,100,1,1,[-.8,.75,1],[.2,.5,1]),n.EntityUtils.addGeyser(t,1,.5,100,1,1,[-.8,.35,-1],[.2,.25,-1])}},"19p_borrelly":{groups:["comets"],radius:2.4,label:"Borrelly (19P/Borrelly)",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:214591680},model:{url:"$STATIC_ASSETS_URL/models/19p_borrelly/borrelly.gltf"},comet:{},fixed:{orientation:r.Quaternion.Identity},dynamo:[{url:"19p_borrelly/sun/orb"}]},c_1995_o1:{groups:["comets"],radius:5,label:"Hale-Bopp (C/1995 O1)",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:8007741e4},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[5,5,5]},comet:{},dynamo:[{url:"c_1995_o1/sun/orb"}],postCreateFunction:t=>{const e=t.addController("spin");e.setAxis(r.Vector3.ZAxis,!1),e.setRate(.00014832826)}},c_2010_x1:{groups:["comets"],radius:5,label:"Elenin (C/2010 X1)",parents:[[Number.NEGATIVE_INFINITY,"sun"],[370699266.182,""]],trail:{length:631152e4},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[5,5,5]},comet:{},fixed:{orientation:r.Quaternion.Identity},dynamo:[{url:"c_2010_x1/sun/pos"}]},c_2012_s1:{groups:["comets"],radius:3,label:"ISON (C/2012 S1)",parents:[[Number.NEGATIVE_INFINITY,"sun"],[440596867.184,""]],trail:{length:631152e4},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[3,3,3]},comet:{},fixed:{orientation:r.Quaternion.Identity},dynamo:[{url:"c_2012_s1/sun/pos"}]},c_2013_a1:{groups:["comets"],radius:5,label:"Siding Spring (C/2013 A1)",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:631152e4},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[5,5,5]},comet:{},dynamo:[{url:"c_2013_a1/sun/pos"}],postCreateFunction:t=>{const e=t.addController("spin");e.setAxis(r.Vector3.ZAxis,!1),e.setRate(.00021816615)}},c_2019_y4:{groups:["comets"],radius:3,label:"ATLAS (C/2019 Y4)",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:631152e4},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[3,3,3]},comet:{},fixed:{orientation:r.Quaternion.Identity},dynamo:[{url:"c_2019_y4/sun/orb"}]},c_2020_f3:{groups:["comets"],radius:6,label:"NEOWISE (C/2020 F3)",parents:[[Number.NEGATIVE_INFINITY,"sun"]],trail:{length:2376918432},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[6,6,6]},comet:{},dynamo:[{url:"c_2020_f3/sun/orb"}],postCreateFunction:t=>{const e=t.addController("spin");e.setAxis(r.Vector3.ZAxis,!1),e.setRate(.00023025451)}}});const o={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{EntityUtils:()=>EntityUtils});var s=i(2);class EntityUtils{static addGeyser(t,e,i,n,r,o,a,l){const h=t.addComponent("particleSpray");h.setNumberOfParticles(n),h.setSizeOfParticles(.25*e*o),h.setSpeedOfParticles(r*e),h.setColorOfParticles(new s.Color(1,1,1,.5*i)),h.setSpread(1*o),h.setParticleSpacingRandom(!1),h.setLength(2.5*e),h.setOriginOffset(new s.Vector3(a[0],a[1],a[2])),h.setDirection(new s.Vector3(l[0],l[1],l[2]))}static showSubObjectDuringInterval(t,e,i,n){t.getComponentByType("model").setHiddenObject(e,!0);t.addController("coverage").addCoverage(new s.Interval(i,n),(t=>{t.getComponentByType("model").setHiddenObject(e,!1)}),(t=>{t.getComponentByType("model").setHiddenObject(e,!0)}))}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s}),i(128).default.register({moon:{groups:["earth","moons"],radius:1738.1,label:"Moon",parents:[[Number.NEGATIVE_INFINITY,"earth"]],trail:{length:2360590,color:[0,.6,.8,.7]},spheroid:{equatorialRadius:1738.1,polarRadius:1735.97,planetographic:!0},spheroidLOD:{features:["normalMap","shadowEntities"],textures:{color:{url:"moon/color_$SIZE_$FACE.png",sizes:[16,512,4096]},normal:{url:"moon/normal_$SIZE_$FACE.png",sizes:[16,512,2048]}},shadowEntities:["earth"]},dynamo:[{url:"moon/earth/orb"},{url:"moon/ori"}]}});const s={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s}),i(128).default.register({adrastea:{groups:["jupiter","moons","amalthea","inner","regular"],radius:8.2,label:"Adrastea",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:25770,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[8.2,8.2,8.2],shadowEntities:["jupiter"]},dynamo:[{url:"adrastea/jupiter/orb"},{url:"adrastea/ori"}]},amalthea:{groups:["jupiter","moons","amalthea","inner","regular"],radius:83.5,label:"Amalthea",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:43043,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[83.5,83.5,83.5],shadowEntities:["jupiter"]},dynamo:[{url:"amalthea/jupiter/orb"},{url:"amalthea/ori"}]},callisto:{groups:["jupiter","moons","main","galilean","regular"],radius:2410.3,label:"Callisto",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:1441931,color:[.95,.71,.64,.7]},spheroid:{equatorialRadius:2410.3,polarRadius:2410.3,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"callisto/color_$SIZE_$FACE.png",sizes:[4,512]}},shadowEntities:["jupiter","io","europa","ganymede"]},dynamo:[{url:"callisto/jupiter/orb"},{url:"callisto/ori"}]},europa:{groups:["jupiter","moons","main","galilean","regular"],radius:1569,label:"Europa",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:306822,color:[.95,.71,.64,.7]},spheroid:{equatorialRadius:1569,polarRadius:1569,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"europa/color_$SIZE_$FACE.png",sizes:[4,512,1024]}},shadowEntities:["jupiter","io","callisto","ganymede"]},dynamo:[{url:"europa/jupiter/orb"},{url:"europa/ori"}]},ganymede:{groups:["jupiter","moons","main","galilean","regular"],radius:2634.1,label:"Ganymede",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:618153,color:[.95,.71,.64,.7]},spheroid:{equatorialRadius:2634.1,polarRadius:2634.1,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"ganymede/color_$SIZE_$FACE.png",sizes:[4,512]}},shadowEntities:["jupiter","io","europa","callisto"]},dynamo:[{url:"ganymede/jupiter/orb"},{url:"ganymede/ori"}]},io:{groups:["jupiter","moons","main","galilean","regular"],radius:1821.3,label:"Io",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:152853,color:[.95,.71,.64,.7]},spheroid:{equatorialRadius:1821.3,polarRadius:1821.3,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"io/color_$SIZE_$FACE.png",sizes:[4,512,1024]}},shadowEntities:["jupiter","europa","ganymede","callisto"]},dynamo:[{url:"io/jupiter/orb"},{url:"io/ori"}]},metis:{groups:["jupiter","moons","amalthea","inner","regular"],radius:21.5,label:"Metis",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:25469,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[21.5,21.5,21.5],shadowEntities:["jupiter"]},dynamo:[{url:"metis/jupiter/orb"},{url:"metis/ori"}]},thebe:{groups:["jupiter","moons","amalthea","inner","regular"],radius:49,label:"Thebe",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:58277,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[49,49,49],shadowEntities:["jupiter"]},dynamo:[{url:"thebe/jupiter/orb"},{url:"thebe/ori"}]}});const s={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(128),n=i(2);s.default.register({aitne:{groups:["jupiter","moons","irregular","carme"],radius:1.5,label:"Aitne",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:58720896,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[1.5,1.5,1.5],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"aitne/jupiter/orb"}]},ananke:{groups:["jupiter","moons","irregular","ananke"],radius:14,label:"Ananke",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:152850,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[14,14,14],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"ananke/jupiter/orb"}]},aoede:{groups:["jupiter","moons","irregular","pasiphae"],radius:2,label:"Aoede",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:306823,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[2,2,2],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"aoede/jupiter/orb"}]},arche:{groups:["jupiter","moons","irregular","carme"],radius:1.5,label:"Arche",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:618157,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[1.5,1.5,1.5],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"arche/jupiter/orb"}]},autonoe:{groups:["jupiter","moons","irregular","pasiphae"],radius:2,label:"Autonoe",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:1441929,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[2,2,2],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"autonoe/jupiter/orb"}]},callirrhoe:{groups:["jupiter","moons","irregular","pasiphae"],radius:4.3,label:"Callirrhoe",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:62822304,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[4.3,4.3,4.3],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"callirrhoe/jupiter/orb"}]},carme:{groups:["jupiter","moons","irregular","carme"],radius:23,label:"Carme",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:66005280,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[23,23,23],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"carme/jupiter/orb"}]},carpo:{groups:["jupiter","moons","irregular"],radius:1.5,label:"Carpo",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:39624768,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[1.5,1.5,1.5],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"carpo/jupiter/orb"}]},chaldene:{groups:["jupiter","moons","irregular","carme"],radius:1.9,label:"Chaldene",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:60422112,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[1.9,1.9,1.9],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"chaldene/jupiter/orb"}]},cyllene:{groups:["jupiter","moons","irregular","pasiphae"],radius:1,label:"Cyllene",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:63167040,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[1,1,1],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"cyllene/jupiter/orb"}]},dia:{groups:["jupiter","moons","irregular","himalia"],radius:2,label:"Dia",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:61516800,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:2,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"dia/jupiter/orb"}]},eirene:{groups:["jupiter","moons","irregular","carme"],radius:2,label:"Eirene",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:65359008,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:2,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"eirene/jupiter/orb"}]},elara:{groups:["jupiter","moons","irregular","himalia"],radius:43,label:"Elara",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:22258368,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[43,43,43],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"elara/jupiter/orb"}]},erinome:{groups:["jupiter","moons","irregular","carme"],radius:1.6,label:"Erinome",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:61513344,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[1.6,1.6,1.6],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"erinome/jupiter/orb"}]},ersa:{groups:["jupiter","moons","irregular","himalia"],radius:1.5,label:"Ersa",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:21339936,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:1.5,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"ersa/jupiter/orb"}]},euanthe:{groups:["jupiter","moons","irregular","ananke"],radius:1.5,label:"Euanthe",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:51674976,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[1.5,1.5,1.5],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"euanthe/jupiter/orb"}]},eukelade:{groups:["jupiter","moons","irregular","carme"],radius:2,label:"Eukelade",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:63521280,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[2,2,2],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"eukelade/jupiter/orb"}]},eupheme:{groups:["jupiter","moons","irregular","ananke"],radius:1,label:"Eupheme",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:50397984,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"eupheme/jupiter/orb"}]},euporie:{groups:["jupiter","moons","irregular","ananke"],radius:1,label:"Euporie",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:46550592,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[1,1,1],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"euporie/jupiter/orb"}]},eurydome:{groups:["jupiter","moons","irregular","pasiphae"],radius:1.5,label:"Eurydome",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:62498304,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[1.5,1.5,1.5],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"eurydome/jupiter/orb"}]},harpalyke:{groups:["jupiter","moons","irregular","ananke"],radius:2.2,label:"Harpalyke",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:53960256,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[2.2,2.2,2.2],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"harpalyke/jupiter/orb"}]},hegemone:{groups:["jupiter","moons","irregular","pasiphae"],radius:1.5,label:"Hegemone",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:64411200,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[1.5,1.5,1.5],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"hegemone/jupiter/orb"}]},helike:{groups:["jupiter","moons","irregular","ananke"],radius:2,label:"Helike",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:51960960,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[2,2,2],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"helike/jupiter/orb"}]},hermippe:{groups:["jupiter","moons","irregular","ananke"],radius:2,label:"Hermippe",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:54415584,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[2,2,2],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"hermippe/jupiter/orb"}]},herse:{groups:["jupiter","moons","irregular","carme"],radius:1,label:"Herse",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:58125600,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[1,1,1],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"herse/jupiter/orb"}]},himalia:{groups:["jupiter","moons","irregular","himalia"],radius:85,label:"Himalia",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:21619872,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[85,85,85],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"himalia/jupiter/orb"}]},iocaste:{groups:["jupiter","moons","irregular","ananke"],radius:2.6,label:"Iocaste",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:52654752,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[2.6,2.6,2.6],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"iocaste/jupiter/orb"}]},isonoe:{groups:["jupiter","moons","irregular","carme"],radius:1.9,label:"Isonoe",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:64811232,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[1.9,1.9,1.9],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"isonoe/jupiter/orb"}]},jupiter_li:{groups:["jupiter","moons","irregular","carme"],radius:1,label:"Jupiter LI",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:61516800,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_li/jupiter/orb"}]},jupiter_lii:{groups:["jupiter","moons","irregular","ananke"],radius:.5,label:"Jupiter LII",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:51568704,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:.5,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lii/jupiter/orb"}]},jupiter_liv:{groups:["jupiter","moons","irregular","ananke"],radius:.5,label:"Jupiter LIV",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:51568704,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:.5,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_liv/jupiter/orb"}]},jupiter_lv:{groups:["jupiter","moons","irregular","ananke"],radius:1,label:"Jupiter LV",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:51236064,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lv/jupiter/orb"}]},jupiter_lvi:{groups:["jupiter","moons","irregular","pasiphae"],radius:.5,label:"Jupiter LVI",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:66098592,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:.5,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lvi/jupiter/orb"}]},jupiter_lix:{groups:["jupiter","moons","irregular","pasiphae"],radius:1,label:"Jupiter LIX",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:64619424,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lix/jupiter/orb"}]},jupiter_lxi:{groups:["jupiter","moons","irregular","carme"],radius:1,label:"Jupiter LXI",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:60577632,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lxi/jupiter/orb"}]},jupiter_lxiii:{groups:["jupiter","moons","irregular","carme"],radius:1,label:"Jupiter LXIII",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:59464800,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lxiii/jupiter/orb"}]},jupiter_lxiv:{groups:["jupiter","moons","irregular","ananke"],radius:1,label:"Jupiter LXIV",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:53626752,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lxiv/jupiter/orb"}]},jupiter_lxvi:{groups:["jupiter","moons","irregular","carme"],radius:1,label:"Jupiter LXVI",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:62989920,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lxvi/jupiter/orb"}]},jupiter_lxvii:{groups:["jupiter","moons","irregular","pasiphae"],radius:1,label:"Jupiter LXVII",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:59746464,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lxvii/jupiter/orb"}]},jupiter_lxviii:{groups:["jupiter","moons","irregular","ananke"],radius:1,label:"Jupiter LXVIII",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:52188192,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lxviii/jupiter/orb"}]},jupiter_lxix:{groups:["jupiter","moons","irregular","carme"],radius:.5,label:"Jupiter LXIX",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:62267616,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:.5,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lxix/jupiter/orb"}]},jupiter_lxx:{groups:["jupiter","moons","irregular","ananke"],radius:1.5,label:"Jupiter LXX",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:55617408,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1.5,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lxx/jupiter/orb"}]},jupiter_lxxii:{groups:["jupiter","moons","irregular","ananke"],radius:1,label:"Jupiter LXXII",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:55617408,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jupiter_lxxii/jupiter/orb"}]},kale:{groups:["jupiter","moons","irregular","carme"],radius:1,label:"Kale",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:59211648,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[1,1,1],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"kale/jupiter/orb"}]},kallichore:{groups:["jupiter","moons","irregular","carme"],radius:1,label:"Kallichore",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:62018784,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[1,1,1],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"kallichore/jupiter/orb"}]},kalyke:{groups:["jupiter","moons","irregular","carme"],radius:2.6,label:"Kalyke",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:62296128,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[2.6,2.6,2.6],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"kalyke/jupiter/orb"}]},kore:{groups:["jupiter","moons","irregular","pasiphae"],radius:1,label:"Kore",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:67048128,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[1,1,1],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"kore/jupiter/orb"}]},leda:{groups:["jupiter","moons","irregular","himalia"],radius:10,label:"Leda",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:20806848,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[10,10,10],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"leda/jupiter/orb"}]},lysithea:{groups:["jupiter","moons","irregular","himalia"],radius:18,label:"Lysithea",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:22454496,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[18,18,18],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"lysithea/jupiter/orb"}]},megaclite:{groups:["jupiter","moons","irregular","pasiphae"],radius:2.7,label:"Megaclite",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:68466816,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[2.7,2.7,2.7],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"megaclite/jupiter/orb"}]},mneme:{groups:["jupiter","moons","irregular","ananke"],radius:1,label:"Mneme",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:54214272,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[1,1,1],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"mneme/jupiter/orb"}]},orthosie:{groups:["jupiter","moons","irregular","ananke"],radius:1,label:"Orthosie",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:52066368,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[1,1,1],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"orthosie/jupiter/orb"}]},pandia:{groups:["jupiter","moons","irregular","himalia"],radius:1.5,label:"Pandia",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:21661344,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:1.5,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"pandia/jupiter/orb"}]},pasiphae:{groups:["jupiter","moons","irregular","pasiphae"],radius:30,label:"Pasiphae",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:63918720,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[30,30,30],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"pasiphae/jupiter/orb"}]},pasithee:{groups:["jupiter","moons","irregular","carme"],radius:1,label:"Pasithee",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:62806752,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[1,1,1],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"pasithee/jupiter/orb"}]},philophrosyne:{groups:["jupiter","moons","irregular","pasiphae"],radius:1,label:"Philophrosyne",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:61327584,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"philophrosyne/jupiter/orb"}]},praxidike:{groups:["jupiter","moons","irregular","ananke"],radius:3.4,label:"Praxidike",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:53040960,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[3.4,3.4,3.4],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"praxidike/jupiter/orb"}]},s_2003_j_2:{groups:["jupiter","moons","irregular","ananke"],radius:1,label:"S/2003 J 2",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:52014528,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2003_j_2/jupiter/orb"}]},s_2003_j_4:{groups:["jupiter","moons","irregular","pasiphae"],radius:1,label:"S/2003 J 4",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:57788640,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2003_j_4/jupiter/orb"}]},s_2003_j_9:{groups:["jupiter","moons","irregular","carme"],radius:.5,label:"S/2003 J 9",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:66320640,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:.5,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2003_j_9/jupiter/orb"}]},s_2003_j_10:{groups:["jupiter","moons","irregular","carme"],radius:1,label:"S/2003 J 10",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:61152192,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2003_j_10/jupiter/orb"}]},s_2003_j_12:{groups:["jupiter","moons","irregular","ananke"],radius:.5,label:"S/2003 J 12",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:55869696,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:.5,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2003_j_12/jupiter/orb"}]},s_2003_j_16:{groups:["jupiter","moons","irregular","ananke"],radius:1,label:"S/2003 J 16",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:51855552,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2003_j_16/jupiter/orb"}]},s_2003_j_23:{groups:["jupiter","moons","irregular","pasiphae"],radius:1,label:"S/2003 J 23",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:68428800,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2003_j_23/jupiter/orb"}]},sinope:{groups:["jupiter","moons","irregular","pasiphae"],radius:19,label:"Sinope",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:63878112,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[19,19,19],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"sinope/jupiter/orb"}]},sponde:{groups:["jupiter","moons","irregular","pasiphae"],radius:1,label:"Sponde",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:66666240,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[1,1,1],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"sponde/jupiter/orb"}]},taygete:{groups:["jupiter","moons","irregular","carme"],radius:2.5,label:"Taygete",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:59328288,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[2.5,2.5,2.5],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"taygete/jupiter/orb"}]},thelxinoe:{groups:["jupiter","moons","irregular","ananke"],radius:1,label:"Thelxinoe",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:51633504,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[1,1,1],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"thelxinoe/jupiter/orb"}]},themisto:{groups:["jupiter","moons","irregular"],radius:4,label:"Themisto",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:11220768,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[4,4,4],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"themisto/jupiter/orb"}]},thyone:{groups:["jupiter","moons","irregular","ananke"],radius:2,label:"Thyone",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:55278720,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[2,2,2],shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"thyone/jupiter/orb"}]},valetudo:{groups:["jupiter","moons","irregular"],radius:.5,label:"Valetudo",parents:[[Number.NEGATIVE_INFINITY,"jupiter"]],trail:{length:45568224,color:[.95,.71,.64,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:.5,shadowEntities:["jupiter"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"valetudo/jupiter/orb"}]}});const r={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s}),i(128).default.register({phobos:{groups:["mars","moons"],radius:14,label:"Phobos",parents:[[Number.NEGATIVE_INFINITY,"mars"]],trail:{length:27554,color:[.89,.51,.35,.7]},model:{url:"$STATIC_ASSETS_URL/models/phobos/phobos.gltf",scale:[1,1,1],rotate:[{z:90},{y:90}],shadowEntities:["mars"]},dynamo:[{url:"phobos/mars/orb"},{url:"phobos/ori"}]},deimos:{groups:["mars","moons"],radius:8.70951,label:"Deimos",parents:[[Number.NEGATIVE_INFINITY,"mars"]],trail:{length:109123,color:[.89,.51,.35,.7]},model:{url:"$STATIC_ASSETS_URL/models/deimos/deimos.gltf",scale:[1,1,1],rotate:[{y:-180}],shadowEntities:["mars"]},dynamo:[{url:"deimos/mars/orb"},{url:"deimos/ori"}]}});const s={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(128),n=i(2);s.default.register({despina:{groups:["neptune","moons","regular"],radius:90,label:"Despina",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:28909,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[90,90,90],shadowEntities:["neptune"]},dynamo:[{url:"despina/neptune/orb"},{url:"despina/ori"}]},galatea:{groups:["neptune","moons","regular"],radius:102,label:"Galatea",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:37039,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[102,102,102],shadowEntities:["neptune"]},dynamo:[{url:"galatea/neptune/orb"},{url:"galatea/ori"}]},halimede:{groups:["neptune","moons","irregular"],radius:31,label:"Halimede",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:162352512,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[31,31,31],shadowEntities:["neptune"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"halimede/neptune/orb"}]},hippocamp:{groups:["neptune","moons","regular"],radius:17.4,label:"Hippocamp",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:80870,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[17.4,17.4,17.4],shadowEntities:["neptune"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"hippocamp/neptune/orb"}]},laomedeia:{groups:["neptune","moons","irregular"],radius:21,label:"Laomedeia",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:274002912,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[21,21,21],shadowEntities:["neptune"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"laomedeia/neptune/orb"}]},larissa:{groups:["neptune","moons","regular"],radius:108,label:"Larissa",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:47995,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[108,108,108],shadowEntities:["neptune"]},dynamo:[{url:"larissa/neptune/orb"},{url:"larissa/ori"}]},naiad:{groups:["neptune","moons","regular"],radius:48,label:"Naiad",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:25436,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[48,48,48],shadowEntities:["neptune"]},dynamo:[{url:"naiad/neptune/orb"},{url:"naiad/ori"}]},nereid:{groups:["neptune","moons","irregular"],radius:170,label:"Nereid",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:31115768,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[170,170,170],shadowEntities:["neptune"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"nereid/neptune/orb"}]},neso:{groups:["neptune","moons","irregular"],radius:30,label:"Neso",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:841599072,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[30,30,30],shadowEntities:["neptune"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"neso/neptune/orb"}]},proteus:{groups:["neptune","moons","regular"],radius:232.5,label:"Proteus",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:96940,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/proteus/proteus.gltf",scale:[1,1,1]},dynamo:[{url:"proteus/neptune/orb"},{url:"proteus/ori"}]},psamathe:{groups:["neptune","moons","irregular"],radius:20,label:"Psamathe",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:784019520,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[20,20,20],shadowEntities:["neptune"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"psamathe/neptune/orb"}]},sao:{groups:["neptune","moons","irregular"],radius:22,label:"Sao",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:251659008,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[22,22,22],shadowEntities:["neptune"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"sao/neptune/orb"}]},thalassa:{groups:["neptune","moons","regular"],radius:54,label:"Thalassa",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:26913,color:[.48,.69,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[54,54,54],shadowEntities:["neptune"]},dynamo:[{url:"thalassa/neptune/orb"},{url:"thalassa/ori"}]},triton:{groups:["neptune","moons","irregular"],radius:1353.4,label:"Triton",parents:[[Number.NEGATIVE_INFINITY,"neptune"]],trail:{length:507760,color:[.48,.69,1,.7]},spheroid:{equatorialRadius:1353.4,polarRadius:1353.4,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"triton/color_$SIZE_$FACE.jpg",sizes:[16,512,4096]}},shadowEntities:["neptune"]},dynamo:[{url:"triton/neptune/orb"},{url:"triton/ori"}]}});const r={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(128),n=i(240),r=i(2);s.default.register({dione:{groups:["saturn","moons","inner","major"],radius:561.7,label:"Dione",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:236469,color:[.72,.65,.52,.7]},spheroid:{equatorialRadius:561.7,polarRadius:561.7,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"dione/color_$SIZE_$FACE.png",sizes:[4,512,2048]}},shadowEntities:["saturn"]},dynamo:[{url:"dione/saturn/orb"},{url:"dione/ori"}]},enceladus:{groups:["saturn","moons","inner","major"],radius:252.1,label:"Enceladus",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:118387,color:[.72,.65,.52,.7]},spheroid:{equatorialRadius:252.1,polarRadius:252.1,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"enceladus/color_$SIZE_$FACE.png",sizes:[4,512,2048]}},shadowEntities:["saturn"]},dynamo:[{url:"enceladus/saturn/orb"},{url:"enceladus/ori"}],postCreateFunction:t=>{n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[-20.16,.8*-69.23,.8*-240.99],[-.0999,-.2747,-.9563]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[-49.384,.8*-24.61,.8*-243.08],[-.2449,-.0976,-.9646]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[.8*-35.82,-37.496,-196],[-.1421,-.1859,-.9722]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[21.259,.7*-17.54,-174.685],[.1205,-.0696,-.9902]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[0,1.54,-176.393],[0,.0087,-.9999]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[-21.658,21.658,-173.719],[-.1227,.1227,-.9848]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[32.193,.7*-34.55,.7*-245.35],[.1824,-.1371,-.9736]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[-46.719,.68*.9,-221.931],[-.2059,.0026,-.9785]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[.9*-31.81,-12.024,-224.667],[-.1262,-.053,-.9905]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[.9*-5.49,-26.793,-225.162],[-.0217,-.1181,-.9927]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[14.886,-42.39,-222.309],[.0656,-.1869,-.9801]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[-13.176,48.112,-195.328],[-.0653,.2386,-.9689]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[51.52*.8,19.176,.8*-245.51],[.2044,.0951,-.9742]),n.EntityUtils.addGeyser(t,100,.1,20,.002,4,[22.504,33.52*.8,-198.536],[.1116,.133,-.9848])}},hyperion:{groups:["saturn","moons","outer","major"],radius:135,label:"Hyperion",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:1838299,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/hyperion/hyperion.gltf",scale:[1,1,1]},fixed:{orientation:r.Quaternion.Identity},dynamo:[{url:"hyperion/saturn/orb"}]},iapetus:{groups:["saturn","moons","outer","major"],radius:735.6,label:"Iapetus",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:6853378,color:[.72,.65,.52,.7]},spheroid:{equatorialRadius:735.6,polarRadius:735.6,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"iapetus/color_$SIZE_$FACE.png",sizes:[4,512,2048]}},shadowEntities:["saturn"]},dynamo:[{url:"iapetus/saturn/orb"},{url:"iapetus/ori"}]},mimas:{groups:["saturn","moons","inner","major"],radius:198.3,label:"Mimas",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:81389,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/mimas/mimas.gltf",scale:[1,1,1]},dynamo:[{url:"mimas/saturn/orb"},{url:"mimas/ori"}]},rhea:{groups:["saturn","moons","outer","major"],radius:764.3,label:"Rhea",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:390374,color:[.72,.65,.52,.7]},spheroid:{equatorialRadius:764.3,polarRadius:764.3,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"rhea/color_$SIZE_$FACE.png",sizes:[4,512,2048]}},shadowEntities:["saturn"]},dynamo:[{url:"rhea/saturn/orb"},{url:"rhea/ori"}]},tethys:{groups:["saturn","moons","inner","major"],radius:538.4,label:"Tethys",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:163106,color:[.72,.65,.52,.7]},spheroid:{equatorialRadius:538.4,polarRadius:527.5,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"tethys/color_$SIZE_$FACE.png",sizes:[4,512,2048]}},shadowEntities:["saturn"]},dynamo:[{url:"tethys/saturn/orb"},{url:"tethys/ori"}]},titan:{groups:["saturn","moons","outer","major"],radius:2575,label:"Titan",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:1377648,color:[.72,.65,.52,.7]},spheroid:{equatorialRadius:2575,polarRadius:2575,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"titan/color_$SIZE_$FACE.png",sizes:[4,512,1024]}},shadowEntities:["saturn"]},dynamo:[{url:"titan/saturn/orb"},{url:"titan/ori"}],postCreateFunction:t=>{const e=t.addComponent("atmosphere");e.setScaleHeight(75),e.setDensity(5e-4),e.setColor(new r.Color(179/255,145/255,53/255)),e.setSunsetColor(new r.Color(49/255,103/255,.8)),e.setSunsetIntensity(1.2)}}});const o={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(128),n=i(2);s.default.register({aegaeon:{groups:["saturn","moons","minor","ring moonlet"],radius:.12,label:"Aegaeon",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:69822,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.12,.12,.12],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"aegaeon/saturn/orb"}]},aegir:{groups:["saturn","moons","minor","norse"],radius:3,label:"Aegir",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:94561344,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"aegir/saturn/orb"}]},albiorix:{groups:["saturn","moons","minor","gallic"],radius:16,label:"Albiorix",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:66923712,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[16,16,16],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"albiorix/saturn/orb"}]},anthe:{groups:["saturn","moons","minor","alkyonides"],radius:.9,label:"Anthe",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:90797,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[.9,.9,.9],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"anthe/saturn/orb"}]},atlas:{groups:["saturn","moons","minor","ring shepherd"],radius:15.1,label:"Atlas",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:51986,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[15.1,15.1,15.1],shadowEntities:["saturn"]},dynamo:[{url:"atlas/saturn/orb"},{url:"atlas/ori"}]},bebhionn:{groups:["saturn","moons","minor","gallic"],radius:3,label:"Bebhionn",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:72469728,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"bebhionn/saturn/orb"}]},bergelmir:{groups:["saturn","moons","minor","norse"],radius:3,label:"Bergelmir",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:85175712,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"bergelmir/saturn/orb"}]},bestla:{groups:["saturn","moons","minor","norse"],radius:3.5,label:"Bestla",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:95165280,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[3.5,3.5,3.5],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"bestla/saturn/orb"}]},calypso:{groups:["saturn","moons","minor","trojan"],radius:10.7,label:"Calypso",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:163106,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[10.7,10.7,10.7],shadowEntities:["saturn"]},dynamo:[{url:"calypso/saturn/orb"},{url:"calypso/ori"}]},daphnis:{groups:["saturn","moons","minor","ring shepherd"],radius:3.8,label:"Daphnis",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:51328,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[3.8,3.8,3.8],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"daphnis/saturn/orb"}]},epimetheus:{groups:["saturn","moons","minor","co-orbital"],radius:58.1,label:"Epimetheus",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:59990,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[58.1,58.1,58.1],shadowEntities:["saturn"]},dynamo:[{url:"epimetheus/saturn/orb"},{url:"epimetheus/ori"}]},erriapus:{groups:["saturn","moons","minor","gallic"],radius:5,label:"Erriapus",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:72998496,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[5,5,5],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"erriapus/saturn/orb"}]},farbauti:{groups:["saturn","moons","minor","norse"],radius:2.5,label:"Farbauti",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:91132992,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[2.5,2.5,2.5],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"farbauti/saturn/orb"}]},fenrir:{groups:["saturn","moons","minor","norse"],radius:2,label:"Fenrir",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:104762592,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[2,2,2],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"fenrir/saturn/orb"}]},fornjot:{groups:["saturn","moons","minor","norse"],radius:3,label:"Fornjot",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:123738624,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"fornjot/saturn/orb"}]},greip:{groups:["saturn","moons","minor","norse"],radius:3,label:"Greip",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:78326784,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"greip/saturn/orb"}]},hati:{groups:["saturn","moons","minor","norse"],radius:3,label:"Hati",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:89255520,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"hati/saturn/orb"}]},helene:{groups:["saturn","moons","minor","trojan"],radius:17.6,label:"Helene",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:236469,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[17.6,17.6,17.6],shadowEntities:["saturn"]},dynamo:[{url:"helene/saturn/orb"},{url:"helene/ori"}]},hyrrokkin:{groups:["saturn","moons","minor","norse"],radius:3,label:"Hyrrokkin",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:78994656,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"hyrrokkin/saturn/orb"}]},ijiraq:{groups:["saturn","moons","minor","inuit"],radius:6,label:"Ijiraq",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:39032928,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[6,6,6],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"ijiraq/saturn/orb"}]},janus:{groups:["saturn","moons","minor","co-orbital"],radius:89.5,label:"Janus",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:60019,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[89.5,89.5,89.5],shadowEntities:["saturn"]},dynamo:[{url:"janus/saturn/orb"},{url:"janus/ori"}]},jarnsaxa:{groups:["saturn","moons","minor","norse"],radius:3,label:"Jarnsaxa",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:81542592,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"jarnsaxa/saturn/orb"}]},kari:{groups:["saturn","moons","minor","norse"],radius:3,label:"Kari",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:107573184,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"kari/saturn/orb"}]},kiviuq:{groups:["saturn","moons","minor","inuit"],radius:8,label:"Kiviuq",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:38721024,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[8,8,8],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"kiviuq/saturn/orb"}]},loge:{groups:["saturn","moons","minor","norse"],radius:3,label:"Loge",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:112402080,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"loge/saturn/orb"}]},methone:{groups:["saturn","moons","minor","alkyonides"],radius:1.6,label:"Methone",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:87227,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[1.6,1.6,1.6],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"methone/saturn/orb"}]},mundilfari:{groups:["saturn","moons","minor","norse"],radius:3.5,label:"Mundilfari",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:82658880,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[3.5,3.5,3.5],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"mundilfari/saturn/orb"}]},narvi:{groups:["saturn","moons","minor","norse"],radius:3.5,label:"Narvi",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:87130080,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[3.5,3.5,3.5],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"narvi/saturn/orb"}]},paaliaq:{groups:["saturn","moons","minor","inuit"],radius:11,label:"Paaliaq",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:59873472,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[11,11,11],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"paaliaq/saturn/orb"}]},pallene:{groups:["saturn","moons","minor","alkyonides"],radius:2.5,label:"Pallene",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:99684,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[2.5,2.5,2.5],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"pallene/saturn/orb"}]},pan:{groups:["saturn","moons","minor","ring shepherd"],radius:14.1,label:"Pan",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:49684,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[14.1,14.1,14.1],shadowEntities:["saturn"]},dynamo:[{url:"pan/saturn/orb"},{url:"pan/ori"}]},pandora:{groups:["saturn","moons","minor","ring shepherd"],radius:40.7,label:"Pandora",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:54302,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[40.7,40.7,40.7],shadowEntities:["saturn"]},dynamo:[{url:"pandora/saturn/orb"},{url:"pandora/ori"}]},phoebe:{groups:["saturn","moons","minor","norse"],radius:106.5,label:"Phoebe",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:47095776,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/phoebe/phoebe.gltf"},dynamo:[{url:"phoebe/saturn/orb"},{url:"phoebe/ori"}]},polydeuces:{groups:["saturn","moons","minor","trojan"],radius:1.3,label:"Polydeuces",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:236469,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[1.3,1.3,1.3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"polydeuces/saturn/orb"}]},prometheus:{groups:["saturn","moons","minor","ring shepherd"],radius:43.1,label:"Prometheus",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:52962,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[43.1,43.1,43.1],shadowEntities:["saturn"]},dynamo:[{url:"prometheus/saturn/orb"},{url:"prometheus/ori"}]},s_2004_s_7:{groups:["saturn","moons","minor","norse"],radius:3,label:"S/2004 S 7",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:94270176,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:3,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2004_s_7/saturn/orb"}]},s_2004_s_12:{groups:["saturn","moons","minor","norse"],radius:2.5,label:"S/2004 S 12",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:89439552,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2.5,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2004_s_12/saturn/orb"}]},s_2004_s_13:{groups:["saturn","moons","minor","norse"],radius:3,label:"S/2004 S 13",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:81792288,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:3,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2004_s_13/saturn/orb"}]},s_2004_s_17:{groups:["saturn","moons","minor","norse"],radius:2,label:"S/2004 S 17",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:88339680,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2004_s_17/saturn/orb"}]},s_2004_s_21:{groups:["saturn","moons","minor","norse"],radius:1.5,label:"S/2004 S 21",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:115141824,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1.5,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2004_s_21/saturn/orb"}]},s_2004_s_24:{groups:["saturn","moons","minor","gallic"],radius:1.5,label:"S/2004 S 24",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:114920640,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1.5,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2004_s_24/saturn/orb"}]},s_2004_s_28:{groups:["saturn","moons","minor","norse"],radius:2,label:"S/2004 S 28",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:106225344,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2004_s_28/saturn/orb"}]},s_2004_s_31:{groups:["saturn","moons","minor","inuit"],radius:2,label:"S/2004 S 31",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:74354112,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2004_s_31/saturn/orb"}]},s_2004_s_36:{groups:["saturn","moons","minor","norse"],radius:1.5,label:"S/2004 S 36",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:116774784,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1.5,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2004_s_36/saturn/orb"}]},s_2004_s_37:{groups:["saturn","moons","minor","norse"],radius:2,label:"S/2004 S 37",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:64200384,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2004_s_37/saturn/orb"}]},s_2004_s_39:{groups:["saturn","moons","minor","norse"],radius:1.5,label:"S/2004 S 39",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:115937568,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1.5,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2004_s_39/saturn/orb"}]},s_2006_s_1:{groups:["saturn","moons","minor","norse"],radius:2.5,label:"S/2006 S 1",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:83414016,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2.5,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2006_s_1/saturn/orb"}]},s_2006_s_3:{groups:["saturn","moons","minor","norse"],radius:3,label:"S/2006 S 3",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:102453984,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:3,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2006_s_3/saturn/orb"}]},s_2007_s_2:{groups:["saturn","moons","minor","norse"],radius:3,label:"S/2007 S 2",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:65109312,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:3,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2007_s_2/saturn/orb"}]},s_2007_s_3:{groups:["saturn","moons","minor","norse"],radius:2.5,label:"S/2007 S 3",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:85440096,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2.5,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2007_s_3/saturn/orb"}]},s_2009_s_1:{groups:["saturn","moons","propeller moonlet"],radius:.15,label:"S/2009 S 1",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:40608,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:.15,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},postCreateFunction:t=>{const e=t.addController("orbitalElements",void 0,t.getControllerByType("align")),i=new n.OrbitalElements;i.epoch=0,i.eccentricity=0,i.semiMajorAxis=117e3,i.meanAngularMotion=.00015472777,i.meanAnomalyAtEpoch=-1.5,i.orbitOrientation.set(-.9397445462795919,.02005900203250964,-.052689008288728606,-.33719681579275607),e.addOrbitalElements(-1e100,i),e.addOrbitalElements(1e100,i)}},s_2019_s_1:{groups:["saturn","moons","minor","inuit"],radius:3,label:"S/2019 S 1",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:38342592,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:3,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"s_2019_s_1/saturn/orb"}]},saturn_liv:{groups:["saturn","moons","minor","norse"],radius:2,label:"Saturn LIV",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:85738176,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_liv/saturn/orb"}]},saturn_lv:{groups:["saturn","moons","minor","norse"],radius:1.5,label:"Saturn LV",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:96327360,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1.5,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lv/saturn/orb"}]},saturn_lvi:{groups:["saturn","moons","minor","norse"],radius:2,label:"Saturn LVI",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:101297088,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lvi/saturn/orb"}]},saturn_lvii:{groups:["saturn","moons","minor","norse"],radius:2,label:"Saturn LVII",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:96869088,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lvii/saturn/orb"}]},saturn_lviii:{groups:["saturn","moons","minor","norse"],radius:2,label:"Saturn LVIII",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:140744736,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lviii/saturn/orb"}]},saturn_lix:{groups:["saturn","moons","minor","norse"],radius:3,label:"Saturn LIX",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:91120032,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:3,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lix/saturn/orb"}]},saturn_lx:{groups:["saturn","moons","minor","inuit"],radius:2,label:"Saturn LX",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:72782496,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lx/saturn/orb"}]},saturn_lxi:{groups:["saturn","moons","minor","norse"],radius:1.5,label:"Saturn LXI",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:96300576,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1.5,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lxi/saturn/orb"}]},saturn_lxii:{groups:["saturn","moons","minor","norse"],radius:2,label:"Saturn LXII",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:97908480,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lxii/saturn/orb"}]},saturn_lxiii:{groups:["saturn","moons","minor","norse"],radius:2,label:"Saturn LXIII",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:113160672,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lxiii/saturn/orb"}]},saturn_lxiv:{groups:["saturn","moons","minor","norse"],radius:1.5,label:"Saturn LXIV",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:126476640,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:1.5,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lxiv/saturn/orb"}]},saturn_lxv:{groups:["saturn","moons","minor","norse"],radius:3,label:"Saturn LXV",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:104288256,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:3,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lxv/saturn/orb"}]},saturn_lxvi:{groups:["saturn","moons","minor","norse"],radius:2,label:"Saturn LXVI",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:109711584,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:2,shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"saturn_lxvi/saturn/orb"}]},siarnaq:{groups:["saturn","moons","minor","inuit"],radius:20,label:"Siarnaq",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:76453632,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[20,20,20],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"siarnaq/saturn/orb"}]},skathi:{groups:["saturn","moons","minor","norse"],radius:4,label:"Skathi",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:63289728,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[4,4,4],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"skathi/saturn/orb"}]},skoll:{groups:["saturn","moons","minor","norse"],radius:3,label:"Skoll",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:74508768,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"skoll/saturn/orb"}]},surtur:{groups:["saturn","moons","minor","norse"],radius:3,label:"Surtur",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:107339904,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"surtur/saturn/orb"}]},suttungr:{groups:["saturn","moons","minor","norse"],radius:3.5,label:"Suttungr",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:88371648,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[3.5,3.5,3.5],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"suttungr/saturn/orb"}]},tarqeq:{groups:["saturn","moons","minor","inuit"],radius:3,label:"Tarqeq",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:77315904,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[3,3,3],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"tarqeq/saturn/orb"}]},tarvos:{groups:["saturn","moons","minor","gallic"],radius:7.5,label:"Tarvos",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:81581472,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[7.5,7.5,7.5],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"tarvos/saturn/orb"}]},telesto:{groups:["saturn","moons","minor","trojan"],radius:12.4,label:"Telesto",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:163106,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[12.4,12.4,12.4],shadowEntities:["saturn"]},dynamo:[{url:"telesto/saturn/orb"},{url:"telesto/ori"}]},thrymr:{groups:["saturn","moons","minor","norse"],radius:3.5,label:"Thrymr",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:93146976,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[3.5,3.5,3.5],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"thrymr/saturn/orb"}]},ymir:{groups:["saturn","moons","minor","norse"],radius:9,label:"Ymir",parents:[[Number.NEGATIVE_INFINITY,"saturn"]],trail:{length:108358560,color:[.72,.65,.52,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[9,9,9],shadowEntities:["saturn"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"ymir/saturn/orb"}]}});const r={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s}),i(128).default.register({ariel:{groups:["uranus","moons","major"],radius:578.9,label:"Ariel",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:217728,color:[.67,.92,1,.7]},spheroid:{equatorialRadius:578.9,polarRadius:578.9,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"ariel/color_$SIZE_$FACE.png",sizes:[4,512]}},shadowEntities:["uranus"]},dynamo:[{url:"ariel/uranus/orb"},{url:"ariel/ori"}]},miranda:{groups:["uranus","moons","major"],radius:235.8,label:"Miranda",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:122125,color:[.67,.92,1,.7]},spheroid:{equatorialRadius:235.8,polarRadius:235.8,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"miranda/color_$SIZE_$FACE.png",sizes:[4,256]}},shadowEntities:["uranus"]},dynamo:[{url:"miranda/uranus/orb"},{url:"miranda/ori"}]},oberon:{groups:["uranus","moons","major"],radius:761.4,label:"Oberon",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:1163223,color:[.67,.92,1,.7]},spheroid:{equatorialRadius:761.4,polarRadius:761.4,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"oberon/color_$SIZE_$FACE.png",sizes:[4,512]}},shadowEntities:["uranus"]},dynamo:[{url:"oberon/uranus/orb"},{url:"oberon/ori"}]},titania:{groups:["uranus","moons","major"],radius:788.4,label:"Titania",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:752219,color:[.67,.92,1,.7]},spheroid:{equatorialRadius:788.4,polarRadius:788.4,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"titania/color_$SIZE_$FACE.png",sizes:[4,512]}},shadowEntities:["uranus"]},dynamo:[{url:"titania/uranus/orb"},{url:"titania/ori"}]},umbriel:{groups:["uranus","moons","major"],radius:584.7,label:"Umbriel",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:358042,color:[.67,.92,1,.7]},spheroid:{equatorialRadius:584.7,polarRadius:584.7,planetographic:!1},spheroidLOD:{features:["shadowEntities"],textures:{color:{url:"umbriel/color_$SIZE_$FACE.png",sizes:[4,256]}},shadowEntities:["uranus"]},dynamo:[{url:"umbriel/uranus/orb"},{url:"umbriel/ori"}]}});const s={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(128),n=i(2);s.default.register({belinda:{groups:["uranus","moons","minor","inner"],radius:45,label:"Belinda",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:53873,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[45,45,45],shadowEntities:["uranus"]},dynamo:[{url:"belinda/uranus/orb"},{url:"belinda/ori"}]},bianca:{groups:["uranus","moons","minor","inner"],radius:25.7,label:"Bianca",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:37548,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[25.7,25.7,25.7],shadowEntities:["uranus"]},dynamo:[{url:"bianca/uranus/orb"},{url:"bianca/ori"}]},caliban:{groups:["uranus","moons","minor","irregular"],radius:36,label:"Caliban",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:50068800,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[36,36,36],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"caliban/uranus/orb"}]},cordelia:{groups:["uranus","moons","minor","inner"],radius:20.1,label:"Cordelia",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:28947,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[20.1,20.1,20.1],shadowEntities:["uranus"]},dynamo:[{url:"cordelia/uranus/orb"},{url:"cordelia/ori"}]},cressida:{groups:["uranus","moons","minor","inner"],radius:39.8,label:"Cressida",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:40052,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[39.8,39.8,39.8],shadowEntities:["uranus"]},dynamo:[{url:"cressida/uranus/orb"},{url:"cressida/ori"}]},cupid:{groups:["uranus","moons","minor","inner"],radius:9,label:"Cupid",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:53395,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[9,9,9],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"cupid/uranus/orb"}]},desdemona:{groups:["uranus","moons","minor","inner"],radius:32,label:"Desdemona",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:40923,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[32,32,32],shadowEntities:["uranus"]},dynamo:[{url:"desdemona/uranus/orb"},{url:"desdemona/ori"}]},ferdinand:{groups:["uranus","moons","minor","irregular"],radius:10,label:"Ferdinand",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:243941760,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[10,10,10],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"ferdinand/uranus/orb"}]},francisco:{groups:["uranus","moons","minor","irregular"],radius:11,label:"Francisco",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:23030784,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[11,11,11],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"francisco/uranus/orb"}]},juliet:{groups:["uranus","moons","minor","inner"],radius:46.8,label:"Juliet",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:42601,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[46.8,46.8,46.8],shadowEntities:["uranus"]},dynamo:[{url:"juliet/uranus/orb"},{url:"juliet/ori"}]},mab:{groups:["uranus","moons","minor","inner"],radius:12.5,label:"Mab",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:79747,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[12.5,12.5,12.5],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"mab/uranus/orb"}]},margaret:{groups:["uranus","moons","minor","irregular"],radius:10,label:"Margaret",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:146430720,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[10,10,10],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"margaret/uranus/orb"}]},ophelia:{groups:["uranus","moons","minor","inner"],radius:22.4,label:"Ophelia",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:32521,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[22.4,22.4,22.4],shadowEntities:["uranus"]},dynamo:[{url:"ophelia/uranus/orb"},{url:"ophelia/ori"}]},perdita:{groups:["uranus","moons","minor","inner"],radius:15,label:"Perdita",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:55123,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[15,15,15],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"perdita/uranus/orb"}]},portia:{groups:["uranus","moons","minor","inner"],radius:67.6,label:"Portia",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:44340,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[67.6,67.6,67.6],shadowEntities:["uranus"]},dynamo:[{url:"portia/uranus/orb"},{url:"portia/ori"}]},prospero:{groups:["uranus","moons","minor","irregular"],radius:25,label:"Prospero",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:172177920,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[25,25,25],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"prospero/uranus/orb"}]},puck:{groups:["uranus","moons","minor","inner"],radius:81,label:"Puck",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:65822,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[81,81,81],shadowEntities:["uranus"]},dynamo:[{url:"puck/uranus/orb"},{url:"puck/ori"}]},rosalind:{groups:["uranus","moons","minor","inner"],radius:36,label:"Rosalind",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:48251,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[36,36,36],shadowEntities:["uranus"]},dynamo:[{url:"rosalind/uranus/orb"},{url:"rosalind/ori"}]},setebos:{groups:["uranus","moons","minor","irregular"],radius:24,label:"Setebos",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:190278720,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[24,24,24],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"setebos/uranus/orb"}]},stephano:{groups:["uranus","moons","minor","irregular"],radius:16,label:"Stephano",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:58449600,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_2/generic_asteroid_2.gltf",scale:[16,16,16],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"stephano/uranus/orb"}]},sycorax:{groups:["uranus","moons","minor","irregular"],radius:82,label:"Sycorax",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:110885760,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_3/generic_asteroid_3.gltf",scale:[82,82,82],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"sycorax/uranus/orb"}]},trinculo:{groups:["uranus","moons","minor","irregular"],radius:9,label:"Trinculo",parents:[[Number.NEGATIVE_INFINITY,"uranus"]],trail:{length:65499840,color:[.67,.92,1,.7]},model:{url:"$STATIC_ASSETS_URL/models/generic/asteroid_1/generic_asteroid_1.gltf",scale:[9,9,9],shadowEntities:["uranus"]},fixed:{orientation:n.Quaternion.Identity},dynamo:[{url:"trinculo/uranus/orb"}]}});const r={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(128),n=i(240),r=i(2);s.default.register({sc_3d_winds:{groups:["earth","spacecraft"],occlusionRadius:.002,extentsRadius:.0025,label:"3D-Winds",parents:[[347025366.1839032,"earth"]],trail:{length:5573},dynamo:[{url:"sc_3d_winds"}]},sc_ace:{groups:["earth","spacecraft"],occlusionRadius:8e-4,extentsRadius:.0023,label:"ACE",parents:[[265550465.18489534,"earth"],[694267269.1839212,""]],trail:{length:31715490},model:{url:"$STATIC_ASSETS_URL/models/sc_ace/ace.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis}},spin:{axis:r.Vector3.YAxisNeg,periodInHours:.0033},animdata:[{url:"sc_ace",type:"pos"}]},sc_acrimsat:{groups:["earth","spacecraft"],radius:.0015,label:"ACRIMSAT",parents:[[362596073.18419105,"earth"],[484210266.185391,""]],trail:{length:5933.5},model:{url:"$STATIC_ASSETS_URL/models/sc_acrimsat/acrimsat.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis}},spin:{axis:r.Vector3.YAxisNeg,periodInHours:.00238},dynamo:[{url:"sc_acrimsat"}]},sc_aim:{groups:["earth","spacecraft"],occlusionRadius:7e-4,extentsRadius:.0014,label:"AIM",parents:[[344589947.18311954,"earth"]],trail:{length:5788.83},dynamo:[{url:"sc_aim"}]},sc_aqua:{groups:["earth","spacecraft"],occlusionRadius:.004,extentsRadius:.007,label:"Aqua",parents:[[344589947.18311954,"earth"]],trail:{length:5933.5},model:{url:"$STATIC_ASSETS_URL/models/sc_aqua/Aqua.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_aqua",axis:r.Vector3.XAxis}},dynamo:[{url:"sc_aqua"}]},sc_ascends:{groups:["earth","spacecraft"],radius:.004,label:"ASCENDS",parents:[[347025366.1839032,"earth"]],trail:{length:5573},dynamo:[{url:"sc_ascends"}]},sc_aura:{groups:["earth","spacecraft"],occlusionRadius:.00345,extentsRadius:.0085,label:"Aura",parents:[[344589947.18311954,"earth"]],trail:{length:5933.5},model:{url:"$STATIC_ASSETS_URL/models/sc_aura/Aura.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_aura",axis:r.Vector3.XAxis}},dynamo:[{url:"sc_aura"}]},sc_c_nofs:{groups:["earth","spacecraft"],radius:.004,label:"C/NOFS",parents:[[352800006.1854904,"earth"],[502051928.18300515,""]],trail:{length:5573},dynamo:[{url:"sc_c_nofs"}]},sc_calipso:{groups:["earth","spacecraft"],occlusionRadius:.00165,extentsRadius:.0043,label:"CALIPSO",parents:[[344589947.18311954,"earth"]],trail:{length:5933},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_calipso",axis:r.Vector3.YAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_calipso/calipso.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_calipso"}]},sc_chandra:{groups:["earth","spacecraft"],occlusionRadius:.0059,extentsRadius:.01,label:"Chandra",parents:[[339465600,"earth"],[709344e3,""]],trail:{length:228505.5},align:{primary:{type:"point",target:"sun",axis:new r.Vector3(-.70710678118,-.70710678118,0)}},model:{url:"$STATIC_ASSETS_URL/models/sc_chandra/chandra.gltf",shadowEntities:["earth","moon"]},animdata:[{url:"sc_chandra/earth/all",type:"pos"}]},sc_clarreo:{groups:["earth","spacecraft"],radius:.004,label:"CLARREO",parents:[[347025366.1839032,"earth"]],trail:{length:5573},dynamo:[{url:"sc_clarreo"}]},sc_cloudsat:{groups:["earth","spacecraft"],radius:.0025,label:"CloudSat",parents:[[344589947.18311954,"earth"]],trail:{length:5933.5},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_cloudsat",axis:r.Vector3.XAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_cloudsat/CloudSat.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cloudsat"}]},sc_cluster_ii_fm5:{groups:["earth","spacecraft"],occlusionRadius:.00145,extentsRadius:.00435,label:"Rumba",parents:[[344589947.18311954,"earth"],[661006268.1833516,""]],trail:{length:195541.5},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_cluster_ii_fm5",axis:r.Vector3.ZAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_cluster_ii/cluster_ii.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cluster_ii_fm5"}]},sc_cluster_ii_fm6:{groups:["earth","spacecraft"],occlusionRadius:.00145,extentsRadius:.00435,label:"Salsa",parents:[[344589947.18311954,"earth"],[661006268.1833516,""]],trail:{length:195351},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_cluster_ii_fm6",axis:r.Vector3.ZAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_cluster_ii/cluster_ii.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cluster_ii_fm6"}]},sc_cluster_ii_fm7:{groups:["earth","spacecraft"],occlusionRadius:.00145,extentsRadius:.00435,label:"Samba",parents:[[344589947.18311954,"earth"],[661006268.1833516,""]],trail:{length:195316},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_cluster_ii_fm7",axis:r.Vector3.ZAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_cluster_ii/cluster_ii.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cluster_ii_fm7"}]},sc_cluster_ii_fm8:{groups:["earth","spacecraft"],occlusionRadius:.00145,extentsRadius:.00435,label:"Tango",parents:[[405425863.18259597,"earth"],[661006268.1833516,""]],trail:{length:195388},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_cluster_ii_fm8",axis:r.Vector3.ZAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_cluster_ii/cluster_ii.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cluster_ii_fm8"}]},sc_cygnss_1:{groups:["earth","spacecraft"],radius:8e-4,label:"CYGNSS 1",parents:[[548415404.1851876,"earth"]],trail:{length:5573},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_cygnss_1",axis:r.Vector3.YAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_cygnss/CYGNSS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cygnss_1"}]},sc_cygnss_2:{groups:["earth","spacecraft"],radius:8e-4,label:"CYGNSS 2",parents:[[548415404.1851876,"earth"]],trail:{length:5573},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_cygnss_2",axis:r.Vector3.YAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_cygnss/CYGNSS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cygnss_2"}]},sc_cygnss_3:{groups:["earth","spacecraft"],radius:8e-4,label:"CYGNSS 3",parents:[[548415404.1851876,"earth"]],trail:{length:5573},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_cygnss_3",axis:r.Vector3.YAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_cygnss/CYGNSS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cygnss_3"}]},sc_cygnss_4:{groups:["earth","spacecraft"],radius:8e-4,label:"CYGNSS 4",parents:[[548415404.1851876,"earth"]],trail:{length:5573},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_cygnss_4",axis:r.Vector3.YAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_cygnss/CYGNSS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cygnss_4"}]},sc_cygnss_5:{groups:["earth","spacecraft"],radius:8e-4,label:"CYGNSS 5",parents:[[548415404.1851876,"earth"]],trail:{length:5573},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_cygnss_5",axis:r.Vector3.YAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_cygnss/CYGNSS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cygnss_5"}]},sc_cygnss_6:{groups:["earth","spacecraft"],radius:8e-4,label:"CYGNSS 6",parents:[[548415404.1851876,"earth"]],trail:{length:5573},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_cygnss_6",axis:r.Vector3.YAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_cygnss/CYGNSS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cygnss_6"}]},sc_cygnss_7:{groups:["earth","spacecraft"],radius:8e-4,label:"CYGNSS 7",parents:[[548415404.1851876,"earth"]],trail:{length:5573},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_cygnss_7",axis:r.Vector3.YAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_cygnss/CYGNSS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cygnss_7"}]},sc_cygnss_8:{groups:["earth","spacecraft"],radius:8e-4,label:"CYGNSS 8",parents:[[548415404.1851876,"earth"]],trail:{length:5573},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_cygnss_8",axis:r.Vector3.YAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_cygnss/CYGNSS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_cygnss_8"}]},sc_dscovr:{groups:["earth","spacecraft"],occlusionRadius:9e-4,extentsRadius:.002,label:"DSCOVR",parents:[[476711467.18497694,"earth"]],trail:{length:31536e3},align:{primary:{type:"point",target:"earth",axis:r.Vector3.XAxisNeg},secondary:{type:"velocity",target:"sc_dscovr",axis:r.Vector3.ZAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_dscovr/dscovr.gltf",shadowEntities:["earth","moon"]},animdata:[{url:"sc_dscovr/earth/all",type:"pos"}]},sc_eo_1:{groups:["earth","spacecraft"],occlusionRadius:.003,extentsRadius:.001,label:"EO-1",parents:[[344589947.18311954,"earth"],[544104069.186,""]],trail:{length:5933.33},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxis},secondary:{type:"velocity",target:"sc_eo_1",axis:r.Vector3.XAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_eo_1/eo-1.gltf",rotate:[{y:45}],shadowEntities:["earth","moon"]},dynamo:[{url:"sc_eo_1"}]},sc_explorer_1:{groups:["earth","spacecraft"],occlusionRadius:.001,extentsRadius:.001,label:"Explorer-1",parents:[[-1322726967.5151942,"earth"],[-939025102.1479388,""]],trail:{length:6885.5},model:{url:"$STATIC_ASSETS_URL/models/sc_explorer_1/Explorer_1.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"velocity",target:"sc_explorer_1",axis:r.Vector3.YAxis}},spin:{axis:r.Vector3.YAxisNeg,periodInHours:22e-6},animdata:[{url:"sc_explorer_1",type:"pos"}]},sc_face:{groups:["earth","spacecraft"],radius:.004,label:"FACE",parents:[[347025366.1839032,"earth"],[631022168.1838934,""]],trail:{length:5933.33},dynamo:[{url:"sc_face"}]},sc_fgrst:{groups:["earth","spacecraft"],occlusionRadius:.0014,extentsRadius:.004,label:"FGRST",parents:[[344589947.18311954,"earth"],[661006268.1833516,""]],trail:{length:5733},dynamo:[{url:"sc_fgrst"}]},sc_gacm:{groups:["earth","spacecraft"],radius:.004,label:"GACM",parents:[[347025366.1839032,"earth"]],trail:{length:5733},dynamo:[{url:"sc_gacm"}]},sc_galex:{groups:["earth","spacecraft"],occlusionRadius:.001,extentsRadius:.0014,label:"GALEX",parents:[[352800006.1854904,"earth"],[425718607.184,""]],trail:{length:5733},dynamo:[{url:"sc_galex"}]},sc_geo_cape:{groups:["earth","spacecraft"],radius:.004,label:"GEO-CAPE",parents:[[347025366.1839032,"earth"]],trail:{length:5733},dynamo:[{url:"sc_geo_cape"}]},sc_geotail:{groups:["earth","spacecraft"],occlusionRadius:.0018,extentsRadius:.003,label:"Geotail",parents:[[291384066.1856425,"earth"],[612619269.1849155,""]],trail:{length:450372},animdata:[{url:"sc_geotail/earth/all",type:"pos"}]},sc_goes_12:{groups:["earth","spacecraft"],radius:.003,label:"GOES 12",parents:[[344589947.18311954,"earth"],[661006268.1833516,""]],trail:{length:5733},dynamo:[{url:"sc_goes_12"}]},sc_goes_13:{groups:["earth","spacecraft"],radius:.003,label:"GOES 13",parents:[[344589947.18311954,"earth"]],trail:{length:5733},dynamo:[{url:"sc_goes_13"}]},sc_goes_14:{groups:["earth","spacecraft"],radius:.003,label:"GOES 14",parents:[[344589947.18311954,"earth"]],trail:{length:5733},dynamo:[{url:"sc_goes_14"}]},sc_goes_15:{groups:["earth","spacecraft"],radius:.003,label:"GOES 15",parents:[[344589947.18311954,"earth"]],trail:{length:5733},dynamo:[{url:"sc_goes_15"}]},sc_gpm:{groups:["earth","spacecraft"],occlusionRadius:.002,extentsRadius:.004,label:"GPM",parents:[[629484755.7856493,"earth"]],trail:{length:5549.5},model:{url:"$STATIC_ASSETS_URL/models/sc_gpm/GPM.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_gpm",axis:r.Vector3.ZAxis}},dynamo:[{url:"sc_gpm"}],postCreateFunction:t=>{const e=t.addController("spin");e.setJoint("GPM_antenna"),e.setRate(r.MathUtils.degToRad(192)),e.setAxis(r.Vector3.YAxisNeg,!0),e.setClampedToRealTime(!0)}},sc_grace_1:{groups:["earth","spacecraft"],occlusionRadius:.0015,extentsRadius:.0015,label:"GRACE-1",parents:[[69656411.096817,"earth"],[562382552.2587994,""]],trail:{length:5575},model:{url:"$STATIC_ASSETS_URL/models/sc_grace/grace.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"sc_grace_2",axis:r.Vector3.YAxisNeg},secondary:{type:"point",target:"earth",axis:r.Vector3.ZAxis}},dynamo:[{url:"sc_grace_1/earth/orb"}],coverages:[{coverage:[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY],update:t=>{const e=t.getComponent("microwave"),i=t.getScene().getEngine(),s=r.MathUtils.wrap(e.getTextureYOffset()-r.MathUtils.clamp(i.getTimeRate(),-1,1)*i.getDeltaTime(),0,1);e.setTextureYOffset(s);const n=t.getScene().getEntity("sc_grace_2"),o=null!==n&&n.getPosition().distance(t.getPosition())<=3929;o!==e.isEnabled()&&e.setEnabled(o)}}],postCreateFunction:t=>{const e=t.addComponent("connectedSprite","microwave");e.setTextureUrl("$STATIC_ASSETS_URL/sprites/sine_wave.png"),e.setEntity1("sc_grace_1"),e.setEntity1Offset(new r.Vector3(0,-.00165,0)),e.setEntity2("sc_grace_2"),e.setEntity2Offset(new r.Vector3(0,-.00165,0)),e.setWidth(5e-4),e.setColorMultiplier(new r.Color(.5,1,1)),e.setTextureRepeat(!0),e.setTextureStretch(4)}},sc_grace_2:{groups:["earth","spacecraft"],occlusionRadius:.0015,extentsRadius:.0015,label:"GRACE-2",parents:[[69656411.096817,"earth"],[562382552.2588,""]],trail:{length:5575},model:{url:"$STATIC_ASSETS_URL/models/sc_grace/grace.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"sc_grace_1",axis:r.Vector3.YAxisNeg},secondary:{type:"point",target:"earth",axis:r.Vector3.ZAxis}},dynamo:[{url:"sc_grace_2/earth/orb"}]},sc_grace_fo1:{groups:["earth","spacecraft"],occlusionRadius:.0015,extentsRadius:.0015,label:"GRACE-FO 1",parents:[[580290547.185,"earth"]],trail:{length:5575},model:{url:"$STATIC_ASSETS_URL/models/sc_grace_fo/graceFO.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"sc_grace_fo2",axis:r.Vector3.ZAxisNeg},secondary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg}},dynamo:[{url:"sc_grace_fo1"}],coverages:[{coverage:[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY],update:t=>{const e=t.getComponent("microwave"),i=t.getScene().getEngine(),s=r.MathUtils.wrap(e.getTextureYOffset()-r.MathUtils.clamp(i.getTimeRate(),-1,1)*i.getDeltaTime(),0,1);e.setTextureYOffset(s);const n=t.getScene().getEntity("sc_grace_fo2"),o=null!==n&&n.getPosition().distance(t.getPosition())<=3929;if(o!==e.isEnabled()){const i=t.getComponent("laser1"),s=t.getComponent("laser2");e.setEnabled(o),i.setEnabled(o),s.setEnabled(o)}}}],postCreateFunction:t=>{const e=t.addComponent("connectedSprite","microwave");e.setTextureUrl("$STATIC_ASSETS_URL/sprites/sine_wave.png"),e.setEntity1("sc_grace_fo1"),e.setEntity1Offset(new r.Vector3(0,0,-.00165)),e.setEntity2("sc_grace_fo2"),e.setEntity2Offset(new r.Vector3(0,0,-.00165)),e.setWidth(5e-4),e.setColorMultiplier(new r.Color(.5,1,1)),e.setTextureRepeat(!0),e.setTextureStretch(4);const i=t.addComponent("connectedSprite","laser1");i.setTextureUrl("$STATIC_ASSETS_URL/sprites/line.png"),i.setEntity1("sc_grace_fo1"),i.setEntity1Offset(new r.Vector3(3e-4,15e-5,-.00165)),i.setEntity2("sc_grace_fo2"),i.setEntity2Offset(new r.Vector3(-3e-4,15e-5,-.00165)),i.setWidth(2e-5),i.setColorMultiplier(new r.Color(1,.24,.64)),i.setTextureRepeat(!1);const s=t.addComponent("connectedSprite","laser2");s.setTextureUrl("$STATIC_ASSETS_URL/sprites/line.png"),s.setEntity1("sc_grace_fo1"),s.setEntity1Offset(new r.Vector3(-3e-4,15e-5,-.00165)),s.setEntity2("sc_grace_fo2"),s.setEntity2Offset(new r.Vector3(3e-4,15e-5,-.00165)),s.setWidth(2e-5),s.setColorMultiplier(new r.Color(1,.24,.64)),s.setTextureRepeat(!1)}},sc_grace_fo2:{groups:["earth","spacecraft"],occlusionRadius:.0015,extentsRadius:.0015,label:"GRACE-FO 2",parents:[[580290547.185,"earth"]],trail:{length:5575},model:{url:"$STATIC_ASSETS_URL/models/sc_grace_fo/graceFO.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"sc_grace_fo1",axis:r.Vector3.ZAxisNeg},secondary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg}},dynamo:[{url:"sc_grace_fo2"}]},sc_grifex:{groups:["earth","spacecraft"],occlusionRadius:15e-5,extentsRadius:25e-5,label:"GRIFEX",parents:[[476542806.1849232,"earth"]],trail:{length:5706.25},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_grifex",axis:r.Vector3.ZAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_grifex/grifex.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_grifex"}]},sc_hubble_space_telescope:{groups:["earth","spacecraft","telescope"],occlusionRadius:.0066,extentsRadius:.0066,label:"Hubble",parents:[[-305719099.92837775,"earth"]],trail:{length:5748.5},model:{url:"$STATIC_ASSETS_URL/models/sc_hubble/Hubble.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_hubble_space_telescope",axis:r.Vector3.YAxis}},dynamo:[{url:"sc_hubble_space_telescope/earth/orb"}]},sc_hyspiri:{groups:["earth","spacecraft"],radius:.004,label:"HyspIRI",parents:[[347025366.1839032,"earth"]],trail:{length:5733},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_hyspiri",axis:r.Vector3.ZAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_hyspiri/HyspIRI.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_hyspiri"}]},sc_ibex:{groups:["earth","spacecraft"],occlusionRadius:5e-4,extentsRadius:.001,label:"IBEX",parents:[[277718464.1823969,"earth"]],trail:{length:797489.16},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis}},spin:{axis:r.Vector3.YAxis,periodInHours:.00416},model:{url:"$STATIC_ASSETS_URL/models/sc_ibex/iBEX.gltf",shadowEntities:["earth","moon"]},animdata:[{url:"sc_ibex",type:"pos"}]},sc_icesat_2:{groups:["earth","spacecraft"],occlusionRadius:.00198,extentsRadius:.004,label:"ICESat-2",parents:[[590288589.182,"earth"]],trail:{length:5653.2},model:{url:"$STATIC_ASSETS_URL/models/sc_icesatii/ICESat2.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxis},secondary:{type:"velocity",target:"sc_icesat_2",axis:r.Vector3.XAxis}},dynamo:[{url:"sc_icesat_2"}]},sc_image:{groups:["earth","spacecraft"],occlusionRadius:.00113,extentsRadius:.006,label:"IMAGE",parents:[[7288547.186,"earth"],[188163587.1835355,""]],trail:{length:55541},model:{url:"$STATIC_ASSETS_URL/models/sc_image/image.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_image",axis:r.Vector3.XAxis}},dynamo:[{url:"sc_image"}]},sc_integral:{groups:["earth","spacecraft"],occlusionRadius:.0025,extentsRadius:.005,label:"INTEGRAL",parents:[[367498866.18276465,"earth"]],trail:{length:229689},dynamo:[{url:"sc_integral"}]},sc_ipex:{groups:["earth","spacecraft"],occlusionRadius:1e-4,extentsRadius:15e-5,label:"IPEX",parents:[[439586087.183,"earth"]],trail:{length:5862},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_ipex",axis:r.Vector3.ZAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_ipex/IPEX.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_ipex"}]},sc_isas:{groups:["earth","spacecraft"],occlusionRadius:.001,extentsRadius:.0015,label:"ISAS",parents:[[-186102945.06492478,"earth"],[-183424845.06434903,""]],trail:{length:92680.5},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_isas",axis:r.Vector3.ZAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_isas/isas.gltf",shadowEntities:["earth","moon"]},animdata:[{url:"sc_isas",type:"pos"}]},sc_iss:{groups:["earth","spacecraft"],occlusionRadius:.008,extentsRadius:.055,label:"ISS",parents:[[344589947.18311954,"earth"]],trail:{length:5573},model:{url:"$STATIC_ASSETS_URL/models/sc_iss/ISS_stationary.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_iss",axis:r.Vector3.ZAxis}},dynamo:[{url:"sc_iss"}],postCreateFunction:t=>{const e=new r.Vector3(0,.5,.5*Math.sqrt(3)),i=new r.Vector3(0,.5*Math.sqrt(3),-.5),s=new r.Vector3(0,.5,.5*Math.sqrt(3));let o=t.addController("align");o.setJoint("20_P4_Truss"),o.setPrimaryAxis(r.Vector3.XAxis),o.setSecondaryAxis(e),o.setSecondaryAlignType("point"),o.setSecondaryTargetEntity("sun"),o=t.addController("align"),o.setJoint("23_S4_Truss"),o.setPrimaryAxis(r.Vector3.XAxis),o.setSecondaryAxis(e),o.setSecondaryAlignType("point"),o.setSecondaryTargetEntity("sun"),o=t.addController("align"),o.setJoint("20_P4_Truss_01"),o.setPrimaryAxis(i),o.setSecondaryAxis(s),o.setSecondaryAlignType("point"),o.setSecondaryTargetEntity("sun"),o=t.addController("align"),o.setJoint("20_P4_Truss_02"),o.setPrimaryAxis(i),o.setSecondaryAxis(s),o.setSecondaryAlignType("point"),o.setSecondaryTargetEntity("sun"),o=t.addController("align"),o.setJoint("23_S4_Truss_01"),o.setPrimaryAxis(i),o.setSecondaryAxis(s),o.setSecondaryAlignType("point"),o.setSecondaryTargetEntity("sun"),o=t.addController("align"),o.setJoint("23_S4_Truss_02"),o.setPrimaryAxis(i),o.setSecondaryAxis(s),o.setSecondaryAlignType("point"),o.setSecondaryTargetEntity("sun"),o=t.addController("align"),o.setJoint("32_S6_Truss_01"),o.setPrimaryAxis(i),o.setSecondaryAxis(s),o.setSecondaryAlignType("point"),o.setSecondaryTargetEntity("sun"),o=t.addController("align"),o.setJoint("32_S6_Truss_02"),o.setPrimaryAxis(i),o.setSecondaryAxis(s),o.setSecondaryAlignType("point"),o.setSecondaryTargetEntity("sun"),o=t.addController("align"),o.setJoint("08_P6_Truss_01"),o.setPrimaryAxis(i),o.setSecondaryAxis(s),o.setSecondaryAlignType("point"),o.setSecondaryTargetEntity("sun"),o=t.addController("align"),o.setJoint("08_P6_Truss_02"),o.setPrimaryAxis(i),o.setSecondaryAxis(s),o.setSecondaryAlignType("point"),o.setSecondaryTargetEntity("sun");const a=t.addController("spin");a.setJoint("RapidScat_dish"),a.setRate(r.MathUtils.degToRad(108)),a.setAxis(r.Vector3.ZAxis,!0),a.setClampedToRealTime(!0),a.setCoverage(new r.Interval(465418867.184,524890952.183)),n.EntityUtils.showSubObjectDuringInterval(t,"Ecostress",584127348,Number.POSITIVE_INFINITY),n.EntityUtils.showSubObjectDuringInterval(t,"EMIT",711345507,Number.POSITIVE_INFINITY),n.EntityUtils.showSubObjectDuringInterval(t,"OCO3",610718469,Number.POSITIVE_INFINITY),n.EntityUtils.showSubObjectDuringInterval(t,"45_RapidScat",465418867.184,575406069.184)}},sc_iss_ecostress:{groups:["instrument","sc_iss"],occlusionRadius:8e-4,extentsRadius:2e-4,label:"ECOSTRESS",parents:[[584127348,"sc_iss"]],fixed:{orientation:r.Quaternion.Identity,position:new r.Vector3(.0200195,-.00202631,.0161099),coverage:[584127348,Number.POSITIVE_INFINITY]},postCreateFunction:t=>{t.addController("rotateByEntityOrientation").setCoverage(new r.Interval(584127348,Number.POSITIVE_INFINITY))}},sc_iss_emit:{groups:["instrument","sc_iss"],occlusionRadius:8e-4,extentsRadius:2e-4,label:"EMIT",parents:[[711345507,"sc_iss"]],fixed:{orientation:r.Quaternion.Identity,position:new r.Vector3(.024,-.00225,.00325),coverage:[711345507,Number.POSITIVE_INFINITY]},postCreateFunction:t=>{t.addController("rotateByEntityOrientation").setCoverage(new r.Interval(711345507,Number.POSITIVE_INFINITY))}},sc_iss_oco_3:{groups:["instrument","sc_iss"],occlusionRadius:8e-4,extentsRadius:2e-4,label:"OCO-3",parents:[[610718469,"sc_iss"]],fixed:{orientation:r.Quaternion.Identity,position:new r.Vector3(.0156458,-.00195982,.0200232),coverage:[610718469,Number.POSITIVE_INFINITY]},postCreateFunction:t=>{t.addController("rotateByEntityOrientation").setCoverage(new r.Interval(610718469,Number.POSITIVE_INFINITY))}},sc_iss_rapidscat:{groups:["instrument","sc_iss"],occlusionRadius:8e-4,extentsRadius:2e-4,label:"RapidScat",parents:[[465418867.184,"sc_iss"],[575406069.184,""]],fixed:{orientation:r.Quaternion.Identity,position:new r.Vector3(-.0100725,-.00133401,.0162145),coverage:[465418867.184,575406069.184]},postCreateFunction:t=>{t.addController("rotateByEntityOrientation").setCoverage(new r.Interval(465418867.184,575406069.184))}},sc_ixpe:{groups:["earth","spacecraft","telescope"],occlusionRadius:.0055,extentsRadius:.0026,label:"IXPE",parents:[[692324766.6007013,"earth"]],trail:{length:5400},fixed:{orientation:r.Quaternion.Identity},model:{url:"$STATIC_ASSETS_URL/models/sc_ixpe/ixpe.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_ixpe"}]},sc_jason_1:{groups:["earth","spacecraft"],occlusionRadius:.0014,extentsRadius:.004,label:"Jason-1",parents:[[352800006.1854904,"earth"],[458074266.1839004,""]],trail:{length:6744.5},model:{url:"$STATIC_ASSETS_URL/models/sc_ostm/ostm.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_jason_1",axis:r.Vector3.ZAxisNeg}},animdata:[{url:"sc_jason_1",type:"pos"}]},sc_jason_2:{groups:["earth","spacecraft"],occlusionRadius:.0014,extentsRadius:.004,label:"OSTM/Jason-2",parents:[[344589947.18311954,"earth"],[623851269.182,""]],trail:{length:6744.25},model:{url:"$STATIC_ASSETS_URL/models/sc_ostm/ostm.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_jason_2",axis:r.Vector3.ZAxisNeg}},dynamo:[{url:"sc_jason_2"}]},sc_jason_3:{groups:["earth","spacecraft"],occlusionRadius:.0014,extentsRadius:.004,label:"Jason-3",parents:[[506497796.18443054,"earth"]],trail:{length:6721},model:{url:"$STATIC_ASSETS_URL/models/sc_ostm/ostm.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_jason_3",axis:r.Vector3.ZAxisNeg}},dynamo:[{url:"sc_jason_3"}]},sc_jwst:{groups:["earth","spacecraft"],radius:.01,label:"James Webb Space Telescope",parents:[[693708549.184,"earth"]],trail:{length:5900033.33},model:{url:"$STATIC_ASSETS_URL/models/sc_jwst/webb_deployed.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxisNeg},secondary:{type:"align",target:"sun",axis:r.Vector3.ZAxis,targetAxis:r.Vector3.ZAxis}},coverages:[{coverage:[Number.NEGATIVE_INFINITY,694937889.184],enter:t=>{t.getComponentByType("model").setUrl("$STATIC_ASSETS_URL/models/sc_jwst/webb_stowed.gltf")},exit:t=>{t.getComponentByType("model").setUrl("$STATIC_ASSETS_URL/models/sc_jwst/webb_deployed.gltf")}}],dynamo:[{url:"sc_jwst/earth/orb"}]},sc_landsat_5:{groups:["earth","spacecraft"],radius:.004,label:"Landsat 5",parents:[[352800006.1854904,"earth"],[473889066.18410677,""]],trail:{length:5933.33},dynamo:[{url:"sc_landsat_5"}]},sc_landsat_7:{groups:["earth","spacecraft"],occlusionRadius:.004,extentsRadius:.005,label:"Landsat 7",parents:[[344589947.18311954,"earth"]],trail:{length:5933.33},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxis},secondary:{type:"velocity",target:"sc_landsat_7",axis:r.Vector3.ZAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_landsat_7/LandSat7.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_landsat_7"}]},sc_landsat_8:{groups:["earth","spacecraft"],occlusionRadius:.004,extentsRadius:.005,label:"Landsat 8",parents:[[413877787.185,"earth"]],trail:{length:5933.33},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxisNeg},secondary:{type:"velocity",target:"sc_landsat_8",axis:r.Vector3.YAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_landsat_8/LandSat8.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_landsat_8"}]},sc_landsat_9:{groups:["earth","spacecraft"],occlusionRadius:.004,extentsRadius:.005,label:"Landsat 9",parents:[[686043940.723348,"earth"]],trail:{length:5933.33},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxis},secondary:{type:"velocity",target:"sc_landsat_9",axis:r.Vector3.XAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_landsat_9/Landsat9.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_landsat_9"}]},sc_list:{groups:["earth","spacecraft"],radius:.004,label:"LIST",parents:[[347025366.1839032,"earth"]],trail:{length:5933.33},dynamo:[{url:"sc_list"}]},sc_m_cubed:{groups:["earth","spacecraft"],radius:1e-4,label:"M-Cubed",parents:[[373032066.182,"earth"]],trail:{length:5768.333333333333},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_m_cubed",axis:r.Vector3.XAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_m_cubed/mCubed.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_m_cubed"}]},sc_mcubed_2:{groups:["earth","spacecraft"],occlusionRadius:1e-4,extentsRadius:2e-4,label:"MCubed-2",parents:[[439560067.183,"earth"]],trail:{length:5861},align:{primary:{type:"point",target:"earth",axis:r.Vector3.XAxisNeg},secondary:{type:"velocity",target:"sc_mcubed_2",axis:r.Vector3.ZAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_mcubed_2/M-Cubed2.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_mcubed_2"}]},sc_mms_1:{groups:["earth","spacecraft"],occlusionRadius:.0017,extentsRadius:.013,label:"MMS 1",parents:[[479519767.1855569,"earth"]],trail:{length:85994},spin:{axis:r.Vector3.YAxisNeg,periodInHours:.00556},model:{url:"$STATIC_ASSETS_URL/models/sc_mms/MMS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_mms_1"}]},sc_mms_2:{groups:["earth","spacecraft"],occlusionRadius:.0017,extentsRadius:.013,label:"MMS 2",parents:[[479519767.1855569,"earth"]],trail:{length:85962},spin:{axis:r.Vector3.YAxisNeg,periodInHours:.00556},model:{url:"$STATIC_ASSETS_URL/models/sc_mms/MMS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_mms_2"}]},sc_mms_3:{groups:["earth","spacecraft"],occlusionRadius:.0017,extentsRadius:.013,label:"MMS 3",parents:[[479519767.1855569,"earth"]],trail:{length:86347},spin:{axis:r.Vector3.YAxisNeg,periodInHours:.00556},model:{url:"$STATIC_ASSETS_URL/models/sc_mms/MMS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_mms_3"}]},sc_mms_4:{groups:["earth","spacecraft"],occlusionRadius:.0017,extentsRadius:.013,label:"MMS 4",parents:[[479519767.1855569,"earth"]],trail:{length:86024},spin:{axis:r.Vector3.YAxisNeg,periodInHours:.00556},model:{url:"$STATIC_ASSETS_URL/models/sc_mms/MMS.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_mms_4"}]},sc_nisar:{groups:["earth","spacecraft"],occlusionRadius:.006,extentsRadius:.006,label:"NISAR",parents:[[347025366.1839032,"earth"]],trail:{length:5573},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_nisar",axis:r.Vector3.ZAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_nisar/Nisar.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_nisar"}]},sc_noaa_14:{groups:["earth","spacecraft"],radius:.004,label:"NOAA 14",parents:[[344589947.18311954,"earth"],[661006268.1833516,""]],trail:{length:5933},dynamo:[{url:"sc_noaa_14"}]},sc_noaa_15:{groups:["earth","spacecraft"],radius:.004,label:"NOAA 15",parents:[[344589947.18311954,"earth"]],trail:{length:5933},dynamo:[{url:"sc_noaa_15"}]},sc_noaa_16:{groups:["earth","spacecraft"],radius:.004,label:"NOAA 16",parents:[[344589947.18311954,"earth"],[661006268.1833516,""]],trail:{length:5933},dynamo:[{url:"sc_noaa_16"}]},sc_noaa_17:{groups:["earth","spacecraft"],radius:.004,label:"NOAA 17",parents:[[344589947.18311954,"earth"],[661006268.1833516,""]],trail:{length:5933},dynamo:[{url:"sc_noaa_17"}]},sc_noaa_18:{groups:["earth","spacecraft"],radius:.004,label:"NOAA 18",parents:[[344589947.18311954,"earth"]],trail:{length:5933},dynamo:[{url:"sc_noaa_18"}]},sc_noaa_19:{groups:["earth","spacecraft"],radius:.004,label:"NOAA 19",parents:[[344589947.18311954,"earth"]],trail:{length:5933},dynamo:[{url:"sc_noaa_19"}]},sc_nustar:{groups:["earth","spacecraft"],occlusionRadius:.006,extentsRadius:.006,label:"NuSTAR",parents:[[392875303.185,"earth"]],trail:{length:5798.66},model:{url:"$STATIC_ASSETS_URL/models/sc_nustar/nustar.gltf",shadowEntities:["earth"]},align:{primary:{type:"point",target:"sun",axis:r.Vector3.ZAxisNeg},secondary:{type:"align",axis:r.Vector3.XAxis,target:"sun",targetAxis:r.Vector3.ZAxis}},dynamo:[{url:"sc_nustar"}]},sc_oco_2:{groups:["earth","spacecraft"],occlusionRadius:.0021,extentsRadius:.003,label:"OCO-2",parents:[[457567050.184,"earth"]],trail:{length:5933.333333333333},model:{url:"$STATIC_ASSETS_URL/models/sc_oco_2/oco2.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxisNeg},secondary:{type:"point",target:"sun",axis:r.Vector3.YAxis}},dynamo:[{url:"sc_oco_2"}]},sc_path:{groups:["earth","spacecraft"],radius:.004,label:"PATH",parents:[[347025366.1839032,"earth"]],trail:{length:5933},dynamo:[{url:"sc_path"}]},sc_polar:{groups:["earth","spacecraft"],occlusionRadius:.0012,extentsRadius:.005,label:"Polar",parents:[[-121608237.81469652,"earth"],[262612565.1855274,""]],trail:{length:66571},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_polar",axis:r.Vector3.ZAxis}},model:{url:"$STATIC_ASSETS_URL/models/sc_polar/polar.gltf",shadowEntities:["earth","moon"]},animdata:[{url:"sc_polar",type:"pos"}]},sc_quikscat:{groups:["earth","spacecraft"],occlusionRadius:.0016,extentsRadius:.0018,label:"QuikSCAT",parents:[[344589947.18311954,"earth"],[591710469.182,""]],trail:{length:6061.33},align:{primary:{type:"point",target:"earth",axis:r.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_quikscat",axis:r.Vector3.XAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_quikscat/QuikSCAT.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_quikscat"}]},sc_race:{groups:["earth","spacecraft"],radius:15e-5,label:"RACE",parents:[[467726467.182,"earth"],[467812867.182,""]],trail:{length:5933},dynamo:[{url:"sc_race"}]},sc_raincube:{groups:["earth","spacecraft"],occlusionRadius:35e-5,extentsRadius:5e-4,label:"RainCube",parents:[[608189026.1856545,"earth"],[662040069.184,""]],trail:{length:5743},model:{url:"$STATIC_ASSETS_URL/models/sc_raincube/Raincube.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_raincube",axis:r.Vector3.XAxis}},dynamo:[{url:"sc_raincube"}]},sc_rax_2:{groups:["earth","spacecraft"],radius:2e-4,label:"RAX-2",parents:[[373067348.182,"earth"],[418824067.186,""]],trail:{length:5743},dynamo:[{url:"sc_rax_2"}]},sc_rbsp_a:{groups:["earth","spacecraft"],radius:.004,label:"Van Allen Probe A",parents:[[399585967.183,"earth"],[624628869.182,""]],trail:{length:32214},model:{url:"$STATIC_ASSETS_URL/models/sc_rbsp/rbsp.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_rbsp_a",axis:r.Vector3.XAxis}},dynamo:[{url:"sc_rbsp_a"}]},sc_rbsp_b:{groups:["earth","spacecraft"],radius:.004,label:"Van Allen Probe B",parents:[[399585967.183,"earth"],[616766469.184,""]],trail:{length:32574},model:{url:"$STATIC_ASSETS_URL/models/sc_rbsp/rbsp.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_rbsp_b",axis:r.Vector3.XAxis}},dynamo:[{url:"sc_rbsp_b"}]},sc_sac_d:{groups:["earth","spacecraft"],occlusionRadius:.003,extentsRadius:.0045,label:"Aquarius",parents:[[360987666.185,"earth"],[486907267.185,""]],trail:{length:5884.25},model:{url:"$STATIC_ASSETS_URL/models/sc_sac_d/aquarius.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.XAxis},secondary:{type:"velocity",target:"sc_sac_d",axis:r.Vector3.YAxis}},dynamo:[{url:"sc_sac_d"}]},sc_sclp:{groups:["earth","spacecraft"],radius:.004,label:"SCLP",parents:[[347025366.1839032,"earth"]],trail:{length:5933},dynamo:[{url:"sc_sclp"}]},sc_sdo:{groups:["earth","spacecraft"],occlusionRadius:.0022,extentsRadius:.00315,label:"SDO",parents:[[505918808.18474686,"earth"]],trail:{length:86137.66},model:{url:"$STATIC_ASSETS_URL/models/sc_sdo/sdo.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_sdo",axis:r.Vector3.XAxis}},dynamo:[{url:"sc_sdo"}]},sc_sentinel_6:{groups:["earth","spacecraft"],occlusionRadius:.0026,extentsRadius:.0026,label:"Sentinel-6 Michael Freilich",parents:[[659322339.7879795,"earth"]],trail:{length:5933.5},model:{url:"$STATIC_ASSETS_URL/models/sc_sentinel_6/Sentinel6.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_sentinel_6",axis:r.Vector3.XAxis}},dynamo:[{url:"sc_sentinel_6"}]},sc_smap:{groups:["earth","spacecraft"],occlusionRadius:.003,extentsRadius:.006,label:"SMAP",parents:[[476542806.1849232,"earth"]],trail:{length:5906.8},model:{url:"$STATIC_ASSETS_URL/models/sc_smap/SMAP.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_smap",axis:r.Vector3.XAxis}},dynamo:[{url:"sc_smap"}],postCreateFunction:t=>{const e=t.addController("spin");e.setJoint("arm_etc"),e.setRate(r.MathUtils.degToRad(87.6)),e.setAxis(r.Vector3.YAxis,!0),e.setClampedToRealTime(!0)}},sc_soho:{groups:["earth","spacecraft"],occlusionRadius:.00215,extentsRadius:.00425,label:"SOHO",parents:[[265550465.18489534,"earth"]],trail:{length:31536e3},model:{url:"$STATIC_ASSETS_URL/models/sc_soho/soho.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_soho",axis:r.Vector3.XAxis}},animdata:[{url:"sc_soho",type:"pos"}]},sc_sorce:{groups:["earth","spacecraft"],occlusionRadius:.001,extentsRadius:.0022,label:"SORCE",parents:[[344589947.18311954,"earth"],[635860869.185,""]],trail:{length:5812.5},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_sorce",axis:r.Vector3.XAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_sorce/sorce.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_sorce"}]},sc_suomi_npp:{groups:["earth","spacecraft"],occlusionRadius:.0022,extentsRadius:.004,label:"Suomi NPP",parents:[[373067348.01,"earth"]],trail:{length:5798.66},model:{url:"$STATIC_ASSETS_URL/models/sc_npp/NPP.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.XAxisNeg},secondary:{type:"velocity",target:"sc_suomi_npp",axis:r.Vector3.YAxis}},dynamo:[{url:"sc_suomi_npp"}]},sc_swift:{groups:["earth","spacecraft"],occlusionRadius:.0028,extentsRadius:.0028,label:"Swift",parents:[[344589947.18311954,"earth"]],trail:{length:5933},dynamo:[{url:"sc_swift"}]},sc_swot:{groups:["earth","spacecraft"],occlusionRadius:.005,extentsRadius:.006,label:"SWOT",parents:[[347025366.1839032,"earth"]],trail:{length:5933},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_swot",axis:r.Vector3.XAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_swot/SWOT.gltf",shadowEntities:["earth","moon"]},dynamo:[{url:"sc_swot"}]},sc_tdrs_3:{groups:["earth","spacecraft"],occlusionRadius:.0085,extentsRadius:.0085,label:"TDRS 3",parents:[[344589947.18311954,"earth"]],trail:{length:86137.33},model:{url:"$STATIC_ASSETS_URL/models/sc_tdrs/tdrs.gltf"},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis},secondary:{type:"align",axis:r.Vector3.ZAxis,target:"earth",targetAxis:r.Vector3.ZAxis}},dynamo:[{url:"sc_tdrs_3"}]},sc_tdrs_5:{groups:["earth","spacecraft"],occlusionRadius:.0085,extentsRadius:.0085,label:"TDRS 5",parents:[[344589947.18311954,"earth"]],trail:{length:86137.66},model:{url:"$STATIC_ASSETS_URL/models/sc_tdrs/tdrs.gltf"},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis},secondary:{type:"align",axis:r.Vector3.ZAxis,target:"earth",targetAxis:r.Vector3.ZAxis}},dynamo:[{url:"sc_tdrs_5"}]},sc_tdrs_6:{groups:["earth","spacecraft"],occlusionRadius:.0085,extentsRadius:.0085,label:"TDRS 6",parents:[[344589947.18311954,"earth"]],trail:{length:86137.66},model:{url:"$STATIC_ASSETS_URL/models/sc_tdrs/tdrs.gltf"},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis},secondary:{type:"align",axis:r.Vector3.ZAxis,target:"earth",targetAxis:r.Vector3.ZAxis}},dynamo:[{url:"sc_tdrs_6"}]},sc_tdrs_7:{groups:["earth","spacecraft"],occlusionRadius:.0085,extentsRadius:.0085,label:"TDRS 7",parents:[[344589947.18311954,"earth"]],trail:{length:86151},model:{url:"$STATIC_ASSETS_URL/models/sc_tdrs/tdrs.gltf"},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis},secondary:{type:"align",axis:r.Vector3.ZAxis,target:"earth",targetAxis:r.Vector3.ZAxis}},dynamo:[{url:"sc_tdrs_7"}]},sc_tdrs_8:{groups:["earth","spacecraft"],occlusionRadius:.0085,extentsRadius:.0085,label:"TDRS 8",parents:[[344589947.18311954,"earth"]],trail:{length:86151.2},model:{url:"$STATIC_ASSETS_URL/models/sc_tdrs/tdrs.gltf"},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis},secondary:{type:"align",axis:r.Vector3.ZAxis,target:"earth",targetAxis:r.Vector3.ZAxis}},dynamo:[{url:"sc_tdrs_8"}]},sc_tdrs_9:{groups:["earth","spacecraft"],occlusionRadius:.0085,extentsRadius:.0085,label:"TDRS 9",parents:[[344589947.18311954,"earth"]],trail:{length:86151},model:{url:"$STATIC_ASSETS_URL/models/sc_tdrs/tdrs.gltf"},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis},secondary:{type:"align",axis:r.Vector3.ZAxis,target:"earth",targetAxis:r.Vector3.ZAxis}},dynamo:[{url:"sc_tdrs_9"}]},sc_tdrs_10:{groups:["earth","spacecraft"],occlusionRadius:.0085,extentsRadius:.0085,label:"TDRS 10",parents:[[344589947.18311954,"earth"]],trail:{length:86151.2},model:{url:"$STATIC_ASSETS_URL/models/sc_tdrs/tdrs.gltf"},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis},secondary:{type:"align",axis:r.Vector3.ZAxis,target:"earth",targetAxis:r.Vector3.ZAxis}},dynamo:[{url:"sc_tdrs_10"}]},sc_tdrs_11:{groups:["earth","spacecraft"],occlusionRadius:.0085,extentsRadius:.0085,label:"TDRS 11",parents:[[412868947.185,"earth"]],trail:{length:86151},model:{url:"$STATIC_ASSETS_URL/models/sc_tdrs/tdrs.gltf"},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis},secondary:{type:"align",axis:r.Vector3.ZAxis,target:"earth",targetAxis:r.Vector3.ZAxis}},dynamo:[{url:"sc_tdrs_11"}]},sc_tdrs_12:{groups:["earth","spacecraft"],occlusionRadius:.0085,extentsRadius:.0085,label:"TDRS 12",parents:[[443808067.185,"earth"]],trail:{length:86151},model:{url:"$STATIC_ASSETS_URL/models/sc_tdrs/tdrs.gltf"},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis},secondary:{type:"align",axis:r.Vector3.ZAxis,target:"earth",targetAxis:r.Vector3.ZAxis}},dynamo:[{url:"sc_tdrs_12"}]},sc_tdrs_13:{groups:["earth","spacecraft"],occlusionRadius:.0085,extentsRadius:.0085,label:"TDRS 13",parents:[[556338669.183,"earth"]],trail:{length:86151},model:{url:"$STATIC_ASSETS_URL/models/sc_tdrs/tdrs.gltf"},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis},secondary:{type:"align",axis:r.Vector3.ZAxis,target:"earth",targetAxis:r.Vector3.ZAxis}},dynamo:[{url:"sc_tdrs_13"}]},sc_terra:{groups:["earth","spacecraft"],occlusionRadius:.0034,extentsRadius:.006,label:"Terra",parents:[[344589947.18311954,"earth"]],trail:{length:5933.33},model:{url:"$STATIC_ASSETS_URL/models/sc_terra/Terra.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_terra",axis:r.Vector3.XAxisNeg}},dynamo:[{url:"sc_terra"}]},sc_tess:{groups:["earth","spacecraft","telescope"],occlusionRadius:.002,extentsRadius:.003,label:"TESS",parents:[[577366932.3626,"earth"]],trail:{length:591840},model:{url:"$STATIC_ASSETS_URL/models/sc_tess/TESS.gltf",shadowEntities:["earth","moon"]},fixed:{orientation:r.Quaternion.Identity},dynamo:[{url:"sc_tess/earth/orb"}]},sc_themis_a:{groups:["earth","spacecraft"],occlusionRadius:4e-4,extentsRadius:.0017,label:"THEMIS A",parents:[[344589947.18311954,"earth"]],trail:{length:98428},model:{url:"$STATIC_ASSETS_URL/models/sc_themis/themis.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis}},spin:{axis:r.Vector3.YAxis,periodInHours:8333e-7},dynamo:[{url:"sc_themis_a"}]},sc_themis_d:{groups:["earth","spacecraft"],occlusionRadius:4e-4,extentsRadius:.0017,label:"THEMIS D",parents:[[344589947.18311954,"earth"]],trail:{length:114807},model:{url:"$STATIC_ASSETS_URL/models/sc_themis/themis.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis}},spin:{axis:r.Vector3.YAxis,periodInHours:8333e-7},dynamo:[{url:"sc_themis_d"}]},sc_themis_e:{groups:["earth","spacecraft"],occlusionRadius:4e-4,extentsRadius:.0017,label:"THEMIS E",parents:[[344589947.18311954,"earth"]],trail:{length:105907.5},model:{url:"$STATIC_ASSETS_URL/models/sc_themis/themis.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"sun",axis:r.Vector3.YAxis}},spin:{axis:r.Vector3.YAxis,periodInHours:8333e-7},dynamo:[{url:"sc_themis_e"}]},sc_timed:{groups:["earth","spacecraft"],occlusionRadius:.0015,extentsRadius:.005,label:"TIMED",parents:[[344589947.18311954,"earth"]],trail:{length:5933},dynamo:[{url:"sc_timed"}]},sc_trmm:{groups:["earth","spacecraft"],occlusionRadius:.00255,extentsRadius:.0073,label:"TRMM",parents:[[-66052736.817,"earth"],[482328067.186,""]],trail:{length:5545.6},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_trmm",axis:r.Vector3.XAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_trmm/TRMM.gltf",shadowEntities:["earth","moon"]},tle:{tleName:"TRMM",url:"$DYNAMIC_ASSETS_URL/tle/local_tles.txt",coverage:[-66052736.817,482328067.186]}},sc_uars:{groups:["earth","spacecraft"],occlusionRadius:.00535,extentsRadius:.00535,label:"UARS",parents:[[352800006.1854904,"earth"],[370106644.184,""]],trail:{length:5490},animdata:[{url:"sc_uars",type:"pos"}]},sc_wind:{groups:["earth","spacecraft"],occlusionRadius:.0012,extentsRadius:.0075,label:"WIND",parents:[[330091266.1844764,"earth"],[650203266.1830707,""]],trail:{length:16485927},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxisNeg},secondary:{type:"velocity",target:"sc_wind",axis:r.Vector3.XAxisNeg}},model:{url:"$STATIC_ASSETS_URL/models/sc_wind/wind.gltf",shadowEntities:["earth","moon"]},animdata:[{url:"sc_wind",type:"pos"}]},sc_wise:{groups:["earth","spacecraft"],occlusionRadius:.00142,extentsRadius:.00142,label:"WISE",parents:[[344589947.18311954,"earth"]],trail:{length:5715.4},dynamo:[{url:"sc_wise"}]}});const o={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(128),n=i(2);s.default.register({sc_apollo_15:{groups:["moon","spacecraft"],radius:.004,label:"Apollo 15",parents:[[-897044358.3260887,"moon"],[-896822958.3195117,""]],trail:{length:6855},fixed:{orientation:n.Quaternion.Identity},animdata:[{url:"sc_apollo_15",type:"pos"}]},sc_artemis_1:{groups:["moon","spacecraft"],radius:.005,label:"Artemis I",parents:[[721860361,"earth"],[724052473,""]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_artemis_1/artemis_cmsm.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"velocity",target:"sc_artemis_1",axis:n.Vector3.YAxis},secondary:{type:"align",target:"moon",axis:n.Vector3.ZAxis,targetAxis:n.Vector3.ZAxis}},dynamo:[{url:"sc_artemis_1/earth/pos"}]},sc_capstone:{groups:["moon","spacecraft"],radius:5e-4,label:"CAPSTONE",parents:[[710192447.9999855,"earth"],[721583059,"moon"]],trail:{length:void 0,lengthCoverages:[[4e6,Number.NEGATIVE_INFINITY,721583059],[1210909,721583059,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_capstone/capstone.gltf",shadowEntities:["earth","moon"]},align:{primary:{type:"point",target:"sun",axis:n.Vector3.ZAxisNeg},secondary:{type:"align",target:"moon",axis:n.Vector3.XAxis,targetAxis:n.Vector3.ZAxis}},dynamo:[{url:"sc_capstone/earth/orb"},{url:"sc_capstone/moon/orb"}]},sc_clementine:{groups:["moon","spacecraft"],radius:.002,label:"Clementine",parents:[[-187185539.81536362,"moon"],[-178496939.81459716,""]],trail:{length:5408.5},model:{url:"$STATIC_ASSETS_URL/models/sc_clementine/clementine.gltf",shadowEntities:["moon"]},align:{primary:{type:"point",target:"earth",axis:n.Vector3.YAxisNeg},secondary:{type:"point",target:"sun",axis:n.Vector3.ZAxisNeg}},animdata:[{url:"sc_clementine/moon/all",type:"pos"}]},sc_grail_a:{groups:["moon","spacecraft"],radius:.001,label:"Ebb",parents:[[368763e3,"moon"],[414201667.18513304,""]],trail:{length:41115.75},model:{url:"$STATIC_ASSETS_URL/models/sc_grail/grail_b.gltf",shadowEntities:["moon"]},align:{primary:{type:"velocity",target:"sc_grail_a",axis:n.Vector3.XAxisNeg},secondary:{type:"point",target:"moon",axis:n.Vector3.ZAxis}},animdata:[{url:"sc_grail_a/moon/all",type:"pos"}]},sc_grail_b:{groups:["moon","spacecraft"],radius:.001,label:"Flow",parents:[[368763e3,"moon"],[414201667.18513304,""]],trail:{length:41239.8},model:{url:"$STATIC_ASSETS_URL/models/sc_grail/grail_b.gltf",shadowEntities:["moon"]},align:{primary:{type:"velocity",target:"sc_grail_b",axis:n.Vector3.XAxisNeg},secondary:{type:"point",target:"moon",axis:n.Vector3.ZAxis}},animdata:[{url:"sc_grail_b/moon/all",type:"pos"}]},sc_ladee:{groups:["moon","spacecraft"],radius:.0012,label:"LADEE",parents:[[431798467.18253195,"moon"],[451355187.44558257,""]],trail:{length:7889.57},model:{url:"$STATIC_ASSETS_URL/models/sc_ladee/ladee.gltf",shadowEntities:["moon"]},align:{primary:{type:"velocity",target:"sc_ladee",axis:n.Vector3.XAxisNeg},secondary:{type:"point",target:"moon",axis:n.Vector3.ZAxis}},animdata:[{url:"sc_ladee/moon/all",type:"pos"}]},sc_lcross:{groups:["moon","spacecraft"],occlusionRadius:.0013,extentsRadius:.0022,label:"LCROSS",parents:[[298635466.0304444,"moon"],[308360200.75,""]],trail:{length:3598022},model:{url:"$STATIC_ASSETS_URL/models/sc_lcross/lcross.gltf",rotate:[{z:-90}],shadowEntities:["moon"]},align:{primary:{type:"velocity",target:"sc_lcross",axis:n.Vector3.XAxisNeg},secondary:{type:"point",target:"moon",axis:n.Vector3.ZAxis}},animdata:[{url:"sc_lcross/moon/all",type:"pos",coverage:[Number.NEGATIVE_INFINITY,308360200.75]}]},sc_lcross_impact_site:{groups:["moon","sc_lcross","sites"],radius:.001,systemRadius:200,label:"LCROSS Impact Site",parents:[[298635466.0304444,"moon"]],fixed:{llaOnSpheroid:new n.LatLonAlt(-1.4782008103461848,-.8648271467797672,0),coverage:[298635466.0304444,Number.POSITIVE_INFINITY]}},sc_lunar_flashlight:{groups:["moon","spacecraft"],occlusionRadius:25e-5,extentsRadius:5e-4,label:"Lunar Flashlight",parents:[[721683922,"earth"],[730710213,"moon"]],trail:{length:7106.66,lengthCoverages:[[1e7,Number.NEGATIVE_INFINITY,730710213],[4e5,730710213,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_lunar_flashlight/lunar_flashlight.gltf",shadowEntities:["moon"]},align:{primary:{type:"align",target:"moon",axis:n.Vector3.ZAxisNeg,targetAxis:n.Vector3.ZAxis},secondary:{type:"point",target:"sun",axis:n.Vector3.YAxis}},dynamo:[{url:"sc_lunar_flashlight/earth/orb"},{url:"sc_lunar_flashlight/moon/orb"}]},sc_lunar_prospector:{groups:["moon","spacecraft"],occlusionRadius:653e-6,extentsRadius:.0022,label:"Lunar Prospector",parents:[[-62206800,"moon"],[-13402020,""]],trail:{length:7260},model:{url:"$STATIC_ASSETS_URL/models/sc_lunar_prospector/lunar_prospector.gltf",shadowEntities:["moon"]},align:{primary:{type:"align",target:"moon",axis:n.Vector3.YAxisNeg,targetAxis:n.Vector3.ZAxis}},spin:{axis:n.Vector3.YAxisNeg,periodInHours:.008333},animdata:[{url:"sc_lunar_prospector/moon/all",type:"pos"}]},sc_lunar_reconnaissance_orbiter:{groups:["moon","spacecraft"],occlusionRadius:.00272,extentsRadius:.0038,label:"Lunar Reconnaissance Orbiter",parents:[[298635426.1844444,"earth"],[298929666,"moon"]],trail:{length:7106.66,lengthCoverages:[[1e6,Number.NEGATIVE_INFINITY,299040641],[7106.66,299040641,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_lunar_reconnaissance_orbiter/LRO.gltf",rotate:[{z:-90}],shadowEntities:["moon"]},align:{primary:{type:"velocity",target:"sc_lunar_reconnaissance_orbiter",axis:n.Vector3.XAxisNeg},secondary:{type:"point",target:"moon",axis:n.Vector3.ZAxis}},dynamo:[{url:"sc_lunar_reconnaissance_orbiter/earth/orb"},{url:"sc_lunar_reconnaissance_orbiter/moon/orb"},{url:"sc_lunar_reconnaissance_orbiter/ori"}]},sc_smart_1:{groups:["moon","spacecraft"],occlusionRadius:.0015,extentsRadius:.00653,label:"SMART-1",parents:[[117977163.35299999,"moon"],[210585600,""]],trail:{length:273091},fixed:{orientation:n.Quaternion.Identity},animdata:[{url:"sc_smart_1/moon/all",type:"pos"}]},sc_themis_b:{groups:["moon","spacecraft"],occlusionRadius:4e-4,extentsRadius:.0017,label:"ARTEMIS P1",parents:[[366638466.1829504,"moon"],[694267209.1839211,""]],trail:{length:94838},model:{url:"$STATIC_ASSETS_URL/models/sc_themis/themis.gltf",shadowEntities:["moon"]},align:{primary:{type:"point",target:"sun",axis:n.Vector3.YAxis}},spin:{axis:n.Vector3.YAxis,periodInHours:8333e-7},animdata:[{url:"sc_themis_b/moon/all",type:"pos"}]},sc_themis_c:{groups:["moon","spacecraft"],occlusionRadius:4e-4,extentsRadius:.0017,label:"ARTEMIS P2",parents:[[366638466.1829504,"moon"],[694267209.1839211,""]],trail:{length:204186},model:{url:"$STATIC_ASSETS_URL/models/sc_themis/themis.gltf",shadowEntities:["moon"]},align:{primary:{type:"point",target:"sun",axis:n.Vector3.YAxis}},spin:{axis:n.Vector3.YAxis,periodInHours:8333e-7},animdata:[{url:"sc_themis_c/moon/all",type:"pos"}]}});const r={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(128),n=i(2);s.default.register({sc_mars_science_laboratory:{groups:["mars","spacecraft","landers"],occlusionRadius:.001515,extentsRadius:.004,label:"MSL",parents:[[375594732.3829685,"earth"],[376039259,"sun"],[397477501,"mars"],[397502026,"sc_mars_science_laboratory_landing_site"]],trail:{length:6720,lengthCoverages:[[1e7,Number.NEGATIVE_INFINITY,397477501],[6720,397477501,397502026],[0,397502026,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_mars_science_laboratory/msl_cruisestage.gltf"},align:{primary:{type:"point",target:"sc_mars_science_laboratory_landing_site",axis:n.Vector3.YAxisNeg}},dynamo:[{url:"sc_mars_science_laboratory/earth/orb"},{url:"sc_mars_science_laboratory/sun/orb"},{url:"sc_mars_science_laboratory/mars/pos"},{url:"sc_mars_science_laboratory/surface/pos"}],spin:{axis:n.Vector3.YAxisNeg,periodInHours:.00833333333,coverage:[Number.NEGATIVE_INFINITY,397502026]},postCreateFunction:t=>{const e=t.addController("rotate","landingRotation",t.getControllerByType("align")),i=new n.Quaternion;i.setFromAxes(n.Vector3.YAxis,n.Vector3.XAxisNeg,void 0),e.setRotation(i),e.setRotatingOrientation(!1),e.setCoverage(new n.Interval(397502026,Number.POSITIVE_INFINITY));const s=t.addController("rotateByEntityOrientation","landingRotateByParent",t.getControllerByType("align"));s.setRotatingOrientation(!1),s.setCoverage(new n.Interval(397502026,Number.POSITIVE_INFINITY))}},sc_mars_science_laboratory_landing_site:{groups:["mars","sc_mars_science_laboratory","sites"],occlusionRadius:.001515,extentsRadius:.004,systemRadius:200,label:"MSL Landing Site",parents:[[375594732.3829685,"mars"]],fixed:{llaOnSpheroid:new n.LatLonAlt(-4.643851*Math.PI/180,137.4417*Math.PI/180,-4.926878),coverage:[375594732.3829685,Number.POSITIVE_INFINITY]}},sc_mars_exploration_rover_1:{groups:["mars","spacecraft","landers"],occlusionRadius:.0013,extentsRadius:.0026,label:"Opportunity",parents:[[110911022.184,"earth"],[111234172,"sun"],[128262836,"mars"],[128278419,"sc_mars_exploration_rover_1_landing_site"],[581920316.8566707,""]],trail:{length:6720,lengthCoverages:[[1e7,Number.NEGATIVE_INFINITY,128262836],[6720,128262836,128278419],[0,128278523.336,581920316.856]]},model:{url:"$STATIC_ASSETS_URL/models/sc_mars_exploration_rover/cruise/mpf_mera_merb_cruise.gltf",rotate:[{x:90}]},align:{primary:{type:"velocity",target:"sc_mars_exploration_rover_1",axis:n.Vector3.ZAxisNeg},secondary:{type:"align",target:"mars",axis:n.Vector3.YAxis,targetAxis:n.Vector3.ZAxis},coverage:[Number.NEGATIVE_INFINITY,128278523.336]},dynamo:[{url:"sc_mars_exploration_rover_1/earth/orb"},{url:"sc_mars_exploration_rover_1/sun/orb"},{url:"sc_mars_exploration_rover_1/mars/pos"},{url:"sc_mars_exploration_rover_1/edl/pos"},{url:"sc_mars_exploration_rover_1/surface/pos"}],coverages:[{coverage:[128278419,581920316.856],enter:t=>{const e=t.getComponentByType("trail");null!==e&&e.setRelativeToEntityOrientation(!0)},exit:t=>{const e=t.getComponentByType("trail");null!==e&&e.setRelativeToEntityOrientation(!1)}},{coverage:[128278523.336,581920316.856],enter:t=>{const e=t.getComponentByType("model");null!==e&&e.setUrl("$STATIC_ASSETS_URL/models/sc_mars_exploration_rover/rover/mer_static.gltf")},exit:t=>{const e=t.getComponentByType("model");null!==e&&e.setUrl("$STATIC_ASSETS_URL/models/sc_mars_exploration_rover/cruise/mpf_mera_merb_cruise.gltf")}},{coverage:[Number.NEGATIVE_INFINITY,128262836],enter:t=>{const e=t.getControllerByType("align");null!==e&&(e.setPrimaryAlignType("point"),e.setPrimaryAxis(n.Vector3.ZAxis),e.setPrimaryTargetEntity("sun"))},exit:t=>{const e=t.getControllerByType("align");null!==e&&(e.setPrimaryAlignType("velocity"),e.setPrimaryAxis(n.Vector3.ZAxisNeg),e.setPrimaryTargetEntity("sc_mars_exploration_rover_1"))}}],postCreateFunction:t=>{const e=t.addController("fixed");e.setOrientation(n.Quaternion.Identity),e.setCoverage(new n.Interval(128278523.336,581920316.856));const i=t.addController("rotate"),s=new n.Quaternion;s.setFromAxes(n.Vector3.YAxis,n.Vector3.XAxisNeg,void 0),i.setRotation(s),i.setRotatingOrientation(!1),i.setCoverage(new n.Interval(128278419,581920316.856));t.addController("rotateByEntityOrientation","landingRotateByEntity",t.getControllerByType("align")).setCoverage(new n.Interval(128278419,581920316.856))}},sc_mars_exploration_rover_1_landing_site:{groups:["mars","sc_mars_exploration_rover_1","sites"],radius:.001,systemRadius:200,label:"Opportunity Landing Site",parents:[[110911022.184,"mars"]],fixed:{llaOnSpheroid:new n.LatLonAlt(-.034003934569818886,-.09644392740547784,-2.018490164449304),coverage:[110911022.184,Number.POSITIVE_INFINITY]}},sc_mars_exploration_rover_2:{groups:["mars","spacecraft","landers"],occlusionRadius:.0013,extentsRadius:.0026,label:"Spirit",parents:[[108541883.184,"earth"],[108887371,"sun"],[126444477,"mars"],[126462105,"sc_mars_exploration_rover_2_landing_site"],[322567479.3896215,""]],trail:{length:6720,lengthCoverages:[[1e7,Number.NEGATIVE_INFINITY,126444477],[6720,126444477,126462105],[0,126462396.1058,322567479.38962]]},model:{url:"$STATIC_ASSETS_URL/models/sc_mars_exploration_rover/cruise/mpf_mera_merb_cruise.gltf",rotate:[{x:90}]},align:{primary:{type:"velocity",target:"sc_mars_exploration_rover_2",axis:n.Vector3.ZAxisNeg},secondary:{type:"align",target:"mars",axis:n.Vector3.YAxis,targetAxis:n.Vector3.ZAxis},coverage:[Number.NEGATIVE_INFINITY,126462105]},dynamo:[{url:"sc_mars_exploration_rover_2/earth/orb"},{url:"sc_mars_exploration_rover_2/sun/orb"},{url:"sc_mars_exploration_rover_2/mars/pos"},{url:"sc_mars_exploration_rover_2/edl/pos"},{url:"sc_mars_exploration_rover_2/surface/pos"}],coverages:[{coverage:[126462105,322567479.38962],enter:t=>{const e=t.getComponentByType("trail");null!==e&&e.setRelativeToEntityOrientation(!0)},exit:t=>{const e=t.getComponentByType("trail");null!==e&&e.setRelativeToEntityOrientation(!1)}},{coverage:[126462396.1058,322567479.38962],enter:t=>{const e=t.getComponentByType("model");null!==e&&e.setUrl("$STATIC_ASSETS_URL/models/sc_mars_exploration_rover/rover/mer_static.gltf")},exit:t=>{const e=t.getComponentByType("model");null!==e&&e.setUrl("$STATIC_ASSETS_URL/models/sc_mars_exploration_rover/cruise/mpf_mera_merb_cruise.gltf")}},{coverage:[Number.NEGATIVE_INFINITY,126444477],enter:t=>{const e=t.getControllerByType("align");null!==e&&(e.setPrimaryAlignType("point"),e.setPrimaryAxis(n.Vector3.ZAxis),e.setPrimaryTargetEntity("sun"))},exit:t=>{const e=t.getControllerByType("align");null!==e&&(e.setPrimaryAlignType("velocity"),e.setPrimaryAxis(n.Vector3.ZAxisNeg),e.setPrimaryTargetEntity("sc_mars_exploration_rover_2"))}}],postCreateFunction:t=>{const e=t.addController("fixed");e.setOrientation(n.Quaternion.Identity),e.setCoverage(new n.Interval(126462105,322567479.38962));const i=t.addController("rotate"),s=new n.Quaternion;s.setFromAxes(n.Vector3.YAxis,n.Vector3.XAxisNeg,void 0),i.setRotation(s),i.setRotatingOrientation(!1),i.setCoverage(new n.Interval(126462105,322567479.38962));t.addController("rotateByEntityOrientation","landingRotateByEntity",t.getControllerByType("align")).setCoverage(new n.Interval(126462105,322567479.38962))}},sc_mars_exploration_rover_2_landing_site:{groups:["mars","sc_mars_exploration_rover_2","sites"],radius:.001,systemRadius:200,label:"Spirit Landing Site",parents:[[108541883.184,"mars"]],fixed:{llaOnSpheroid:new n.LatLonAlt(-.25432749290990797,3.062677242395019,-2.614394925059969),coverage:[108541883.184,Number.POSITIVE_INFINITY]}},sc_insight:{groups:["mars","spacecraft","landers"],radius:.00306,label:"InSight",parents:[[578795968.9654216,"earth"],[579182469.185,"sun"],[596376069.183,"mars"]],trail:{length:32137022.16,lengthCoverages:[[32137022.16,Number.NEGATIVE_INFINITY,596376069.183],[14400,596376069.183,596529871.284],[3600,596529871.284,596533602],[0,596533602,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_insight/model.gltf",rotate:[{y:90}]},align:{primary:{type:"point",target:"mars",axis:n.Vector3.ZAxisNeg},secondary:{type:"align",target:"mars",axis:n.Vector3.YAxis,targetAxis:n.Vector3.ZAxis}},dynamo:[{url:"sc_insight/earth/pos"},{url:"sc_insight/sun/orb"},{url:"sc_insight/mars/orb"},{url:"sc_insight_edl/mars/pos"},{url:"sc_insight/ori"},{url:"sc_insight_edl/ori"}],coverages:[{coverage:[596529871.284,596533602],enter:t=>{const e=t.get("trail");null!==e&&e.setRelativeToEntityOrientation(!0)},exit:t=>{const e=t.get("trail");null!==e&&e.setRelativeToEntityOrientation(!1)}}],postCreateFunction:t=>{const e=t.getControllerByType("align"),i=t.addController("fixed","fixedLanding",e);i.setPosition(new n.Vector3(-2432.935716315694,2349.9743692542434,267.1293812071009)),i.setCoverage(new n.Interval(596533602,Number.POSITIVE_INFINITY));const s=t.addController("rotateByEntityOrientation","fixedLandingRotation",e);s.setRotatingOrientation(!1),s.setCoverage(new n.Interval(596533602,Number.POSITIVE_INFINITY))}},sc_insight_landing_site:{groups:["mars","sc_insight","sites"],radius:.001,systemRadius:200,label:"InSight Landing Site",parents:[[578795968.9654216,"mars"],[596533602,""]],fixed:{llaOnSpheroid:new n.LatLonAlt(.07880952080218703,2.3735381213938798,-2.9965049849733987),coverage:[578795968.9654216,596533602]}},sc_marco_a:{groups:["mars","spacecraft"],radius:44375e-8,label:"MarCO A",parents:[[578796051,"earth"],[579182469.185,"sun"],[596376069.183,"mars"],[596552080,"sun"],[631152e3,""]],trail:{length:6720,lengthCoverages:[[1e7,Number.NEGATIVE_INFINITY,579182469.185],[6720,579182469.185,596552080],[1e7,596552080,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_marco/model.gltf"},dynamo:[{url:"sc_marco_a/earth/orb"},{url:"sc_marco_a/sun/1/orb"},{url:"sc_marco_a/mars/orb"},{url:"sc_marco_a/sun/2/orb"}],align:{primary:{type:"point",target:"sun",axis:n.Vector3.YAxis}}},sc_marco_b:{groups:["mars","spacecraft"],radius:44375e-8,label:"MarCO B",parents:[[578796051,"earth"],[579182469.185,"sun"],[596376069.183,"mars"],[596552080,"sun"],[631152e3,""]],trail:{length:6720,lengthCoverages:[[1e7,Number.NEGATIVE_INFINITY,579182469.185],[6720,579182469.185,596552080],[1e7,596552080,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_marco/model.gltf"},dynamo:[{url:"sc_marco_b/earth/orb"},{url:"sc_marco_b/sun/1/orb"},{url:"sc_marco_b/mars/orb"},{url:"sc_marco_b/sun/2/orb"}],align:{primary:{type:"point",target:"sun",axis:n.Vector3.YAxis}}},sc_mars_odyssey:{groups:["mars","spacecraft"],occlusionRadius:.0013,extentsRadius:.004,label:"Mars Odyssey",parents:[[39932700,"earth"],[40233664,"sun"],[57128464,"mars"]],trail:{length:6727,lengthCoverages:[[1e7,Number.NEGATIVE_INFINITY,57128464],[6727,57128464,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_mars_odyssey/mars_odyssey.gltf",environmentMap:{cubemap:"$STATIC_ASSETS_URL/env_maps/park_gray/$FACE.jpg"},shadowEntities:["mars","deimos","phobos"]},align:{primary:{type:"point",target:"mars",axis:new n.Vector3(-.95630475596,.29237170472,0)},secondary:{type:"velocity",target:"sc_mars_odyssey",axis:new n.Vector3(.29237170472,.95630475596,0)}},dynamo:[{url:"sc_mars_odyssey/earth/orb"},{url:"sc_mars_odyssey/sun/orb"},{url:"sc_mars_odyssey/mars/orb"},{url:"sc_mars_odyssey/ori"}]},sc_mars_reconnaissance_orbiter:{groups:["mars","spacecraft"],radius:.0068,label:"Mars Reconnaissance Orbiter",parents:[[177122516,"earth"],[177429664,"sun"],[195285665,"mars"]],trail:{length:6720,lengthCoverages:[[1e7,Number.NEGATIVE_INFINITY,195285665],[6720,195285665,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_mars_reconnaissance_orbiter/MRO.gltf",environmentMap:{cubemap:"$STATIC_ASSETS_URL/env_maps/park_gray/$FACE.jpg"},shadowEntities:["mars","deimos","phobos"]},align:{primary:{type:"point",target:"mars",axis:n.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_mars_reconnaissance_orbiter",axis:n.Vector3.XAxis}},dynamo:[{url:"sc_mars_reconnaissance_orbiter/earth/orb"},{url:"sc_mars_reconnaissance_orbiter/sun/orb"},{url:"sc_mars_reconnaissance_orbiter/mars/orb"},{url:"sc_mars_reconnaissance_orbiter/ori"}]},sc_maven:{groups:["mars","spacecraft"],radius:.0057,label:"MAVEN",parents:[[438074509.3428109,"earth"],[438296467,"sun"],[464590867,"mars"]],trail:{length:16139},model:{url:"$STATIC_ASSETS_URL/models/sc_maven/Maven.gltf",rotate:[{x:90},{z:90}],environmentMap:{cubemap:"$STATIC_ASSETS_URL/env_maps/park_gray/$FACE.jpg"},shadowEntities:["mars","deimos","phobos"]},align:{primary:{type:"point",target:"sun",axis:n.Vector3.ZAxis}},dynamo:[{url:"sc_maven/earth/orb"},{url:"sc_maven/sun/orb"},{url:"sc_maven/mars/orb"},{url:"sc_maven/ori"}]},sc_mars_express:{groups:["mars","spacecraft"],radius:.006,label:"Mars Express",parents:[[107853140.59600002,"earth"],[108232264,"sun"],[125539264,"mars"]],trail:{length:25e3,lengthCoverages:[[1e7,Number.NEGATIVE_INFINITY,126749131],[12720,126749131,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_mars_express/mars_express.gltf",rotate:[{x:90},{z:-180}],environmentMap:{cubemap:"$STATIC_ASSETS_URL/env_maps/park_gray/$FACE.jpg"},shadowEntities:["mars","deimos","phobos"]},align:{primary:{type:"point",target:"mars",axis:n.Vector3.XAxisNeg}},dynamo:[{url:"sc_mars_express/earth/orb"},{url:"sc_mars_express/sun/orb"},{url:"sc_mars_express/mars/orb"},{url:"sc_mars_express/ori"}]},sc_perseverance:{groups:["mars","spacecraft","landers"],occlusionRadius:.0015,extentsRadius:.003,label:"Mars 2020",parents:[[649385563.6433017,"earth"],[649595376,"sun"],[666932224,"mars"]],trail:{length:1e7},model:{url:"$STATIC_ASSETS_URL/models/sc_perseverance/cruise/MSLcruiseStage.gltf"},align:{primary:{type:"point",target:"sun",axis:n.Vector3.YAxis},coverage:[Number.NEGATIVE_INFINITY,666953078]},spin:{axis:n.Vector3.YAxis,periodInHours:-.00833333333,coverage:[Number.NEGATIVE_INFINITY,666932224]},dynamo:[{url:"sc_perseverance/earth/orb"},{url:"sc_perseverance/sun/orb"},{url:"sc_perseverance/mars/pos"}],coverages:[{coverage:[666952341,Number.POSITIVE_INFINITY],enter:t=>{const e=t.get("trail");null!==e&&(e.setStartTime(1e3),e.setRelativeToEntityOrientation(!0),e.resetPoints());const i=t.get("align");null!==i&&(i.setPrimaryAlignType("velocity"),i.setPrimaryAxis(n.Vector3.YAxisNeg),i.setPrimaryTargetEntity(t.getName())),t.get("spin").setEnabled(!1)},exit:t=>{const e=t.get("trail");null!==e&&(e.setStartTime(1e7),e.setRelativeToEntityOrientation(!1),e.resetPoints());const i=t.get("align");null!==i&&(i.setPrimaryAlignType("point"),i.setPrimaryAxis(n.Vector3.YAxis),i.setPrimaryTargetEntity("sun")),t.get("spin").setEnabled(!0)}}],postCreateFunction:t=>{const e=t.addController("fixed");e.setPosition(new n.Vector3(700.6720498758596,3140.3161023698767,1073.6913476720615)),e.setOrientation(n.Quaternion.Identity),e.setCoverage(new n.Interval(666953078,Number.POSITIVE_INFINITY));t.addController("rotateByEntityOrientation","landingRotateByEntity").setCoverage(new n.Interval(666953078,Number.POSITIVE_INFINITY))}},sc_perseverance_landing_site:{groups:["mars","sc_perseverance","sites"],radius:.001,systemRadius:200,label:"Perseverance Landing Site",parents:[[649385563.6433017,"mars"]],fixed:{llaOnSpheroid:new n.LatLonAlt(18.470270180371674*Math.PI/180,77.4326757785127*Math.PI/180,-2.2130185476344195),coverage:[649385563.6433017,Number.POSITIVE_INFINITY]}},sc_phoenix:{groups:["mars","spacecraft"],radius:.0027,label:"Phoenix",parents:[[239496427,"earth"],[239618121,"sun"],[265008306,"mars"],[265030318,"sc_phoenix_landing_site"],[278942465,""]],trail:{length:45411186,lengthCoverages:[[45411186,Number.NEGATIVE_INFINITY,265008306],[5e4,265008306,265030318],[500,265030318,265030769],[0,265030769,278942465]]},model:{url:"$STATIC_ASSETS_URL/models/sc_phoenix/cruise/phoenix_cruise.gltf",rotate:[{z:90}]},align:{primary:{type:"point",target:"sun",axis:n.Vector3.ZAxisNeg}},dynamo:[{url:"sc_phoenix/earth/orb"},{url:"sc_phoenix/sun/orb"},{url:"sc_phoenix/mars/orb"},{url:"sc_phoenix/phx_topo/pos"},{url:"sc_phoenix/ori"}],coverages:[{coverage:[265029904,Number.POSITIVE_INFINITY],enter:t=>{t.getComponentByType("model").setUrl("$STATIC_ASSETS_URL/models/sc_phoenix/edl/phoenix_edl.gltf")},exit:t=>{t.getComponentByType("model").setUrl("$STATIC_ASSETS_URL/models/sc_phoenix/cruise/phoenix_cruise.gltf")}}],postCreateFunction:t=>{const e=t.getControllerByType("align"),i=t.addController("fixed",void 0,e);i.setPosition(new n.Vector3(.027059368126568832,.013878235928918032,-.04367634407940447)),i.setCoverage(new n.Interval(265030769,278942465));const s=t.addController("rotateByEntityOrientation",void 0,e);s.setCoverage(new n.Interval(265030769,278942465)),s.setRotatingOrientation(!1),t.addParentChangedCallback(((t,e,i)=>{if(null!==i){const e=i.getName(),s=t.getComponentByType("trail");"sc_phoenix_landing_site"===e?(s.setRelativeToEntity("mars"),s.setRelativeToEntityOrientation(!0)):(s.setRelativeToEntity(""),s.setRelativeToEntityOrientation(!1))}}))}},sc_phoenix_landing_site:{groups:["mars","sc_phoenix","sites"],radius:.001,systemRadius:200,label:"Phoenix Landing Site",parents:[[239496427,"mars"]],fixed:{llaOnSpheroid:new n.LatLonAlt(1.1906355815662266,-2.1947740491302206,-2.5912352775421823),coverage:[239496427,Number.POSITIVE_INFINITY]}},sc_trace_gas_orbiter:{groups:["mars","spacecraft"],radius:.00875915,label:"Trace Gas Orbiter",parents:[[511257268,"earth"],[511941668,"sun"],[530107268,"mars"]],trail:{length:6720,lengthCoverages:[[1e7,Number.NEGATIVE_INFINITY,530160041],[6720,530160041,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_trace_gas_orbiter/TGO.gltf",rotate:[{x:-90},{y:-90}],environmentMap:{cubemap:"$STATIC_ASSETS_URL/env_maps/park_gray/$FACE.jpg"},shadowEntities:["mars","deimos","phobos"]},align:{primary:{type:"point",target:"mars",axis:n.Vector3.YAxisNeg},secondary:{type:"point",target:"sun",axis:n.Vector3.XAxisNeg}},dynamo:[{url:"sc_trace_gas_orbiter/earth/orb"},{url:"sc_trace_gas_orbiter/sun/orb"},{url:"sc_trace_gas_orbiter/mars/orb"},{url:"sc_trace_gas_orbiter/ori"}],postCreateFunction:t=>{let e=t.addController("align");e.setJoint("right_array_1"),e.setPrimaryAxis(n.Vector3.XAxis),e.setSecondaryAxis(n.Vector3.YAxis),e.setSecondaryAlignType("point"),e.setSecondaryTargetEntity("sun"),e=t.addController("align"),e.setJoint("left_array_1"),e.setPrimaryAxis(n.Vector3.XAxis),e.setSecondaryAxis(n.Vector3.YAxis),e.setSecondaryAlignType("point"),e.setSecondaryTargetEntity("sun")}},sc_mars_orbiter_mission:{groups:["mars","spacecraft"],radius:.00275,label:"Mars Orbiter Mission",parents:[[623211069.1823474,"mars"]],trail:{length:234146},animdata:[{url:"sc_mars_orbiter_mission/mars",type:"pos"}]},sc_mars_global_surveyor:{groups:["mars","spacecraft"],occlusionRadius:.003,extentsRadius:.005,label:"Mars Global Surveyor",parents:[[-72699545,"mars"],[215697664.184,""]],trail:{length:7068.67},model:{url:"$STATIC_ASSETS_URL/models/sc_mars_global_surveyor/mars_global_surveyor.gltf",shadowEntities:["mars"]},align:{primary:{type:"point",target:"mars",axis:n.Vector3.XAxisNeg}},animdata:[{url:"sc_mars_global_surveyor_mission",type:"pos"}]},sc_mars_climate_orbiter:{groups:["mars","spacecraft"],radius:.0011,label:"Mars Climate Orbiter",parents:[[-33318e3,"sun"],[-8650375.816,""]],trail:{length:73762215},fixed:{orientation:n.Quaternion.Identity},animdata:[{url:"sc_mars_climate_orbiter",type:"pos"}]},sc_mars_pathfinder:{groups:["mars","spacecraft"],radius:33e-5,label:"Mars Pathfinder",parents:[[-91704541,"sun"],[-78692880,""]],trail:{length:51497488},fixed:{orientation:n.Quaternion.Identity},animdata:[{url:"sc_mars_pathfinder",type:"pos"}]},sc_mars_pathfinder_landing_site:{groups:["mars","sc_mars_pathfinder","sites"],radius:.001,systemRadius:200,label:"Mars Pathfinder Landing Site",parents:[[-97045250.817,"mars"]],fixed:{llaOnSpheroid:new n.LatLonAlt(19.13*Math.PI/180,-33.22*Math.PI/180,0),coverage:[-97045250.817,Number.POSITIVE_INFINITY]}},sc_mars_polar_lander:{groups:["mars","spacecraft"],radius:.0018,label:"Mars Polar Lander",parents:[[-31298400,"sun"],[-2476735.816,""]],trail:{length:41109006},fixed:{orientation:n.Quaternion.Identity},animdata:[{url:"sc_mars_polar_lander",type:"pos"}]},sc_viking_1_orbiter:{groups:["mars","spacecraft"],radius:.0047,label:"Viking 1 Orbiter",parents:[[-742490410,"mars"],[-663249600,""]],trail:{length:88649},fixed:{orientation:n.Quaternion.Identity},animdata:[{url:"sc_viking_1_orbiter",type:"pos"}]},sc_viking_1_lander_landing_site:{groups:["mars","sc_viking_1_lander","sites"],radius:.001,systemRadius:200,label:"Viking 1 Lander Landing Site",parents:[[-768926233.817,"mars"]],fixed:{llaOnSpheroid:new n.LatLonAlt(22.27*Math.PI/180,312.05*Math.PI/180,0),coverage:[-768926233.817,Number.POSITIVE_INFINITY]}},sc_viking_2_orbiter:{groups:["mars","spacecraft"],radius:.0047,label:"Viking 2 Orbiter",parents:[[-738460186,"mars"],[-676517400,""]],trail:{length:98694},fixed:{orientation:n.Quaternion.Identity},animdata:[{url:"sc_viking_2_orbiter",type:"pos"}]},sc_viking_2_lander_landing_site:{groups:["mars","sc_viking_2_lander","sites"],radius:.001,systemRadius:200,label:"Viking 2 Lander Landing Site",parents:[[-767208013.818,"mars"]],fixed:{llaOnSpheroid:new n.LatLonAlt(47.64*Math.PI/180,-225.71*Math.PI/180,0),coverage:[-767208013.818,Number.POSITIVE_INFINITY]}}});const r={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(128),n=i(2);s.default.register({sc_messenger:{groups:["mercury","spacecraft"],occlusionRadius:.00133,extentsRadius:.0035,label:"MESSENGER",parents:[[144789279.39320505,"earth"],[145066469,"sun"],[175801890,"earth"],[176659095,"sun"],[214828942,"venus"],[215033751,"sun"],[234289415,"venus"],[234436749,"sun"],[253547108,"mercury"],[253671753,"sun"],[276485360,"mercury"],[276627276,"sun"],[307423681,"mercury"],[307651285,"sun"],[353474040,"mercury"],[483694028.351,""]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_messenger/Messenger.gltf",rotate:[{z:-90},{y:90}],shadowEntities:["mercury"]},align:{primary:{type:"point",target:"mercury",axis:n.Vector3.YAxis},secondary:{type:"velocity",target:"sc_messenger",axis:n.Vector3.ZAxis}},dynamo:[{url:"sc_messenger/earth/launch/orb"},{url:"sc_messenger/sun/1/orb"},{url:"sc_messenger/earth/flyby/orb"},{url:"sc_messenger/sun/2/orb"},{url:"sc_messenger/venus/flyby1/orb"},{url:"sc_messenger/sun/3/orb"},{url:"sc_messenger/venus/flyby2/orb"},{url:"sc_messenger/sun/4/orb"},{url:"sc_messenger/mercury/flyby1/orb"},{url:"sc_messenger/sun/5/orb"},{url:"sc_messenger/mercury/flyby2/orb"},{url:"sc_messenger/sun/6/orb"},{url:"sc_messenger/mercury/flyby3/orb"},{url:"sc_messenger/sun/7/orb"},{url:"sc_messenger/mercury/orb"},{url:"sc_messenger/ori"}]},sc_messenger_impact_site:{groups:["mercury","sc_messenger","sites"],radius:.001,label:"MESSENGER Impact Site",parents:[[Number.NEGATIVE_INFINITY,"mercury"]],fixed:{llaOnSpheroid:new n.LatLonAlt(.9501527254431932,-2.615904550043192,-.910251923861324),coverage:[483694028.351,Number.POSITIVE_INFINITY]}}});const r={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>d});var s=i(128),n=i(2),r=i(233),o=i(234);s.default.register({sc_juno:{groups:["jupiter","spacecraft"],occlusionRadius:.001732,extentsRadius:.01,label:"Juno",parents:[[365836752.1832,"earth"],[366088266.183,"sun"],[434433667.182,"earth"],[434793667.182,"sun"],[519652868.184,"jupiter"],[676339597,"ganymede"],[676381521,"jupiter"],[717700360,"europa"],[717727733,"jupiter"],[757191924,"io"],[757203571,"jupiter"],[760247560,"io"],[760262808,"jupiter"]],trail:{length:void 0,lengthCoverages:[[63072e3,Number.NEGATIVE_INFINITY,519652868.184],[5184e3,519652868.184,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_juno/Juno.gltf",rotate:[{x:90}],shadowEntities:["jupiter","europa","ganymede","callisto","io"]},dynamo:[{url:"sc_juno/earth/launch/orb"},{url:"sc_juno/sun/preflyby/orb"},{url:"sc_juno/earth/flyby/orb"},{url:"sc_juno/sun/postflyby/orb"},{url:"sc_juno/jupiter/orb"},{url:"sc_juno/ganymede/orb"},{url:"sc_juno/europa/orb"},{url:"sc_juno/io/1/orb"},{url:"sc_juno/io/2/orb"},{url:"sc_juno/ori"}],coverages:[{coverage:[393471366,529749008],update:t=>{const e=t.getComponentByType("model").getThreeJsObjectByName("engine_cover");if(null!==e){const i=t.getScene().getEngine().getTime(),s=n.Sort.getIndex(i,a,((t,e)=>t[1]<e)),r=a[s][0],o=a[s][1],l=n.MathUtils.clamp01(((o-r)/2-Math.abs(i-(o+r)/2))/600);e.rotation.x=n.MathUtils.lerp(Math.PI,Math.PI/8,l)}},exit:t=>{const e=t.getComponentByType("model").getThreeJsObjectByName("engine_cover");null!==e&&(e.rotation.x=Math.PI)}},{coverage:[399637867.183,520959604.184],update:t=>{const e=t.getComponentByType("particleSpray"),i=t.getScene().getEngine().getTime(),s=n.Sort.getIndex(i,l,((t,e)=>t[1]<e)),r=l[s][0],o=l[s][1],a=r<=i&&i<o;e.setEnabled(a)},exit:t=>{t.getComponentByType("particleSpray").setEnabled(!1)}},{coverage:[519652868.184,Number.POSITIVE_INFINITY],enter:t=>{const e=t.getComponentByType("trail");e&&e.setRelativeToEntity("jupiter")},exit:t=>{const e=t.getComponentByType("trail");e&&e.setRelativeToEntity("")}}],postCreateFunction:t=>{const e=t.getScene().getEngine();e.isControllerTypeRegistered("keyframePointing")||e.registerControllerType("keyframePointing",r.default),e.isControllerTypeRegistered("keyframeSpin")||e.registerControllerType("keyframeSpin",o.default);const i=t.addController("fixed",void 0,t.getControllerByType("dynamo"));i.setOrientation(n.Quaternion.Identity),i.setCoverage(new n.Interval(365836752.1832,Number.POSITIVE_INFINITY));const s=t.addController("keyframePointing");s.setKeyframes(h),s.setDirection(n.Vector3.ZAxis),s.setCoverage(new n.Interval(365836752.1832,521025625));const a=t.addController("keyframeSpin");a.setKeyframes(c),a.setAxis(n.Vector3.ZAxis),a.setCoverage(new n.Interval(365836752.1832,521025625)),a.setStartingAngle(-.96);const l=t.addComponent("particleSpray");l.setNumberOfParticles(100),l.setSizeOfParticles(3e-4),l.setSpeedOfParticles(.01),l.setColorOfParticles(new n.Color(1,.75,0,.25)),l.setSpread(-3),l.setParticleSpacingRandom(!1),l.setLength(.003),l.setOriginOffset(new n.Vector3(0,0,-.0017)),l.setDirection(n.Vector3.ZAxisNeg),l.setEnabled(!1)}},sc_cassini:{groups:["saturn","spacecraft"],occlusionRadius:.0034,extentsRadius:.0055,label:"Cassini",parents:[[-69820368.42763124,"earth"],[-69537536.818,"sun"],[-53179136.814,"venus"],[-53092736.814,"sun"],[-16495135.816,"venus"],[-16451935.816,"sun"],[-11951935.817,"earth"],[-11660335.817,"sun"],[139219264.185,"saturn"],[558743640,""]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_cassini/Cassini.gltf",rotate:[{x:-90},{z:180}],shadowEntities:["saturn","titan","enceladus","mimas","tethys"]},dynamo:[{url:"sc_cassini/earth/launch/orb"},{url:"sc_cassini/sun/1/orb"},{url:"sc_cassini/venus/flyby1/orb"},{url:"sc_cassini/sun/2/orb"},{url:"sc_cassini/venus/flyby2/orb"},{url:"sc_cassini/sun/3/orb"},{url:"sc_cassini/earth/flyby/orb"},{url:"sc_cassini/sun/4/orb"},{url:"sc_cassini/saturn/orb"},{url:"sc_cassini/ori"}],coverages:[{coverage:[157212064.184,Number.POSITIVE_INFINITY],enter:t=>{const e=t.get("model");null!==e&&e.setHiddenObject("huygens_probe",!0)},exit:t=>{const e=t.get("model");null!==e&&e.setHiddenObject("huygens_probe",!1)}}]},sc_europa_clipper:{groups:["jupiter","europa","ganymede","callisto","spacecraft"],occlusionRadius:.003,extentsRadius:.011,label:"Europa Clipper",parents:[[781796651,"sun"],[849443647,"earth"],[849694384,"sun"],[954569001,"jupiter"],[1096736672,""]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_europa_clipper/europa_clipper.gltf",shadowEntities:["jupiter","earth","mars","europa"]},align:{primary:{type:"point",target:"sun",axis:n.Vector3.ZAxis}},dynamo:[{url:"sc_europa_clipper/sun/orb"},{url:"sc_europa_clipper/earth/flyby/orb"},{url:"sc_europa_clipper/jupiter/orb"}]},sc_galileo:{groups:["jupiter","spacecraft"],occlusionRadius:.003,extentsRadius:.0055,label:"Galileo",parents:[[-321964226.73959994,"earth"],[-321559829,"sun"],[-312199026,"venus"],[-311946958,"sun"],[-286252262,"earth"],[-285827020,"sun"],[-223105356,"earth"],[-222610262,"sun"],[-129268796,"jupiter"],[117442702,""]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_galileo/galileo.gltf",shadowEntities:["jupiter","earth","venus"],rotate:[{x:-90},{z:180}]},dynamo:[{url:"sc_galileo/earth/launch/orb"},{url:"sc_galileo/sun/orb"},{url:"sc_galileo/venus/flyby/orb"},{url:"sc_galileo/earth/flyby1/orb"},{url:"sc_galileo/earth/flyby2/orb"},{url:"sc_galileo/jupiter/orb"},{url:"sc_galileo/quat"}],postCreateFunction:t=>{const e=t.addController("align",void 0,t.getControllerByType("dynamo",6));e.setPrimaryAlignType("point"),e.setPrimaryTargetEntity("mercury"),e.setPrimaryAxis(n.Vector3.ZAxisNeg),e.setSecondaryAlignType("align"),e.setSecondaryAxis(n.Vector3.YAxis),e.setSecondaryTargetAxis(n.Vector3.ZAxis),e.setSecondaryTargetEntity("earth");const i=t.addController("spin");i.setJoint("spinning_section"),i.setRate(6*Math.PI/60),i.setAxis(n.Vector3.YAxisNeg,!0)}},sc_galileo_probe:{groups:["jupiter","spacecraft"],radius:72e-5,label:"Galileo Probe",parents:[[-321964226.73959994,"sc_galileo"],[-129268796,"jupiter"],[-128353980,""]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_galileo_probe/galileo_probe.gltf",rotate:[{x:-90}]},fixed:{position:n.Vector3.Zero,orientation:n.Quaternion.Identity,coverage:[-321964226.73959994,-141114537.48322043]},dynamo:[{url:"sc_galileo_probe/galileo/orb"},{url:"sc_galileo_probe/jupiter/orb"}],coverages:[{coverage:[Number.NEGATIVE_INFINITY,-141114537.48322043],enter:t=>{t.getComponentByType("div").setEnabled(!1),t.getComponentByType("trail").setEnabled(!1);t.getControllerByType("translate").setTranslation(new n.Vector3(0,0,.001))},exit:t=>{t.getComponentByType("div").setEnabled(!0),t.getComponentByType("trail").setEnabled(!0);t.getControllerByType("translate").setTranslation(new n.Vector3(-16e-6,24e-6,7e-4))}}],postCreateFunction:t=>{t.get("model").setTranslation(new n.Vector3(0,0,-.001));const e=t.addController("translate");e.setTranslation(new n.Vector3(-16e-6,24e-6,7e-4)),e.setRelativeToOrientation(!0),e.setCoverage(new n.Interval(-321964226.73959994,-128353980));t.addController("rotateByEntityOrientation").setCoverage(new n.Interval(-321964226.73959994,-141114537.48322043));const i=t.addController("fixed");i.setOrientation(new n.Quaternion(.40004226980201746,.3894033591393042,-.7928008139628516,.24453645053961984)),i.setCoverage(new n.Interval(-141114537.48322043,Number.POSITIVE_INFINITY))}},sc_huygens:{groups:["saturn","spacecraft","titan"],occlusionRadius:.0013,extentsRadius:.0013,label:"Huygens",parents:[[157212064.184,"saturn"],[158945582,"titan"],[158974766.184,""]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_huygens/Huygens.gltf",rotate:[{x:-90},{z:180}],shadowEntities:["saturn","titan","enceladus","mimas","tethys"]},fixed:{orientation:new n.Quaternion(.8295521744501194,.09912464029342342,-.04158756948048668,-.5479853735424731)},dynamo:[{url:"sc_huygens/saturn/orb"},{url:"sc_huygens/titan/orb"}],coverages:[{coverage:[158965616.707,Number.POSITIVE_INFINITY],enter:t=>{const e=t.get("trail");null!==e&&e.setRelativeToEntityOrientation(!0)},exit:t=>{const e=t.get("trail");null!==e&&e.setRelativeToEntityOrientation(!1)}}],postCreateFunction:t=>{t.get("model").setTranslation(new n.Vector3(.0013,0,-.0011));const e=t.addController("keyframe");e.addPositionKeyframe(158965616.707,new n.Vector3(-74.84608000701567,-3832.0774028380238,-305.9513410781612)),e.addPositionKeyframe(158965667.7750001,new n.Vector3(-168.19015737501377,-3541.733393771429,-291.12326824195395)),e.addPositionKeyframe(158965894.184,new n.Vector3(-376.8992769951708,-2686.9622048526126,-273.33138256355716));const i=t.addController("keyframe");i.addPositionKeyframe(158965894.184,new n.Vector3(-376.8992769951708,-2686.9622048526126,-273.33138256355716)),i.addPositionKeyframe(158974766.184,new n.Vector3(-251.2479743710496,-2548.813556954952,-266.5500089234507));const s=t.addController("translate");s.setTranslation(new n.Vector3(-.0013,0,.0011)),s.setRelativeToOrientation(!0),s.setCoverage(new n.Interval(157212064.184,158974766.184));const r=t.addController("spin");r.setAxis(new n.Vector3(-1,0,0),!0),r.setRate(.78539816339),r.setReferenceTime(157212064.184)}},sc_huygens_landing_site:{groups:["titan","sc_huygens","sites"],radius:.001,systemRadius:200,label:"Huygens Landing Site",parents:[[157212064.184,"titan"]],fixed:{llaOnSpheroid:new n.LatLonAlt(-.18453331247520502,2.9263055188728955,0),coverage:[157212064.184,Number.POSITIVE_INFINITY]}},sc_pioneer_10:{groups:["sun","jupiter","spacecraft"],occlusionRadius:.002118055,extentsRadius:.003,label:"Pioneer 10",parents:[[-878291717.8145751,"earth"],[-878146409,"sun"],[-824046472,"jupiter"],[-822011429,"sun"]],trail:{length:31536e4},model:{url:"$STATIC_ASSETS_URL/models/sc_pioneer/pioneer.gltf",rotate:[{x:90}]},align:{primary:{type:"point",target:"earth",axis:n.Vector3.YAxis}},dynamo:[{url:"sc_pioneer_10/earth/orb"},{url:"sc_pioneer_10/sun/1/orb"},{url:"sc_pioneer_10/jupiter/orb"},{url:"sc_pioneer_10/sun/2/orb"}]},sc_pioneer_11:{groups:["sun","jupiter","saturn","spacecraft"],occlusionRadius:.002118055,extentsRadius:.003,label:"Pioneer 11",parents:[[-843816855.8143449,"earth"],[-843644357,"sun"],[-792658454,"jupiter"],[-790152245,"sun"],[-643302619,"saturn"],[-640194311,"sun"]],trail:{length:31536e4},model:{url:"$STATIC_ASSETS_URL/models/sc_pioneer/pioneer.gltf",rotate:[{x:90}]},align:{primary:{type:"point",target:"earth",axis:n.Vector3.YAxis}},dynamo:[{url:"sc_pioneer_11/earth/orb"},{url:"sc_pioneer_11/sun/1/orb"},{url:"sc_pioneer_11/jupiter/orb"},{url:"sc_pioneer_11/sun/2/orb"},{url:"sc_pioneer_11/saturn/orb"},{url:"sc_pioneer_11/sun/3/orb"}]},sc_voyager_1:{groups:["jupiter","saturn","sun","spacecraft"],occlusionRadius:.00183,extentsRadius:.0043,label:"Voyager 1",parents:[[-704412035.617,"earth"],[-703530245,"sun"],[-660264745,"jupiter"],[-655057463,"sun"],[-606239665,"saturn"],[-600733702,"sun"]],trail:{length:94608e4,lengthCoverages:[[15768e4,Number.NEGATIVE_INFINITY,377123932.454],[94608e4,377123932.454,Number.POSITIVE_INFINITY],[5184e3,-660264745,-655057463],[5184e3,-606239665,-600733702]]},model:{url:"$STATIC_ASSETS_URL/models/sc_voyager/Voyager.gltf",rotate:[{x:-90}]},align:{primary:{type:"point",target:"earth",axis:n.Vector3.ZAxisNeg}},dynamo:[{url:"sc_voyager_1/earth/orb"},{url:"sc_voyager_1/sun/1/orb"},{url:"sc_voyager_1/jupiter/orb"},{url:"sc_voyager_1/sun/2/orb"},{url:"sc_voyager_1/saturn/orb"},{url:"sc_voyager_1/sun/3/orb"},{url:"sc_voyager_1/ori"}]},sc_voyager_2:{groups:["jupiter","saturn","uranus","neptune","sun","spacecraft"],occlusionRadius:.00183,extentsRadius:.0043,label:"Voyager 2",parents:[[-705788847.817,"earth"],[-704774613,"sun"],[-650828783,"jupiter"],[-642276063,"sun"],[-582886481,"saturn"],[-574538624,"sun"],[-440395228,"uranus"],[-439259319,"sun"],[-327233138,"neptune"],[-326252606,"sun"]],trail:{length:94608e4,lengthCoverages:[[15768e4,Number.NEGATIVE_INFINITY,651751314.724],[94608e4,651751314.724,Number.POSITIVE_INFINITY],[5184e3,-650828783,-642276063],[5184e3,-582886481,-574538624],[5184e3,-440395228,-439259319],[5184e3,-327233138,-326252606]]},model:{url:"$STATIC_ASSETS_URL/models/sc_voyager/Voyager.gltf",rotate:[{x:-90}]},align:{primary:{type:"point",target:"earth",axis:n.Vector3.ZAxisNeg}},dynamo:[{url:"sc_voyager_2/earth/orb"},{url:"sc_voyager_2/sun/1/orb"},{url:"sc_voyager_2/jupiter/orb"},{url:"sc_voyager_2/sun/2/orb"},{url:"sc_voyager_2/saturn/orb"},{url:"sc_voyager_2/sun/3/orb"},{url:"sc_voyager_2/uranus/orb"},{url:"sc_voyager_2/sun/4/orb"},{url:"sc_voyager_2/neptune/orb"},{url:"sc_voyager_2/sun/5/orb"},{url:"sc_voyager_2/ori"}]}});const a=[[393471366,393501486],[399019747,399883447],[400569547,400988887],[420541747,420794647],[454490527,454650187],[487136707,487309687],[519804068,521041748],[528958868,529749008]],l=[[399637867.183,399639659.183],[400933867.182,400935660.182],[420714067.185,420714072.185],[454572067.185,454572072.185],[487231267.185,487231272.185],[520957868.184,520959604.184]],h=[[365835906,"velocity"],[365836206,"sun"],[371908866,"sun"],[371909466,"earth"],[399631646,"earth"],[399632628,"sun"],[399635271,"sun"],[399636306,"-velocity"],[399640481,"-velocity"],[399641686,"sun"],[399700717,"sun"],[399641887,"earth"],[400927646,"earth"],[400928454,"sun"],[400931272,"sun"],[400932282,"-velocity"],[400936477,"-velocity"],[400937632,"sun"],[401003197,"sun"],[401009197,"earth"],[423014467,"earth"],[423014767,"sun"],[436924867,"sun"],[436925167,"earth"],[520954868,"earth"],[520955888,"-velocity"],[520960808,"-velocity"],[520962008,"sun"],[521018048,"sun"],[521025625,"earth"]],c=[[394545667,1*Math.PI/30],[394545967,2*Math.PI/30],[399636967,2*Math.PI/30],[399637264,5*Math.PI/30],[399637866,5*Math.PI/30],[399639659,5.5*Math.PI/30],[399639788,5.5*Math.PI/30],[399640072,2*Math.PI/30],[400932921,2*Math.PI/30],[400933214,5*Math.PI/30],[400933866,5*Math.PI/30],[400935660,5.5*Math.PI/30],[400935790,5.5*Math.PI/30],[400936068,2*Math.PI/30],[520956548,2*Math.PI/30],[520956848,5*Math.PI/30],[520960088,5*Math.PI/30],[520960388,2*Math.PI/30],[521025625,2*Math.PI/30]],d={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(128),n=i(256),r=i(2);s.default.register({sc_dart:{groups:["small body spacecraft","asteroid spacecraft","65803_didymos","dimorphos","spacecraft"],occlusionRadius:.0012,extentsRadius:.00625,label:"DART",parents:[[691007069,"earth"],[691418893,"sun"],[717454117,"65803_didymos"]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_dart/dart.gltf",shadowEntities:["earth"]},align:{primary:{type:"velocity",target:"sc_dart",axis:r.Vector3.ZAxisNeg},secondary:{type:"point",target:"sun",axis:r.Vector3.YAxis}},dynamo:[{url:"sc_dart/earth/orb"},{url:"sc_dart/sun/orb"},{url:"sc_dart/65803_didymos/pos"}],coverages:[{coverage:[717454117,Number.POSITIVE_INFINITY],enter:t=>{const e=t.getControllerByType("align");e.setPrimaryAlignType("point"),e.setPrimaryTargetEntity("dimorphos"),e.setPrimaryAxis(r.Vector3.ZAxisNeg)},exit:t=>{const e=t.getControllerByType("align");e.setPrimaryAlignType("velocity"),e.setPrimaryTargetEntity("sc_dart"),e.setPrimaryAxis(r.Vector3.ZAxisNeg)}}],postCreateFunction:t=>{const e=t.addController("keyframe",void 0,t.getControllerByType("align"));e.addPositionKeyframe(717503237,new r.Vector3(-10320.163052194115,13421.106828492655,5349.381737812169)),e.addPositionKeyframe(717506127.238318,new r.Vector3(-.9047084058613565,-.7147384471771195,-.30125475602973617))}},sc_dawn:{groups:["small body spacecraft","asteroid spacecraft","dwarf planet spacecraft","4_vesta","1_ceres","spacecraft"],occlusionRadius:885e-6,extentsRadius:.00985,label:"Dawn",parents:[[244168849.8323595,"earth"],[244461608,"sun"],[288169447,"mars"],[288210177,"sun"],[363182466,"4_vesta"],[400075267,"sun"],[476712067,"1_ceres"],[594302469.184,""]],trail:{length:659889.75},model:{url:"$STATIC_ASSETS_URL/models/sc_dawn/model.gltf",rotate:[{z:-90}]},fixed:{orientation:new r.Quaternion(.9999478154504517,.008904517167862874,.004868284692665544,-.0011729254143642916),coverage:[244168849.8323595,244171353.18400002]},dynamo:[{url:"sc_dawn/earth/orb"},{url:"sc_dawn/sun/1/orb"},{url:"sc_dawn/mars/orb"},{url:"sc_dawn/sun/2/orb"},{url:"sc_dawn/vesta/orb"},{url:"sc_dawn/sun/3/orb"},{url:"sc_dawn/ceres/orb"},{url:"sc_dawn/ori"}]},sc_deep_impact:{groups:["small body spacecraft","comet spacecraft","9p_tempel_1","103p_hartley_2","spacecraft"],occlusionRadius:.00165,extentsRadius:.003,label:"Deep Impact",parents:[[158829812.068274,"earth"],[159287744,"sun"],[173560752,"9p_tempel_1"],[173923158,"sun"],[251798121,"earth"],[253531474,"sun"],[282984399,"earth"],[285405903,"sun"],[330384030,"earth"],[331534813,"sun"],[342017751,"103p_hartley_2"],[342368983,"sun"],[429192067,""]],trail:{length:47421459,lengthCoverages:[[362406,173560752,173923158],[1733353,251798121,253531474],[2421504,282984399,285405903],[1150783,330384030,331534813],[351232,342017751,342368983]]},model:{url:"$STATIC_ASSETS_URL/models/sc_deep_impact/deep_impact_wo_impactor.gltf",rotate:[{y:-90}]},fixed:{orientation:r.Quaternion.Identity},dynamo:[{url:"sc_deep_impact/earth/launch/orb"},{url:"sc_deep_impact/sun/orb"},{url:"sc_deep_impact/9p_tempel_1/pos"},{url:"sc_deep_impact/earth/flyby1/orb"},{url:"sc_deep_impact/earth/flyby2/orb"},{url:"sc_deep_impact/earth/flyby3/orb"},{url:"sc_deep_impact/103p_hartley_2/pos"},{url:"sc_deep_impact/quat"}]},sc_deep_impact_impactor:{groups:["small body spacecraft","comet spacecraft","9p_tempel_1","sc_deep_impact","spacecraft"],occlusionRadius:.001,extentsRadius:.001,label:"Deep Impact Impactor",parents:[[158829812.068274,"sc_deep_impact"],[173642464.18400002,"9p_tempel_1"],[173727938.18158135,""]],trail:{length:27830},model:{url:"$STATIC_ASSETS_URL/models/sc_deep_impact_impactor/deep_impact_impactor.gltf",rotate:[{y:-90}]},fixed:{position:new r.Vector3(-713e-6,-55e-6,0),orientation:r.Quaternion.Identity,relativeToEntity:"sc_deep_impact",coverage:[158829812.068274,173642464.18400002]},dynamo:[{url:"sc_deep_impact_impactor/quat",coverage:[173642464.18400002,Number.POSITIVE_INFINITY]}],postCreateFunction:t=>{const e=t.addController("keyframe");e.addPositionKeyframe(173642464.18400002,new r.Vector3(-713e-6,-55e-6,0),"sc_deep_impact",void 0,"sc_deep_impact"),e.addPositionKeyframe(173656621.40411958,new r.Vector3(-123095.24746842826,-48294.70341251187,61743.99881253781),"sc_deep_impact",173642464.18400002),e.addPositionKeyframe(173727938.18158135,new r.Vector3(1.580046751199936,3.178179950746365,-.628457454223176));const i=t.addController("fixed","",t.getControllerByType("dynamo"));i.setOrientation(new r.Quaternion(.9060465048532422,.3173702681972099,.2649483984949708,.09032269948692226)),i.setCoverage(new r.Interval(173642464.18400002,Number.POSITIVE_INFINITY))}},sc_deep_impact_impactor_impact_site:{groups:["small body sites","comet sites","9p_tempel_1","sc_deep_impact","sc_deep_impact_impactor","sites"],radius:.001,label:"Deep Impact Impactor Impact Site",parents:[[173727938.18158135,"9p_tempel_1"]],fixed:{position:new r.Vector3(3.1153282512332603,-1.2860729555237982,-1.277920399403075),orientation:r.Quaternion.Identity,relativeToEntity:"9p_tempel_1",coverage:[173727938.18158135,Number.POSITIVE_INFINITY]}},sc_deep_space_1:{groups:["small body spacecraft","asteroid spacecraft","9969_braille","spacecraft"],occlusionRadius:.00125,extentsRadius:.005,label:"Deep Space 1",parents:[[-37470248,"earth"],[-36628312,"sun"],[-13523799,"9969_braille"],[-13496699,"sun"],[54458637,"19p_borrelly"],[54476825,"sun"],[61977664.184,""]],trail:{length:40845609,lengthCoverages:[[27100,-13523799,-13496699],[18188,54458637,54476825]]},model:{url:"$STATIC_ASSETS_URL/models/sc_deep_space_1/deep_space_1.gltf",rotate:[{x:90},{z:90}]},dynamo:[{url:"sc_deep_space_1/earth/orb"},{url:"sc_deep_space_1/sun/orb"},{url:"sc_deep_space_1/9969_braille/pos"},{url:"sc_deep_space_1/19p_borrelly/pos"},{url:"sc_deep_space_1/quat"}],postCreateFunction:t=>{const e=t.addController("align","",t.getControllerByType("dynamo",4));e.setPrimaryAlignType("point"),e.setPrimaryAxis(r.Vector3.XAxis),e.setPrimaryTargetEntity("earth"),e.setSecondaryAlignType("point"),e.setSecondaryAxis(r.Vector3.ZAxisNeg),e.setSecondaryTargetEntity("sun")}},sc_near_shoemaker:{groups:["small body spacecraft","asteroid spacecraft","253_mathilde","433_eros","spacecraft"],occlusionRadius:.002,extentsRadius:.0034,label:"NEAR",parents:[[-122129937,"sun"],[-61397606,"earth"],[-60793811,"sun"],[-79403925,"253_mathilde"],[-79210250,"sun"],[-8425610,"433_eros"],[36675809.3654,""]],trail:{length:63919069,lengthCoverages:[[4e5,-8425610,35279032.137],[0,35279032.137,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_near_shoemaker/near.gltf",rotate:[{x:90},{z:135}]},fixed:{orientation:new r.Quaternion(.5052018803124495,-.11842169431143575,.7652511949887616,-.3809697770341459),coverage:[-122129937,-121953528.049046]},dynamo:[{url:"sc_near_shoemaker/sun/orb"},{url:"sc_near_shoemaker/earth/flyby/orb"},{url:"sc_near_shoemaker/253_mathilde/pos"},{url:"sc_near_shoemaker/433_eros/orb"},{url:"sc_near_shoemaker/quat"}],postCreateFunction:t=>{const e=t.addController("orbitalElements"),i=new r.OrbitalElements;i.eccentricity=.3722732412046076,i.epoch=-122129937,i.semiMajorAxis=235420679.8644008,i.orbitOrientation.set(.25408339907533106,.05463135384055627,-.18986948069810847,.9467875272685549),i.meanAngularMotion=1.0085301888805118e-7,i.meanAnomalyAtEpoch=-.005941352116228519,e.addOrbitalElements(-122129937,i),e.addOrbitalElements(-113227200,i),e.setCoverage(new r.Interval(-122129937,-113227200));const s=t.addController("fixed");s.setPosition(new r.Vector3(.930389249841349,4.935129554115763,-4.002004469114965)),s.setOrientation(new r.Quaternion(.11222410400554989,.7066112547219852,-.6897721372150081,.11099857612696495)),s.setCoverage(new r.Interval(35279032.137,36675809.3654));t.addController("rotateByEntityOrientation").setCoverage(new r.Interval(35279032.137,36675809.3654))}},sc_near_shoemaker_landing_site:{groups:["433_eros","sc_near_shoemaker","sites"],radius:.001,systemRadius:200,label:"NEAR Shoemaker Landing Site",parents:[[36675809.3654,"433_eros"]],fixed:{position:new r.Vector3(.930389249841349,4.935129554115763,-4.002004469114965),orientation:new r.Quaternion(.11222410400554989,.7066112547219852,-.6897721372150081,.11099857612696495),relativeToEntity:"433_eros",coverage:[36675809.3654,Number.POSITIVE_INFINITY]}},sc_lucy:{groups:["small body spacecraft","asteroid spacecraft","52246_donaldjohanson","3548_eurybates","15094_polymele","11351_leucus","21900_orus","617_patroclus","menoetius","spacecraft"],occlusionRadius:.002,extentsRadius:.007125,label:"Lucy",parents:[[687656642.763,"earth"],[687915086,"sun"],[718960993,"earth"],[719531941,"sun"],[787134972,"earth"],[787532222,"sun"],[798252820,"52246_donaldjohanson"],[798584539,"sun"],[870652086,"3548_eurybates"],[872642047,"sun"],[872642047,"15094_polymele"],[875308504,"sun"],[891166024,"11351_leucus"],[894761809,"sun"],[909384911,"21900_orus"],[912190135,"sun"],[977590306,"earth"],[978108682,"sun"],[1046169596,"617_patroclus_barycenter"],[1047892376,"sun"]],trail:{length:63919069,lengthCoverages:[[570948,718960993,719531941],[397250,787134972,787532222],[331719,798252820,798584539],[1989961,870652086,872642047],[2666457,872642047,875308504],[3595785,891166024,894761809],[2805224,909384911,912190135],[518376,977590306,978108682],[1722780,1046169596,1047892376]]},model:{url:"$STATIC_ASSETS_URL/models/sc_lucy/lucy.gltf",rotate:[{x:90},{z:90}]},fixed:{orientation:r.Quaternion.Identity},dynamo:[{url:"sc_lucy/earth/launch/orb"},{url:"sc_lucy/sun/orb"},{url:"sc_lucy/earth/flyby1/orb"},{url:"sc_lucy/earth/flyby2/orb"},{url:"sc_lucy/52246_donaldjohanson/pos"},{url:"sc_lucy/3548_eurybates/pos"},{url:"sc_lucy/15094_polymele/pos"},{url:"sc_lucy/11351_leucus/pos"},{url:"sc_lucy/21900_orus/pos"},{url:"sc_lucy/earth/flyby3/orb"},{url:"sc_lucy/617_patroclus/pos"},{url:"sc_lucy/quat"}],postCreateFunction:t=>{const e=t.addController("align",void 0,t.getControllerByType("dynamo",11));e.setPrimaryAlignType("point"),e.setPrimaryAxis(r.Vector3.XAxis),e.setPrimaryTargetEntity("earth"),e.setSecondaryAlignType("align"),e.setSecondaryAxis(r.Vector3.YAxis),e.setSecondaryTargetAxis(r.Vector3.ZAxis),e.setSecondaryTargetEntity("sun")}},sc_new_horizons:{groups:["small body spacecraft","dwarf planet spacecraft","TNO spacecraft","134340_pluto","486958_arrokoth","spacecraft"],occlusionRadius:.00135,extentsRadius:.0026,label:"New Horizons",parents:[[190972278.33046317,"earth"],[191055829,"sun"],[225619606,"jupiter"],[226100665,"sun"],[490130161,"134340_pluto"],[490167848,"sun"],[598753684,"486958_arrokoth"],[600203601,"sun"]],trail:{length:94608e3},model:{url:"$STATIC_ASSETS_URL/models/sc_new_horizons/new_horizons.gltf",rotate:[{y:90}]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.YAxis}},dynamo:[{url:"sc_new_horizons/earth/orb"},{url:"sc_new_horizons/sun/1/orb"},{url:"sc_new_horizons/jupiter/orb"},{url:"sc_new_horizons/sun/2/orb"},{url:"sc_new_horizons/pluto/orb"},{url:"sc_new_horizons/sun/3/pos"},{url:"sc_new_horizons/mu69/pos"},{url:"sc_new_horizons/sun/4/pos"},{url:"sc_new_horizons/ori/1"},{url:"sc_new_horizons/ori/2"}]},sc_rosetta:{groups:["small body spacecraft","comet spacecraft","67p_churyumov_gerasimenko","spacecraft"],occlusionRadius:.0014,extentsRadius:.016,label:"Rosetta",parents:[[131491581.583,"earth"],[131901500,"sun"],[162704887,"earth"],[163831232,"sun"],[225623375,"mars"],[225657862,"sun"],[248111015,"earth"],[248475560,"sun"],[311055929,"earth"],[311664877,"sun"],[452394238,"67p_churyumov_gerasimenko"],[528503957.968,""]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_rosetta/rosettaPhilae.gltf",rotate:[{x:180},{z:90}]},fixed:{orientation:r.Quaternion.Identity},dynamo:[{url:"sc_rosetta/earth/launch/orb"},{url:"sc_rosetta/sun/1/orb"},{url:"sc_rosetta/earth/flyby1/orb"},{url:"sc_rosetta/sun/2/orb"},{url:"sc_rosetta/mars/flyby/orb"},{url:"sc_rosetta/sun/3/orb"},{url:"sc_rosetta/earth/flyby2/orb"},{url:"sc_rosetta/sun/4/orb"},{url:"sc_rosetta/earth/flyby3/orb"},{url:"sc_rosetta/sun/5/orb"},{url:"sc_rosetta/67p_churyumov_gerasimenko/pos"},{url:"sc_rosetta/ori"}],coverages:[{coverage:[469053367.183,Number.POSITIVE_INFINITY],enter:t=>{const e=t.get("model");null!==e&&e.setHiddenObject("Philae",!0)},exit:t=>{const e=t.get("model");null!==e&&e.setHiddenObject("Philae",!1)}}],postCreateFunction:t=>{const e=t.addController("align");e.setJoint("panels_01"),e.setSecondaryAlignType("point"),e.setSecondaryAxis(r.Vector3.ZAxis),e.setSecondaryTargetEntity("sun");const i=t.addController("align");i.setJoint("panels_02"),i.setSecondaryAlignType("point"),i.setSecondaryAxis(r.Vector3.ZAxis),i.setSecondaryTargetEntity("sun")}},sc_rosetta_impact_site:{groups:["small body sites","comet sites","67p_churyumov_gerasimenko","sc_rosetta","sites"],radius:.001,label:"Rosetta Impact Site",parents:[[528503957.968,"67p_churyumov_gerasimenko"]],fixed:{position:new r.Vector3(1.7309310500292525,.3509303067271947,1.1641920075039298),orientation:r.Quaternion.Identity,relativeToEntity:"67p_churyumov_gerasimenko",coverage:[528503957.968,Number.POSITIVE_INFINITY]}},sc_osiris_rex:{groups:["small body spacecraft","asteroid spacecraft","101955_bennu","spacecraft"],occlusionRadius:.0016,extentsRadius:.005,label:"OSIRIS-REx",parents:[[526676400,"earth"],[527025408,"sun"],[558938468,"earth"],[559919190,"sun"],[591770603,"101955_bennu"],[674049669,"sun"],[748358886,"earth"]],trail:{length:102742.5,lengthCoverages:[[1e7,Number.NEGATIVE_INFINITY,599748661],[672e3,599748661,668095733],[1e7,668095733,Number.POSITIVE_INFINITY]]},model:{url:"$STATIC_ASSETS_URL/models/sc_osiris_rex/osiris_rex.gltf",rotate:[{x:90}],shadowEntities:["bennu"]},align:{primary:{type:"point",target:"sun",axis:r.Vector3.ZAxisNeg}},dynamo:[{url:"sc_osiris_rex/earth/launch/orb"},{url:"sc_osiris_rex/sun/1/orb"},{url:"sc_osiris_rex/earth/flyby/orb"},{url:"sc_osiris_rex/sun/2/orb"},{url:"sc_osiris_rex/bennu/pos"},{url:"sc_osiris_rex/sun/3/orb"},{url:"sc_osiris_rex/earth/landing/orb"},{url:"sc_osiris_rex/ori"}],postCreateFunction:t=>{const e=t.getComponentByType("model");e.setResourcesLoadedCallback((()=>{e.getThreeJsObjectByName("Tagsam_rod_bottom").rotation.x=0,e.getThreeJsObjectByName("Tagsam_rod_bottom").rotation.z=0,e.getThreeJsObjectByName("Tagsam_rod_top").rotation.x=0,e.getThreeJsObjectByName("Tagsam_rod_top").rotation.z=0,e.getThreeJsObjectByName("tagsam_head").rotation.x=0,e.getThreeJsObjectByName("tagsam_head").rotation.z=0})),n.default.makeSubobjectVisibleAnimation(e,"Tagsam_housing_cover",!0,[[593036911,!1]]),n.default.makeJointRotationAnimation(e,"Tagsam_rod_bottom","y",[[595442726,2.51758508612],[595442906,0],[595443086,0],[595443266,2.51758508612],[656489486,2.51758508612],[656489846,0],[656502896,0],[656503076,2.51758508612],[657366686,2.51758508612],[657367046,-.22013488789],[657367406,2.51758508612]]),n.default.makeJointRotationAnimation(e,"Tagsam_rod_top","y",[[593728111,-2.73247002363],[593728113,-2.58247002363],[595442726,-2.58247002363],[595442906,0],[595443086,0],[595443266,-2.58247002363],[656489486,-2.58247002363],[656489846,0],[656502896,0],[656503076,-2.58247002363],[657366686,-2.58247002363],[657366866,-1.57110175941],[657367046,-2.22286878863],[657367226,-1.57110175941],[657367406,-2.58247002363]]),n.default.makeJointRotationAnimation(e,"tagsam_head","y",[[595442906,-1.37257230233],[595442996,0],[595443086,-1.37257230233],[656489486,-1.37257230233],[656489576,0],[656502806,0],[656502896,-1.37257230233],[657366686,-1.37257230233],[657367046,-.55616487411]]),n.default.makeSubobjectVisibleAnimation(e,"tagsam_head",!0,[[657367046,!1]])}},sc_philae:{groups:["small body spacecraft","comet spacecraft","67p_churyumov_gerasimenko","spacecraft","landers"],occlusionRadius:6e-4,extentsRadius:.001,label:"Philae",parents:[[469053367.183,"67p_churyumov_gerasimenko"],[469078512.324,""]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_philae/philae.gltf",rotate:[{x:180},{z:90}]},fixed:{orientation:new r.Quaternion(.05763938670269045,.04093459828351704,.6750586755218195,.7343690110337115)},dynamo:[{url:"sc_philae/67p_churyumov_gerasimenko/pos"}],postCreateFunction:t=>{const e=new r.Vector3(.0021658104318583687,.0011575046500869896,.00011875498849156656),i=new r.Vector3(.00147,0,0),s=t.addController("translate");s.setTranslation(e),s.setCoverage(new r.Interval(469053367.183,469078512.324));t.get("model").setTranslation(i)}},sc_philae_landing_site:{groups:["small body sites","comet sites","67p_churyumov_gerasimenko","sc_philae","sites"],radius:.001,systemRadius:200,label:"Philae Landing Site",parents:[[469078512.324,"67p_churyumov_gerasimenko"]],fixed:{position:new r.Vector3(2.4452763955965984,-.12110982508097201,-.36032099522959377),orientation:r.Quaternion.Identity,relativeToEntity:"67p_churyumov_gerasimenko",coverage:[469078512.324,Number.POSITIVE_INFINITY]}},sc_psyche:{groups:["small body spacecraft","asteroid spacecraft","16_psyche","spacecraft"],occlusionRadius:.0031,extentsRadius:.025,label:"Psyche",parents:[[712659243.191877,"earth"],[713424696,"sun"],[736836669,"mars"],[737177380,"sun"],[820013200,"16_psyche"]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_psyche/psyche.gltf",rotate:[{y:-90},{x:90}]},align:{primary:{type:"point",target:"earth",axis:r.Vector3.XAxisNeg}},dynamo:[{url:"sc_psyche/earth/orb"},{url:"sc_psyche/sun/orb"},{url:"sc_psyche/mars/orb"},{url:"sc_psyche/16_psyche/orb"}],postCreateFunction:t=>{const e=t.addController("align");e.setJoint("ArrayGimbleLeft"),e.setSecondaryAlignType("point"),e.setSecondaryAxis(r.Vector3.YAxis),e.setSecondaryTargetEntity("sun");const i=t.addController("align");i.setJoint("ArrayGimbleRight"),i.setSecondaryAlignType("point"),i.setSecondaryAxis(r.Vector3.YAxis),i.setSecondaryTargetEntity("sun")}},sc_stardust:{groups:["small body spacecraft","comet spacecraft","81p_wild_2","9p_tempel_1","spacecraft"],occlusionRadius:65e-5,extentsRadius:.003,label:"Stardust",parents:[[-28304869.3,"earth"],[-28038699,"sun"],[32627842,"earth"],[33120541,"sun"],[89379733,"5535_annefrank"],[89550209,"sun"],[126009572,"81p_wild_2"],[126678668,"sun"],[190336290,"earth"],[190866114,"sun"],[284944970,"earth"],[285742028,"sun"],[350896766,"9p_tempel_1"],[351068113,"sun"],[354279666,""]],trail:{length:62659492},model:{url:"$STATIC_ASSETS_URL/models/sc_stardust/stardust_articulated.gltf",shadowEntities:["earth"],rotate:[{x:90},{z:90}]},fixed:{orientation:new r.Quaternion(.382740492391079,-.1080542417135509,-.5511677923678098,-.7335175941913997),coverage:[351017063,354279666]},dynamo:[{url:"sc_stardust/earth/launch/orb"},{url:"sc_stardust/sun/orb"},{url:"sc_stardust/earth/flyby1/orb"},{url:"sc_stardust/5535_annefrank/pos"},{url:"sc_stardust/81p_wild_2/pos"},{url:"sc_stardust/earth/flyby2/orb"},{url:"sc_stardust/earth/flyby3/orb"},{url:"sc_stardust/9p_tempel_1/pos"},{url:"sc_stardust/quat"}],coverages:[{coverage:[190576690.7833838,Number.POSITIVE_INFINITY],enter:t=>{const e=t.getComponentByType("model");for(const t of["Stardust_capsule","Stardust_tex_01_c","Stardust_tex_02_c","Stardust_tex_03_c","Stardust_tex_02_c2","Stardust_Sample_Collection1"])e.setHiddenObject(t,!0)},exit:t=>{const e=t.getComponentByType("model");for(const t of["Stardust_capsule","Stardust_tex_01_c","Stardust_tex_02_c","Stardust_tex_03_c","Stardust_tex_02_c2","Stardust_Sample_Collection1"])e.setHiddenObject(t,!1)}}],postCreateFunction:t=>{const e=t.getComponentByType("model"),stardustAnimation=(t,e,i)=>[[4449664+e,t],[4449664+e+i,0],[10411264-e-i,0],[10411264-e,t],[81864064+e,t],[81864064+e+i,0],[92664064-e-i,0],[92664064-e,t],[125496064+e,t],[125496064+e+i,0],[126363664-e-i,0],[126363664-e,t]];n.default.makeJointRotationAnimation(e,"Stardust_capsule","x",stardustAnimation(1.481785,0,600)),n.default.makeJointRotationAnimation(e,"Stardust_Sample_Collection1","x",stardustAnimation(-Math.PI,610,300)),n.default.makeJointRotationAnimation(e,"Stardust_Sample_Collection2","x",stardustAnimation(-Math.PI,920,300))}},sc_stardust_src:{groups:["small body spacecraft","comet spacecraft","81p_wild_2","earth","spacecraft"],occlusionRadius:4e-4,extentsRadius:8e-4,label:"Stardust SRC",parents:[[190576690.7833838,"sc_stardust"],[190576755.185,"earth"],[190591985.184,""]],trail:{length:14547},fixed:{orientation:new r.Quaternion(.5761056269233067,.6860897901682099,.2627910947477326,.3582233199772653)},model:{url:"$STATIC_ASSETS_URL/models/sc_stardust_src/stardust_capsule.gltf",shadowEntities:["earth"],rotate:[{x:90},{z:90}]},dynamo:[{url:"sc_stardust_src/earth/pos"}],coverages:[{coverage:[190591100,Number.POSITIVE_INFINITY],enter:t=>{const e=t.getComponentByType("trail");e.setRelativeToEntityOrientation(!0),e.setStartTime(1600)},exit:t=>{const e=t.getComponentByType("trail");e.setRelativeToEntityOrientation(!1),e.setStartTime(18e3)}}],postCreateFunction:t=>{const e=t.addController("keyframe");e.addPositionKeyframe(190576690.7833838,new r.Vector3(-.0010057,0,1569e-7),"sc_stardust",void 0,"sc_stardust",void 0),e.addPositionKeyframe(190576755.185,new r.Vector3(-.016734488308429718,-.019199222326278687,-.00404781848192215),"sc_stardust");const i=t.addController("keyframe");i.addPositionKeyframe(190591163,new r.Vector3(-1979.4577357598625,-4478.591383446022,4136.322858267745),"earth"),i.addPositionKeyframe(190591445.184,new r.Vector3(-1947.8360605285134,-4491.082890234251,4123.1018367103425),"earth"),i.addPositionKeyframe(190591985.184,new r.Vector3(-1918.7633689113482,-4478.864184129612,4103.897124245734),"earth");t.addController("rotateByEntityOrientation").setCoverage(new r.Interval(190591163,190591985.184))}}});const o={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(2);const n=class Animation{static makeSubobjectVisibleAnimation(t,e,i,n){if(0===n.length)return;n.sort(((t,e)=>t[0]-e[0]));const r=t.getEntity();(r.getControllerByType("coverage")||r.addController("coverage")).addCoverage(new s.Interval(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),void 0,void 0,(()=>{const o=r.getScene().getEngine().getTime(),a=s.Sort.getIndex(o,n,((t,e)=>t[0]<e));0===a?t.setHiddenObject(e,!i):t.setHiddenObject(e,!n[a-1][1])}))}static makeJointRotationAnimation(t,e,i,n){if(0===n.length)return;n.sort(((t,e)=>t[0]-e[0]));const r=t.getEntity();(r.getControllerByType("coverage")||r.addController("coverage")).addCoverage(new s.Interval(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY),void 0,void 0,(()=>{const o=t.getThreeJsObjectByName(e);if(null!==o){const t=r.getScene().getEngine().getTime(),e=s.Sort.getIndex(t,n,((t,e)=>t[0]<e));if(0===e)o.rotation[i]=n[0][1];else if(e===n.length)o.rotation[i]=n[n.length-1][1];else{const r=n[e-1],a=n[e],l=(t-r[0])/(a[0]-r[0]);o.rotation[i]=s.MathUtils.lerp(r[1],a[1],l)}}}))}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(128),n=i(2);s.default.register({sc_kepler_space_telescope:{groups:["sun","spacecraft","telescope"],occlusionRadius:.00235,extentsRadius:.004,label:"Kepler",parents:[[289679042.1855,"earth"],[290348743,"sun"],[595512069.183,""]],trail:{length:32190048},model:{url:"$STATIC_ASSETS_URL/models/sc_kepler/Kepler.gltf"},align:{primary:{type:"align",target:"sun",targetAxis:new n.Vector3(.25176480336,-.66735243742,.7009092643),axis:n.Vector3.YAxis},secondary:{type:"point",target:"sun",axis:n.Vector3.XAxisNeg}},dynamo:[{url:"sc_kepler/earth/orb"},{url:"sc_kepler/sun/orb"}]},sc_mariner_2:{groups:["sun","spacecraft"],occlusionRadius:.002,extentsRadius:.0025,label:"Mariner 2",parents:[[-1178599240.703784,"sun"],[409233667.18358755,""]],trail:{length:29411352},animdata:[{url:"sc_mariner_2",type:"pos"}]},sc_parker_solar_probe:{groups:["sun","spacecraft"],occlusionRadius:.0015,extentsRadius:.003,label:"Parker Solar Probe",parents:[[587333783.3431,"earth"],[587454078,"sun"]],trail:{length:12942631},model:{url:"$STATIC_ASSETS_URL/models/sc_parker_solar_probe/PSP.gltf"},align:{primary:{type:"point",target:"sun",axis:n.Vector3.ZAxisNeg}},dynamo:[{url:"sc_parker_solar_probe/earth/orb"},{url:"sc_parker_solar_probe/sun/orb"}]},sc_spitzer:{groups:["sun","spacecraft"],occlusionRadius:.0085,extentsRadius:.004,label:"Spitzer",parents:[[115064803.183,"earth"],[115493678,"sun"],[633614469.185,""]],trail:{length:32167331},model:{url:"$STATIC_ASSETS_URL/models/sc_spitzer/SPITZER.gltf",rotate:[{z:-90},{x:-90}],shadowEntities:["venus","mercury"]},fixed:{orientation:new n.Quaternion(.5258297992951877,.8139480432783324,-.1400557906856776,-.20341086625833524),coverage:[633777341.191,Number.POSITIVE_INFINITY]},dynamo:[{url:"sc_spitzer/earth/orb"},{url:"sc_spitzer/sun/orb"},{url:"sc_spitzer/quat"}]},sc_stereo_ahead:{groups:["sun","spacecraft"],occlusionRadius:.003,extentsRadius:.003,label:"STEREO Ahead",parents:[[215097110,"earth"],[221418192,"sun"]],trail:{length:29809031},model:{url:"$STATIC_ASSETS_URL/models/sc_stereo_ahead/stereo_a.gltf",rotate:[{x:90}],shadowEntities:["venus","mercury"]},align:{primary:{type:"point",target:"sun",axis:n.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_stereo_ahead",axis:n.Vector3.YAxisNeg}},dynamo:[{url:"sc_stereo_ahead/earth/orb"},{url:"sc_stereo_ahead/sun/orb"}]},sc_stereo_behind:{groups:["sun","spacecraft"],occlusionRadius:.003,extentsRadius:.003,label:"STEREO Behind",parents:[[215097110,"earth"],[224468337,"sun"],[527860868.182,""]],trail:{length:33473699},model:{url:"$STATIC_ASSETS_URL/models/sc_stereo_behind/stereo_b.gltf",rotate:[{x:90}],shadowEntities:["venus","mercury"]},align:{primary:{type:"point",target:"sun",axis:n.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_stereo_behind",axis:n.Vector3.YAxisNeg}},dynamo:[{url:"sc_stereo_behind/earth/orb"},{url:"sc_stereo_behind/sun/orb"}]},sc_ulysses:{groups:["sun","spacecraft"],occlusionRadius:.002,extentsRadius:.002,label:"Ulysses",parents:[[-291488100,"sun"],[268142464.18410408,""]],trail:{length:140294739},model:{url:"$STATIC_ASSETS_URL/models/sc_ulysses/ulysses.gltf",shadowEntities:["venus","mercury"]},align:{primary:{type:"point",target:"sun",axis:n.Vector3.ZAxis},secondary:{type:"velocity",target:"sc_ulysses",axis:n.Vector3.YAxisNeg}},animdata:[{url:"sc_ulysses",type:"pos"}]},sc_wmap:{groups:["sun","spacecraft"],occlusionRadius:.0026,extentsRadius:.0026,label:"WMAP",parents:[[339422466.184,"sun"],[360158466.184,""]],trail:{length:31536e3},animdata:[{url:"sc_wmap",type:"pos"}]}});const r={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(128),n=i(2);s.default.register({sc_magellan:{groups:["venus","spacecraft"],occlusionRadius:.0032,extentsRadius:.006,label:"Magellan",parents:[[-336388283.36,"sun"],[-296448521.457,"venus"],[-164631538.81763855,""]],trail:{length:void 0},model:{url:"$STATIC_ASSETS_URL/models/sc_magellan/magellan.gltf",shadowEntities:["venus"]},align:{primary:{type:"point",target:"earth",axis:n.Vector3.YAxis},secondary:{type:"align",axis:new n.Vector3(-Math.sqrt(.5),Math.sqrt(.5),0),target:"venus",targetAxis:n.Vector3.ZAxisNeg}},dynamo:[{url:"sc_magellan/venus/orb"}],postCreateFunction:t=>{const e=t.addController("orbitalElements",void 0,t.getControllerByType("align")),i=new n.OrbitalElements;i.epoch=-336394683.816,i.eccentricity=.1791852824104108,i.semiMajorAxis=128280596.63956015,i.meanAngularMotion=2.5073465306679634e-7,i.meanAnomalyAtEpoch=2.9229288382327625,i.orbitOrientation.set(.8728453580255966,.1876084386162498,-.08948587100888229,.4415159494547423),e.addOrbitalElements(-336388283.36,i),e.addOrbitalElements(-296448521.457,i);const s=t.addController("orbitalElements",void 0,t.getControllerByType("align")),r=new n.OrbitalElements;r.epoch=-296448521.457,r.eccentricity=1.272922970547487,r.semiMajorAxis=23358.593430196037,r.meanAngularMotion=.00015965302516479147,r.meanAnomalyAtEpoch=-6.138103356108873,r.orbitOrientation.set(-.49933963770188916,.11817755769547109,.7262027627540558,-.45751889408554064),s.addOrbitalElements(-296448521.457,r),s.addOrbitalElements(-296410230.351,r);const o=new n.OrbitalElements;o.epoch=-295884037.7511,o.eccentricity=.39186818222106645,o.semiMajorAxis=10434.012201911135,o.meanAngularMotion=.000534773863104956,o.meanAnomalyAtEpoch=-1.5165416917234864,o.orbitOrientation.set(-.4665778554219434,.18802595119032475,.7217932088991018,-.47535871728198204),s.addOrbitalElements(-296410230.351,o),s.addOrbitalElements(-295884037.7511,o)}},sc_venus_express:{groups:["venus","spacecraft"],occlusionRadius:9e-4,extentsRadius:.004,label:"Venus Express",parents:[[184784701.549,"venus"],[505628714.4371663,""]],trail:{length:779592.165087551},fixed:{orientation:n.Quaternion.Identity},animdata:[{url:"sc_venus_express/venus/all",type:"pos"}]}});const r={}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(128),n=i(2);s.default.register({rose_bowl:{groups:["comparison"],radius:.15,label:"Rose Bowl",parents:[],model:{url:"$STATIC_ASSETS_URL/models/comparison/rose_bowl/rose_bowl.gltf",rotate:[{x:90},{z:-90}]},fixed:{position:n.Vector3.Zero,orientation:n.Quaternion.Identity}},school_bus:{groups:["comparison"],radius:.0065,label:"School bus",parents:[],model:{url:"$STATIC_ASSETS_URL/models/comparison/school_bus/school_bus.gltf",rotate:[{x:90},{z:-90}]},fixed:{position:n.Vector3.Zero,orientation:n.Quaternion.Identity}},scientist:{groups:["comparison"],radius:835e-6,label:"Scientist",parents:[],model:{url:"$STATIC_ASSETS_URL/models/comparison/scientist/scientist.gltf",rotate:[{x:90}]},fixed:{position:n.Vector3.Zero,orientation:n.Quaternion.Identity}}});const r={}},(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var s=i(2),n=i(1),r=i(265),o=i.n(r);const a=class TimeManager{constructor(t){this._pioneer=t,this._utcTimezone="Etc/UTC",this._localTimezone=o().tz.guess(),this._previousTimeRate=this._pioneer.getTimeRate(),this._dateFormats={utc:{full:"YYYY-MM-D HH[:]mm[:]ss",datetime:"YYYY-MM-D HH[:]mm",date:"YYYY MMMM D",time:"HH[:]mm[:]ss",url:"YYYY-MM-DDTHH:mm:ss.SSSZ"},local:{full:"M/D/YY hh[:]mm[:]ss",datetime:"M/D/YY hh[:]mm",date:"MMMM D, YYYY",time:"hh[:]mm[:]ss",meridiem:"a"}},this._displayUTC=!0,this._timezone=this._utcTimezone,this._components={setDisplayUTC:[],setTime:[],update:[]},this._time=o()().tz(this._timezone),this.setTime(this._time),this.setTimeRate(1),this._pioneer.addCallback((()=>{this._time=o().tz(1e3*s.TimeUtils.etToUnix(this._pioneer.getTime()),this._timezone);for(let t=this._components.update.length-1;t>=0;t--){const e=this._components.update[t];null!==n.default.get(e)&&n.default.get(e).update(this._time)}}),!0)}getNowTime(){return o()().tz(this._timezone)}async now(){return this._time=o()().tz(this._timezone),await n.default.router.navigate(await n.default.router.addQueryToPath({time:this.getTimeUrl()})),this._time}getTime(){return this._time}async setTime(t){if(t=o().tz(t,this._timezone),this._pioneer.setTime(s.TimeUtils.unixToEt(t.valueOf()/1e3)),this._components.setTime){this._time=o().tz(1e3*s.TimeUtils.etToUnix(this._pioneer.getTime()),this._timezone);for(let t=this._components.setTime.length-1;t>=0;t--){const e=this._components.setTime[t];null!==n.default.get(e)&&n.default.get(e).setDisplayToTime(this._time)}}}parseTime(t){return o().tz(t,this._timezone)}getTimezone(){return this._timezone}getUTCTimezone(){return this._utcTimezone}getLocalTimezone(){return this._localTimezone}getDisplayUTC(){return this._displayUTC}setDisplayUTC(t){this._displayUTC=t,this._timezone=this._displayUTC?this._utcTimezone:this._localTimezone;for(let e=this._components.setDisplayUTC.length-1;e>=0;e--){const i=this._components.setDisplayUTC[e];null!==n.default.get(i)&&n.default.get(i).setUTC(t)}}getDateFormat(t,e){return e||(e=this.getDisplayUTC()?"utc":"local"),this._dateFormats[e][t]}getTimeUrl(t){return t||(t=this._time),(t=o().tz(t,this._utcTimezone)).format(this._dateFormats.utc.url)}getTimeRate(){return this._pioneer.getTimeRate()}setTimeRate(t){this._pioneer.setTimeRate(t)}getTimeRates(){return this._timerates}play(){const t=0===this._previousTimeRate?1:this._previousTimeRate;this.setTimeRate(t);const e=new CustomEvent("playPause",{detail:{rate:t}});window.dispatchEvent(e)}pause(){this._previousTimeRate=this.getTimeRate(),this.setTimeRate(0);const t=new CustomEvent("playPause",{detail:{rate:0}});window.dispatchEvent(t)}getMidTime(t,e){const i=(t.unix()+e.unix())/2;return o()(i,"X")}setManagedComponents(t){this._components=t}}},,,,(t,e,i)=>{var s={"./af":269,"./af.js":269,"./ar":270,"./ar-dz":271,"./ar-dz.js":271,"./ar-kw":272,"./ar-kw.js":272,"./ar-ly":273,"./ar-ly.js":273,"./ar-ma":274,"./ar-ma.js":274,"./ar-sa":275,"./ar-sa.js":275,"./ar-tn":276,"./ar-tn.js":276,"./ar.js":270,"./az":277,"./az.js":277,"./be":278,"./be.js":278,"./bg":279,"./bg.js":279,"./bm":280,"./bm.js":280,"./bn":281,"./bn-bd":282,"./bn-bd.js":282,"./bn.js":281,"./bo":283,"./bo.js":283,"./br":284,"./br.js":284,"./bs":285,"./bs.js":285,"./ca":286,"./ca.js":286,"./cs":287,"./cs.js":287,"./cv":288,"./cv.js":288,"./cy":289,"./cy.js":289,"./da":290,"./da.js":290,"./de":291,"./de-at":292,"./de-at.js":292,"./de-ch":293,"./de-ch.js":293,"./de.js":291,"./dv":294,"./dv.js":294,"./el":295,"./el.js":295,"./en-au":296,"./en-au.js":296,"./en-ca":297,"./en-ca.js":297,"./en-gb":298,"./en-gb.js":298,"./en-ie":299,"./en-ie.js":299,"./en-il":300,"./en-il.js":300,"./en-in":301,"./en-in.js":301,"./en-nz":302,"./en-nz.js":302,"./en-sg":303,"./en-sg.js":303,"./eo":304,"./eo.js":304,"./es":305,"./es-do":306,"./es-do.js":306,"./es-mx":307,"./es-mx.js":307,"./es-us":308,"./es-us.js":308,"./es.js":305,"./et":309,"./et.js":309,"./eu":310,"./eu.js":310,"./fa":311,"./fa.js":311,"./fi":312,"./fi.js":312,"./fil":313,"./fil.js":313,"./fo":314,"./fo.js":314,"./fr":315,"./fr-ca":316,"./fr-ca.js":316,"./fr-ch":317,"./fr-ch.js":317,"./fr.js":315,"./fy":318,"./fy.js":318,"./ga":319,"./ga.js":319,"./gd":320,"./gd.js":320,"./gl":321,"./gl.js":321,"./gom-deva":322,"./gom-deva.js":322,"./gom-latn":323,"./gom-latn.js":323,"./gu":324,"./gu.js":324,"./he":325,"./he.js":325,"./hi":326,"./hi.js":326,"./hr":327,"./hr.js":327,"./hu":328,"./hu.js":328,"./hy-am":329,"./hy-am.js":329,"./id":330,"./id.js":330,"./is":331,"./is.js":331,"./it":332,"./it-ch":333,"./it-ch.js":333,"./it.js":332,"./ja":334,"./ja.js":334,"./jv":335,"./jv.js":335,"./ka":336,"./ka.js":336,"./kk":337,"./kk.js":337,"./km":338,"./km.js":338,"./kn":339,"./kn.js":339,"./ko":340,"./ko.js":340,"./ku":341,"./ku.js":341,"./ky":342,"./ky.js":342,"./lb":343,"./lb.js":343,"./lo":344,"./lo.js":344,"./lt":345,"./lt.js":345,"./lv":346,"./lv.js":346,"./me":347,"./me.js":347,"./mi":348,"./mi.js":348,"./mk":349,"./mk.js":349,"./ml":350,"./ml.js":350,"./mn":351,"./mn.js":351,"./mr":352,"./mr.js":352,"./ms":353,"./ms-my":354,"./ms-my.js":354,"./ms.js":353,"./mt":355,"./mt.js":355,"./my":356,"./my.js":356,"./nb":357,"./nb.js":357,"./ne":358,"./ne.js":358,"./nl":359,"./nl-be":360,"./nl-be.js":360,"./nl.js":359,"./nn":361,"./nn.js":361,"./oc-lnc":362,"./oc-lnc.js":362,"./pa-in":363,"./pa-in.js":363,"./pl":364,"./pl.js":364,"./pt":365,"./pt-br":366,"./pt-br.js":366,"./pt.js":365,"./ro":367,"./ro.js":367,"./ru":368,"./ru.js":368,"./sd":369,"./sd.js":369,"./se":370,"./se.js":370,"./si":371,"./si.js":371,"./sk":372,"./sk.js":372,"./sl":373,"./sl.js":373,"./sq":374,"./sq.js":374,"./sr":375,"./sr-cyrl":376,"./sr-cyrl.js":376,"./sr.js":375,"./ss":377,"./ss.js":377,"./sv":378,"./sv.js":378,"./sw":379,"./sw.js":379,"./ta":380,"./ta.js":380,"./te":381,"./te.js":381,"./tet":382,"./tet.js":382,"./tg":383,"./tg.js":383,"./th":384,"./th.js":384,"./tk":385,"./tk.js":385,"./tl-ph":386,"./tl-ph.js":386,"./tlh":387,"./tlh.js":387,"./tr":388,"./tr.js":388,"./tzl":389,"./tzl.js":389,"./tzm":390,"./tzm-latn":391,"./tzm-latn.js":391,"./tzm.js":390,"./ug-cn":392,"./ug-cn.js":392,"./uk":393,"./uk.js":393,"./ur":394,"./ur.js":394,"./uz":395,"./uz-latn":396,"./uz-latn.js":396,"./uz.js":395,"./vi":397,"./vi.js":397,"./x-pseudo":398,"./x-pseudo.js":398,"./yo":399,"./yo.js":399,"./zh-cn":400,"./zh-cn.js":400,"./zh-hk":401,"./zh-hk.js":401,"./zh-mo":402,"./zh-mo.js":402,"./zh-tw":403,"./zh-tw.js":403};function webpackContext(t){var e=webpackContextResolve(t);return i(e)}function webpackContextResolve(t){if(!i.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}webpackContext.keys=function webpackContextKeys(){return Object.keys(s)},webpackContext.resolve=webpackContextResolve,t.exports=webpackContext,webpackContext.id=268},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(1),n=i(406);i(407);class SearchBar extends n.default{constructor(t,e){super(t),this._pioneer=e,this._input=null,this._results=null,this._constructHTML(),this._invert=!0,this._maxResults=10,this._isVisible=!0,this._selectionKey=0,this._selection=null,this._displayMobileInput=!1,window.addEventListener("resize",(t=>{this._setVisibility()}),!1),this._setVisibility(),s.default.isMobile()&&this.hideInput()}_setVisibility(){s.default.isMobile()?(this.showToggle(),this._displayMobileInput||""!==this._input.value.trim()||this.hideInput()):(this._isVisible||this.showInput(),this.hideToggle())}_constructHTML(){this._container=document.createElement("div"),this._container.className="search-container empty",this._resultsBg=document.createElement("div"),this._resultsBg.className="bg",this._resultsBg.style.display="none",this._container.appendChild(this._resultsBg),this._results=document.createElement("ul"),this._results.id="search-results",this._results.className="empty",this._container.appendChild(this._results),this._form=document.createElement("form"),this._form.action="",this._form.method="post",this._form.autocomplete="off",this._form.autocorrect="off",this._form.autocapitalize="off",this._form.spellcheck=!1,this._form.addEventListener("submit",(async t=>{if(t.preventDefault(),s.default.isMobile())this._input.blur();else if(null!==this._selection){const t=this._selection.getElementsByClassName("search-result");void 0!==t&&void 0!==t[0]&&await this._goToEntity(t[0].value)}return!1})),this._container.appendChild(this._form),this._input=document.createElement("input"),this._input.type="text",this._input.name="hidden",this._input.id="search-input",this._input.placeholder="Search",this._input.autocomplete="off",this._input.autocorrect="off",this._input.autocapitalize="off",this._input.spellcheck=!1,this._input.addEventListener("keydown",(t=>{t.stopPropagation(),"ArrowUp"!==t.code&&"ArrowDown"!==t.code||t.preventDefault()})),this._input.addEventListener("focus",(()=>{s.default.isMobile()&&s.default.isFullscreen()&&s.default.toggleFullscreen()})),this._input.addEventListener("keyup",(t=>{const e=this._input.value.trim();if(e.length>0)try{this._updateResults(s.default.search(e))}catch(t){this._results.innerHTML="",console.log("Error",t)}else this._results.innerHTML="";"ArrowUp"===t.code?(this._nextSelection(),t.preventDefault()):"ArrowDown"===t.code?(this._previousSelection(),t.preventDefault()):this._updateSelection(),t.stopPropagation()}),!1),document.addEventListener("click",(t=>{"search-input"===t.target.id||t.target.classList.contains("search-toggle")||t.target.classList.contains("search-result")||this._clear()})),document.addEventListener("touchend",(t=>{"search-input"===t.target.id||t.target.classList.contains("search-toggle")||t.target.classList.contains("search-result")||this._clear()})),document.addEventListener("keyup",(t=>{"KeyF"===t.code&&(s.default.isMobile()&&this.showInput(),this._input.focus())})),this._form.appendChild(this._input),this._toggle=document.createElement("button"),this._toggle.type="button",this._toggle.className="search-toggle secondary",this._toggle.value="toggle",this._toggle.innerHTML="",this._toggle.addEventListener("click",(t=>{this._isVisible=!this._isVisible,this._isVisible?(this._displayMobileInput=!0,this.showInput(),this._input.focus()):(this._displayMobileInput=!1,this.hideInput())})),this._container.appendChild(this._toggle),this._div.appendChild(this._container)}async _goToEntity(t){const e="/"+t,i={time:s.default.get("time").getTimeUrl()};await s.default.router.navigate(e,i),this._clear()}_clear(){this._results.innerHTML="",this._results.classList.add("empty"),this._container.classList.add("empty"),this._resultsBg.style.display="none",this._input.value="",this._input.blur(),this._selectionKey=0,this._selection=null,s.default.isMobile()&&this.hideInput()}_updateResults(t){this._results.innerHTML="";const e=this._invert?Math.min(t.length,this._maxResults)-1:0,i=this._invert?0:Math.min(t.length,this._maxResults);let s=t.length;if(this._invert)for(let n=e;n>=i;n--)this._checkResult(t,n)?this._updateResult(t,n):s--;else for(let n=e;n<i;n++)this._checkResult(t,n)?this._updateResult(t,n):s--;0===s?(this._results.classList.add("empty"),this._container.classList.add("empty"),this._resultsBg.style.display="none",this._selectionKey=0,this._selection=null):(this._results.classList.remove("empty"),this._container.classList.remove("empty"),this._resultsBg.style.display="block",this._invert?this._results.firstChild.classList.add("last"):this._results.lastChild.classList.add("last"))}_checkResult(t,e){const i=s.default.scene.get(t[e].ref),n=i.getPositionCoverage(),r=this._pioneer.getTime();return null!==i&&!i.getPosition().isNaN()&&n.min<=r&&r<=n.max}_updateResult(t,e){const i=document.createElement("li"),n=s.default.get("content").getEntityList(),r=document.createElement("button");r.type="button",r.className="search-result",r.value=n[t[e].ref].id,r.innerHTML=n[t[e].ref].name,r.addEventListener("click",(async t=>{await this._goToEntity(r.value)})),i.addEventListener("mouseenter",(t=>{this._setSelection(t.target)})),i.appendChild(r),this._results.appendChild(i)}_updateSelection(){if(this._results.childElementCount<=0)return;null!==this._selection&&this._selection.classList.remove("selection");let t=this._results.lastChild,e=this._selectionKey;this._invert&&(e=this._results.childElementCount-1-this._selectionKey),e<0&&(e=0);for(let i=this._results.childElementCount-1;i>=0&&i!==e;i--)t=t.previousSibling;this._selection=t,this._selection.classList.add("selection")}_setSelection(t){null!==this._selection&&this._selection.classList.remove("selection");const e=t.getElementsByClassName("search-result")[0].value;let i=this._results.lastChild;for(let t=this._results.childElementCount-1;t>=0;t--){const s=i.getElementsByClassName("search-result");if(void 0!==s&&void 0!==s[0]&&s[0].value===e){this._selectionKey=t,this._invert&&(this._selectionKey=this._results.childElementCount-1-t);break}i=i.previousSibling}this._selection=t,this._selection.classList.add("selection")}_nextSelection(){const t=this._results.childElementCount;this._selectionKey=(this._selectionKey+1)%t,this._updateSelection()}_previousSelection(){const t=this._results.childElementCount;this._selectionKey=(t+this._selectionKey-1)%t,this._updateSelection()}showToggle(){this._toggle.style.display="block"}hideToggle(){this._toggle.style.display="none"}showInput(){this._input.style.display="block",this._results.style.display="block",this._isVisible=!0,this._toggle.classList.add("active")}hideInput(){this._input.style.display="none",this._results.style.display="none",this._resultsBg.style.display="none",this._isVisible=!1,this._toggle.classList.remove("active")}__disable(){this._div.style.display="none",this.hideInput(),this.hideToggle()}__enable(){this._div.style.display="block",this.showInput(),this._setVisibility()}}const r=SearchBar},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s=class BaseComponent{constructor(t){this._div=t,this._parent=this._div.parentElement,this._enabled=!0,this.isEnabled=this.isEnabled.bind(this),this.setEnabled=this.setEnabled.bind(this)}isEnabled(){return this._enabled}setEnabled(t){const e=this._enabled;this._enabled=t,this._enabled&&!e?this.__enable():!this._enabled&&e&&this.__disable()}__enable(){this._parent.appendChild(this._div)}__disable(){this._div=this._parent.removeChild(this._div)}}},(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(409),n=i.n(s);const r=class Search{constructor(t){this._empty=[],this._idx=null,this._entityList=t,this._loadSearchIndex()}_loadSearchIndex(){const t=new(n().Builder);t.field("keywords",{boost:1}),t.field("name",{boost:100}),t.ref("id"),t.k1(1.3),t.b(0);for(const e in this._entityList)t.add(this._entityList[e],{boost:this._entityList[e].weight});this._idx=t.build()}search(t){return null===this._idx||""===t||t.length<2?this._empty:this._idx.query((function(e){e.term(n().tokenizer(t),{presence:n().Query.presence.REQUIRED,wildcard:n().Query.wildcard.TRAILING|n().Query.wildcard.LEADING,fields:["name","keywords"]})}))}}},,(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var s=i(1),n=i(406),r=i(411),o=i.n(r);i(412),i(413);class DetailsPanel extends n.default{constructor(t,e,i){super(t),this._pioneer=e,this._id=null,this._entityDesc=null,this._entityInfo=null,this._scene=i,this._constructHTML(),window.addEventListener("selectionupdate",(async t=>{if(!this.isEnabled())return this._id=null,void this._stopTracking();const e=t.detail.new;switch(e){case"solar_system":case"inner_solar_system":case"outer_solar_system":this._id=null,this.hide(),this._stopTracking();break;default:e!==this._id&&(this._id=e,await this.setObject(e)),s.default.isMobile()&&(this.showToggle(),this._isMini||this.toggleMiniMode()),this.show()}}),!1),window.addEventListener("unselect",(t=>{this._id=null,this.hide(),this._stopTracking()}),!1),window.addEventListener("resize",(t=>{s.default.get("compareManager").isComparing()||this._updateVisibility()}),!1),this._isVisible=!0,this._isMini=!1,this._lastClassName=null,this._scrollbar=null,this._isMetric=!1,this._miToKm=1.60934,this._interval=null,this._outData={distance:0,speed:0,parent:""}}_constructHTML(){this._container=document.createElement("div"),this._container.className="container content",this._div.className="scrollable",this._div.innerHTML="",this._div.appendChild(this._container),this._div.style.display="none",this._div.addEventListener("animationend",(()=>{"0"===window.getComputedStyle(this._div).opacity?this._div.style.display="none":this._div.style.display="block"}),!0),this._title=document.createElement("h1"),this._title.innerHTML="Empty",this._title.addEventListener("click",(t=>{s.default.isMobile()&&this._isMini&&this.toggleMiniMode()})),this._container.appendChild(this._title),this._category=document.createElement("p"),this._category.className="category",this._container.appendChild(this._category),this._categoryName=document.createElement("span"),this._categoryName.innerHTML="Empty",this._category.appendChild(this._categoryName),this._image=document.createElement("img"),this._image.className="objectimage no-select",this._image.src="",this._container.appendChild(this._image),this._description=document.createElement("p"),this._description.className="description",this._description.innerHTML="Empty",this._container.appendChild(this._description),this._videoContainer=document.createElement("a"),this._videoContainer.className="video-container no-select",this._videoContainer.href="",this._container.appendChild(this._videoContainer),this._video=document.createElement("video"),this._video.className="video no-select",this._video.preload="auto",this._video.autoplay=!0,this._video.playsInline=!0,this._video.defaultMuted=!0,this._video.muted=!0,this._video.loop=!0,this._video.addEventListener("stalled",(()=>{this._videoContainer.replaceChild(this._videoFallback,this._video)})),this._videoContainer.appendChild(this._video),this._videoSource=document.createElement("source"),this._videoSource.src="",this._videoSource.type="video/mp4",this._video.appendChild(this._videoSource),this._videoFallback=document.createElement("img"),this._videoFallback.src="",this._videoFallback.title="Your browser does not support the <video> tag",this._video.appendChild(this._videoFallback),this._moduleLink=document.createElement("a"),this._moduleLink.className="module-link no-select",this._moduleLink.href="",this._moduleLink.target="_blank",this._moduleLink.innerHTML="",this._container.appendChild(this._moduleLink),this._link=document.createElement("a"),this._link.className="read-more no-select",this._link.href="",this._link.target="_blank",this._link.innerHTML="Read more",this._container.appendChild(this._link),this._quickfacts=document.createElement("div"),this._quickfacts.className="quickfacts",this._container.appendChild(this._quickfacts),this._quickfactMap={};const t=[["topLeft","topRight"],["bottomLeft","bottomRight"]];for(let e=0;e<2;e++){for(let i=0;i<2;i++){const s=t[e][i];this._quickfactMap[s]={};const n=document.createElement("div");n.className="data-block",this._quickfacts.appendChild(n),this._quickfactMap[s].dataBlock=n;const r=document.createElement("div");r.className="data",n.appendChild(r),this._quickfactMap[s].data=r;const o=document.createElement("div");o.className="info",n.appendChild(o),this._quickfactMap[s].info=o}for(let i=0;i<2;i++){const s=t[e][i],n=document.createElement("div");n.className="label-block",this._quickfacts.appendChild(n),this._quickfactMap[s].labelBlock=n}}this._tracking=document.createElement("div"),this._tracking.className="tracking quickfacts hidden",this._container.appendChild(this._tracking);const e=document.createElement("div");e.className="system-switch",this._milesButton=document.createElement("button"),this._milesButton.className="no-select active",this._milesButton.innerHTML="miles",this._milesButton.addEventListener("click",this._displayMiles.bind(this)),e.appendChild(this._milesButton),this._kmButton=document.createElement("button"),this._kmButton.className="no-select",this._kmButton.innerHTML="km",this._kmButton.addEventListener("click",this._displayKm.bind(this)),e.appendChild(this._kmButton),this._trackingMap={};for(let i=0;i<2;i++){for(let s=0;s<2;s++){if(1===i&&1===s){this._tracking.appendChild(e);continue}const n=t[i][s];this._trackingMap[n]={};const r=document.createElement("div");r.className="data-block",this._tracking.appendChild(r),this._trackingMap[n].dataBlock=r;const o=document.createElement("div");o.className="data",r.appendChild(o),this._trackingMap[n].data=o;const a=document.createElement("div");a.className="info",r.appendChild(a),this._trackingMap[n].info=a}for(let e=0;e<2;e++){if(1===i&&1===e)continue;const s=t[i][e],n=document.createElement("div");n.className="label-block",this._tracking.appendChild(n),this._trackingMap[s].labelBlock=n}}this._legend=document.createElement("p"),this._legend.className="legend",this._legend.innerHTML="AU: Astronomical Unit, the distance between the Earth and the Sun.",this._container.appendChild(this._legend),this._footer=document.createElement("div"),this._footer.className="footer",this._container.appendChild(this._footer),this._compare=document.createElement("button"),this._compare.type="button",this._compare.className="compare no-select",this._compare.innerHTML="Compare Size",this._compare.value="compare",this._compare.addEventListener("click",(async t=>{const e="/"+s.default.get("content").getReplacement(this._id)+"/compare",i={time:s.default.get("time").getTimeUrl()};await s.default.router.navigate(e,i)})),this._footer.appendChild(this._compare),this._toggle=document.createElement("button"),this._toggle.type="button",this._toggle.className="details-toggle",this._toggle.value="toggle",this._toggle.innerHTML="",this._toggle.addEventListener("click",(t=>{this.toggleMiniMode()})),this._container.appendChild(this._toggle),this._close=document.createElement("button"),this._close.type="button",this._close.className="details-close",this._close.value="close",this._close.innerHTML="",this._close.addEventListener("click",(t=>{s.default._selector.unselect()})),this._container.appendChild(this._close)}_updateVisibility(){s.default.isMobile()?(this.showToggle(),this._isMini?(this._div.classList.add("mini"),this._div.classList.remove("expand")):(this._div.classList.remove("mini"),this._div.classList.add("expand"))):(this._isVisible||null===this._id||this.show(),this.hideToggle(),this._div.classList.remove("mini"),this._div.classList.remove("expand"))}async _updateDescription(){const t=this._id;let e=this._getClassName(this._id);if(null!==this._lastClassName){const t=this._lastClassName.split(" ");for(let e=0;e<t.length;e++)this._div.classList.remove(t[e])}const i=e.split(" ");for(let t=0;t<i.length;t++)this._div.classList.add(i[t]);this._lastClassName=e,this._title.innerHTML=this._entityDesc.name;let n=this._entityInfo.category;if(this._category.className="category "+this._entityInfo.category.toLowerCase().replace(/ /g,"-"),"Moon"===n){let e=this._scene.get(this._id).getParent().getName();e=s.default.get("content").getReplacement(e);const i=await fetch("descriptions/"+e+".json").then((t=>t.json()));if(this._id!==t)return;n="Moon of "+i.name}else void 0!==this._entityInfo.subcategory&&(n=this._entityInfo.subcategory,"Spacecraft"===this._entityInfo.category&&(n=this._entityInfo.subcategory+" "+this._entityInfo.category,this._category.className+=" "+this._entityInfo.subcategory.toLowerCase().replace(/ /g,"-")));this._categoryName.innerHTML=n,void 0!==this._entityDesc.image?(this._image.src=this._entityDesc.image,this._image.alt=this._id,this._image.classList.remove("hidden")):this._image.classList.add("hidden"),this._description.innerHTML=this._entityDesc.shortDescription;const r=this._entityDesc.quickfacts;if(void 0===r)this._quickfacts.classList.add("hidden");else{this._quickfacts.classList.remove("hidden");const t=["topLeft","topRight","bottomLeft","bottomRight"];for(let i=0;i<t.length;i++){const s=t[i],n=r[s];void 0!==n?(this._quickfactMap[s].dataBlock.style.display="grid",this._quickfactMap[s].labelBlock.style.display="block",this._quickfactMap[s].data.innerHTML=n.data,this._quickfactMap[s].data.className="data color",void 0!==n.class&&(e+=n.class,this._quickfactMap[s].data.classList.add(...n.class.split(" "))),void 0!==n.info?(this._quickfactMap[s].info.innerHTML=n.info,this._quickfactMap[s].info.style.display="block"):this._quickfactMap[s].info.style.display="none",this._quickfactMap[s].labelBlock.innerHTML=n.label):(this._quickfactMap[s].dataBlock.style.display="none",this._quickfactMap[s].labelBlock.style.display="none")}null===this._scrollbar?this._scrollbar=new(o())(this._container,{className:"os-theme-dark",resize:"none",sizeAutoCapable:!0,clipAlways:!0,normalizeRTL:!1,paddingAbsolute:!1,autoUpdate:!0,overflowBehavior:{x:"hidden",y:"scroll"},scrollbars:{clickScrolling:!0}}):this._scrollbar.scroll(0)}if(void 0===this._entityDesc.trackings)this._stopTracking();else if(await this._startTracking(t),t!==this._id)return;this._entityDesc.video?(this._videoSource.src=this._entityDesc.video.url,this._video.load(),this._entityDesc.video.link&&(this._videoContainer.href=this._entityDesc.video.link),this._entityDesc.video.fallback&&(this._videoFallback.src=this._entityDesc.video.fallback),this._videoContainer.classList.remove("hidden")):this._videoContainer.classList.add("hidden"),this._link.href=this._entityDesc.link,"Spacecraft"===this._entityInfo.category?this._legend.classList.add("hidden"):this._legend.classList.remove("hidden"),s.default.get("content").hasLanded(this._id)?(this._compare.style.display="none",this._footer.classList.add("hidden")):(this._compare.style.display="inline-block",this._footer.classList.remove("hidden"))}_getClassName(t){let e="";const i=this._pioneer.get("main",t);if(null===i)return"";const n=i.getParent();return null!==n&&"sun"!==t&&"sun"!==n.getName()&&(t=n.getName(),t=s.default.get("content").getReplacement(t)),e=s.default.get("content").getClassName(t),e}async setObject(t){this._entityDesc=await s.default.get("content").getEntityDesc(t),this._id===t&&(this._entityInfo=s.default.get("content").getEntityInfo(t),await this._updateDescription())}hide(){this._isVisible=!1,this._div.classList.add("hidden"),this._div.classList.remove("active")}show(){this._isVisible=!0,this._div.classList.remove("hidden"),this._div.classList.add("active"),this._div.style.display="block",this._container.scrollTop=0}toggleMiniMode(){this._isMini=!this._isMini,this._isMini?(this._div.classList.add("mini"),this._div.classList.remove("expand")):(this._div.classList.remove("mini"),this._div.classList.add("expand"))}showToggle(){this._toggle.style.display="block"}hideToggle(){this._toggle.style.display="none"}_displayMiles(){this._kmButton.classList.remove("active"),this._milesButton.classList.add("active"),this._isMetric=!1}_displayKm(){this._milesButton.classList.remove("active"),this._kmButton.classList.add("active"),this._isMetric=!0}_formatDistance(t){let e="<span>",i="",s="km";t=Number.parseFloat(t),this._isMetric||(t/=this._miToKm,s="mi");const n=[{label:"trillion",value:1e12},{label:"billion",value:1e9},{label:"million",value:1e6},{label:"thousand",value:1e3}];for(let e=0;e<n.length;e++){const s=n[e];if(t/s.value>1){i=s.label,t/=s.value;break}}return t=Math.abs(t.toFixed(2)),e+=this._numberWithCommas(t)+'<span class="unit">'+i+" "+s+"</span>",e+="</span>",e}_formatSpeed(t){let e="<span>";return this._isMetric?(t=Number.parseFloat(3600*t),t=Math.abs(Math.floor(t)),e+=this._numberWithCommas(t)+'<span class="unit">km/h</span>'):(t=Number.parseFloat(3600*t/this._miToKm),t=Math.abs(Math.floor(t)),e+=this._numberWithCommas(t)+'<span class="unit">mph</span>'),e+="</span>",e}_numberWithCommas(t){return Number(t).toLocaleString()}async _startTracking(t){const e=this._entityDesc.trackings,i=["topLeft","topRight","bottomLeft"];for(let t=0;t<i.length;t++){const n=e[i[t]];void 0!==n&&void 0!==n.target&&await s.default.get("scene").isReady(n.target)}if(this._id===t){for(let t=0;t<i.length;t++){const s=i[t],n=e[s];void 0!==n?(this._trackingMap[s].dataBlock.style.display="grid",this._trackingMap[s].labelBlock.style.display="block",this._trackingMap[s].data.className="data color",void 0!==n.class&&this._trackingMap[s].data.classList.add(...n.class.split(" ")),this._trackingMap[s].info.style.display="none",this._trackingMap[s].labelBlock.innerHTML=n.label):(this._trackingMap[s].dataBlock.style.display="none",this._trackingMap[s].labelBlock.style.display="none")}this._tracking.classList.remove("hidden"),null!==this._interval&&clearInterval(this._interval),this._interval=setInterval((()=>{if((!this._isMini||!s.default.isMobile())&&this._isVisible){if(!s.default._pioneer.get("main",this._id).isInPositionCoverage()||s.default.get("content").hasLanded(this._id))return void this._tracking.classList.add("hidden");if(this._id!==t)return;this._tracking.classList.remove("hidden");for(let t=0;t<i.length;t++){const n=i[t],r=e[n];if(void 0!==r&&void 0!==r.type)switch(r.type){case"distance":void 0!==r.target&&(s.default.get("scene").getDistance(this._id,r.target,this._outData,{subtractRadius:!0}),r.data=this._formatDistance(this._outData.distance),this._trackingMap[n].data.innerHTML=r.data);break;case"speed":s.default.get("scene").getSpeed(this._id,s.default.get("time").getTime(),this._outData),r.label="Speed (relative to "+this._outData.parent+")",r.data=this._formatSpeed(this._outData.speed),this._trackingMap[n].labelBlock.innerHTML=r.label,this._trackingMap[n].data.innerHTML=r.data}}}}),500)}}_stopTracking(){this._tracking&&this._tracking.classList.add("hidden"),null!==this._interval&&(clearInterval(this._interval),this._interval=null)}__disable(){this._div.style.display="none",this._stopTracking(),this.hide()}__enable(){null!==this._id&&(this._div.style.display="block",this.show(),this._updateVisibility(),this._entityDesc&&void 0!==this._entityDesc.trackings&&this._startTracking(this._id))}}const a=DetailsPanel},,,(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(1),n=i(406);i(415);class NavigationBar extends n.default{constructor(t,e){super(t),this._pioneer=e,this._id=null,this._leftButton=null,this._rightButton=null,this._customTargets={inner_solar_system:{system:"outer_solar_system",object:"outer_solar_system"},outer_solar_system:{system:"inner_solar_system",object:"inner_solar_system"},sun:{system:"inner_solar_system",object:"sun"}},this._constructHTML(),this._displaySystem=!1,this.setObject("outer_solar_system",this._displaySystem),window.addEventListener("selectionupdate",(t=>{const e=t.detail.new;this._id!==e&&(this._displaySystem=!1,this.setObject(e,this._displaySystem))}),!1),window.addEventListener("cameraupdate",(t=>{const e=t.detail.target,i=t.detail.range;this._displaySystem="near"===i,this.setObject(e,this._displaySystem)}),!1),window.addEventListener("unselect",(t=>{this._id=null,this._displaySystem=!1,this.setObject("outer_solar_system",this._displaySystem)}),!1)}_constructHTML(){const t=document.createElement("div");t.className="container",this._div.appendChild(t),this._leftButton=document.createElement("button"),this._leftButton.type="button",this._leftButton.value="solar_system",this._leftButton.className="outer-solar-system no-select left secondary",this._leftButton.addEventListener("click",(async()=>{if("/home"===s.default.router.lastPathResolved())s.default.selector.unselect(),s.default.camera.goToObject("outer_solar_system","default").then((()=>{}));else{const t="/home",e={time:s.default.get("time").getTimeUrl()};await s.default.router.navigate(t,e)}})),t.appendChild(this._leftButton),this._leftButtonText=document.createElement("span"),this._leftButtonText.innerHTML="Solar System",this._leftButton.appendChild(this._leftButtonText),this._rightButton=document.createElement("button"),this._rightButton.type="button",this._rightButton.value="inner_solar_system",this._rightButton.className="inner-solar-system no-select right secondary",this._rightButton.addEventListener("click",(async()=>{let t="near";this._displaySystem&&(t="far");let e="/"+this._id,i={range:t,time:s.default.get("time").getTimeUrl()};"inner_solar_system"===this._id?i={time:s.default.get("time").getTimeUrl()}:"outer_solar_system"===this._id&&(e="/home",i={time:s.default.get("time").getTimeUrl()}),await s.default.router.navigate(e,i)})),t.appendChild(this._rightButton),this._rightButtonText=document.createElement("span"),this._rightButtonText.innerHTML="Inner Solar System",this._rightButton.appendChild(this._rightButtonText)}_getAdjective(t){const e=this._pioneer.get("main",t),i=s.default.get("content").getEntityInfo(t);if(null===e)return i.adjective;const n=e.getParent();if(null===n)return i.adjective;if("sun"===n.getName())return i.adjective;return s.default.get("content").getEntityInfo(n.getName()).adjective}_getButtonText(t,e){let i="";const n=s.default.get("content").getEntityInfo(t);if(e)switch(n.category){case"Spacecraft":case"Asteroid":case"Comet":i=n.category+" Location";break;default:i=this._getAdjective(t)+" System"}else if("Spacecraft"===n.category)i="Spacecraft View";else i=n.name;return i}_getClassName(t,e){let i="object";return e&&(i="system"),s.default.get("content").getClassName(t)+" right no-select secondary "+i}async _updateButtons(t,e){this._rightButtonText.innerHTML=this._getButtonText(t,e),this._rightButton.className=this._getClassName(t,e)}_getTarget(t,e){if(t in this._customTargets)return e?this._customTargets[t].system:this._customTargets[t].object;if(!e)return t;{const e=this._pioneer.get("main",t).getParent();if(null!==e&&"sun"===e.getName())return t;if(null!==e)return e.getName()}}async setObject(t,e){this._id=this._getTarget(t,e),this._updateButtons(this._id,e)}__disable(){this._div.style.display="none"}__enable(){this._div.style.display="block"}}const r=NavigationBar},(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(417),n=i(1),r=i(406);i(418);class Controls extends r.default{constructor(t,e){super(t),this._pioneer=e,this._light=null,this._isLightOn=!1,this._forcedLightOn=!1,this._isFullScreen=!1,this._fullscreenResolution={width:0,height:0},this._constructHTML(),window.addEventListener("cameraupdate",(t=>{const e=t.detail.target,i=t.detail.range;"Spacecraft"===n.default.get("content").getEntityInfo(e).category&&"near"===i?this._isLightOn||(this.toggleLight(),this._forcedLightOn=!0):this._forcedLightOn&&this._isLightOn?(this.toggleLight(),this._forcedLightOn=!1):this._forcedLightOn=!1;const s=n.default.get("scene").hasHD(e);this._hd.disabled=!s,s?this._hd.classList.remove("hidden"):this._hd.classList.add("hidden")}),!1),window.addEventListener("comparisonenter",(()=>{this._isLightOn||(this.toggleLight(),this._forcedLightOn=!0),this._hd.classList.add("hidden")}),!1),window.addEventListener("comparisonexit",(()=>{this._isLightOn&&this._forcedLightOn?(this.toggleLight(),this._forcedLightOn=!1):this._forcedLightOn=!1,this._hd.classList.remove("hidden")}),!1),window.addEventListener("loading",(()=>{this.setLoading(!0)})),window.addEventListener("allloaded",(()=>{this.setLoading(!1)}))}_constructHTML(){const t=document.createElement("div");t.className="controls-container",this._div.appendChild(t),this._toggleUnit=document.createElement("button"),this._toggleUnit.type="button",this._toggleUnit.className="toggle-unit no-select secondary",this._toggleUnit.value="toggle",this._toggleUnit.style.display="none",n.default.isMetric()?this._toggleUnit.classList.add("metric"):this._toggleUnit.classList.remove("metric"),this._toggleUnit.addEventListener("click",(()=>{n.default.toggleUnitSystem(),n.default.isMetric()?this._toggleUnit.classList.add("metric"):this._toggleUnit.classList.remove("metric")})),t.appendChild(this._toggleUnit),window.addEventListener("comparisonenter",(()=>{this._toggleUnit.style.display="inline-block"})),window.addEventListener("comparisonexit",(()=>{this._toggleUnit.style.display="none"})),this._hd=document.createElement("button"),this._hd.type="button",this._hd.className="hd-toggle secondary",this._hd.value="hd",this._hd.innerHTML="",this._hd.addEventListener("click",(()=>{this.toggleHD()})),t.appendChild(this._hd),this._light=document.createElement("button"),this._light.type="button",this._light.className="light-toggle secondary",this._light.value="light",this._light.innerHTML="",this._light.addEventListener("click",(()=>{this.toggleLight()})),t.appendChild(this._light),this._loadIcon=document.createElement("div"),this._loadIcon.className="load-icon",this._loadIcon.classList.add("hidden");const e=["bg","front","left","top","right","bottom"];for(let t=0;t<e.length;t++){const i=document.createElement("div");i.className=e[t]+" face",this._loadIcon.appendChild(i)}const i=document.createElement("div");i.innerHTML="Loading",i.className="text",this._loadIcon.appendChild(i),t.appendChild(this._loadIcon),s.default.isEnabled?(this._fullscreen=document.createElement("button"),this._fullscreen.innerHTML="",this._fullscreen.type="button",this._fullscreen.className="toggle-fullscreen secondary",this._fullscreen.value="toggle",this._fullscreen.addEventListener("click",(()=>{this.toggleFullscreen()})),t.appendChild(this._fullscreen),s.default.on("change",(()=>{this._isFullScreen=s.default.isFullscreen,this._isFullScreen?(this._fullscreen.classList.add("active"),n.default.showNASALogo()):(this._fullscreen.classList.remove("active"),n.default.hideNASALogo())})),this._fullscreen.classList.add("last")):this._light.classList.add("last"),document.addEventListener("keyup",(t=>{this._isFullScreen||"F11"!==t.code||(this._fullscreenResolution.width=window.innerWidth,this._fullscreenResolution.height=window.innerHeight,this._isFullScreen=!0,this._fullscreen.classList.add("active"))})),window.addEventListener("resize",(()=>{this._isFullScreen&&this._fullscreenResolution.height>window.innerHeight&&this._fullscreenResolution.width>window.innerWidth&&(this._isFullScreen=!1,this._fullscreen.classList.remove("active"))}))}toggleLight(){this._isLightOn=!this._isLightOn,n.default.camera.toggleCameraLight(this._isLightOn),n.default.get("compareManager").toggleCameraLight(this._isLightOn),this._isLightOn?this._light.classList.add("on"):this._light.classList.remove("on")}toggleHD(){n.default.get("scene").toggleHD(),n.default.get("scene").isHD()?this._hd.classList.add("active"):this._hd.classList.remove("active")}toggleFullscreen(){s.default.isEnabled&&s.default.toggle()}isFullscreen(){return this._isFullScreen}setLoading(t){t?this._loadIcon.classList.remove("hidden"):this._loadIcon.classList.add("hidden")}__disable(){this._div.style.display="none"}__enable(){this._div.style.display="block"}}const o=Controls},,(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var s=i(265),n=i.n(s),r=i(1),o=(i(420),i(406));class Clock extends o.default{constructor(t,e){super(t),this._pioneer=e,this._timeElement=null,this._timezone="America/Los_Angeles",this._timeFormat=r.default.get("time").getDateFormat("time"),this._dateFormat=r.default.get("time").getDateFormat("date"),this._isUTC=r.default.get("time").getDisplayUTC(),this._handleClick=this._handleClick.bind(this),this._clickCount=0,this._timeLimit=1e3,this._timer=0,this._clickIntervals=[],this._constructHTML()}_constructHTML(){const t=document.createElement("div");t.className="clock-container",t.addEventListener("click",this._handleClick,!1),this._div.appendChild(t),this._dateComponents=document.createElement("div"),this._dateComponents.className="date-components",t.appendChild(this._dateComponents),this._dateElement=document.createElement("p"),this._dateElement.className="date",this._dateComponents.appendChild(this._dateElement),this._timeComponents=document.createElement("div"),this._timeComponents.className="time-components",t.appendChild(this._timeComponents),this._timeElement=document.createElement("p"),this._timeElement.className="time",this._timeComponents.appendChild(this._timeElement),this._meridiem=document.createElement("span"),this._meridiem.className="meridiem",this._timeComponents.appendChild(this._meridiem),this._am=document.createElement("div"),this._am.innerHTML="AM",this._meridiem.appendChild(this._am),this._pm=document.createElement("div"),this._pm.innerHTML="PM",this._am.classList.add("off"),this._meridiem.appendChild(this._pm),this._timezone=n().tz.guess()}_handleClick(){this._clickCount++;const t=new Date;1===this._clickCount&&(this._timer=new Date),this._clickIntervals[this._clickCount-1]=t.valueOf()-this._timer.valueOf(),this._clickCount>1&&this._clickIntervals[this._clickCount-1]-this._clickIntervals[this._clickCount-2]>this._timeLimit&&(this._clickCount=0,this._clickIntervals=[]),this._clickCount>=6&&!r.default._timeRateSlider.isEnabled()&&(r.default._timeRateSlider.setEnabled(!0),this._clickCount=0,this._clickIntervals=[]),this._clickCount>=3&&r.default._timeRateSlider.isEnabled()&&(r.default._timeRateSlider.setEnabled(!1),this._clickCount=0,this._clickIntervals=[])}setUTC(t){this._isUTC=t,this._isUTC?this._meridiem.style.display="none":this._meridiem.style.display="inline-block",this._timeFormat=r.default.get("time").getDateFormat("time"),this._dateFormat=r.default.get("time").getDateFormat("date")}update(t){this.isEnabled&&(this._updateTimeDisplay(t),this._isUTC||("pm"===t.format("a")?(this._am.classList.add("off"),this._pm.classList.remove("off")):(this._am.classList.remove("off"),this._pm.classList.add("off"))))}_updateTimeDisplay(t){const e=t.format(this._timeFormat),i=t.format(this._dateFormat);this._timeElement.innerHTML=e,this._dateElement.innerHTML=i,"pm"===t.format("a")?(this._am.classList.add("off"),this._pm.classList.remove("off")):(this._am.classList.remove("off"),this._pm.classList.add("off"))}__disable(){this._div.style.display="none"}__enable(){this._div.style.display="block"}}const a=Clock},(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>s});const s=class ObjectSelector{constructor(t){this._id=null,this._scene=t}async selectEntity(t){const e=this._id;if(t!==e){const i=new CustomEvent("selectionupdate",{detail:{new:t,old:this._id}});window.dispatchEvent(i),this._id=t,this._switchSelectionClass(this._id,e)}}_switchSelectionClass(t,e){if(null!==e){const t=this._scene.get(e);if(null!==t){const e=t.getComponentByType("div").getDiv();e&&e.classList.remove("selection")}}if(null!==t){const e=this._scene.get(t);if(null!==e){const t=e.getComponentByType("div").getDiv();t&&t.classList.add("selection")}}}getCurrentId(){return this._id}unselect(){const t=this._id;if(null!==t){const t=new CustomEvent("unselect",{old:this._id});window.dispatchEvent(t)}this._id=null,this._switchSelectionClass(this._id,t)}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(2),n=i(125),r=i(1);const o=class Camera{constructor(t,e){this._scene=t,this._cameraEntity=t.get("camera"),this._selector=e,this._id=null,this._range="",this._previousId=null,this._cameraLight=this._cameraEntity.get("lightSource"),null===this._cameraLight&&(this._cameraLight=this._cameraEntity.addComponent("lightSource"),this._cameraLight.setEnabled(!1)),this._customOrbits={earth:"moon",sun:"earth","134340_pluto_barycenter":"134340_pluto"},this._customSystemDistances={mercury:425648,venus:862136,earth:1040264,mars:8e4,jupiter:7157638,saturn:4869142,uranus:1886367,neptune:2407045,"134340_pluto":122231,"136199_eris":180309,"1_ceres":87225,"136108_haumea":126609,"136472_makemake":118584},this._isTransitioning=!1,this._defaultMaxDistance=2e18}getCurrentId(){return this._id}getRange(){return this._range}toggleCameraLight(t){null!==this._cameraLight&&this._cameraLight.setEnabled(t)}async intro(){const t=new CustomEvent("cameraupdate",{detail:{target:"outer_solar_system",range:"far"}});window.dispatchEvent(t),this._renderMessage("outer_solar_system","Solar","Welcome to the","System"),this._id="sun",this._range="default",await this._goToSystem("sun",{distance:1e10,angle:55,duration:0}),await this._goToSystem("sun",{distance:1e10,angle:25,duration:1.5})}async goToObject(t,e){if(this._isTransitioning&&this._id===t&&this._range===e)return;this._previousId=this._id,this._id=t,this._range=e;const i=new CustomEvent("cameraupdate",{detail:{target:t,range:e}});window.dispatchEvent(i);const s=r.default.get("content").getEntityInfo(t);if("near"===e)switch(s.category){case"System":"inner_solar_system"===t?(this._renderMessage(t,s.adjective,"Traveling to","System"),await this._goToSystem("sun",{distance:7e8,angle:25}).then((()=>{const i=new CustomEvent("cameratransitiondone",{detail:{target:t,range:e,mode:"system"}});window.dispatchEvent(i)}))):(this._renderMessage(t,s.adjective,"Traveling to","System"),await this._goToSystem("sun",{distance:1e10,angle:25}).then((()=>{const i=new CustomEvent("cameratransitiondone",{detail:{target:t,range:e,mode:"system"}});window.dispatchEvent(i)})));break;case"Spacecraft":r.default.get("content").hasLanded(t)?(this._renderMessage(t,s.name,"Aligning view with"),await this._alignSpacecraftPlanet(t).then((()=>{const i=new CustomEvent("cameratransitiondone",{detail:{target:t,range:e,mode:"align"}});window.dispatchEvent(i)}))):(this._renderMessage(t,s.name,"Traveling to"),await this._goToSpacecraft(t).then((()=>{const i=new CustomEvent("cameratransitiondone",{detail:{target:t,range:e,mode:"spacecraft"}});window.dispatchEvent(i)})));break;default:this._renderMessage(t,s.name,"Traveling to"),await this._goToPlanet(t).then((()=>{const i=new CustomEvent("cameratransitiondone",{detail:{target:t,range:e,mode:"planet"}});window.dispatchEvent(i)}))}else switch(s.category){case"Moon":case"Spacecraft":case"Asteroid":case"Comet":this._renderMessage(t,s.name,"Showing location of"),await this._showLocation(t).then((()=>{const i=new CustomEvent("cameratransitiondone",{detail:{target:t,range:e,mode:"location"}});window.dispatchEvent(i)}));break;case"System":"inner_solar_system"===t?(this._renderMessage(t,s.adjective,"Traveling to","System"),await this._goToSystem("sun",{distance:7e8,angle:25}).then((()=>{const i=new CustomEvent("cameratransitiondone",{detail:{target:t,range:e,mode:"system"}});window.dispatchEvent(i)}))):(this._renderMessage(t,s.adjective,"Traveling to","System"),await this._goToSystem("sun",{distance:1e10,angle:25}).then((()=>{const i=new CustomEvent("cameratransitiondone",{detail:{target:t,range:e,mode:"system"}});window.dispatchEvent(i)})));break;default:{this._renderMessage(t,s.adjective,"Traveling to","System");let i=0;t in this._customSystemDistances&&(i=this._customSystemDistances[t]),await this._goToSystem(t,{minDistance:i}).then((()=>{const i=new CustomEvent("cameratransitiondone",{detail:{target:t,range:e,mode:"system"}});window.dispatchEvent(i)}));break}}}async compareObjects(t,e,{cameraLeft:i,cameraRight:s,cameraLeftPosition:n,cameraRightPosition:r,cameraUp:o,scene:a,duration:l=.75}){const h=new CustomEvent("cameracompare",{detail:{left:t,right:e}});window.dispatchEvent(h),this._goToEntity(t,{camera:i,destination:n,destinationUp:o,scene:a,select:!1,duration:l,zoom:!1,cinematic:!0}),this._goToEntity(e,{camera:s,destination:r,destinationUp:o,scene:a,select:!1,duration:l,zoom:!1,cinematic:!0})}_renderMessage(t,e,i,s){let n="";const o=this._scene.get(t);let a="";a=null!==o&&null!==o.getParent()&&"sun"!==t&&"sun"!==o.getParent().getName()?r.default.get("content").getClassName(o.getParent().getName()):r.default.get("content").getClassName(t);const l={className:a};void 0!==i&&(n+=i),n+='<em class="color">'+e,void 0!==s&&(n+=" "+s),n+="</em>",r.default.sendNotification(n,l)}async _showLocation(t){const e=this._scene.get(t),i=this._scene.get("sun"),r=[];r.push(i),r.push(e);const o=new s.Vector3(0,0,1),a=new s.Vector3(1,0,0),l=new s.Vector3;this._getNormalToEcliptic(l,"sun"),l.isNaN()&&l.copy(new s.Vector3(0,0,1));const h=new s.Quaternion;h.setFromAxes(a,o,void 0);let c=n.Cameras.getDistanceToFitEntities(this._cameraEntity,h,e,r);c*=1.5;const d=new s.Vector3;e.getPositionRelativeToEntity(d,s.Vector3.Zero,i),c=Math.max(d.magnitude(),c);const u=e.getOcclusionRadius(),_=1.2*u,g=new s.Vector3;return g.copy(o),g.mult(g,5*u),this._goToEntity(t,{destination:g,destinationUp:l,duration:1.5}).then((()=>(o.mult(o,c),this._goToEntity(t,{destination:o,cinematic:!1,minRadius:_,destinationUp:l}))))}async _goToPlanet(t){const e=this._scene.get(t),i=this._scene.get("sun");let o=new s.Vector3;e.getPositionRelativeToEntity(o,s.Vector3.Zero,i),0===o.magnitude()&&(o=new s.Vector3(0,1,0));const a=new s.Vector3;e.getOrientation().getAxis(a,2),o.neg(o),o.normalize(o);let l=e.getOcclusionRadius();null!==e.getComponentByType("spheroid")&&(l=e.getComponentByType("spheroid").getEquatorialRadius());const h=1.2*l,c=new s.Quaternion;c.setFromAxes(void 0,o,a);const d=[e];if(r.default.get("content").isBarycenter(t)){const e=r.default.get("content").removeBarycenter(t);d.push(this._scene.get(e))}let u=n.Cameras.getDistanceToFitEntities(this._cameraEntity,c,e,d);return u*=1.3,o.mult(o,u),this._goToEntity(t,{distance:u}).then((()=>this._goToEntity(t,{destination:o,cinematic:!0,minRadius:h,destinationUp:a,duration:1.5})))}async _goToSpacecraft(t){const e=this._scene.get(t),i=1.2*e.getOcclusionRadius(),o=new s.Vector3;o.normalize(e.getPosition());const a=new s.Vector3;"sun"===e.getParent().getName()?(this._getNormalToEcliptic(a,"sun"),a.isNaN()&&a.copy(new s.Vector3(0,0,1))):e.getParent().getOrientation().getAxis(a,2);const l=r.default.get("content").getEntityInfo(t);let h=0;if(void 0!==l.customDistance)h=l.customDistance;else{const t=new s.Quaternion;t.setFromAxes(void 0,o,a);h=1.3*n.Cameras.getDistanceToFitEntities(this._cameraEntity,t,e,[e])}return o.mult(o,h),this._goToEntity(t,{distance:h}).then((()=>this._goToEntity(t,{destination:o,cinematic:!0,minRadius:i,destinationUp:a,duration:1.5})))}async _alignSpacecraftPlanet(t){const e=this._scene.get(t);let i=e.getParent();for(;null!==i&&null===i.getComponentByType("spheroid");)i=i.getParent();let n=i.getOcclusionRadius();null!==i.getComponentByType("spheroid")&&(n=i.getComponentByType("spheroid").getEquatorialRadius());const r=new s.Vector3;e.getPositionRelativeToEntity(r,s.Vector3.Zero,i),r.normalize(r),r.mult(r,5*n);const o=new s.Vector3;return i.getOrientation().getAxis(o,2),this._goToEntity(i.getName(),{}).then((()=>this._goToEntity(t,{destination:r,cinematic:!1,minRadius:50,destinationUp:o,duration:1.5})))}_getNormalToEcliptic(t,e){e in this._customOrbits&&(e=this._customOrbits[e]);const i=new s.Quaternion;r.default.pioneer.get("main",e,"dynamo").getOrbitOrientation(i,r.default.pioneer.getTime()),i.getAxis(t,2)}async _goToSystem(t,{distance:e,angle:i=25,minDistance:o=0,duration:a=1}){const l=this._scene.get(t),h=[];for(let t=0;t<l._children.length;t++){const e=l._children[t],i=r.default.get("content").getEntityInfo(e.getName());null===e.getComponentByType("camera")&&("Spacecraft"!==i.category&&(e.getPosition().isNaN()||h.push(e)))}h.push(l);const c=new s.Vector3,d=new s.Vector3;this._cameraEntity.getPositionRelativeToEntity(d,s.Vector3.Zero,l),d.isNaN()?(c.copy(new s.Vector3(0,-1,0)),c.mult(c,1e10)):c.copy(d);const u=new s.Vector3,_=new s.Vector3;t in this._customOrbits?(this._getNormalToEcliptic(_,t),_.isNaN()&&_.copy(new s.Vector3(0,0,1))):l.getOrientation().getAxis(_,2),u.cross(c,_),u.normalize(u),c.setNormalTo(_,c),c.normalize(c);const g=new s.Quaternion;g.setFromAxisAngle(u,s.MathUtils.degToRad(i)),c.rotate(g,c);let p=l.getOcclusionRadius(),m=l.getComponentByType("spheroid");if(null!==m)p=l.getComponentByType("spheroid").getEquatorialRadius();else if(r.default.get("content").isBarycenter(t)){const e=r.default.get("content").removeBarycenter(t),i=this._scene.get(e);m=i.getComponentByType("spheroid"),null!==m&&(p=i.getComponentByType("spheroid").getEquatorialRadius())}const f=1.2*p;let y=e;if(void 0===y){const t=new s.Quaternion;t.setFromAxes(u,c,void 0),y=n.Cameras.getDistanceToFitEntities(this._cameraEntity,t,l,h),y*=1.3}y=Math.max(o,y);const T=new s.Vector3;return this._cameraEntity.getPositionRelativeToEntity(d,s.Vector3.Zero,l),d.isNaN()?(T.copy(new s.Vector3(0,-1,0)),T.setNormalTo(_,T),T.mult(T,1e10),T.rotate(g,T)):T.copy(d),this._goToEntity(t,{destination:T,destinationUp:_,duration:a}).then((()=>(c.mult(c,y),this._goToEntity(t,{destination:c,cinematic:!1,minRadius:f,destinationUp:_,duration:a}))))}async _goToEntity(t,{camera:e,scene:i,destination:o,distance:a,cinematic:l=!1,minRadius:h=.001,maxRadius:c=this._defaultMaxDistance,duration:d=.75,destinationUp:u,zoom:_=!0,select:g=!0}){if(void 0===e&&(e=this._cameraEntity),void 0===i&&(i=this._scene),this._isTransitioning=!0,void 0!==o){const i=new s.Vector3;i.sub(e.getPosition(),o);const n=this._cameraEntity.getParent();if(null!==n){const r=n.getName();if(!isNaN(i.magnitude())){const t=s.MathUtils.clamp01(i.magnitude()/e.getPosition().magnitude());d=Math.max(d/5,d*t)}if(!isNaN(i.magnitude())&&i.magnitude()<=.001&&t===r)return void(this._isTransitioning=!1)}}return n.Cameras.goToEntity(e,i.get(t),{destination:o,distance:a,up:!1,duration:d,destinationUp:u,zoom:_}).then((()=>{r.default.get("scene").addLoading(t,"camera");const n=[],o=["model","wmts","spheroidLOD"];for(let e=0;e<o.length;e++){const s=i.get(t,o[e]);null!==s&&s.isEnabled()&&(n.push(s.getLoadedPromise()),"wmts"===o[e]&&n.push(s.getTilesLoadedPromise()))}if(Promise.all(n).then((()=>{const e=new CustomEvent("loaded",{detail:{id:t,type:"camera"}});window.dispatchEvent(e)})),g){e.addController("select").setCallback((async t=>{if(null===t||r.default.labelClicked)null!==t||r.default.labelClicked||this._selector.unselect();else if(this._selector.getCurrentId()===t.getName()){const e="/"+t.getName(),i={time:r.default.get("time").getTimeUrl()};await r.default.router.navigate(e,i)}else this._selector.selectEntity(t.getName())}))}if(_&&e.get("zoom").setDistanceClamp(new s.Interval(h,c)),l){const t=e.getControllerByType("align"),i=e.addController("spin",void 0,t);i instanceof s.SpinController&&(i.setAxis(s.Vector3.ZAxis,!0),i.setRate(.025),i.setUsingRealTime(!0),i.setRotatingPosition(!0));const n=e.addController("tap");n instanceof s.TapController&&n.setTapCallback((()=>{e.removeController(i),e.removeController(n)}))}this._isTransitioning=!1}),(t=>{t&&(console.log(t),this._isTransitioning=!1)}))}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(2),n=i(265),r=i.n(n);const o=class Content{constructor(t){this._pioneer=t,this._customClass={"134340_pluto":"pluto",outer_solar_system:"outer-solar-system",inner_solar_system:"inner-solar-system",school_bus:"comparison",rose_bowl:"comparison",scientist:"comparison"},this._customEntityDesc={inner_solar_system:{name:"Inner Solar System"},outer_solar_system:{name:"Outer Solar System"},milky_way:{name:"Milky Way"},observable_universe:{name:"Observable Universe"},scientist:{name:"Scientist"},school_bus:{name:"School bus"},rose_bowl:{name:"Rose Bowl Stadium"}},this._customEntityInfo={inner_solar_system:{name:"Inner Solar System",id:"inner_solar_system",adjective:"Inner Solar",category:"System",keywords:["solar system"],weight:0},outer_solar_system:{name:"Outer Solar System",id:"outer_solar_system",adjective:"Outer Solar",category:"System",keywords:["solar system"],weight:0},milky_way:{name:"Milky Way",id:"milky_way",adjective:"Outer Solar",category:"Galaxy",keywords:["milky way"],weight:0},observable_universe:{name:"Observable Universe",id:"observable_universe",adjective:"Outer Solar",category:"Universe",keywords:["observable universe"],weight:0},scientist:{name:"Scientist",category:"Comparison Object"},school_bus:{name:"School bus",category:"Comparison Object"},rose_bowl:{name:"Rose Bowl Stadium",category:"Comparison Object"}},this._replacements={"134340_pluto_barycenter":"134340_pluto",sc_mars_science_laboratory_landing_site:"sc_mars_science_laboratory",sc_perseverance_landing_site:"sc_perseverance"},this._entityList=null}async init(){this._entityList=await this._downloadEntities()}async _downloadEntities(){return fetch("./entity_info.json").then((t=>t.json())).then((t=>{for(const[e,i]of Object.entries(t))!0===i.disabled&&delete t[e];return t}))}getEntityList(){return this._entityList}getReplacement(t){return t in this._replacements&&(t=this._replacements[t]),t}isBarycenter(t){return!!t.includes("_barycenter")}removeBarycenter(t){return this.isBarycenter(t)?t.replace("_barycenter",""):t}getEntityInfo(t){let e={};return e=(t=this.getReplacement(t))in this._customEntityInfo?this._customEntityInfo[t]:this._entityList[t],e}getCustomEntitiesDesc(){return this._customEntityDesc}getCustomEntityDesc(t){return(t=this.getReplacement(t))in this._customEntityDesc?this._customEntityDesc[t]:null}async getEntityDesc(t){let e={};return e=(t=this.getReplacement(t))in this.getCustomEntitiesDesc()?this.getCustomEntityDesc(t):await fetch("descriptions/"+t+".json").then((t=>404===t.status?{}:t.json()),(t=>{t&&console.log(t)})),e}getClassName(t){t=this.getReplacement(t);const e=this.getEntityInfo(t);if(void 0===e.category)return t;let i=e.category.toLowerCase().replace(/ /g,"-");switch(e.category){case"Dwarf Planet":case"Asteroid":case"Comet":i+=" _"+t;break;case"Moon":{const e=this._pioneer.get("main",t);if(null!==e){let s=e.getParent();for(;null!==s;)null!==s.getParent()&&"sun"===s.getParent().getName()&&(i+=" parent-"+s.getName()+" "+t),s=s.getParent()}break}default:i+=" "+t}return t in this._customClass&&(i+=" "+this._customClass[t]),i}hasKeyword(t,e){if(t=this.getReplacement(t),void 0!==this.getEntityInfo(t))return this.getEntityInfo(t).keywords.includes(e)}hasLanded(t){if(t.endsWith("landing_site"))return!0;if(t=this.getReplacement(t),void 0!==this._entityList[t]&&void 0!==this._entityList[t].landingDate){const e=r().tz(this._entityList[t].landingDate,"Etc/UTC");return!!r().tz(1e3*s.TimeUtils.etToUnix(this._pioneer.getTime()),"Etc/UTC").isSameOrAfter(e)}return!1}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(425),n=i(1);class LabelManager{constructor(t,e,i){this._algorithm=this.Quadtree,this._pioneer=e,this._scene=i,this._labels={},this._entities=t,this._createLabelArray(),this._weights={},this._weightsLength=0,this._quadTree=new s.Quadtree({x:0,y:0,width:window.innerWidth,height:window.innerHeight},2,8),this._collidingLabels=[],this._frameCount=0,this._frameStep=1,this._frameCycle=3*this._frameStep,this._activeClass="active",this._hiddenClass="hidden",this._overlapThreshold=.25,this._centerBoundingRect={name:"center",x:0,y:0,width:50,height:50},this.update=this.update.bind(this)}setAlgorithm(t){this._algorithm=t}setEntities(t){this._entities=t,this._createLabelArray()}setWeights(t){this._weights=t,this._weightsLength=Object.keys(this._weights).length}getWeight(t){return this._weightsLength<=0?0:void 0!==this._weights[t]?this._weights[t].weight:0}getZ(t){return this._labels[t].z}update(){0===this._frameCount?(this._collidingLabels=[],this._buildQuadtree()):this._frameCount===this._frameCycle/3?this._checkWithQuadtree():this._frameCount===2*this._frameCycle/3&&this._fixCollisions(),this._frameCount++,this._frameCount=this._frameCount%this._frameCycle}_createLabelArray(){this._labels={};for(let t=this._entities.size-1;t>=0;t--){const e=this._entities.get(t);e.getComponentByType("div")&&(this._labels[e.getName()]={name:e.getName(),x:0,y:0,width:0,height:0,check:!1,collisions:[],isHidden:!1})}}_buildQuadtree(){this._quadTree.clear();for(let t=this._entities.size-1;t>=0;t--){const e=this._entities.get(t);if(e.getComponentByType("div")){const t=e.getComponentByType("div").getDiv(),i=t.getBoundingClientRect();if("0"===t.style.opacity){"none"!==t.style.display&&(t.style.display="none"),this._labels[e.getName()].check=!1;continue}if(this._isOutOfWindow(i)){this._labels[e.getName()].check=!1;continue}""!==t.style.display&&(t.style.display=""),this._labels[e.getName()].x=i.x,this._labels[e.getName()].y=i.y,this._labels[e.getName()].width=i.width,this._labels[e.getName()].height=i.height,this._labels[e.getName()].check=!0,this._labels[e.getName()].collisions=[],this._labels[e.getName()].isHidden=!1;const s=this._pioneer.get("main","camera","camera");this._labels[e.getName()].z=e.getCameraSpacePosition(s).magnitude(),this._quadTree.insert(this._labels[e.getName()])}}}_checkWithQuadtree(){for(const t of Object.keys(this._labels)){const e=this._labels[t];if(!e.check)continue;const i=this._quadTree.retrieve(e);for(let t=0;t<i.length;t++){const s=i[t];s.check&&this._checkCollision(s,e)&&e.name!==s.name&&this._overlap(s,e)>=this._overlapThreshold&&this._addCollision(s.name,e.name)}}}getItemAtCenter(){this._centerBoundingRect.x=window.innerWidth/2-this._centerBoundingRect.width/2,this._centerBoundingRect.y=window.innerHeight/2-this._centerBoundingRect.height/2;const t=this._quadTree.retrieve(this._centerBoundingRect);for(let e=0;e<t.length;e++){const i=t[e];if(i.y+=i.height/2,i.width=this._centerBoundingRect.width,i.height=this._centerBoundingRect.height,this._checkCollision(i,this._centerBoundingRect))return i}return null}_addCollision(t,e){this._collidingLabels.indexOf(t)<0&&this._collidingLabels.push(t),this._collidingLabels.indexOf(e)<0&&this._collidingLabels.push(e),this._labels[t].collisions.push(e)}_fixCollisions(){this._collidingLabels.sort(((t,e)=>this.getWeight(e)-this.getWeight(t)!=0?this.getWeight(e)-this.getWeight(t):this.getZ(t)-this.getZ(e)));const t=n.default.selector.getCurrentId();if(t in this._labels){const e=this._entities.get(t);if(e.getComponentByType("div")){"0"!==e.getComponentByType("div").getDiv().style.opacity&&this._collidingLabels.unshift(t)}}for(let t=0;t<this._collidingLabels.length;t++){const e=this._collidingLabels[t];if(!this._labels[e].isHidden){this._showLabel(e);for(let t=0;t<this._labels[e].collisions.length;t++){const i=this._labels[e].collisions[t];this._hideLabel(i)}}}this._restoreLabels()}_restoreLabels(){for(const t of Object.keys(this._labels)){const e=this._labels[t];e.isHidden||this._showLabel(e.name),0===e.collisions.length&&this._showLabel(e.name)}const t=n.default.selector.getCurrentId();t in this._labels&&this._showLabel(t)}_showLabel(t){const e=this._pioneer.get("main",t).getComponentByType("div").getDiv();e.classList.add(this._activeClass),e.classList.remove(this._hiddenClass),this._labels[t].isHidden=!1}_hideLabel(t){const e=this._pioneer.get("main",t).getComponentByType("div").getDiv();e.classList.add(this._hiddenClass),e.classList.remove(this._activeClass),this._labels[t].isHidden=!0}_checkCollision(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}_overlap(t,e){const i=(Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x))*(Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return i/(t.width*t.height+e.width*e.height-i)}_isOutOfWindow(t){return t.x>window.innerWidth||t.x+t.width<0||t.y>window.innerHeight||t.y+t.height<0}}LabelManager.Quadtree=1,LabelManager.BruteForce=0;const r=LabelManager},(t,e,i)=>{"use strict";i.r(e),i.d(e,{Quadtree:()=>Quadtree});class Quadtree{constructor(t,e,i,s){this.max_objects=e||10,this.max_levels=i||4,this.level=s||0,this.bounds=t,this.objects=[],this.nodes=[]}split(){const t=this.level+1,e=Math.round(this.bounds.width/2),i=Math.round(this.bounds.height/2),s=Math.round(this.bounds.x),n=Math.round(this.bounds.y);this.nodes[0]=new Quadtree({x:s+e,y:n,width:e,height:i},this.max_objects,this.max_levels,t),this.nodes[1]=new Quadtree({x:s,y:n,width:e,height:i},this.max_objects,this.max_levels,t),this.nodes[2]=new Quadtree({x:s,y:n+i,width:e,height:i},this.max_objects,this.max_levels,t),this.nodes[3]=new Quadtree({x:s+e,y:n+i,width:e,height:i},this.max_objects,this.max_levels,t)}getIndex(t){let e=-1;const i=this.bounds.x+this.bounds.width/2,s=this.bounds.y+this.bounds.height/2,n=t.y<s&&t.y+t.height<s,r=t.y>s;return t.x<i&&t.x+t.width<i?n?e=1:r&&(e=2):t.x>i&&(n?e=0:r&&(e=3)),e}insert(t){let e,i=0;if(void 0===this.nodes[0]||(e=this.getIndex(t),-1===e)){if(this.objects.push(t),this.objects.length>this.max_objects&&this.level<this.max_levels)for(void 0===this.nodes[0]&&this.split();i<this.objects.length;)e=this.getIndex(this.objects[i]),-1!==e?this.nodes[e].insert(this.objects.splice(i,1)[0]):i+=1}else this.nodes[e].insert(t)}retrieve(t){const e=this.getIndex(t);let i=this.objects;if(void 0!==this.nodes[0])if(-1!==e)i=i.concat(this.nodes[e].retrieve(t));else for(let e=0;e<this.nodes.length;e+=1)i=i.concat(this.nodes[e].retrieve(t));return i}clear(){this.objects=[];for(let t=0;t<this.nodes.length;t+=1)void 0!==this.nodes[t]&&this.nodes[t].clear();this.nodes=[]}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(406);i(427);class MessageBar extends s.default{constructor(t){super(t),this._isNotificationOn=!1,this._notifTimeout=null,this._notificationText=null,this._constructHTML()}_constructHTML(){const t=document.createElement("div");t.className="container",this._div.innerHTML="",this._div.style.display="none",this._div.appendChild(t),this._notificationText=document.createElement("p"),this._notificationText.innerHTML="",t.appendChild(this._notificationText)}showNotification(t,{timeout:e=2e3,className:i=""}){this._isNotificationOn&&clearTimeout(this._notifTimeout),this._notificationText.innerHTML="<span>"+t+"</span>",this._notificationText.className=i,this._isNotificationOn=!0,this._div.classList.add("active"),this._div.classList.remove("hidden"),this._notifTimeout=setTimeout((()=>{this.fadeNotification()}),e),this._div.style.display="block"}fadeNotification(){this._div.classList.add("hidden"),this._div.classList.remove("active")}__disable(){this._div.style.display="none"}__enable(){this._div.style.display="block"}}const n=MessageBar},(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var s=i(406);i(429);class Options extends s.default{constructor(t){super(t),this._infoTemplate="",this._isInfoPanelVisible=!1,this._showCloseButton=!1,this._constructHTML()}_constructHTML(){const t=document.createElement("div");t.className="container",this._div.appendChild(t),this._infoPanel=document.createElement("div"),this._infoPanel.innerHTML="",this._infoPanel.style.display="none",this._infoPanel.className="panel scrollable",this._infoPanel.id="info-panel",this._infoPanel.addEventListener("animationend",(()=>{"0"===window.getComputedStyle(this._infoPanel).opacity?this._infoPanel.style.display="none":this._infoPanel.style.display="block"}),!0),t.appendChild(this._infoPanel),this._infoContent=document.createElement("div"),this._infoContent.className="content",this._infoPanel.appendChild(this._infoContent),this._closeInfo=document.createElement("button"),this._closeInfo.innerHTML="",this._closeInfo.type="button",this._closeInfo.className="close-info",this._closeInfo.value="close",this._closeInfo.addEventListener("click",(t=>{this.toggleInfoPanel()})),this._toogleInfo=document.createElement("button"),this._toogleInfo.innerHTML="",this._toogleInfo.type="button",this._toogleInfo.className="toggle-info",this._toogleInfo.value="toggle",this._toogleInfo.addEventListener("click",(t=>{this.toggleInfoPanel()})),t.appendChild(this._toogleInfo),this.inIframe()&&(this._closeApp=document.createElement("button"),this._closeApp.innerHTML="",this._closeApp.type="button",this._closeApp.className="close-app",this._closeApp.value="close",this._closeApp.style.display="none",this._closeApp.addEventListener("click",(t=>{this.closeApp()})),t.appendChild(this._closeApp))}async _getInfoText(){await fetch("info.html").then((t=>t.text())).then((t=>{this._infoContent.innerHTML=t,this._infoContent.appendChild(this._closeInfo)}))}toggleInfoPanel(){this._infoPanel.style.display="block",""===this._infoTemplate&&this._getInfoText(),this._isInfoPanelVisible=!this._isInfoPanelVisible,this._isInfoPanelVisible?(this._infoPanel.classList.add("active"),this._infoPanel.classList.remove("hidden"),this._div.style.zIndex=500):(this._infoPanel.classList.add("hidden"),this._infoPanel.classList.remove("active"),this._div.style.zIndex=10)}closeApp(){window.parent.postMessage("close_overlay","*")}inIframe(){try{return window.self!==window.top}catch(t){return!0}}displayCloseButton(t){this._showCloseButton=t,this._closeApp&&(this._showCloseButton?this._closeApp.style.display="inline-block":this._closeApp.style.display="none")}__disable(){this._div.style.display="none"}__enable(){this._div.style.display="block"}}const n=Options},(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(2),n=i(125),r=i(1);const o=class ComparisonManager{constructor(t,e){this._pioneer=e,this._entities=t._entities,this._mainScene=t,this._comparisonScene=null,this._leftEntity=null,this._rightEntity=null,this._leftPosition=new s.Vector3(0,1e10,0),this._rightPosition=new s.Vector3(0,-1e10,0),this._componentsToBeCopied=["rings","atmosphere","model","spheroid","spheroidLOD","div"],this._isComparisonOn=!1,this._customRotations={rose_bowl:{x:45},sc_juno:{x:45},saturn:{x:25},sc_lucy:{z:-90,y:-25},sc_ixpe:{z:-90,y:180},sc_hubble_space_telescope:{x:90,z:90}},this._zoomSensitivity={click:.3,hold:.1},this._replacements={sun:"sun_compare"}}_init(){this._leftViewport=this._pioneer.addViewport("left-viewport"),this._leftViewport.getDiv().style.position="absolute",this._leftViewport.setEnabled(!1),this._rightViewport=this._pioneer.addViewport("right-viewport"),this._rightViewport.getDiv().style.position="absolute",this._rightViewport.setEnabled(!1),this._resizeViewports(),this._comparisonScene=this._pioneer.addScene("comparison"),this._comparisonScene.setAmbientLightColor(new s.Color(.005,.005,.005)),this._leftCameraEntity=this._comparisonScene.addEntity("leftCamera"),this._leftCamera=this._leftCameraEntity.addComponent("camera"),this._leftLight=this._leftCameraEntity.addComponent("lightSource"),this._leftLight.setEnabled(!1),this._rightCameraEntity=this._comparisonScene.addEntity("rightCamera"),this._rightCamera=this._rightCameraEntity.addComponent("camera"),this._rightLight=this._rightCameraEntity.addComponent("lightSource"),this._rightLight.setEnabled(!1),this._leftViewport.setCamera(this._leftCamera),this._rightViewport.setCamera(this._rightCamera),n.Entity.create("observable_universe",this._comparisonScene),n.Entity.create("milky_way",this._comparisonScene),this._sun=n.Entity.create("sun",this._comparisonScene),this._sun.getComponentByType("div").setEnabled(!1),this._sun.getComponentByType("atmosphere").setEnabled(!1),this._sun.getComponentByType("sprite").setEnabled(!1),this._sun.getComponentByType("spheroidLOD").setEnabled(!1),this._sunLight=this._sun.get("lightSource"),window.addEventListener("resize",(t=>{this._resizeViewports()}))}setScene(t){this._scene=t}adjustZoomFromViewport(){if(!this._leftViewport||!this._leftViewport.isEnabled())return!1;if(!this._rightViewport||!this._rightViewport.isEnabled())return!1;if(!this._leftCameraEntity||!this._rightCameraEntity)return!1;let t=this._leftCameraEntity.getPosition().magnitude();Number.isNaN(t)&&(t=1);const e=this.app._pioneer.getInput().getActiveViewport();e&&"right-viewport"===e._name&&(t=this._rightCameraEntity.getPosition().magnitude(),Number.isNaN(t)&&(t=1));const i=s.Vector3.pool.get();i.normalize(this._leftCameraEntity.getPosition()),i.mult(i,t);const n=s.Vector3.pool.get();return n.normalize(this._rightCameraEntity.getPosition()),n.mult(n,t),this._leftCameraEntity.setPosition(i),this._rightCameraEntity.setPosition(n),!0}zoomIn(t=!1){let e=1;const i=t?this._zoomSensitivity.hold:this._zoomSensitivity.click;e/=Math.pow(2,i);const s=this.app.getManager("camera");s.zoom(e,this._leftCameraEntity),s.zoom(e,this._rightCameraEntity)}zoomOut(t=!1){let e=1;const i=t?this._zoomSensitivity.hold:this._zoomSensitivity.click;e*=Math.pow(2,i);const s=this.app.getManager("camera");s.zoom(e,this._leftCameraEntity),s.zoom(e,this._rightCameraEntity)}_createCopy(t,e){if(null!==this._leftEntity&&this._leftEntity.getName()===t&&"left"===e||null!==this._rightEntity&&this._rightEntity.getName()===t&&"right"===e)return;"left"===e&&null!==this._leftEntity&&this._leftEntity.getName()!==t?(this._leftCameraEntity.setParent(this._sun),this._leftCameraEntity.setPosition(s.Vector3.Zero),this._comparisonScene.removeEntity(this._leftEntity)):"right"===e&&null!==this._rightEntity&&this._rightEntity.getName()!==t&&(this._rightCameraEntity.setParent(this._sun),this._rightCameraEntity.setPosition(s.Vector3.Zero),this._comparisonScene.removeEntity(this._rightEntity));let i=null;const n=this._mainScene.get(t);i=t in this._replacements?this._comparisonScene.addEntity(this._replacements[t]):this._comparisonScene.addEntity(t),i.setParent(this._sun),i.setExtentsRadius(n.getExtentsRadius()),i.setOcclusionRadius(n.getOcclusionRadius());for(let t=0;t<n.getNumComponents();t++)if(this._componentsToBeCopied.includes(n.getComponent(t)._type))switch(n.getComponent(t)._type){case"spheroid":this._copySpheroid(i,n.getComponent(t));break;case"spheroidLOD":this._copySpheroidLOD(i,n.getComponent(t));break;case"rings":this._copyRings(i,n.getComponent(t));break;case"div":this._copyDiv(i,n.getComponent(t),e);break;case"model":this._copyModel(i,n.getComponent(t));break;case"atmosphere":this._copyAtmosphere(i,n.getComponent(t))}"left"===e?this._leftEntity=i:this._rightEntity=i}_copySpheroid(t,e){const i=t.addComponent("spheroid");i.setEquatorialRadius(e.getEquatorialRadius()),i.setPolarRadius(e.getPolarRadius())}_copySpheroidLOD(t,e){const i=t.addComponent("spheroidLOD"),s=e.getTextureNames();for(let t=0;t<s.length;t++){const n=s[t],r=e.getTextureSizes(n),o=e.getTextureUrl(n);i.setTexture(n,o,r)}i.setMapping(e.getMapping());const n=e._features.entries();for(const t of n)i.setFeature(t[0],!0)}_copyRings(t,e){const i=t.addComponent("rings");i.setInnerRadius(e.getInnerRadius()),i.setOuterRadius(e.getOuterRadius()),i.setTopTextureUrl(e.getTopTextureUrl()),i.setBottomTextureUrl(e.getBottomTextureUrl())}_copyModel(t,e){const i=t.addComponent("model");i.setScale(e.getScale()),i.setRotation(e.getRotation()),""!==e._environmentCubemapUrl?i.setEnvironmentCubemapUrl(e._environmentCubemapUrl):""!==e._environmentCylindricalUrl&&i.setEnvironmentCylindricalUrl(e._environmentCylindricalUrl),i.setUrl(e.getUrl())}_copyAtmosphere(t,e){const i=t.addComponent("atmosphere");i.setDensity(e.getDensity()),i.setScaleHeight(e.getScaleHeight()),i.setEmissivity(e.getEmissivity()),i.setColor(e.getColor()),i.setSunBrightness(e.getSunBrightness()),i.setSunsetColor(e.getSunsetColor()),i.setSunsetIntensity(e.getSunsetIntensity())}_copyDiv(t,e,i){const s=t.addComponent("div");"left"===i?s.setActiveCamera(this._leftCamera):s.setActiveCamera(this._rightCamera),s.setAlignment(e.getAlignment()),s.getDiv().innerHTML=e.getDiv().innerHTML;let n=t.getName();for(const t in this._replacements)if(n===this._replacements[t]){n=t;break}const o=r.default.get("content").getClassName(n);s.getDiv().className="pioneer-label-div no-select "+o}_positionEntity(t,e){t.setOrientation(s.Quaternion.Identity);let i=this._leftPosition;"right"===e&&(i=this._rightPosition);const n=new s.Vector3,r=new s.Quaternion,o=t.getName();if(void 0!==this._customRotations[o]){r.set(1,0,0,0);for(const t in this._customRotations[o]){let i,n=this._customRotations[o][t];if("right"===e&&(n*=-1),"x"===t)i=new s.Vector3(1,0,0);else if("y"===t)i=new s.Vector3(0,1,0);else{if("z"!==t)throw new Error("Invalid model rotate axis.");i=new s.Vector3(0,0,1)}n=s.MathUtils.degToRad(n);const a=new s.Quaternion;a.setFromAxisAngle(i,n),r.mult(r,a)}}else t.getOrientation().getAxis(n,2),r.setFromAxisAngle(n,s.MathUtils.degToRad(180));t.setOrientation(r),t.setPosition(i)}_showViewports(){this._isComparisonOn=!0;const t=this.pioneer.getNumViewports();for(let e=0;e<t;e++){const t=this.pioneer.getViewport(e);t.isEnabled()&&(this._activeViewports.push(e),t.setEnabled(!1))}this._leftViewport.setEnabled(this._isComparisonOn),this._rightViewport.setEnabled(this._isComparisonOn)}_hideViewports(){this._isComparisonOn=!1,this._leftViewport.setEnabled(this._isComparisonOn),this._rightViewport.setEnabled(this._isComparisonOn);for(let t=0;t<this._activeViewports.length;t++){const e=this._activeViewports[t];this.pioneer.getViewport(e).setEnabled(!0)}this._activeViewports=[]}_toggleViewports(){this._isComparisonOn=!this._isComparisonOn;this._pioneer.getViewport(0).setEnabled(!this._isComparisonOn),this._leftViewport.setEnabled(this._isComparisonOn),this._rightViewport.setEnabled(this._isComparisonOn)}_resizeViewports(){r.default.isMobile()&&!r.default.isLandscape()?(this._leftViewport.getDiv().style.width="100%",this._leftViewport.getDiv().style.height="calc(50% - 25px)",this._leftViewport.getDiv().style.left="0%",this._leftViewport.getDiv().style.top="0%",this._rightViewport.getDiv().style.width="100%",this._rightViewport.getDiv().style.height="calc(50% - 25px)",this._rightViewport.getDiv().style.left="0%",this._rightViewport.getDiv().style.top="calc(50% - 25px)"):(this._leftViewport.getDiv().style.width="50%",this._leftViewport.getDiv().style.height="100%",this._leftViewport.getDiv().style.left="0%",this._leftViewport.getDiv().style.top="0%",this._rightViewport.getDiv().style.width="50%",this._rightViewport.getDiv().style.height="100%",this._rightViewport.getDiv().style.left="50%",this._rightViewport.getDiv().style.top="0%")}async compare(t,e){if(t=r.default.get("content").getReplacement(t),e=r.default.get("content").getReplacement(e),null===this._mainScene.get(t)||null===this._mainScene.get(e))return;if(this._createCopy(t,"left"),this._positionEntity(this._leftEntity,"left"),this._createCopy(e,"right"),this._positionEntity(this._rightEntity,"right"),this._leftEntity.setEnabled(!0),this._rightEntity.setEnabled(!0),!this._isComparisonOn){this._toggleViewports();const t=new CustomEvent("comparisonenter",{detail:{}});window.dispatchEvent(t)}const i=new s.Quaternion;i.setFromAxes(new s.Vector3(0,-1,0),void 0,new s.Vector3(0,0,1));const o=n.Cameras.getDistanceToFitEntities(this._leftCameraEntity,i,this._leftEntity,[this._leftEntity]);i.setFromAxes(new s.Vector3(0,1,0),void 0,new s.Vector3(0,0,1));const a=n.Cameras.getDistanceToFitEntities(this._rightCameraEntity,i,this._rightEntity,[this._rightEntity]);let l=Math.max(a,o);l*=1.6;const h=new s.Vector3(0,-1,0);h.mult(h,l);const c=new s.Vector3(0,1,0);c.mult(c,l);const d=new s.Vector3(0,0,1);this._leftCameraEntity.clearControllers(),this._rightCameraEntity.clearControllers();const u={cameraLeft:this._leftCameraEntity,cameraRight:this._rightCameraEntity,cameraLeftPosition:h,cameraRightPosition:c,cameraUp:d,minRadius:.5*l,maxRadius:10*l,scene:this._comparisonScene};t in this._replacements&&(t=this._replacements[t]),e in this._replacements&&(e=this._replacements[e]),await r.default.camera.compareObjects(t,e,u)}isACopy(t){return!!t.getName().includes("_copy")}toggleCameraLight(t,e){this._leftLight.setEnabled(t),this._rightLight.setEnabled(t),void 0!==e&&(this._leftLight.setColor(e),this._rightLight.setColor(e)),this._sunLight.setEnabled(!t)}clear(){null!==this._leftEntity&&this._leftEntity.setEnabled(!1),null!==this._rightEntity&&this._rightEntity.setEnabled(!1)}exit(){this.clear(),this._leftEntity&&this._comparisonScene.removeEntity(this._leftEntity),this._leftCameraEntity.setParent(this._sun),this._leftEntity=null,this._rightEntity&&this._comparisonScene.removeEntity(this._rightEntity),this._rightCameraEntity.setParent(this._sun),this._rightEntity=null,this._isComparisonOn&&this._toggleViewports();const t=new CustomEvent("comparisonexit",{detail:{}});window.dispatchEvent(t)}isComparing(){return this._isComparisonOn}getScene(){return this._comparisonScene}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var s=i(2),n=i(432),r=i(1);const o=class Scene{constructor(t,e){this._pioneer=t,this._scene=e,this._wmtsList=n,this._hdList={},this._isHD=!1,this._loadingItems=[],this._addWMTS(),window.addEventListener("loaded",(t=>{this.removeLoading(t.detail.id,t.detail.type)}))}async isReady(t,e){e=void 0===e?this._pioneer.getTime():s.TimeUtils.unixToEt(e.unix());return new Promise(((i,n)=>{const r=setInterval((()=>{const o=this._scene.get(t);if(null===o)return void n(new Error("Object not found."));const a=s.Vector3.pool.get(),l=s.Quaternion.pool.get(),h=s.Quaternion.pool.get();o.getPositionAtTime(a,e),null===o||a.isNaN()||(clearInterval(r),i()),s.Quaternion.pool.release(l),s.Quaternion.pool.release(h),s.Vector3.pool.release(a)}),30)}))}async isListReady(t,e){const i=[];void 0===e&&(e=[void 0]);for(let s=0;s<t.length;s++)for(let n=0;n<e.length;n++)i.push(this.isReady(t[s],e[n]));return Promise.all(i)}setAtmosphere(t){this._scene.get("mars").get("atmosphere").setEnabled(t)}getDistance(t,e,i,{subtractRadius:n=!1}={}){const r=s.Vector3.pool.get(),o=this._scene.get(t),a=this._scene.get(e);o.getPositionRelativeToEntity(r,s.Vector3.Zero,a);let l=r.magnitude();if(n){l-=o.getExtentsRadius()+a.getExtentsRadius()}i.distance=l,s.Vector3.pool.release(r)}getSpeed(t,e,i){const n=s.Vector3.pool.get(),r=s.Vector3.pool.get(),o=this._scene.get(t),a=s.TimeUtils.unixToEt(e.valueOf()/1e3);o.getPositionAtTime(r,a),o.getVelocityAtTime(n,a),i.parent=o.getParent(a).getName(),i.speed=n.magnitude(),s.Vector3.pool.release(n),s.Vector3.pool.release(r)}async tileIsReady(t){let e=null;return new Promise(((i,s)=>{const n=setInterval((()=>{t.isEnabled()&&t.getEntity().isEnabled()||s(new Error("disabled")),null===e&&null!==t._tilesLoadedPromise&&(e=t.getTilesLoadedPromise().then((()=>{clearInterval(n),i(!0)})))}),30)}))}async toggleHD(){this._isHD=!this._isHD,this._isHD||this._pioneer.getConfig().setValue("maxTextureSize",512);for(const t in this._hdList){const e=r.default.camera.getCurrentId(),i=this._scene.get(e).getParent().getName(),s=this._hdList[t],n=this._scene.get(t),o=n.getComponentByType("spheroidLOD"),a=n.getComponent(s);r.default.isMobile()&&a.setMaxLevel(5),a.setEnabled(this._isHD),this._isHD&&(e!==t&&i!==t||(this.addLoading(t,"wmts"),this._wmtsList[a.getName()].loaded||(await this.tileIsReady(a),this._wmtsList[a.getName()].loaded=!0),this.removeLoading(t,"wmts"))),o.setEnabled(!this._isHD),this._isHD&&this._pioneer.getConfig().setValue("maxTextureSize",4096)}}isHD(){return this._isHD}hasHD(t){const e=this._scene.get(t);if(null===e)return!1;if(Object.prototype.hasOwnProperty.call(this._hdList,t))return!0;if(null!==e.getParent()&&Object.prototype.hasOwnProperty.call(this._hdList,e.getParent().getName()))return!0;if(null!==e.get("spheroidLOD")){const t=e.get("spheroidLOD").getTextureSizes("color");for(let e=0;e<t.length;e++)if(t[e]>512)return!0}if(null!==e.getParent()&&null!==e.getParent().get("spheroidLOD")){const t=e.getParent().get("spheroidLOD").getTextureSizes("color");for(let e=0;e<t.length;e++)if(t[e]>512)return!0}return!1}addLoading(t,e){const i=t+"_"+e;if(this._loadingItems.indexOf(i)<0&&this._loadingItems.push(i),this._loadingItems.length>0){const t=new CustomEvent("loading");window.dispatchEvent(t)}}removeLoading(t,e){const i=t+"_"+e,s=this._loadingItems.indexOf(i);if(s>=0&&this._loadingItems.splice(s,1),0===this._loadingItems.length){const t=new CustomEvent("allloaded");window.dispatchEvent(t)}}_addWMTS(){for(const t in this._wmtsList){const e=this._wmtsList[t];e.hd&&(this._hdList[e.entity]=e.name);const i=this._scene.get(e.entity).addComponent("wmts",e.name);i.setEnabled(!1),i.setEndPoint(e.endPoint),i.setLayer(e.layer),e.tile&&i.setTileMatrixSet(e.tile);const s=new Date;"yesterday"===e.time?(s.setDate(s.getDate()-1),i.setDimensionValue("Time",s.getFullYear()+"-"+(s.getMonth()+1+"").padStart(2,"0")+"-"+(s.getDate()+"").padStart(2,"0"))):"now"===e.time&&i.setDimensionValue("Time",s.getFullYear()+"-"+(s.getMonth()+1+"").padStart(2,"0")+"-"+(s.getDate()+"").padStart(2,"0")),e.level?i.setMaxLevel(e.level):i.setMaxLevel(1/0)}}}},t=>{"use strict";t.exports=JSON.parse('{"viirs":{"name":"viirs","entity":"earth","hd":true,"endPoint":"https://gibs.earthdata.nasa.gov/wmts/epsg4326/best","layer":"VIIRS_SNPP_CorrectedReflectance_TrueColor","tile":"250m","time":"yesterday"},"lro":{"name":"lro","entity":"moon","hd":true,"endPoint":"https://trek.nasa.gov/tiles/Moon/EQ/corrected/LRO_WAC_Mosaic_Global_303ppd_v02","layer":"LRO_WAC_Mosaic_Global_303ppd_v02","tile":"default028mm"},"viking":{"name":"viking","entity":"mars","hd":true,"endPoint":"https://trek.nasa.gov/tiles/Mars/EQ/corrected/Mars_Viking_MDIM21_ClrMosaic_global_232m","layer":"Mars_Viking_MDIM21_ClrMosaic_global_232m","tile":"default028mm"}}')},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var s=i(1),n=i(406);i(434);class CompareMenu extends n.default{constructor(t,e){super(t),this._isVisible=!1,this._init=!1,this._scene=e,this._initialObjectId="",this._comparisonCategory="",this._leftObjectId="",this._rightObjectId="",this._planetList=["sun","mercury","venus","earth","moon","mars","4_vesta","jupiter","saturn","uranus","neptune","134340_pluto"],this._moonList=["mercury","moon","phobos","1_ceres","io","europa","ganymede","callisto","enceladus","titan","134340_pluto","charon"],this._asteroidCometList=["101955_bennu","16_psyche","433_eros","4_vesta","1p_halley","67p_churyumov_gerasimenko","81p_wild_2","9p_tempel_1","c_1995_o1"],this._dwarfPlanetList=["earth","moon","1_ceres","io","europa","titan","134340_pluto","136472_makemake","136108_haumea","136199_eris"],this._spacecraftList=["scientist","school_bus","rose_bowl","sc_parker_solar_probe","sc_osiris_rex","sc_hubble_space_telescope","sc_juno","sc_new_horizons","sc_voyager_1"],this._categories={planet:{types:["Terrestrial Planet","Gas Giant","Ice Giant","Star"],list:this._planetList,default:"earth",fallback:"mars"},moon:{types:["Moon"],list:this._moonList,default:"moon",fallback:"europa"},asteroid:{types:["Asteroid","Comet"],list:this._asteroidCometList,default:"4_vesta",fallback:"101955_bennu"},dwarf:{types:["Dwarf Planet"],list:this._dwarfPlanetList,default:"134340_pluto",fallback:"1_ceres"},spacecraft:{types:["Spacecraft"],list:this._spacecraftList,default:"sc_hubble_space_telescope",fallback:"sc_juno"}},this.setEnabled(!1)}async init(){const t=document.createElement("div");t.className="container",this._div.appendChild(t),this._comparePanel=document.createElement("div"),this._comparePanel.innerHTML="",this._comparePanel.style.display="none",this._comparePanel.className="compare-panel",this._comparePanel.addEventListener("animationend",(()=>{"0"===window.getComputedStyle(this._comparePanel).opacity?this._comparePanel.style.display="none":this._comparePanel.style.display="block"}),!0),t.appendChild(this._comparePanel),await this._loadTemplate(this._comparePanel)}async _loadTemplate(t){await fetch("compare_panels.html").then((t=>t.text())).then((e=>{t.innerHTML=e})),this._closeContainer=document.getElementById("close-compare-container"),this._closeContainer.style.display="none",this._closeCompare=document.createElement("button"),this._closeCompare.innerHTML="Close Comparison Mode",this._closeCompare.type="button",this._closeCompare.className="close-compare no-select",this._closeCompare.value="close",this._closeCompare.addEventListener("click",(t=>{const e="/"+s.default.router._currentRoute.params.id,i={time:s.default.get("time").getTimeUrl()};s.default.router.navigate(e,i)})),this._closeContainer.appendChild(this._closeCompare),this._previousCompareButton=document.getElementsByClassName("left-arrow")[0],this._nextCompareButton=document.getElementsByClassName("right-arrow")[0],this._previousCompareButton.addEventListener("click",(async t=>{await this._previous(this._initialObjectId,this._rightObjectId)})),this._nextCompareButton.addEventListener("click",(async t=>{await this._next(this._initialObjectId,this._rightObjectId)}));const e=t.getElementsByClassName("title"),i=t.getElementsByClassName("type"),n=t.getElementsByClassName("radius"),r=t.getElementsByClassName("unit"),o=t.getElementsByClassName("label");this._comparisonText={left:{name:e[0],type:i[0],radius:n[0],unit:r[0],label:o[0]},right:{name:e[1],type:i[1],radius:n[1],unit:r[1],label:o[1]}},this._leftContainer=t.querySelector("#left-container"),this._rightContainer=t.querySelector("#right-container"),window.addEventListener("unitSystemToggle",(t=>{this._updateText("left"),this._updateText("right")}),!1)}_getClassName(t){let e="";const i=s.default.scene.get(t);if(null===i)e=s.default.get("content").getClassName(t);else{const n=i.getParent();null!==n&&"sun"!==n.getName()&&"milky_way"!==n.getName()&&(t=n.getName(),t=s.default.get("content").getReplacement(t)),e=s.default.get("content").getClassName(t)}return e}hide(){this._isVisible=!1,this._closeContainer.style.display="none";const t=document.getElementById("left-viewport"),e=document.getElementById("right-viewport");for(const i of[t,e,this._comparePanel])i.style.display="block",i.classList.add("hidden"),i.classList.remove("active")}show(){this._isVisible=!0,this._closeContainer.style.display="block";const t=document.getElementById("left-viewport"),e=document.getElementById("right-viewport");for(const i of[t,e,this._comparePanel])i.style.display="block",i.classList.add("active"),i.classList.remove("hidden")}isVisible(){return this._isVisible}__disable(){this._isVisible&&this.hide(),this._init=!1,this._initialObjectId="",this._comparisonCategory="",this._leftObjectId="",this._rightObjectId=""}__enable(){this.show()}async update(t,e){if(t=s.default.get("content").getReplacement(t),e=s.default.get("content").getReplacement(e),!this._init){this._init=!0,this._initialObjectId=t;const e=s.default.get("content").getEntityInfo(this._initialObjectId);this._comparisonCategory=e.category}t!==this._leftObjectId&&(this._leftObjectId=t,await this._updateText("left")),e!==this._rightObjectId&&(this._rightObjectId=e,await this._updateText("right"))}async _updateText(t){let e="";"right"===t?(e=this._rightObjectId,this._rightContainer.className=this._getClassName(e)):(e=this._leftObjectId,this._leftContainer.className=this._getClassName(e));const i=await this.entityCompareLookup(e),n=this._comparisonText[t],r=s.default.get("content").getEntityInfo(e);if(r&&["Spacecraft","Comparison Object"].indexOf(r.category)>=0?(i.radius*=2,n.label.innerHTML="Length"):n.label.innerHTML="Radius",n.name.innerHTML=i.name,n.type.innerHTML=i.category,n.type.className="type "+i.icon,n.radius.innerHTML=i.radius<1?(1e3*i.radius).toFixed(1):i.radius.toFixed(1),n.unit.innerHTML=i.radius<1?"M":"KM",!s.default.isMetric()){const t=s.default.conversionTable,e=i.radius*t.kmToMi;if(e<1){const i=e*t.miToFt;n.radius.innerHTML=i.toFixed(1),n.unit.innerHTML="Feet"}else n.radius.innerHTML=e.toFixed(1),n.unit.innerHTML="Miles"}}async entityCompareLookup(t){const e=s.default.get("content").getEntityInfo(t),i=this._scene.get(t);let n=(await s.default.get("content").getEntityDesc(t)).shortName;void 0!==n&&""!==n||(n=e.name);let r=e.category,o=e.category.toLowerCase().replace(/ /g,"-");return void 0!==e.subcategory&&(r=e.subcategory,"Spacecraft"===e.category&&(r+=" "+e.category,o+=" "+e.subcategory.toLowerCase().replace(/ /g,"-"))),{name:n,category:r,icon:o,radius:"Spacecraft"===e.category?i.getExtentsRadius():i.getOcclusionRadius()}}async _previous(t,e){const i=this._comparisonCategory;let n="";for(const s in this._categories){const r=this._categories[s];if(r.types.includes(i)){n=this.scrollListWithExclusion(r.list,e,-1,t);break}}if(""===n)return void console.log("[Comparison] Cannot find next object before "+e);const r=s.default.router._currentRoute.url,o={to:n,time:s.default.get("time").getTimeUrl()};s.default.router.navigate(r,o)}async _next(t,e){const i=this._comparisonCategory;let n="";for(const s in this._categories){const r=this._categories[s];if(r.types.includes(i)){n=this.scrollListWithExclusion(r.list,e,1,t);break}}if(""===n)return void console.log("[Comparison] Cannot find next object after "+e);const r=s.default.router._currentRoute.url,o={to:n,time:s.default.get("time").getTimeUrl()};s.default.router.navigate(r,o)}scrollListWithExclusion(t,e,i,s){let n=t.indexOf(e);return n=(n+t.length+i)%t.length,t[n]===s&&(n=(n+t.length+i)%t.length),t[n]}getDefaultComparison(t){const e=s.default.get("content").getEntityInfo(t).category;let i="earth";for(const s in this._categories){const n=this._categories[s];if(n.types.includes(e)){i=n.default===t?n.fallback:n.default;break}}return i}}const r=CompareMenu},(t,e,i)=>{"use strict";i.r(e)},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>TimeRateSlider});var s=i(436);i(2);class TimeRateSlider extends s.default{constructor(t,e){super(t),this._pioneer=e,this._prevTimeRate=this._pioneer.getTimeRate(),this.resetValue=.5,this.handleGrabbedCallback=()=>{this._prevTimeRate=this._pioneer.getTimeRate()},this.valueChangedCallback=t=>{let e=0;const i=2*Math.abs(t-.5);for(let t=1;t<TimeRateSlider._rates.length;t++)if(i<=t/(TimeRateSlider._rates.length-1)){e=TimeRateSlider._rates[t-1]+i/(t/(TimeRateSlider._rates.length-1))*(TimeRateSlider._rates[t]-TimeRateSlider._rates[t-1]);break}t<.5&&(e*=-1),this._pioneer.setTimeRate(e)},this.handleReleasedCallback=()=>{this._pioneer.setTimeRate(this._prevTimeRate)}}}TimeRateSlider._rates=[0,10,60,600,3600,21600,86400,604800,2419200,7889616,31558464]},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>BaseSlider});var s=i(437);class BaseSlider extends s.default{constructor(t){super(t),this._handleGrabbedCallback=null,this._valueChangedCallback=null,this._handleReleasedCallback=null,this._resetValue=void 0,this._value=0,this._sliding=!1,this._boundMouseMoveEventListener=this._mouseMoveEventListener.bind(this),this._boundMouseUpEventListener=this._mouseUpEventListener.bind(this);const e=this.elem.querySelector("#bar");e.addEventListener("mousedown",(t=>{null!==this._handleGrabbedCallback&&this._handleGrabbedCallback(),this._sliding=!0,this._mouseMoveEventListener(t),t.preventDefault()})),e.addEventListener("touchstart",(t=>{this._sliding=!0,null!==this._handleGrabbedCallback&&this._handleGrabbedCallback(),t.preventDefault()})),e.addEventListener("touchmove",(t=>{this._mouseMoveEventListener(t.touches[0])})),e.addEventListener("touchend",this._boundMouseUpEventListener),document.addEventListener("mouseup",this._boundMouseUpEventListener),document.addEventListener("mousemove",this._boundMouseMoveEventListener)}destroy(){document.removeEventListener("mousemove",this._boundMouseMoveEventListener),document.removeEventListener("mouseup",this._boundMouseUpEventListener),super.destroy()}set handleGrabbedCallback(t){this._handleGrabbedCallback=t}set valueChangedCallback(t){this._valueChangedCallback=t}set handleReleasedCallback(t){this._handleReleasedCallback=t}get value(){return this._value}set value(t){const e=Math.max(0,Math.min(1,t));if(this._value!==e){const t=this.elem.querySelector("#bar").getBoundingClientRect(),i=this.elem.querySelector("#handle").getBoundingClientRect();this.elem.querySelector("#handle").style.left=e*(t.width-i.width)/t.width*100+"%",this._value=e,null!==this._valueChangedCallback&&this._valueChangedCallback(e)}}get resetValue(){return this._resetValue}set resetValue(t){this._resetValue=t,void 0!==this._resetValue&&(this.value=this._resetValue)}_mouseUpEventListener(t){this._sliding&&(this._sliding=!1,void 0!==this._resetValue&&(this.value=this._resetValue),null!==this._handleReleasedCallback&&this._handleReleasedCallback())}_mouseMoveEventListener(t){if(this._sliding){const e=this.elem.querySelector("#bar").getBoundingClientRect(),i=this.elem.querySelector("#handle").getBoundingClientRect(),s=(t.clientX-e.left-i.width/2)/(e.width-i.width);this.value=s}}}BaseSlider.style="\n\t.BaseSlider {\n\t\tposition: relative;\n\t\toverflow: auto;\n\t\tpointer-events: auto;\n\t}\n\t.BaseSlider #bar {\n\t\twidth: calc(100% - 1em);\n\t\theight: 100%;\n\t}\n\t.BaseSlider #handle {\n\t\tposition: absolute;\n\t\tmargin: auto;\n\t\ttop: 0;\n\t\tbottom: 0;\n\t\twidth: 1em;\n\t\theight: 1em;\n\t\tpointer-events: none;\n\t}\n\t",BaseSlider.html='\n\t<svg id="bar"><line x1="0" y1="50%" x2="100%" y2="50%" stroke="var(--fg)" stroke-width="1.5"/>\x3c!--<line x1="0" y1="0" x2="0" y2="100%" stroke="var(--fg)" stroke-width="1.5"/><line x1="100%" y1="0" x2="100%" y2="100%" stroke="var(--fg)" stroke-width="1.5"/>--\x3e</svg>\n\t<div id="handle"></div>\n\t'},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>UIComponent});var s=i(406);class UIComponent extends s.default{constructor(t){if(super(t),null==t)throw new Error("No element was specified in which to create the "+this.constructor.name);this._elem=t;let e=Object.getPrototypeOf(this);for(;e.constructor!==UIComponent;){if(this._elem.classList.add(e.constructor.name),Object.prototype.hasOwnProperty.call(e.constructor,"style")){let t=document.querySelector("head style#"+e.constructor.name);null===t&&(t=document.createElement("style"),t.id=e.constructor.name,t.useCount=0,t.innerHTML=e.constructor.style,document.head.appendChild(t)),t.useCount+=1}e=Object.getPrototypeOf(e)}this._elem.innerHTML=this.constructor.html||""}destroy(){this._elem.innerHTML="";let t=Object.getPrototypeOf(this);for(;t.constructor!==UIComponent;){const e=document.querySelector("head style#"+t.constructor.name);e&&(e.useCount-=1,0===e.useCount&&document.head.removeChild(e)),this._elem.classList.remove(t.constructor.name),t=Object.getPrototypeOf(t)}}get elem(){return this._elem}}},(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>l});var s=i(439),n=i.n(s),r=i(1),o=i(265),a=i.n(o);const l=class Router{constructor(){this._router=new(n())(null,!0),this._lastRoute=null,this._currentRoute={},this._previousRoute={},this.navigate=this.navigate.bind(this),this._componentsMap={always:["messageBar","controls","options"],default:["clock","searchBar","navigationBar","detailsPanel"],compare:["compareMenu"]},this._introLaunched=!1,this._firstLoad=!0,this._componentsToActivate=[],this._init()}_init(){this._router.hooks({before:async t=>{this._previousRoute={...this._currentRoute};const e=window.location.hash.match(/\/([a-zA-Z0-9_-]*)/g);if(this._componentsToActivate=[],null!==e&&void 0!==e[1]){const t=e[1].replace("/","");void 0!==this._componentsMap[t]&&(this._componentsToActivate=this._componentsToActivate.concat(this._componentsMap[t]))}if(null!==e&&void 0!==e[0]){const t=e[0].replace("/","");void 0!==this._componentsMap[t]&&(this._componentsToActivate=this._componentsToActivate.concat(this._componentsMap[t]))}if(0===this._componentsToActivate.length&&(this._componentsToActivate=this._componentsMap.default),this._componentsToActivate=this._componentsToActivate.concat(this._componentsMap.always),this.resetStatus(Object.keys(r.default.getComponents())),this._lastRoute=Object.assign({},this._currentRoute),this._currentRoute=this._router.lastRouteResolved(),null!==this._currentRoute){this._currentRoute.url=this._currentRoute.url.replace(/(\/)+/,"/");const t=await this._parseQuery(this.lastRouteResolved().query);t.close&&null!==r.default.get("options")?r.default.get("options").displayCloseButton(!0):null!==r.default.get("options")&&r.default.get("options").displayCloseButton(!1),t.close&&r.default.showNASALogo()}t()},after:()=>{this._router.updatePageLinks(),this._router.history||(this._router.history=[]);const t=this._router.lastRouteResolved();this._router.history.unshift(t)}}),this._router.on("/",(async t=>{t&&(t="?"+t);const e=window.location.pathname;history.replaceState(t,"",e+"#/home"+t),this._router.resolve()})).on("/inner_solar_system",(async(t,e)=>{e&&(e=await this._processQuery(e)),await r.default.pioneer.waitUntilNextFrame();const i="inner_solar_system";r.default.selector.selectEntity(i),r.default.camera.goToObject(i,"default").then((()=>{})),this._firstLoad=!1}),{before:async t=>{const e=await this._parseQuery(this.lastRouteResolved().query);let i=r.default.get("time").getNowTime();e.time&&(i=this.parseTime(e.time)),this._previousRoute.url&&this._previousRoute.url.endsWith("/compare")&&r.default.get("compareManager").exit(),r.default.get("scene").isReady("sun",i).then((()=>{t()}))}}).on("/home",(async(t,e)=>{e&&(e=await this._processQuery(e)),await r.default.pioneer.waitUntilNextFrame();const i="outer_solar_system";r.default.selector.selectEntity(i),!this._introLaunched&&this._firstLoad?r.default.camera.intro().then((()=>{this._introLaunched=!0})):r.default.camera.goToObject(i,"default").then((()=>{})),this._firstLoad=!1}),{before:async(t,e)=>{const i=await this._parseQuery(this.lastRouteResolved().query);let s=r.default.get("time").getNowTime();i.time&&(s=this.parseTime(i.time)),this._previousRoute.url&&this._previousRoute.url.endsWith("/compare")&&r.default.get("compareManager").exit(),r.default.get("scene").isReady("sun",s).then((()=>{t()}))},after:()=>{},leave:()=>{}}).on("/:id/compare",(async(t,e)=>{e&&(e=await this._processQuery(e)),await r.default.pioneer.waitUntilNextFrame(),r.default.pioneer.getConfig().setValue("maxTextureSize",512),r.default.selector.selectEntity(t.id);let i=r.default.get("compareMenu").getDefaultComparison(t.id);e.to&&null!==r.default.get("content").getEntityInfo(e.to)&&e.to!==t.id&&(i=e.to),await r.default.get("compareManager").compare(t.id,i),r.default.get("compareMenu").update(t.id,i),this._firstLoad=!1}),{before:async(t,e)=>{const i=await this._parseQuery(this.lastRouteResolved().query);let s=r.default.get("time").getNowTime();i.time&&(s=this.parseTime(i.time)),r.default.get("scene").isReady(e.id,s).then((()=>{t()})).catch((async t=>{if(t){const t="/home";await this.navigate(t)}}))},after:()=>{},leave:()=>{r.default.get("scene").isHD()&&r.default.pioneer.getConfig().setValue("maxTextureSize",4096)}}).on("/:id",(async(t,e)=>{e&&(e=await this._processQuery(e)),await r.default.pioneer.waitUntilNextFrame(),r.default.selector.selectEntity(t.id);let i="near";e&&e.range&&"far"===e.range&&(i=e.range),r.default.camera.goToObject(t.id,i).then((()=>{})),this._firstLoad=!1}),{before:async(t,e)=>{const i=await this._parseQuery(this.lastRouteResolved().query);let s=r.default.get("time").getNowTime();i.time&&(s=this.parseTime(i.time)),this._previousRoute.url&&this._previousRoute.url.endsWith("/compare")&&r.default.get("compareManager").exit();try{await r.default.get("scene").isListReady([e.id],[s]);const i=r.default.scene.get(e.id);if(null===i){const t="/home";await this.navigate(t)}const n=i.getParent();null!==n&&await r.default.get("scene").isListReady([n.getName()],[s]),t()}catch(t){if(t){const t="/home";await this.navigate(t)}}},after:()=>{},leave:()=>{}}).notFound((async(t,e)=>{let i="/home";t&&(i+="?"+t),await this.navigate(i)})).resolve()}resetStatus(t){for(let e=t.length-1;e>=0;e--)r.default.get(t[e]).setEnabled(this._componentsToActivate.includes(t[e]))}_urlChanged(t,e){return this.getOnlyURL(t)!==this.getOnlyURL(e)}extractGETParameters(t){return t.split(/\?(.*)?$/).slice(1).join("")}getOnlyURL(t){let e=t;const cleanGETParam=t=>t.split(/\?(.*)?$/)[0],i=t.split("#");return e=i.length>1?cleanGETParam(i[1]):cleanGETParam(i[0]),e}_stillOnRoute(t){const e=this._currentRoute.url.match(/^\/([^!/]*)/);return null!==e&&void 0!==e[1]&&e[1]===t}_parseQuery(t){return t?(t.replace("?",""),Promise.resolve(t.split("&").reduce(((t,e)=>{const i=e.split("=");if(i[0]){let e=i[1].trim();switch(e.toLowerCase()){case"true":e=!0;break;case"false":e=!1;break;case"undefined":case"null":e=null}t[i[0].trim()]=e}return t}),{}))):Promise.resolve({})}_buildQuery(t){let e="";for(const[i,s]of Object.entries(t))e+="&"+i+"="+s;return e=e.replace("&","?"),e}async _processQuery(t){return this._parseQuery(t).then((t=>{if(t.time){const e=this.parseTime(t.time);r.default.get("time").setTime(e)}return t}))}parseTime(t){const e=t.match(/^(?:[1-9]\d{3}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1\d|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[1-9]\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-02-29)T(?:[01]\d|2[0-3]):[0-5]\d(?:|:[0-5]\d)(?:\.\d{1,6})?(?:|Z|[+-][01]\d:[0-5]\d)$/);let i=a()();return i=null===e||"now"===t?r.default.get("time").getNowTime():a().tz(t,"Etc/UTC"),i}async addQueryToPath(t){const e=this._router.lastRouteResolved();return this._parseQuery(e.query).then((i=>{const s=this._buildQuery(Object.assign({},i,t));return e.url.replace(/(\/)(?=\/*\1)/,"")+s}))}async hasSameQuery(t){const e=await this._parseQuery(this._router.lastRouteResolved().query),i=Object.keys(t);let s=!0;for(let n=i.length-1;n>=0;n--)if(e[i[n]]!==t[i[n]]){s=!1;break}return s}pause(){this._router.pause()}resume(){this._router.resume()}async navigate(t,e){if(e){const i=await this._parseQuery(this.lastRouteResolved().query);i.close&&(e.close=i.close),t+=this._buildQuery(e)}this._router.navigate(t)}navigateBack(){if(null===r.default.router.getLastRoute())this._router.navigate("/home");else{let t=r.default.router.getLastRoute().url;r.default.router.getLastRoute().query&&(t+="?"+r.default.router.getLastRoute().query),this._router.navigate(t)}}getLastRoute(){return Object.keys(this._lastRoute).length>0?this._lastRoute:null}getCurrentRoute(){return this._currentRoute}lastRouteResolved(){return this._router.lastRouteResolved()}lastPathResolved(){const t=this._router.lastRouteResolved();return t.query?t.url+"?"+t.query:t.url}}}],i={};function __webpack_require__(t){var s=i[t];if(void 0!==s)return s.exports;var n=i[t]={id:t,loaded:!1,exports:{}};return e[t].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=e,t=[],__webpack_require__.O=(e,i,s,n)=>{if(!i){var r=1/0;for(h=0;h<t.length;h++){for(var[i,s,n]=t[h],o=!0,a=0;a<i.length;a++)(!1&n||r>=n)&&Object.keys(__webpack_require__.O).every((t=>__webpack_require__.O[t](i[a])))?i.splice(a--,1):(o=!1,n<r&&(r=n));if(o){t.splice(h--,1);var l=s();void 0!==l&&(e=l)}}return e}n=n||0;for(var h=t.length;h>0&&t[h-1][2]>n;h--)t[h]=t[h-1];t[h]=[i,s,n]},__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var i in e)__webpack_require__.o(e,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={0:0};__webpack_require__.O.j=e=>0===t[e];var webpackJsonpCallback=(e,i)=>{var s,n,[r,o,a]=i,l=0;if(r.some((e=>0!==t[e]))){for(s in o)__webpack_require__.o(o,s)&&(__webpack_require__.m[s]=o[s]);if(a)var h=a(__webpack_require__)}for(e&&e(i);l<r.length;l++)n=r[l],__webpack_require__.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return __webpack_require__.O(h)},e=globalThis.webpackChunkorrery=globalThis.webpackChunkorrery||[];e.forEach(webpackJsonpCallback.bind(null,0)),e.push=webpackJsonpCallback.bind(null,e.push.bind(e))})();var s=__webpack_require__.O(void 0,[1],(()=>__webpack_require__(0)));s=__webpack_require__.O(s)})();